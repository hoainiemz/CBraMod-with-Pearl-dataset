100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.01it/s]
Epoch 1 : Training Loss: 1.73503, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00025, Time elapsed 0.27 mins
[[  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.63it/s]
Epoch 2 : Training Loss: 1.66206, acc: 0.20533, kappa: 0.00667, f1: 0.11047, LR: 0.00025, Time elapsed 0.27 mins
[[ 39   0   0 111   0]
 [ 42   0   1 107   0]
 [ 38   0   0 112   0]
 [ 35   0   0 115   0]
 [ 46   0   1 103   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20533, kappa: 0.00667, f1: 0.11047
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.00it/s]
Epoch 3 : Training Loss: 1.63192, acc: 0.21067, kappa: 0.01333, f1: 0.08694, LR: 0.00025, Time elapsed 0.27 mins
[[  0   4 146   0   0]
 [  0   8 142   0   0]
 [  0   0 150   0   0]
 [  0   5 145   0   0]
 [  0   5 145   0   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21067, kappa: 0.01333, f1: 0.08694
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.23it/s]
Epoch 4 : Training Loss: 1.63050, acc: 0.24667, kappa: 0.05833, f1: 0.20653, LR: 0.00025, Time elapsed 0.27 mins
[[59 15 50  0 26]
 [65 13 45  0 27]
 [42 11 61  0 36]
 [55 13 46  0 36]
 [45  7 46  0 52]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24667, kappa: 0.05833, f1: 0.20653
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.91it/s]
Epoch 5 : Training Loss: 1.62023, acc: 0.23733, kappa: 0.04667, f1: 0.14833, LR: 0.00025, Time elapsed 0.28 mins
[[ 31   0 119   0   0]
 [ 32  10 108   0   0]
 [ 15   1 134   0   0]
 [ 21   4 125   0   0]
 [ 20   2 125   0   3]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.92it/s]
Epoch 6 : Training Loss: 1.59506, acc: 0.27333, kappa: 0.09167, f1: 0.24017, LR: 0.00024, Time elapsed 0.28 mins
[[88 19 31  0 12]
 [82 38 20  0 10]
 [66 11 52  0 21]
 [83 18 24  3 22]
 [77 20 27  2 24]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27333, kappa: 0.09167, f1: 0.24017
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.30it/s]
Epoch 7 : Training Loss: 1.54279, acc: 0.28533, kappa: 0.10667, f1: 0.26125, LR: 0.00024, Time elapsed 0.27 mins
[[ 27  10  20  13  80]
 [ 22  28  30   8  62]
 [ 16   2  42  10  80]
 [ 19  10  18  16  87]
 [  9  11  13  16 101]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28533, kappa: 0.10667, f1: 0.26125
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.14it/s]
Epoch 8 : Training Loss: 1.48025, acc: 0.33467, kappa: 0.16833, f1: 0.31931, LR: 0.00024, Time elapsed 0.27 mins
[[26 16 55 22 31]
 [17 27 56 20 30]
 [10 10 87 16 27]
 [13  8 55 49 25]
 [12 12 48 16 62]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.33467, kappa: 0.16833, f1: 0.31931
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.67it/s]
Epoch 9 : Training Loss: 1.34760, acc: 0.38000, kappa: 0.22500, f1: 0.38223, LR: 0.00023, Time elapsed 0.27 mins
[[65 23 21 15 26]
 [43 54 16 17 20]
 [32 11 59 10 38]
 [44 13 17 48 28]
 [35 20 12 24 59]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.38000, kappa: 0.22500, f1: 0.38223
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.41it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.13it/s]
Epoch 10 : Training Loss: 1.17306, acc: 0.39733, kappa: 0.24667, f1: 0.39651, LR: 0.00023, Time elapsed 0.28 mins
[[57 23 22 27 21]
 [32 58 22 18 20]
 [12 25 72 21 20]
 [26 24 20 59 21]
 [23 27 29 19 52]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.39733, kappa: 0.24667, f1: 0.39651
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.45it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.07it/s]
Epoch 11 : Training Loss: 0.98808, acc: 0.43067, kappa: 0.28833, f1: 0.42725, LR: 0.00022, Time elapsed 0.28 mins
[[47 22 25 32 24]
 [18 64 30 23 15]
 [14 23 84 18 11]
 [12 26 31 69 12]
 [19 17 26 29 59]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.43067, kappa: 0.28833, f1: 0.42725
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.78it/s]
Epoch 12 : Training Loss: 0.80931, acc: 0.44400, kappa: 0.30500, f1: 0.44390, LR: 0.00022, Time elapsed 0.28 mins
[[62 26  7 18 37]
 [26 71 10 15 28]
 [25 27 53 12 33]
 [26 19  8 61 36]
 [27 17  9 11 86]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.44400, kappa: 0.30500, f1: 0.44390
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.76it/s]
Epoch 13 : Training Loss: 0.71249, acc: 0.44000, kappa: 0.30000, f1: 0.44031, LR: 0.00021, Time elapsed 0.27 mins
[[59 27 15 23 26]
 [25 70 19 19 17]
 [16 30 69  7 28]
 [16 35 14 57 28]
 [18 26 13 18 75]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.04it/s]
Epoch 14 : Training Loss: 0.65426, acc: 0.45867, kappa: 0.32333, f1: 0.45932, LR: 0.00021, Time elapsed 0.28 mins
[[75 16 13 23 23]
 [30 65 15 18 22]
 [24 25 70 12 19]
 [24 24 13 70 19]
 [28 19 20 19 64]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.45867, kappa: 0.32333, f1: 0.45932
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.46it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.75it/s]
Epoch 15 : Training Loss: 0.59111, acc: 0.46667, kappa: 0.33333, f1: 0.46742, LR: 0.00020, Time elapsed 0.28 mins
[[65 21 12 28 24]
 [24 73 14 19 20]
 [16 22 68 20 24]
 [14 30 14 70 22]
 [26 18 11 21 74]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.46667, kappa: 0.33333, f1: 0.46742
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.54it/s]
Epoch 16 : Training Loss: 0.55563, acc: 0.47067, kappa: 0.33833, f1: 0.47002, LR: 0.00019, Time elapsed 0.28 mins
[[69 11 19 25 26]
 [31 58 24 17 20]
 [19 16 76 13 26]
 [16 17 17 74 26]
 [24 14 17 19 76]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.47067, kappa: 0.33833, f1: 0.47002
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.91it/s]
Epoch 17 : Training Loss: 0.53524, acc: 0.48400, kappa: 0.35500, f1: 0.48383, LR: 0.00019, Time elapsed 0.28 mins
[[69 25 16 18 22]
 [19 74 20 21 16]
 [16 17 83 15 19]
 [22 27 14 64 23]
 [29 16 16 16 73]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.48400, kappa: 0.35500, f1: 0.48383
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.88it/s]
Epoch 18 : Training Loss: 0.50153, acc: 0.47067, kappa: 0.33833, f1: 0.47285, LR: 0.00018, Time elapsed 0.28 mins
[[55 28 10 32 25]
 [24 71 11 25 19]
 [13 29 73 19 16]
 [10 32  9 80 19]
 [15 29  7 25 74]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.57it/s]
Epoch 19 : Training Loss: 0.49109, acc: 0.47200, kappa: 0.34000, f1: 0.47296, LR: 0.00017, Time elapsed 0.28 mins
[[74 20 16 17 23]
 [38 64 15 15 18]
 [19 21 79  9 22]
 [20 29 13 65 23]
 [24 19 16 19 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.82it/s]
Epoch 20 : Training Loss: 0.47408, acc: 0.50000, kappa: 0.37500, f1: 0.49985, LR: 0.00017, Time elapsed 0.27 mins
[[77 22 17 17 17]
 [29 72 16 14 19]
 [15 18 92  7 18]
 [19 31 13 66 21]
 [28 22 20 12 68]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.50000, kappa: 0.37500, f1: 0.49985
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.14it/s]
Epoch 21 : Training Loss: 0.45952, acc: 0.49333, kappa: 0.36667, f1: 0.49150, LR: 0.00016, Time elapsed 0.27 mins
[[72 14 30 16 18]
 [32 65 18 18 17]
 [15 16 95 10 14]
 [17 19 25 71 18]
 [26 17 27 13 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.42it/s]
Epoch 22 : Training Loss: 0.45058, acc: 0.51200, kappa: 0.39000, f1: 0.51373, LR: 0.00015, Time elapsed 0.27 mins
[[82 17 13 16 22]
 [41 71 10 16 12]
 [21 16 87 11 15]
 [23 27 13 70 17]
 [28 16 13 19 74]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.51200, kappa: 0.39000, f1: 0.51373
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.83it/s]
Epoch 23 : Training Loss: 0.44227, acc: 0.49867, kappa: 0.37333, f1: 0.49667, LR: 0.00014, Time elapsed 0.27 mins
[[80 11 14 28 17]
 [37 56 14 27 16]
 [19 13 92 11 15]
 [19 23 16 78 14]
 [26 10 21 25 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.85it/s]
Epoch 24 : Training Loss: 0.43456, acc: 0.50133, kappa: 0.37667, f1: 0.50154, LR: 0.00014, Time elapsed 0.27 mins
[[75 20 15 19 21]
 [32 65  9 22 22]
 [19 12 80 15 24]
 [17 23 12 71 27]
 [23 11 16 15 85]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.06it/s]
Epoch 25 : Training Loss: 0.42715, acc: 0.51333, kappa: 0.39167, f1: 0.51283, LR: 0.00013, Time elapsed 0.27 mins
[[75 14 21 24 16]
 [31 68 15 23 13]
 [16 15 88 14 17]
 [17 21 18 79 15]
 [20 12 22 21 75]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.51333, kappa: 0.39167, f1: 0.51283
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.25it/s]
Epoch 26 : Training Loss: 0.42557, acc: 0.51067, kappa: 0.38833, f1: 0.51025, LR: 0.00012, Time elapsed 0.27 mins
[[78 20 17 19 16]
 [23 72 13 24 18]
 [17 14 91 13 15]
 [18 25 12 71 24]
 [20 16 21 22 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.42it/s]
Epoch 27 : Training Loss: 0.42202, acc: 0.50667, kappa: 0.38333, f1: 0.50846, LR: 0.00011, Time elapsed 0.27 mins
[[75 20 15 26 14]
 [32 70 10 25 13]
 [14 20 86 14 16]
 [16 32 10 80 12]
 [21 23 13 24 69]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.90it/s]
Epoch 28 : Training Loss: 0.41926, acc: 0.50800, kappa: 0.38500, f1: 0.50869, LR: 0.00010, Time elapsed 0.28 mins
[[75 22 16 20 17]
 [31 70 11 19 19]
 [14 17 89 12 18]
 [19 28 11 73 19]
 [25 13 16 22 74]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.86it/s]
Epoch 29 : Training Loss: 0.41755, acc: 0.50267, kappa: 0.37833, f1: 0.50297, LR: 0.00010, Time elapsed 0.27 mins
[[79 17 15 23 16]
 [32 68 10 19 21]
 [16 17 83 14 20]
 [17 26 13 72 22]
 [23 13 19 20 75]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.38it/s]
Epoch 30 : Training Loss: 0.41614, acc: 0.50400, kappa: 0.38000, f1: 0.50410, LR: 0.00009, Time elapsed 0.27 mins
[[74 18 14 27 17]
 [35 63 10 26 16]
 [15 15 85 18 17]
 [16 21 12 84 17]
 [23 13 17 25 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.21it/s]
Epoch 31 : Training Loss: 0.41403, acc: 0.51067, kappa: 0.38833, f1: 0.51103, LR: 0.00008, Time elapsed 0.27 mins
[[74 19 13 24 20]
 [32 67 10 20 21]
 [16 15 92 10 17]
 [17 22 11 78 22]
 [23 16 19 20 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.07it/s]
Epoch 32 : Training Loss: 0.41192, acc: 0.51333, kappa: 0.39167, f1: 0.51371, LR: 0.00007, Time elapsed 0.27 mins
[[76 19 17 20 18]
 [34 71 11 20 14]
 [17 16 89 13 15]
 [15 26 12 75 22]
 [23 16 18 19 74]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.03it/s]
Epoch 33 : Training Loss: 0.41125, acc: 0.51200, kappa: 0.39000, f1: 0.51156, LR: 0.00007, Time elapsed 0.27 mins
[[72 23 19 19 17]
 [29 71 17 18 15]
 [16 16 93 11 14]
 [15 24 16 76 19]
 [23 20 16 19 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.45it/s]
Epoch 34 : Training Loss: 0.41029, acc: 0.51200, kappa: 0.39000, f1: 0.51173, LR: 0.00006, Time elapsed 0.28 mins
[[74 18 17 21 20]
 [30 74 14 18 14]
 [16 17 91 11 15]
 [14 28 16 73 19]
 [23 18 18 19 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.18it/s]
Epoch 35 : Training Loss: 0.40928, acc: 0.50667, kappa: 0.38333, f1: 0.50806, LR: 0.00005, Time elapsed 0.28 mins
[[78 20 13 23 16]
 [36 68  9 24 13]
 [19 17 82 16 16]
 [14 24 11 79 22]
 [23 16 13 25 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.38it/s]
Epoch 36 : Training Loss: 0.40927, acc: 0.51067, kappa: 0.38833, f1: 0.51138, LR: 0.00005, Time elapsed 0.27 mins
[[74 19 18 22 17]
 [29 70 11 23 17]
 [15 18 85 15 17]
 [13 28 11 78 20]
 [20 17 14 23 76]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.90it/s]
Epoch 37 : Training Loss: 0.40796, acc: 0.51067, kappa: 0.38833, f1: 0.51061, LR: 0.00004, Time elapsed 0.28 mins
[[76 19 16 21 18]
 [30 68 11 23 18]
 [15 16 90 15 14]
 [15 26 12 79 18]
 [22 15 18 25 70]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.11it/s]
Epoch 38 : Training Loss: 0.40843, acc: 0.52133, kappa: 0.40167, f1: 0.52119, LR: 0.00004, Time elapsed 0.27 mins
[[79 16 19 18 18]
 [32 69 12 20 17]
 [17 17 90 12 14]
 [14 25 13 76 22]
 [22 17 18 16 77]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.52133, kappa: 0.40167, f1: 0.52119
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.09it/s]
Epoch 39 : Training Loss: 0.40753, acc: 0.51067, kappa: 0.38833, f1: 0.51107, LR: 0.00003, Time elapsed 0.27 mins
[[76 18 17 19 20]
 [32 69 10 20 19]
 [14 17 89 13 17]
 [15 26 11 76 22]
 [23 18 18 18 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.65it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.48it/s]
Epoch 40 : Training Loss: 0.40652, acc: 0.52000, kappa: 0.40000, f1: 0.52009, LR: 0.00003, Time elapsed 0.27 mins
[[74 18 17 20 21]
 [28 70 11 22 19]
 [13 14 91 16 16]
 [13 27 11 78 21]
 [22 16 17 18 77]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.41it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.58it/s]
Epoch 41 : Training Loss: 0.40629, acc: 0.51333, kappa: 0.39167, f1: 0.51327, LR: 0.00002, Time elapsed 0.28 mins
[[74 17 19 19 21]
 [28 68 12 24 18]
 [15 16 91 14 14]
 [14 27 10 78 21]
 [23 17 17 19 74]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.89it/s]
Epoch 42 : Training Loss: 0.40678, acc: 0.51467, kappa: 0.39333, f1: 0.51495, LR: 0.00002, Time elapsed 0.28 mins
[[76 19 17 19 19]
 [29 70 12 20 19]
 [16 16 90 15 13]
 [14 30 11 74 21]
 [23 16 17 18 76]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.10it/s]
Epoch 43 : Training Loss: 0.40654, acc: 0.52133, kappa: 0.40167, f1: 0.52142, LR: 0.00001, Time elapsed 0.27 mins
[[75 19 17 20 19]
 [28 69 11 22 20]
 [15 15 91 15 14]
 [13 27 11 78 21]
 [23 15 17 17 78]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.40it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.04it/s]
Epoch 44 : Training Loss: 0.40612, acc: 0.52000, kappa: 0.40000, f1: 0.52059, LR: 0.00001, Time elapsed 0.28 mins
[[73 19 16 22 20]
 [26 72 11 22 19]
 [15 15 89 15 16]
 [12 29 10 77 22]
 [23 16 15 17 79]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.57it/s]
Epoch 45 : Training Loss: 0.40582, acc: 0.52000, kappa: 0.40000, f1: 0.52022, LR: 0.00001, Time elapsed 0.27 mins
[[74 18 18 20 20]
 [28 69 11 21 21]
 [15 15 90 14 16]
 [13 29 10 77 21]
 [23 15 16 16 80]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.44it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.86it/s]
Epoch 46 : Training Loss: 0.40599, acc: 0.51467, kappa: 0.39333, f1: 0.51494, LR: 0.00000, Time elapsed 0.28 mins
[[73 18 18 21 20]
 [27 69 10 23 21]
 [14 16 90 14 16]
 [14 28 10 77 21]
 [23 16 17 17 77]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.36it/s]
Epoch 47 : Training Loss: 0.40579, acc: 0.51467, kappa: 0.39333, f1: 0.51504, LR: 0.00000, Time elapsed 0.27 mins
[[73 18 17 21 21]
 [27 69 10 23 21]
 [16 15 89 14 16]
 [14 26 10 78 22]
 [23 16 17 17 77]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.43it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.28it/s]
Epoch 48 : Training Loss: 0.40590, acc: 0.51600, kappa: 0.39500, f1: 0.51646, LR: 0.00000, Time elapsed 0.28 mins
[[73 19 16 21 21]
 [27 69 10 23 21]
 [16 15 89 14 16]
 [13 27 10 78 22]
 [23 16 17 16 78]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.55it/s]
Epoch 49 : Training Loss: 0.40604, acc: 0.51600, kappa: 0.39500, f1: 0.51646, LR: 0.00000, Time elapsed 0.28 mins
[[73 19 16 21 21]
 [27 69 10 23 21]
 [16 15 89 14 16]
 [13 27 10 78 22]
 [23 16 17 16 78]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.60it/s]
Epoch 50 : Training Loss: 0.40536, acc: 0.51867, kappa: 0.39833, f1: 0.51911, LR: 0.00000, Time elapsed 0.28 mins
[[73 19 16 21 21]
 [27 70 10 22 21]
 [15 15 90 14 16]
 [13 27 10 78 22]
 [23 16 17 16 78]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.96it/s]
***************************Test results************************
Test Evaluation: acc: 0.50667, kappa: 0.38333, f1: 0.50658
[[79 21 22 11 17]
 [23 78 17 14 18]
 [21 15 80 15 19]
 [19 29 15 74 13]
 [18 20 23 20 69]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch38_acc_0.50667_kappa_0.38333_f1_0.50658.pth
[32m[I 2025-08-30 03:41:46,416][0m Trial 98 finished with value: 0.3833333333333333 and parameters: {'lr': 0.00025344568077927153, 'weight_decay': 0.0017650960928557507, '--dropout': 0.18471500678443833, '--clip_value': 1.289063037557857}. Best is trial 98 with value: 0.3833333333333333.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.0002599399580121983, weight_decay=1.0302809342915862e-06, optimizer='AdamW', clip_value=1.296333929347376, dropout=0.18349874728400378, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.18349874728400378, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.18349874728400378, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
