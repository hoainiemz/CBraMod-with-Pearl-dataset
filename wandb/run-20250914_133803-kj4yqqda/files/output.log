3085 695 825
4605
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=19000, out_features=1000, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=200, out_features=1, bias=True)
    (8): Rearrange('b 1 -> (b 1)')
  )
)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:16<00:00,  2.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 14.63it/s]
Epoch 1 : Training Loss: 0.58965, acc: 0.80754, pr_auc: 0.91154, roc_auc: 0.91524, LR: 0.00030, Time elapsed 0.33 mins
[[1151  462]
 [ 145 1327]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:01<00:00,  7.16it/s]
val Evaluation: acc: 0.59115, pr_auc: 0.64034, roc_auc: 0.62928
[[187 159]
 [125 224]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.59115, pr_auc: 0.64034, roc_auc: 0.62928
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:13<00:00,  3.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 14.72it/s]
Epoch 2 : Training Loss: 0.38144, acc: 0.90009, pr_auc: 0.96587, roc_auc: 0.96645, LR: 0.00029, Time elapsed 0.27 mins
[[1523   90]
 [ 212 1260]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 14.56it/s]
val Evaluation: acc: 0.65711, pr_auc: 0.76052, roc_auc: 0.71412
[[307  39]
 [200 149]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.65711, pr_auc: 0.76052, roc_auc: 0.71412
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 14.92it/s]
Epoch 3 : Training Loss: 0.24488, acc: 0.81598, pr_auc: 0.94197, roc_auc: 0.94842, LR: 0.00028, Time elapsed 0.27 mins
[[1530   83]
 [ 466 1006]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 14.05it/s]
val Evaluation: acc: 0.64583, pr_auc: 0.78249, roc_auc: 0.80397
[[322  24]
 [223 126]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.64583, pr_auc: 0.78249, roc_auc: 0.80397
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 14.84it/s]
Epoch 4 : Training Loss: 0.14270, acc: 0.98024, pr_auc: 0.99705, roc_auc: 0.99692, LR: 0.00027, Time elapsed 0.27 mins
[[1592   21]
 [  39 1433]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 14.58it/s]
val Evaluation: acc: 0.50446, pr_auc: 0.60762, roc_auc: 0.69744
[[244 102]
 [243 106]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.03it/s]
Epoch 5 : Training Loss: 0.09985, acc: 0.97370, pr_auc: 0.99658, roc_auc: 0.99664, LR: 0.00026, Time elapsed 0.27 mins
[[1595   18]
 [  61 1411]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 14.73it/s]
val Evaluation: acc: 0.53751, pr_auc: 0.72131, roc_auc: 0.73289
[[252  94]
 [228 121]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 15.42it/s]
Epoch 6 : Training Loss: 0.08344, acc: 0.98913, pr_auc: 0.99916, roc_auc: 0.99919, LR: 0.00024, Time elapsed 0.26 mins
[[1590   23]
 [  11 1461]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 14.55it/s]
val Evaluation: acc: 0.61960, pr_auc: 0.80143, roc_auc: 0.81654
[[286  60]
 [205 144]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.61960, pr_auc: 0.80143, roc_auc: 0.81654
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:09<00:00,  4.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 13.72it/s]
Epoch 7 : Training Loss: 0.12982, acc: 0.98717, pr_auc: 0.99905, roc_auc: 0.99909, LR: 0.00022, Time elapsed 0.23 mins
[[1599   14]
 [  25 1447]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 13.56it/s]
val Evaluation: acc: 0.60395, pr_auc: 0.72093, roc_auc: 0.77342
[[295  51]
 [225 124]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:11<00:00,  4.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 13.45it/s]
Epoch 8 : Training Loss: 0.06201, acc: 0.99294, pr_auc: 0.99965, roc_auc: 0.99968, LR: 0.00020, Time elapsed 0.26 mins
[[1599   14]
 [   8 1464]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 14.24it/s]
val Evaluation: acc: 0.57936, pr_auc: 0.70719, roc_auc: 0.68172
[[276  70]
 [223 126]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  4.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 14.10it/s]
Epoch 9 : Training Loss: 0.03088, acc: 0.99465, pr_auc: 0.99981, roc_auc: 0.99981, LR: 0.00017, Time elapsed 0.26 mins
[[1610    3]
 [  13 1459]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 13.51it/s]
val Evaluation: acc: 0.61000, pr_auc: 0.72380, roc_auc: 0.73143
[[321  25]
 [247 102]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 13.59it/s]
Epoch 10 : Training Loss: 0.03317, acc: 0.99660, pr_auc: 0.99993, roc_auc: 0.99993, LR: 0.00015, Time elapsed 0.27 mins
[[1613    0]
 [  10 1462]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 13.16it/s]
val Evaluation: acc: 0.54927, pr_auc: 0.59648, roc_auc: 0.44849
[[276  70]
 [244 105]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  4.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 13.67it/s]
Epoch 11 : Training Loss: 0.02393, acc: 0.98689, pr_auc: 0.99967, roc_auc: 0.99966, LR: 0.00013, Time elapsed 0.26 mins
[[1574   39]
 [   3 1469]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 13.96it/s]
val Evaluation: acc: 0.61347, pr_auc: 0.67428, roc_auc: 0.70948
[[254  92]
 [177 172]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 13.92it/s]
Epoch 12 : Training Loss: 0.01794, acc: 0.99904, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00010, Time elapsed 0.26 mins
[[1611    2]
 [   1 1471]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 13.52it/s]
val Evaluation: acc: 0.58524, pr_auc: 0.70615, roc_auc: 0.68435
[[288  58]
 [231 118]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 13.56it/s]
Epoch 13 : Training Loss: 0.01228, acc: 0.99932, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00008, Time elapsed 0.27 mins
[[1613    0]
 [   2 1470]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 13.58it/s]
val Evaluation: acc: 0.56072, pr_auc: 0.65346, roc_auc: 0.66869
[[275  71]
 [235 114]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 14.02it/s]
Epoch 14 : Training Loss: 0.00634, acc: 0.99966, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00006, Time elapsed 0.26 mins
[[1613    0]
 [   1 1471]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 13.56it/s]
val Evaluation: acc: 0.59823, pr_auc: 0.75352, roc_auc: 0.75829
[[296  50]
 [230 119]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 13.81it/s]
Epoch 15 : Training Loss: 0.00419, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00004, Time elapsed 0.27 mins
[[1613    0]
 [   0 1472]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 14.13it/s]
val Evaluation: acc: 0.58377, pr_auc: 0.67437, roc_auc: 0.63467
[[285  61]
 [229 120]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 14.16it/s]
Epoch 16 : Training Loss: 0.00258, acc: 0.99966, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00003, Time elapsed 0.26 mins
[[1613    0]
 [   1 1471]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 13.18it/s]
val Evaluation: acc: 0.58090, pr_auc: 0.70193, roc_auc: 0.69466
[[285  61]
 [231 118]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 13.35it/s]
Epoch 17 : Training Loss: 0.00107, acc: 0.99966, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00002, Time elapsed 0.27 mins
[[1613    0]
 [   1 1471]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 13.97it/s]
val Evaluation: acc: 0.57519, pr_auc: 0.69976, roc_auc: 0.69247
[[286  60]
 [236 113]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 14.19it/s]
Epoch 18 : Training Loss: 0.00127, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00001, Time elapsed 0.26 mins
[[1613    0]
 [   0 1472]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 13.36it/s]
val Evaluation: acc: 0.57081, pr_auc: 0.69658, roc_auc: 0.68331
[[280  66]
 [233 116]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 14.76it/s]
Epoch 19 : Training Loss: 0.00152, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00000, Time elapsed 0.26 mins
[[1613    0]
 [   0 1472]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 14.31it/s]
val Evaluation: acc: 0.57799, pr_auc: 0.69714, roc_auc: 0.68145
[[281  65]
 [229 120]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:12<00:00,  3.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:03<00:00, 14.45it/s]
Epoch 20 : Training Loss: 0.00021, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00000, Time elapsed 0.26 mins
[[1613    0]
 [   0 1472]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 13.79it/s]
val Evaluation: acc: 0.57799, pr_auc: 0.69881, roc_auc: 0.68515
[[281  65]
 [229 120]]
***************************Test************************
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:01<00:00,  6.97it/s]
***************************Test results************************
Test Evaluation: acc: 0.55425, pr_auc: 0.50280, roc_auc: 0.46828
[[396  88]
 [242  99]]
model save in ./data/wjq/models_weights/Big/BigFaced/epoch20_acc_0.55425_pr_0.50280_roc_0.46828.pth
