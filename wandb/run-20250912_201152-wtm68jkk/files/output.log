Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.0001, weight_decay=0.05, optimizer='AdamW', clip_value=1, dropout=0.1, classifier='all_patch_reps', downstream_dataset='PEARL', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/pearl', num_of_classes=2, model_dir='./data/wjq/models_weights/Big/BigFaced', num_workers=16, label_smoothing=0.1, multi_lr=False, frozen=False, use_pretrained_weights=True, foundation_dir='pretrained_weights/pretrained_weights.pth')
The downstream dataset is PEARL
3255 476 874
4605
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (meta_backbone): Sequential(
    (0): Linear(in_features=28, out_features=50, bias=True)
    (1): ELU(alpha=1.0)
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=50, out_features=100, bias=True)
    (4): ELU(alpha=1.0)
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=100, out_features=100, bias=True)
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=19000, out_features=1000, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=100, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1, inplace=False)
  )
  (final_classifier): Sequential(
    (0): Linear(in_features=200, out_features=200, bias=True)
    (1): ELU(alpha=1.0)
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=200, out_features=1, bias=True)
    (4): Rearrange('b 1 -> (b 1)')
  )
)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:06<00:00,  8.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 42.22it/s]
Epoch 1 : Training Loss: 0.57392, acc: 0.54412, pr_auc: 0.50727, roc_auc: 0.55019, LR: 0.00010, Time elapsed 0.10 mins
[[133 105]
 [112 126]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 44.54it/s]
Val Evaluation: acc: 0.70869, pr_auc: 0.81209, roc_auc: 0.77755
[[374  94]
 [155 251]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.54412, pr_auc: 0.50727, roc_auc: 0.55019
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.68it/s]
Epoch 2 : Training Loss: 0.34374, acc: 0.50210, pr_auc: 0.53187, roc_auc: 0.57063, LR: 0.00010, Time elapsed 0.08 mins
[[212  26]
 [211  27]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.49it/s]
Val Evaluation: acc: 0.73814, pr_auc: 0.77705, roc_auc: 0.76515
[[435  33]
 [184 222]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.50210, pr_auc: 0.53187, roc_auc: 0.57063
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.90it/s]
Epoch 3 : Training Loss: 0.25486, acc: 0.53151, pr_auc: 0.54350, roc_auc: 0.58686, LR: 0.00010, Time elapsed 0.08 mins
[[158  80]
 [143  95]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.93it/s]
Val Evaluation: acc: 0.70935, pr_auc: 0.76880, roc_auc: 0.76296
[[385  83]
 [164 242]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.53151, pr_auc: 0.54350, roc_auc: 0.58686
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.47it/s]
Epoch 4 : Training Loss: 0.14707, acc: 0.51261, pr_auc: 0.51345, roc_auc: 0.57289, LR: 0.00010, Time elapsed 0.08 mins
[[158  80]
 [152  86]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.09it/s]
Val Evaluation: acc: 0.75366, pr_auc: 0.84829, roc_auc: 0.84748
[[355 113]
 [102 304]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.71it/s]
Epoch 5 : Training Loss: 0.10182, acc: 0.44538, pr_auc: 0.47701, roc_auc: 0.46916, LR: 0.00010, Time elapsed 0.08 mins
[[151  87]
 [177  61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.87it/s]
Val Evaluation: acc: 0.75003, pr_auc: 0.80293, roc_auc: 0.79456
[[415  53]
 [157 249]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.19it/s]
Epoch 6 : Training Loss: 0.09480, acc: 0.53571, pr_auc: 0.56103, roc_auc: 0.57134, LR: 0.00010, Time elapsed 0.08 mins
[[225  13]
 [208  30]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.75it/s]
Val Evaluation: acc: 0.69989, pr_auc: 0.78621, roc_auc: 0.77057
[[443  25]
 [222 184]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.36it/s]
Epoch 7 : Training Loss: 0.06342, acc: 0.51261, pr_auc: 0.56088, roc_auc: 0.56587, LR: 0.00010, Time elapsed 0.08 mins
[[187  51]
 [181  57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.13it/s]
Val Evaluation: acc: 0.72480, pr_auc: 0.83686, roc_auc: 0.83471
[[396  72]
 [161 245]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.59it/s]
Epoch 8 : Training Loss: 0.05553, acc: 0.46429, pr_auc: 0.47430, roc_auc: 0.45502, LR: 0.00009, Time elapsed 0.08 mins
[[178  60]
 [195  43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.62it/s]
Val Evaluation: acc: 0.74061, pr_auc: 0.76511, roc_auc: 0.73902
[[435  33]
 [182 224]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.67it/s]
Epoch 9 : Training Loss: 0.02957, acc: 0.59664, pr_auc: 0.65022, roc_auc: 0.61025, LR: 0.00009, Time elapsed 0.08 mins
[[165  73]
 [119 119]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.80it/s]
Val Evaluation: acc: 0.65282, pr_auc: 0.80207, roc_auc: 0.77458
[[339 129]
 [170 236]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.59664, pr_auc: 0.65022, roc_auc: 0.61025
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.88it/s]
Epoch 10 : Training Loss: 0.01583, acc: 0.57353, pr_auc: 0.60243, roc_auc: 0.62376, LR: 0.00009, Time elapsed 0.08 mins
[[196  42]
 [161  77]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.83it/s]
Val Evaluation: acc: 0.72679, pr_auc: 0.78434, roc_auc: 0.75018
[[414  54]
 [175 231]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.57353, pr_auc: 0.60243, roc_auc: 0.62376
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.27it/s]
Epoch 11 : Training Loss: 0.01573, acc: 0.56303, pr_auc: 0.60946, roc_auc: 0.61977, LR: 0.00009, Time elapsed 0.08 mins
[[214  24]
 [184  54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.68it/s]
Val Evaluation: acc: 0.71225, pr_auc: 0.77051, roc_auc: 0.71440
[[405  63]
 [179 227]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.59it/s]
Epoch 12 : Training Loss: 0.00646, acc: 0.55882, pr_auc: 0.63685, roc_auc: 0.63135, LR: 0.00009, Time elapsed 0.08 mins
[[218  20]
 [190  48]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.26it/s]
Val Evaluation: acc: 0.72411, pr_auc: 0.76878, roc_auc: 0.71424
[[438  30]
 [198 208]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.55882, pr_auc: 0.63685, roc_auc: 0.63135
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.90it/s]
Epoch 13 : Training Loss: 0.00842, acc: 0.53782, pr_auc: 0.63186, roc_auc: 0.64215, LR: 0.00008, Time elapsed 0.08 mins
[[224  14]
 [206  32]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.89it/s]
Val Evaluation: acc: 0.72836, pr_auc: 0.77053, roc_auc: 0.72409
[[427  41]
 [185 221]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.53782, pr_auc: 0.63186, roc_auc: 0.64215
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.90it/s]
Epoch 14 : Training Loss: 0.00904, acc: 0.61975, pr_auc: 0.62105, roc_auc: 0.54219, LR: 0.00008, Time elapsed 0.08 mins
[[217  21]
 [160  78]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.32it/s]
Val Evaluation: acc: 0.59590, pr_auc: 0.74976, roc_auc: 0.71562
[[318 150]
 [198 208]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.30it/s]
Epoch 15 : Training Loss: 0.00105, acc: 0.54622, pr_auc: 0.62355, roc_auc: 0.62704, LR: 0.00008, Time elapsed 0.08 mins
[[196  42]
 [174  64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.33it/s]
Val Evaluation: acc: 0.67509, pr_auc: 0.79045, roc_auc: 0.73945
[[361 107]
 [171 235]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.86it/s]
Epoch 16 : Training Loss: 0.00369, acc: 0.61134, pr_auc: 0.63681, roc_auc: 0.59455, LR: 0.00008, Time elapsed 0.08 mins
[[192  46]
 [139  99]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.20it/s]
Val Evaluation: acc: 0.61494, pr_auc: 0.78814, roc_auc: 0.74361
[[307 161]
 [173 233]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.68it/s]
Epoch 17 : Training Loss: 0.00181, acc: 0.61555, pr_auc: 0.67600, roc_auc: 0.64126, LR: 0.00007, Time elapsed 0.08 mins
[[173  65]
 [118 120]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.68it/s]
Val Evaluation: acc: 0.58756, pr_auc: 0.77530, roc_auc: 0.74263
[[271 197]
 [164 242]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.60it/s]
Epoch 18 : Training Loss: 0.00164, acc: 0.64706, pr_auc: 0.63710, roc_auc: 0.57203, LR: 0.00007, Time elapsed 0.08 mins
[[202  36]
 [132 106]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.11it/s]
Val Evaluation: acc: 0.57090, pr_auc: 0.76229, roc_auc: 0.73278
[[275 193]
 [181 225]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.90it/s]
Epoch 19 : Training Loss: 0.00012, acc: 0.61555, pr_auc: 0.62022, roc_auc: 0.56598, LR: 0.00007, Time elapsed 0.08 mins
[[201  37]
 [146  92]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.45it/s]
Val Evaluation: acc: 0.58709, pr_auc: 0.77163, roc_auc: 0.74172
[[289 179]
 [180 226]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.76it/s]
Epoch 20 : Training Loss: 0.00008, acc: 0.57983, pr_auc: 0.62387, roc_auc: 0.58709, LR: 0.00007, Time elapsed 0.08 mins
[[201  37]
 [163  75]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.19it/s]
Val Evaluation: acc: 0.61428, pr_auc: 0.77936, roc_auc: 0.74641
[[311 157]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 12.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.37it/s]
Epoch 21 : Training Loss: 0.00012, acc: 0.62395, pr_auc: 0.61858, roc_auc: 0.56149, LR: 0.00006, Time elapsed 0.07 mins
[[216  22]
 [157  81]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.31it/s]
Val Evaluation: acc: 0.56737, pr_auc: 0.73302, roc_auc: 0.70713
[[274 194]
 [183 223]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 12.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 49.04it/s]
Epoch 22 : Training Loss: 0.00018, acc: 0.59874, pr_auc: 0.60944, roc_auc: 0.58422, LR: 0.00006, Time elapsed 0.07 mins
[[193  45]
 [146  92]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.40it/s]
Val Evaluation: acc: 0.60228, pr_auc: 0.77168, roc_auc: 0.73360
[[294 174]
 [172 234]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 12.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.45it/s]
Epoch 23 : Training Loss: 0.00018, acc: 0.53992, pr_auc: 0.60951, roc_auc: 0.58557, LR: 0.00006, Time elapsed 0.07 mins
[[199  39]
 [180  58]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.19it/s]
Val Evaluation: acc: 0.63352, pr_auc: 0.77357, roc_auc: 0.72691
[[329 139]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 12.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.60it/s]
Epoch 24 : Training Loss: 0.00017, acc: 0.57143, pr_auc: 0.60533, roc_auc: 0.55298, LR: 0.00005, Time elapsed 0.07 mins
[[198  40]
 [164  74]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.98it/s]
Val Evaluation: acc: 0.59983, pr_auc: 0.75762, roc_auc: 0.72397
[[309 159]
 [187 219]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 49.05it/s]
Epoch 25 : Training Loss: 0.00214, acc: 0.54832, pr_auc: 0.59550, roc_auc: 0.59395, LR: 0.00005, Time elapsed 0.07 mins
[[194  44]
 [171  67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.70it/s]
Val Evaluation: acc: 0.61988, pr_auc: 0.76122, roc_auc: 0.72771
[[322 146]
 [182 224]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 49.24it/s]
Epoch 26 : Training Loss: 0.00004, acc: 0.55672, pr_auc: 0.60130, roc_auc: 0.59847, LR: 0.00005, Time elapsed 0.07 mins
[[194  44]
 [167  71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.33it/s]
Val Evaluation: acc: 0.63812, pr_auc: 0.77018, roc_auc: 0.73517
[[331 137]
 [175 231]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.71it/s]
Epoch 27 : Training Loss: 0.00079, acc: 0.62815, pr_auc: 0.63233, roc_auc: 0.58667, LR: 0.00004, Time elapsed 0.07 mins
[[188  50]
 [127 111]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.32it/s]
Val Evaluation: acc: 0.56407, pr_auc: 0.75612, roc_auc: 0.72861
[[264 204]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.67it/s]
Epoch 28 : Training Loss: 0.00060, acc: 0.59664, pr_auc: 0.60396, roc_auc: 0.57152, LR: 0.00004, Time elapsed 0.07 mins
[[203  35]
 [157  81]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.15it/s]
Val Evaluation: acc: 0.57057, pr_auc: 0.75748, roc_auc: 0.72295
[[277 191]
 [183 223]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.14it/s]
Epoch 29 : Training Loss: 0.00002, acc: 0.59664, pr_auc: 0.60402, roc_auc: 0.56351, LR: 0.00004, Time elapsed 0.07 mins
[[204  34]
 [158  80]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.53it/s]
Val Evaluation: acc: 0.57714, pr_auc: 0.75943, roc_auc: 0.72408
[[282 186]
 [182 224]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.75it/s]
Epoch 30 : Training Loss: 0.00003, acc: 0.55672, pr_auc: 0.60543, roc_auc: 0.57551, LR: 0.00004, Time elapsed 0.07 mins
[[206  32]
 [179  59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.53it/s]
Val Evaluation: acc: 0.58792, pr_auc: 0.75524, roc_auc: 0.71941
[[299 169]
 [188 218]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.67it/s]
Epoch 31 : Training Loss: 0.00060, acc: 0.62815, pr_auc: 0.62740, roc_auc: 0.57447, LR: 0.00003, Time elapsed 0.07 mins
[[196  42]
 [135 103]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.44it/s]
Val Evaluation: acc: 0.57410, pr_auc: 0.75506, roc_auc: 0.72694
[[278 190]
 [181 225]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.76it/s]
Epoch 32 : Training Loss: 0.00003, acc: 0.59874, pr_auc: 0.62193, roc_auc: 0.58570, LR: 0.00003, Time elapsed 0.07 mins
[[195  43]
 [148  90]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.37it/s]
Val Evaluation: acc: 0.59382, pr_auc: 0.77240, roc_auc: 0.73963
[[293 175]
 [178 228]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.16it/s]
Epoch 33 : Training Loss: 0.00005, acc: 0.56723, pr_auc: 0.62115, roc_auc: 0.60417, LR: 0.00003, Time elapsed 0.07 mins
[[195  43]
 [163  75]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.26it/s]
Val Evaluation: acc: 0.61970, pr_auc: 0.78898, roc_auc: 0.74866
[[308 160]
 [170 236]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.44it/s]
Epoch 34 : Training Loss: 0.00005, acc: 0.60084, pr_auc: 0.61761, roc_auc: 0.58459, LR: 0.00002, Time elapsed 0.07 mins
[[196  42]
 [148  90]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.41it/s]
Val Evaluation: acc: 0.59554, pr_auc: 0.77490, roc_auc: 0.74434
[[290 178]
 [174 232]]
 33%|███████████████████████████████████▎                                                                      | 17/51 [00:01<00:03, 11.32it/s]
Traceback (most recent call last):
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_main.py", line 170, in <module>
    main()
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_main.py", line 156, in main
    t.train_for_binaryclass()
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_trainer.py", line 179, in train_for_binaryclass
    loss.backward()
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/_tensor.py", line 647, in backward
    torch.autograd.backward(
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/autograd/__init__.py", line 354, in backward
    _engine_run_backward(
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/autograd/graph.py", line 829, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
