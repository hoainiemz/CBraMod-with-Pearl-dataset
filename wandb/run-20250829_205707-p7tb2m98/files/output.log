100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
Epoch 1 : Training Loss: 1.82450, acc: 0.18400, kappa: -0.02000, f1: 0.10084, LR: 0.00022, Time elapsed 0.21 mins
[[  7 128  14   0   1]
 [ 11 117  18   0   4]
 [  9 127  13   0   1]
 [ 11 121  15   0   3]
 [  3 135  11   0   1]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.02it/s]
Epoch 2 : Training Loss: 1.63871, acc: 0.21467, kappa: 0.01833, f1: 0.10402, LR: 0.00022, Time elapsed 0.21 mins
[[ 21   0 129   0   0]
 [ 32   0 118   0   0]
 [ 10   0 140   0   0]
 [ 17   0 133   0   0]
 [ 12   0 138   0   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21467, kappa: 0.01833, f1: 0.10402
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.24it/s]
Epoch 3 : Training Loss: 1.62211, acc: 0.22800, kappa: 0.03500, f1: 0.15080, LR: 0.00022, Time elapsed 0.21 mins
[[ 10  33 106   0   1]
 [ 23  47  80   0   0]
 [ 10  27 112   0   1]
 [ 11  24 114   0   1]
 [ 10  34 104   0   2]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22800, kappa: 0.03500, f1: 0.15080
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.49it/s]
Epoch 4 : Training Loss: 1.59487, acc: 0.23200, kappa: 0.04000, f1: 0.20298, LR: 0.00022, Time elapsed 0.21 mins
[[17 38 48  4 43]
 [21 49 44  3 33]
 [15 28 57  0 50]
 [16 28 47  2 57]
 [17 35 46  3 49]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23200, kappa: 0.04000, f1: 0.20298
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.14it/s]
Epoch 5 : Training Loss: 1.55170, acc: 0.28267, kappa: 0.10333, f1: 0.25699, LR: 0.00022, Time elapsed 0.21 mins
[[39 18 64  8 21]
 [23 35 61  3 28]
 [17  8 95  6 24]
 [31 13 69 12 25]
 [40 20 54  5 31]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28267, kappa: 0.10333, f1: 0.25699
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.79it/s]
Epoch 6 : Training Loss: 1.45487, acc: 0.29733, kappa: 0.12167, f1: 0.29153, LR: 0.00022, Time elapsed 0.21 mins
[[23 39 10 42 36]
 [16 55  6 31 42]
 [ 7 28 33 34 48]
 [18 33  6 62 31]
 [11 39  8 42 50]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.29733, kappa: 0.12167, f1: 0.29153
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.49it/s]
Epoch 7 : Training Loss: 1.29224, acc: 0.34800, kappa: 0.18500, f1: 0.34456, LR: 0.00021, Time elapsed 0.21 mins
[[36 39 25 28 22]
 [24 51 35 22 18]
 [10 25 73 18 24]
 [12 34 27 50 27]
 [11 30 31 27 51]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.34800, kappa: 0.18500, f1: 0.34456
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.37it/s]
Epoch 8 : Training Loss: 1.10596, acc: 0.38667, kappa: 0.23333, f1: 0.38481, LR: 0.00021, Time elapsed 0.21 mins
[[64 24 19 28 15]
 [38 47 26 27 12]
 [17 11 73 25 24]
 [46  9 24 61 10]
 [25 15 26 39 45]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.38667, kappa: 0.23333, f1: 0.38481
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.86it/s]
Epoch 9 : Training Loss: 0.91085, acc: 0.39867, kappa: 0.24833, f1: 0.39609, LR: 0.00021, Time elapsed 0.21 mins
[[41 20 19 32 38]
 [21 57 17 26 29]
 [18 13 62 20 37]
 [18 17 21 64 30]
 [12 15 25 23 75]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.39867, kappa: 0.24833, f1: 0.39609
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.56it/s]
Epoch 10 : Training Loss: 0.76503, acc: 0.39200, kappa: 0.24000, f1: 0.39300, LR: 0.00020, Time elapsed 0.21 mins
[[59 21 13 26 31]
 [22 64 15 22 27]
 [19 27 63 15 26]
 [20 30 23 54 23]
 [22 38 18 18 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.50it/s]
Epoch 11 : Training Loss: 0.69220, acc: 0.39467, kappa: 0.24333, f1: 0.39453, LR: 0.00020, Time elapsed 0.21 mins
[[66 15 12 30 27]
 [26 49 20 33 22]
 [22 16 65 17 30]
 [24 18 29 55 24]
 [21 12 25 31 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.47it/s]
Epoch 12 : Training Loss: 0.63937, acc: 0.39600, kappa: 0.24500, f1: 0.39331, LR: 0.00019, Time elapsed 0.21 mins
[[62 27 24 18 19]
 [29 57 22 23 19]
 [21 19 78 10 22]
 [24 28 31 54 13]
 [24 27 35 18 46]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.37it/s]
Epoch 13 : Training Loss: 0.58567, acc: 0.39600, kappa: 0.24500, f1: 0.39601, LR: 0.00019, Time elapsed 0.21 mins
[[60 19 13 34 24]
 [22 55 20 33 20]
 [16 23 56 24 31]
 [14 21 23 69 23]
 [17 24 27 25 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.00it/s]
Epoch 14 : Training Loss: 0.53621, acc: 0.42667, kappa: 0.28333, f1: 0.42621, LR: 0.00018, Time elapsed 0.21 mins
[[48 24 16 29 33]
 [20 70 14 20 26]
 [14 18 67 17 34]
 [16 28 13 64 29]
 [13 25 17 24 71]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42667, kappa: 0.28333, f1: 0.42621
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.17it/s]
Epoch 15 : Training Loss: 0.52228, acc: 0.43733, kappa: 0.29667, f1: 0.43549, LR: 0.00018, Time elapsed 0.21 mins
[[66 24 17 20 23]
 [21 66 22 23 18]
 [18 20 79 11 22]
 [21 18 24 69 18]
 [23 31 22 26 48]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.43733, kappa: 0.29667, f1: 0.43549
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.88it/s]
Epoch 16 : Training Loss: 0.49347, acc: 0.43600, kappa: 0.29500, f1: 0.43558, LR: 0.00017, Time elapsed 0.21 mins
[[73 17 19 19 22]
 [29 63 18 24 16]
 [25 19 72  9 25]
 [31 20 24 59 16]
 [28 22 20 20 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 17 : Training Loss: 0.47359, acc: 0.45200, kappa: 0.31500, f1: 0.45032, LR: 0.00017, Time elapsed 0.21 mins
[[75 11 22 24 18]
 [21 52 25 25 27]
 [16 15 78 12 29]
 [23 17 17 70 23]
 [18 15 30 23 64]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.45200, kappa: 0.31500, f1: 0.45032
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.58it/s]
Epoch 18 : Training Loss: 0.45684, acc: 0.42933, kappa: 0.28667, f1: 0.42802, LR: 0.00016, Time elapsed 0.21 mins
[[69 29 14 20 18]
 [28 70 21 18 13]
 [14 25 75  9 27]
 [27 24 24 57 18]
 [25 34 23 17 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.88it/s]
Epoch 19 : Training Loss: 0.44700, acc: 0.46667, kappa: 0.33333, f1: 0.46568, LR: 0.00015, Time elapsed 0.21 mins
[[72 19 17 23 19]
 [25 61 19 30 15]
 [18 17 82 11 22]
 [22 18 24 67 19]
 [18 20 25 19 68]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.46667, kappa: 0.33333, f1: 0.46568
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.00it/s]
Epoch 20 : Training Loss: 0.43838, acc: 0.44800, kappa: 0.31000, f1: 0.44640, LR: 0.00015, Time elapsed 0.21 mins
[[69 17 19 20 25]
 [29 56 23 23 19]
 [21 14 82  9 24]
 [19 19 27 63 22]
 [21 19 25 19 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
Epoch 21 : Training Loss: 0.43159, acc: 0.44533, kappa: 0.30667, f1: 0.44543, LR: 0.00014, Time elapsed 0.21 mins
[[70 18 17 24 21]
 [27 65 18 24 16]
 [21 20 74 13 22]
 [26 23 18 64 19]
 [22 25 17 25 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.82it/s]
Epoch 22 : Training Loss: 0.42756, acc: 0.44400, kappa: 0.30500, f1: 0.44359, LR: 0.00013, Time elapsed 0.21 mins
[[66 19 18 28 19]
 [26 58 24 23 19]
 [16 18 77 15 24]
 [15 26 23 66 20]
 [20 25 17 22 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.07it/s]
Epoch 23 : Training Loss: 0.42263, acc: 0.46267, kappa: 0.32833, f1: 0.46256, LR: 0.00013, Time elapsed 0.21 mins
[[71 21 16 20 22]
 [26 61 18 26 19]
 [20 20 76 10 24]
 [19 23 21 66 21]
 [22 21 15 19 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.77it/s]
Epoch 24 : Training Loss: 0.42086, acc: 0.46267, kappa: 0.32833, f1: 0.46250, LR: 0.00012, Time elapsed 0.21 mins
[[70 14 16 24 26]
 [29 59 17 29 16]
 [21 15 76 14 24]
 [21 16 21 72 20]
 [25 17 16 22 70]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.76it/s]
Epoch 25 : Training Loss: 0.41869, acc: 0.46400, kappa: 0.33000, f1: 0.46314, LR: 0.00011, Time elapsed 0.21 mins
[[73 16 15 22 24]
 [29 59 20 28 14]
 [22 17 78 12 21]
 [19 18 23 70 20]
 [22 13 26 21 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.90it/s]
Epoch 26 : Training Loss: 0.41665, acc: 0.47067, kappa: 0.33833, f1: 0.46909, LR: 0.00010, Time elapsed 0.21 mins
[[74 12 16 22 26]
 [27 59 22 24 18]
 [18 16 84 10 22]
 [21 18 24 64 23]
 [19 18 22 19 72]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.47067, kappa: 0.33833, f1: 0.46909
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.95it/s]
Epoch 27 : Training Loss: 0.41648, acc: 0.45733, kappa: 0.32167, f1: 0.45626, LR: 0.00010, Time elapsed 0.21 mins
[[69 18 16 23 24]
 [30 56 19 27 18]
 [20 17 82 12 19]
 [22 18 24 65 21]
 [26 19 18 16 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.95it/s]
Epoch 28 : Training Loss: 0.41300, acc: 0.45867, kappa: 0.32333, f1: 0.45776, LR: 0.00009, Time elapsed 0.21 mins
[[67 20 14 23 26]
 [24 60 22 26 18]
 [19 17 80 12 22]
 [21 20 23 64 22]
 [16 21 21 19 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.47it/s]
Epoch 29 : Training Loss: 0.41163, acc: 0.46800, kappa: 0.33500, f1: 0.46645, LR: 0.00008, Time elapsed 0.21 mins
[[71 15 17 24 23]
 [30 55 20 30 15]
 [19 17 82 11 21]
 [20 18 25 68 19]
 [21 17 17 20 75]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.92it/s]
Epoch 30 : Training Loss: 0.41029, acc: 0.47067, kappa: 0.33833, f1: 0.47013, LR: 0.00008, Time elapsed 0.21 mins
[[70 15 17 24 24]
 [26 61 21 30 12]
 [20 17 82 10 21]
 [19 22 21 69 19]
 [21 20 15 23 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.05it/s]
Epoch 31 : Training Loss: 0.40926, acc: 0.46133, kappa: 0.32667, f1: 0.46045, LR: 0.00007, Time elapsed 0.21 mins
[[70 16 16 21 27]
 [26 59 21 28 16]
 [23 17 80 10 20]
 [20 23 23 65 19]
 [19 20 19 20 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.44it/s]
Epoch 32 : Training Loss: 0.40867, acc: 0.46800, kappa: 0.33500, f1: 0.46725, LR: 0.00006, Time elapsed 0.21 mins
[[70 17 18 19 26]
 [26 62 18 26 18]
 [20 14 83 10 23]
 [18 21 23 69 19]
 [19 22 19 23 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.62it/s]
Epoch 33 : Training Loss: 0.40830, acc: 0.46133, kappa: 0.32667, f1: 0.45996, LR: 0.00006, Time elapsed 0.21 mins
[[71 16 18 21 24]
 [25 59 21 27 18]
 [20 15 83 13 19]
 [18 22 25 66 19]
 [20 20 24 19 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.00it/s]
Epoch 34 : Training Loss: 0.40730, acc: 0.45600, kappa: 0.32000, f1: 0.45529, LR: 0.00005, Time elapsed 0.21 mins
[[66 16 17 25 26]
 [28 63 19 26 14]
 [19 16 82 13 20]
 [21 18 25 68 18]
 [22 23 19 23 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 35 : Training Loss: 0.40693, acc: 0.46267, kappa: 0.32833, f1: 0.46159, LR: 0.00005, Time elapsed 0.21 mins
[[67 18 18 23 24]
 [26 59 19 28 18]
 [15 16 82 13 24]
 [18 22 24 66 20]
 [21 19 18 19 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.09it/s]
Epoch 36 : Training Loss: 0.40609, acc: 0.46533, kappa: 0.33167, f1: 0.46434, LR: 0.00004, Time elapsed 0.21 mins
[[71 15 18 24 22]
 [26 61 19 28 16]
 [18 15 83 12 22]
 [19 23 24 65 19]
 [19 19 21 22 69]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.95it/s]
Epoch 37 : Training Loss: 0.40567, acc: 0.47067, kappa: 0.33833, f1: 0.46962, LR: 0.00004, Time elapsed 0.22 mins
[[69 17 19 24 21]
 [27 63 18 28 14]
 [20 16 85  8 21]
 [19 23 25 65 18]
 [20 19 21 19 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
Epoch 38 : Training Loss: 0.40603, acc: 0.46933, kappa: 0.33667, f1: 0.46848, LR: 0.00003, Time elapsed 0.21 mins
[[70 16 18 24 22]
 [27 63 17 28 15]
 [17 17 83 12 21]
 [20 23 25 64 18]
 [22 17 21 18 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.99it/s]
Epoch 39 : Training Loss: 0.40520, acc: 0.46933, kappa: 0.33667, f1: 0.46814, LR: 0.00003, Time elapsed 0.21 mins
[[70 15 18 24 23]
 [30 61 18 25 16]
 [20 15 85  9 21]
 [20 22 25 65 18]
 [22 16 22 19 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.59it/s]
Epoch 40 : Training Loss: 0.40510, acc: 0.47067, kappa: 0.33833, f1: 0.46952, LR: 0.00002, Time elapsed 0.21 mins
[[70 15 18 23 24]
 [28 62 18 27 15]
 [19 14 85 10 22]
 [20 21 25 65 19]
 [21 16 22 20 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.95it/s]
Epoch 41 : Training Loss: 0.40456, acc: 0.46933, kappa: 0.33667, f1: 0.46858, LR: 0.00002, Time elapsed 0.21 mins
[[69 16 18 23 24]
 [28 63 17 26 16]
 [20 16 83  9 22]
 [20 22 23 66 19]
 [22 16 22 19 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.86it/s]
Epoch 42 : Training Loss: 0.40464, acc: 0.47200, kappa: 0.34000, f1: 0.47107, LR: 0.00001, Time elapsed 0.21 mins
[[69 15 17 24 25]
 [28 64 18 25 15]
 [20 14 85  9 22]
 [19 24 24 64 19]
 [22 16 20 20 72]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.47200, kappa: 0.34000, f1: 0.47107
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.69it/s]
Epoch 43 : Training Loss: 0.40409, acc: 0.47067, kappa: 0.33833, f1: 0.46999, LR: 0.00001, Time elapsed 0.21 mins
[[70 14 16 25 25]
 [27 64 17 27 15]
 [20 14 84 10 22]
 [18 22 24 66 20]
 [22 17 21 21 69]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.48it/s]
Epoch 44 : Training Loss: 0.40470, acc: 0.46400, kappa: 0.33000, f1: 0.46325, LR: 0.00001, Time elapsed 0.21 mins
[[68 14 17 26 25]
 [28 61 17 27 17]
 [20 14 83 10 23]
 [19 21 24 65 21]
 [22 17 19 21 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 45 : Training Loss: 0.40440, acc: 0.46667, kappa: 0.33333, f1: 0.46563, LR: 0.00001, Time elapsed 0.22 mins
[[69 16 17 23 25]
 [29 61 18 26 16]
 [20 14 84  9 23]
 [19 22 24 64 21]
 [22 18 19 19 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.03it/s]
Epoch 46 : Training Loss: 0.40380, acc: 0.47067, kappa: 0.33833, f1: 0.46965, LR: 0.00000, Time elapsed 0.21 mins
[[71 16 16 23 24]
 [28 62 18 26 16]
 [20 14 84  9 23]
 [18 22 25 64 21]
 [22 17 19 20 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.93it/s]
Epoch 47 : Training Loss: 0.40333, acc: 0.47067, kappa: 0.33833, f1: 0.46970, LR: 0.00000, Time elapsed 0.21 mins
[[71 14 16 25 24]
 [28 62 17 27 16]
 [19 14 84 10 23]
 [18 23 25 64 20]
 [22 16 20 20 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.75it/s]
Epoch 48 : Training Loss: 0.40360, acc: 0.46933, kappa: 0.33667, f1: 0.46839, LR: 0.00000, Time elapsed 0.21 mins
[[70 16 16 24 24]
 [28 62 17 27 16]
 [19 14 84 10 23]
 [18 23 25 64 20]
 [22 17 19 20 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.75it/s]
Epoch 49 : Training Loss: 0.40375, acc: 0.46933, kappa: 0.33667, f1: 0.46831, LR: 0.00000, Time elapsed 0.21 mins
[[71 15 17 23 24]
 [28 62 18 26 16]
 [19 14 84 10 23]
 [18 23 25 64 20]
 [22 17 19 21 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.68it/s]
Epoch 50 : Training Loss: 0.40365, acc: 0.46800, kappa: 0.33500, f1: 0.46689, LR: 0.00000, Time elapsed 0.21 mins
[[70 16 17 23 24]
 [29 61 18 26 16]
 [19 14 84 10 23]
 [18 23 25 64 20]
 [22 17 19 20 72]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
***************************Test results************************
Test Evaluation: acc: 0.46000, kappa: 0.32500, f1: 0.46032
[[68 23 22 17 20]
 [25 67 17 22 19]
 [28 13 69 14 26]
 [22 21 21 72 14]
 [21 13 22 25 69]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch42_acc_0.46000_kappa_0.32500_f1_0.46032.pth
[32m[I 2025-08-29 21:07:59,087][0m Trial 64 finished with value: 0.32499999999999996 and parameters: {'lr': 0.00022285850959901583, 'weight_decay': 0.005176678894960057, '--dropout': 0.1852470583417279, '--clip_value': 1.8887806399556057}. Best is trial 35 with value: 0.36.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.00039293766165608213, weight_decay=0.04583251363885934, optimizer='AdamW', clip_value=1.8109262866660751, dropout=0.17738933337794152, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.17738933337794152, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.17738933337794152, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
