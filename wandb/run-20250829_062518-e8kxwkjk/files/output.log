100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.93it/s]
Epoch 1 : Training Loss: 1.62199, acc: 0.21867, kappa: 0.02333, f1: 0.16292, LR: 0.00004, Time elapsed 0.21 mins
[[ 1 59  4 74 12]
 [ 0 59  1 79 11]
 [ 0 46  4 84 16]
 [ 0 53  6 81 10]
 [ 0 54  4 73 19]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21867, kappa: 0.02333, f1: 0.16292
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.91it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.05it/s]
Epoch 2 : Training Loss: 1.59929, acc: 0.27067, kappa: 0.08833, f1: 0.26777, LR: 0.00004, Time elapsed 0.21 mins
[[50 45 17 22 16]
 [50 55 18 15 12]
 [33 34 28 35 20]
 [40 41 17 35 17]
 [46 35 12 22 35]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27067, kappa: 0.08833, f1: 0.26777
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.04it/s]
Epoch 3 : Training Loss: 1.57709, acc: 0.26667, kappa: 0.08333, f1: 0.24707, LR: 0.00004, Time elapsed 0.21 mins
[[ 7 28 50 34 31]
 [ 4 49 52 22 23]
 [ 1 22 65 38 24]
 [ 2 26 46 40 36]
 [ 3 24 49 35 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 4 : Training Loss: 1.53657, acc: 0.23333, kappa: 0.04167, f1: 0.21289, LR: 0.00004, Time elapsed 0.22 mins
[[48 14 13 10 65]
 [46 24 11 12 57]
 [32  6 16 15 81]
 [29 14 10 14 83]
 [44 12 11 10 73]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 5 : Training Loss: 1.48084, acc: 0.24133, kappa: 0.05167, f1: 0.24154, LR: 0.00004, Time elapsed 0.21 mins
[[43 27 24 33 23]
 [36 39 16 34 25]
 [30 19 32 43 26]
 [32 22 31 36 29]
 [38 26 18 37 31]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
Epoch 6 : Training Loss: 1.40827, acc: 0.24800, kappa: 0.06000, f1: 0.24474, LR: 0.00004, Time elapsed 0.21 mins
[[47 29 13 43 18]
 [34 41 11 42 22]
 [32 20 24 49 25]
 [33 26 20 46 25]
 [41 28 11 42 28]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 7 : Training Loss: 1.33405, acc: 0.23200, kappa: 0.04000, f1: 0.23220, LR: 0.00004, Time elapsed 0.21 mins
[[38 25 24 38 25]
 [39 37 14 34 26]
 [29 25 30 41 25]
 [29 20 29 38 34]
 [33 22 28 36 31]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.51it/s]
Epoch 8 : Training Loss: 1.26702, acc: 0.23333, kappa: 0.04167, f1: 0.22683, LR: 0.00004, Time elapsed 0.22 mins
[[18 37 23 41 31]
 [14 46 14 45 31]
 [15 26 26 51 32]
 [16 32 17 48 37]
 [16 36 23 38 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.63it/s]
Epoch 9 : Training Loss: 1.19766, acc: 0.24667, kappa: 0.05833, f1: 0.24606, LR: 0.00004, Time elapsed 0.21 mins
[[39 31 28 32 20]
 [33 43 20 30 24]
 [25 25 32 41 27]
 [27 30 27 39 27]
 [29 30 30 29 32]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.64it/s]
Epoch 10 : Training Loss: 1.11831, acc: 0.23867, kappa: 0.04833, f1: 0.23578, LR: 0.00004, Time elapsed 0.21 mins
[[39 24 23 50 14]
 [34 35 23 44 14]
 [24 20 35 57 14]
 [26 29 28 49 18]
 [27 26 26 50 21]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 11 : Training Loss: 1.05531, acc: 0.25067, kappa: 0.06333, f1: 0.24806, LR: 0.00004, Time elapsed 0.21 mins
[[31 27 22 38 32]
 [29 29 15 41 36]
 [24 21 33 35 37]
 [21 22 21 46 40]
 [28 22 22 29 49]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.93it/s]
Epoch 12 : Training Loss: 0.98029, acc: 0.25067, kappa: 0.06333, f1: 0.25107, LR: 0.00004, Time elapsed 0.21 mins
[[41 25 26 37 21]
 [29 36 22 40 23]
 [30 22 33 36 29]
 [29 22 30 37 32]
 [29 23 30 27 41]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 13 : Training Loss: 0.91219, acc: 0.24400, kappa: 0.05500, f1: 0.23935, LR: 0.00004, Time elapsed 0.21 mins
[[30 29 23 33 35]
 [32 35 12 34 37]
 [32 21 23 30 44]
 [24 27 16 41 42]
 [27 27 15 27 54]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.01it/s]
Epoch 14 : Training Loss: 0.83492, acc: 0.24800, kappa: 0.06000, f1: 0.24560, LR: 0.00003, Time elapsed 0.21 mins
[[41 35 20 28 26]
 [36 45 19 21 29]
 [28 30 32 24 36]
 [33 36 22 25 34]
 [29 32 26 20 43]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.11it/s]
Epoch 15 : Training Loss: 0.78022, acc: 0.25600, kappa: 0.07000, f1: 0.25330, LR: 0.00003, Time elapsed 0.21 mins
[[44 19 20 39 28]
 [31 34 15 37 33]
 [28 22 25 34 41]
 [35 21 24 39 31]
 [30 20 23 27 50]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.86it/s]
Epoch 16 : Training Loss: 0.74431, acc: 0.25333, kappa: 0.06667, f1: 0.25295, LR: 0.00003, Time elapsed 0.22 mins
[[35 25 24 40 26]
 [27 33 16 46 28]
 [28 18 36 35 33]
 [26 25 20 45 34]
 [27 23 28 31 41]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.14it/s]
Epoch 17 : Training Loss: 0.68139, acc: 0.26000, kappa: 0.07500, f1: 0.25806, LR: 0.00003, Time elapsed 0.21 mins
[[45 32 21 26 26]
 [30 43 18 24 35]
 [23 25 35 26 41]
 [35 28 24 26 37]
 [33 20 30 21 46]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.91it/s]
Epoch 18 : Training Loss: 0.62979, acc: 0.26400, kappa: 0.08000, f1: 0.26287, LR: 0.00003, Time elapsed 0.21 mins
[[36 24 25 32 33]
 [30 39 15 33 33]
 [22 20 36 29 43]
 [26 25 24 34 41]
 [21 22 27 27 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.11it/s]
Epoch 19 : Training Loss: 0.60015, acc: 0.26933, kappa: 0.08667, f1: 0.26997, LR: 0.00003, Time elapsed 0.21 mins
[[36 24 25 39 26]
 [29 44 11 36 30]
 [16 21 36 40 37]
 [22 31 23 39 35]
 [23 26 20 34 47]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.62it/s]
Epoch 20 : Training Loss: 0.57467, acc: 0.27200, kappa: 0.09000, f1: 0.27176, LR: 0.00003, Time elapsed 0.21 mins
[[49 21 21 39 20]
 [33 35 17 41 24]
 [25 21 37 39 28]
 [26 24 25 46 29]
 [32 19 21 41 37]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27200, kappa: 0.09000, f1: 0.27176
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.31it/s]
Epoch 21 : Training Loss: 0.54745, acc: 0.25200, kappa: 0.06500, f1: 0.25085, LR: 0.00003, Time elapsed 0.21 mins
[[40 26 27 41 16]
 [29 40 16 40 25]
 [21 28 31 41 29]
 [30 28 20 47 25]
 [25 22 34 38 31]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.60it/s]
Epoch 22 : Training Loss: 0.52448, acc: 0.26000, kappa: 0.07500, f1: 0.25978, LR: 0.00003, Time elapsed 0.21 mins
[[32 30 33 30 25]
 [25 46 21 33 25]
 [19 24 42 32 33]
 [27 30 31 36 26]
 [20 22 33 36 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
Epoch 23 : Training Loss: 0.50770, acc: 0.26400, kappa: 0.08000, f1: 0.26171, LR: 0.00002, Time elapsed 0.21 mins
[[27 30 31 36 26]
 [24 47 22 37 20]
 [19 21 47 34 29]
 [22 28 25 46 29]
 [24 23 36 36 31]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.62it/s]
Epoch 24 : Training Loss: 0.49530, acc: 0.26000, kappa: 0.07500, f1: 0.25919, LR: 0.00002, Time elapsed 0.22 mins
[[35 30 27 31 27]
 [33 51 17 30 19]
 [22 29 37 28 34]
 [29 36 22 32 31]
 [26 24 30 30 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 25 : Training Loss: 0.48076, acc: 0.26800, kappa: 0.08500, f1: 0.26696, LR: 0.00002, Time elapsed 0.21 mins
[[29 34 25 34 28]
 [29 50 17 32 22]
 [16 25 41 36 32]
 [21 32 23 43 31]
 [26 23 26 37 38]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.52it/s]
Epoch 26 : Training Loss: 0.47206, acc: 0.26000, kappa: 0.07500, f1: 0.25835, LR: 0.00002, Time elapsed 0.21 mins
[[31 30 15 36 38]
 [29 44 10 36 31]
 [19 28 30 34 39]
 [25 32 18 41 34]
 [27 22 20 32 49]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.92it/s]
Epoch 27 : Training Loss: 0.46314, acc: 0.27067, kappa: 0.08833, f1: 0.26812, LR: 0.00002, Time elapsed 0.21 mins
[[35 29 26 24 36]
 [26 47 21 28 28]
 [23 28 40 21 38]
 [31 32 21 28 38]
 [27 20 29 21 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.10it/s]
Epoch 28 : Training Loss: 0.45422, acc: 0.25733, kappa: 0.07167, f1: 0.25797, LR: 0.00002, Time elapsed 0.21 mins
[[35 27 30 30 28]
 [30 43 20 37 20]
 [20 24 41 32 33]
 [31 31 24 34 30]
 [25 17 33 35 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 29 : Training Loss: 0.44589, acc: 0.24800, kappa: 0.06000, f1: 0.24825, LR: 0.00002, Time elapsed 0.21 mins
[[38 30 23 34 25]
 [26 47 17 42 18]
 [24 26 32 41 27]
 [35 28 25 36 26]
 [34 24 25 34 33]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.86it/s]
Epoch 30 : Training Loss: 0.44065, acc: 0.27067, kappa: 0.08833, f1: 0.27157, LR: 0.00002, Time elapsed 0.21 mins
[[37 26 33 30 24]
 [32 40 20 34 24]
 [23 21 45 33 28]
 [38 21 26 37 28]
 [31 17 28 30 44]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.58it/s]
Epoch 31 : Training Loss: 0.43916, acc: 0.26133, kappa: 0.07667, f1: 0.26176, LR: 0.00001, Time elapsed 0.21 mins
[[34 27 32 29 28]
 [30 46 22 31 21]
 [20 23 41 30 36]
 [36 25 27 35 27]
 [28 19 32 31 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.11it/s]
Epoch 32 : Training Loss: 0.43244, acc: 0.24667, kappa: 0.05833, f1: 0.24645, LR: 0.00001, Time elapsed 0.22 mins
[[35 28 28 36 23]
 [33 46 16 33 22]
 [23 30 31 36 30]
 [35 27 22 37 29]
 [29 26 26 33 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.09it/s]
Epoch 33 : Training Loss: 0.42768, acc: 0.25733, kappa: 0.07167, f1: 0.25687, LR: 0.00001, Time elapsed 0.21 mins
[[34 37 29 29 21]
 [29 48 17 34 22]
 [22 28 39 32 29]
 [31 30 25 35 29]
 [27 30 28 28 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.19it/s]
Epoch 34 : Training Loss: 0.42380, acc: 0.26000, kappa: 0.07500, f1: 0.25864, LR: 0.00001, Time elapsed 0.21 mins
[[33 33 22 29 33]
 [31 48 17 30 24]
 [22 28 32 33 35]
 [31 31 21 36 31]
 [26 26 25 27 46]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.77it/s]
Epoch 35 : Training Loss: 0.42037, acc: 0.25600, kappa: 0.07000, f1: 0.25621, LR: 0.00001, Time elapsed 0.21 mins
[[36 28 35 22 29]
 [34 47 19 29 21]
 [25 25 39 29 32]
 [37 24 25 34 30]
 [32 24 29 29 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.87it/s]
Epoch 36 : Training Loss: 0.41718, acc: 0.26000, kappa: 0.07500, f1: 0.26050, LR: 0.00001, Time elapsed 0.21 mins
[[38 30 27 31 24]
 [36 43 14 35 22]
 [26 23 34 34 33]
 [38 24 18 40 30]
 [33 23 24 30 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.61it/s]
Epoch 37 : Training Loss: 0.41645, acc: 0.26800, kappa: 0.08500, f1: 0.26856, LR: 0.00001, Time elapsed 0.21 mins
[[36 30 29 28 27]
 [33 46 18 33 20]
 [24 24 38 34 30]
 [37 24 22 38 29]
 [30 21 28 28 43]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.71it/s]
Epoch 38 : Training Loss: 0.41499, acc: 0.27067, kappa: 0.08833, f1: 0.27058, LR: 0.00001, Time elapsed 0.21 mins
[[36 33 31 25 25]
 [31 48 17 31 23]
 [20 23 37 36 34]
 [33 26 25 39 27]
 [28 22 27 30 43]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.02it/s]
Epoch 39 : Training Loss: 0.41203, acc: 0.27733, kappa: 0.09667, f1: 0.27758, LR: 0.00001, Time elapsed 0.21 mins
[[36 34 25 30 25]
 [30 50 16 32 22]
 [23 24 37 35 31]
 [35 28 20 41 26]
 [30 20 21 35 44]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27733, kappa: 0.09667, f1: 0.27758
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.64it/s]
Epoch 40 : Training Loss: 0.41142, acc: 0.28133, kappa: 0.10167, f1: 0.28174, LR: 0.00000, Time elapsed 0.21 mins
[[38 38 25 27 22]
 [31 47 16 35 21]
 [23 24 40 34 29]
 [33 26 21 40 30]
 [28 25 22 29 46]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28133, kappa: 0.10167, f1: 0.28174
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.64it/s]
Epoch 41 : Training Loss: 0.40998, acc: 0.26267, kappa: 0.07833, f1: 0.26256, LR: 0.00000, Time elapsed 0.21 mins
[[33 33 30 27 27]
 [30 40 20 35 25]
 [21 24 38 38 29]
 [31 22 25 39 33]
 [29 19 26 29 47]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.04it/s]
Epoch 42 : Training Loss: 0.40886, acc: 0.26400, kappa: 0.08000, f1: 0.26420, LR: 0.00000, Time elapsed 0.21 mins
[[35 34 28 27 26]
 [32 47 17 33 21]
 [22 25 37 35 31]
 [34 25 24 36 31]
 [35 23 23 26 43]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.91it/s]
Epoch 43 : Training Loss: 0.40747, acc: 0.27333, kappa: 0.09167, f1: 0.27416, LR: 0.00000, Time elapsed 0.21 mins
[[40 27 27 30 26]
 [34 44 16 34 22]
 [24 23 37 37 29]
 [37 23 20 39 31]
 [33 20 23 29 45]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.18it/s]
Epoch 44 : Training Loss: 0.40705, acc: 0.27600, kappa: 0.09500, f1: 0.27651, LR: 0.00000, Time elapsed 0.21 mins
[[37 31 28 27 27]
 [32 45 16 35 22]
 [23 23 40 34 30]
 [34 24 22 39 31]
 [32 20 26 26 46]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.90it/s]
Epoch 45 : Training Loss: 0.40647, acc: 0.27733, kappa: 0.09667, f1: 0.27775, LR: 0.00000, Time elapsed 0.21 mins
[[37 34 29 27 23]
 [32 46 17 34 21]
 [22 24 41 35 28]
 [35 25 23 40 27]
 [29 22 29 26 44]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 46 : Training Loss: 0.40668, acc: 0.27733, kappa: 0.09667, f1: 0.27764, LR: 0.00000, Time elapsed 0.21 mins
[[36 30 29 27 28]
 [33 45 16 35 21]
 [21 25 39 34 31]
 [34 25 21 40 30]
 [31 20 23 28 48]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.93it/s]
Epoch 47 : Training Loss: 0.40590, acc: 0.27733, kappa: 0.09667, f1: 0.27757, LR: 0.00000, Time elapsed 0.21 mins
[[37 33 28 26 26]
 [32 46 16 35 21]
 [21 25 40 34 30]
 [33 26 24 39 28]
 [30 21 27 26 46]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.06it/s]
Epoch 48 : Training Loss: 0.40551, acc: 0.27333, kappa: 0.09167, f1: 0.27349, LR: 0.00000, Time elapsed 0.21 mins
[[35 30 29 27 29]
 [32 43 17 35 23]
 [21 24 39 36 30]
 [33 24 22 39 32]
 [29 18 25 29 49]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.02it/s]
Epoch 49 : Training Loss: 0.40541, acc: 0.27600, kappa: 0.09500, f1: 0.27617, LR: 0.00000, Time elapsed 0.21 mins
[[36 32 29 26 27]
 [33 45 17 34 21]
 [22 25 38 35 30]
 [34 24 22 40 30]
 [30 20 24 28 48]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.62it/s]
Epoch 50 : Training Loss: 0.40514, acc: 0.27733, kappa: 0.09667, f1: 0.27738, LR: 0.00000, Time elapsed 0.22 mins
[[35 32 29 26 28]
 [32 46 17 33 22]
 [21 25 40 33 31]
 [34 25 22 39 30]
 [30 21 25 26 48]]
***************************Test************************
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.54it/s]
***************************Test results************************
Test Evaluation: acc: 0.28000, kappa: 0.10000, f1: 0.27965
[[51 29 21 27 22]
 [38 35 21 25 31]
 [26 28 39 27 30]
 [36 34 17 42 21]
 [25 26 24 32 43]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch40_acc_0.28000_kappa_0.10000_f1_0.27965.pth
[32m[I 2025-08-29 06:36:10,887][0m Trial 2 finished with value: 0.09999999999999998 and parameters: {'lr': 4.191711516695204e-05, 'weight_decay': 0.0021242802137208896, '--dropout': 0.004116898859160489, '--clip_value': 1.9548647782429915}. Best is trial 2 with value: 0.09999999999999998.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.0001764971584817573, weight_decay=9.948901058090736e-06, optimizer='AdamW', clip_value=0.7751067647801507, dropout=0.03636499344142013, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.03636499344142013, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.03636499344142013, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
