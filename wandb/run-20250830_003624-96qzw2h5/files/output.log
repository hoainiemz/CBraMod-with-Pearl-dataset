100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.48it/s]
Epoch 1 : Training Loss: 1.72927, acc: 0.20133, kappa: 0.00167, f1: 0.08299, LR: 0.00022, Time elapsed 0.21 mins
[[144   0   3   3   0]
 [144   0   1   5   0]
 [146   0   3   1   0]
 [145   0   1   4   0]
 [147   0   0   3   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20133, kappa: 0.00167, f1: 0.08299
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.61it/s]
Epoch 2 : Training Loss: 1.64165, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00022, Time elapsed 0.21 mins
[[150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.98it/s]
Epoch 3 : Training Loss: 1.63372, acc: 0.21867, kappa: 0.02333, f1: 0.13512, LR: 0.00022, Time elapsed 0.21 mins
[[  2  18 111  19   0]
 [  9  17 113  11   0]
 [  1  13 128   8   0]
 [  2  16 115  17   0]
 [  2  14 119  15   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21867, kappa: 0.02333, f1: 0.13512
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.73it/s]
Epoch 4 : Training Loss: 1.62518, acc: 0.23333, kappa: 0.04167, f1: 0.14603, LR: 0.00022, Time elapsed 0.22 mins
[[ 40   0  10   0 100]
 [ 40   0  13   0  97]
 [ 22   0  11   0 117]
 [ 29   0  12   0 109]
 [ 21   0   5   0 124]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23333, kappa: 0.04167, f1: 0.14603
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.59it/s]
Epoch 5 : Training Loss: 1.60772, acc: 0.23733, kappa: 0.04667, f1: 0.17289, LR: 0.00022, Time elapsed 0.22 mins
[[  2  30  32   0  86]
 [  0  30  31   1  88]
 [  1  11  42   2  94]
 [  3  22  24   0 101]
 [  2  16  28   0 104]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23733, kappa: 0.04667, f1: 0.17289
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.50it/s]
Epoch 6 : Training Loss: 1.56258, acc: 0.27733, kappa: 0.09667, f1: 0.26200, LR: 0.00021, Time elapsed 0.22 mins
[[13 28 52 22 35]
 [ 9 42 41 22 36]
 [ 6 22 62 13 47]
 [10 20 42 31 47]
 [11 20 38 21 60]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27733, kappa: 0.09667, f1: 0.26200
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.63it/s]
Epoch 7 : Training Loss: 1.47343, acc: 0.32267, kappa: 0.15333, f1: 0.31652, LR: 0.00021, Time elapsed 0.22 mins
[[41 18 49 26 16]
 [33 34 50 20 13]
 [33  5 84 13 15]
 [26 15 57 39 13]
 [35 10 42 19 44]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.32267, kappa: 0.15333, f1: 0.31652
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.91it/s]
Epoch 8 : Training Loss: 1.31639, acc: 0.34267, kappa: 0.17833, f1: 0.34158, LR: 0.00021, Time elapsed 0.22 mins
[[49 29 19 24 29]
 [27 57 13 21 32]
 [32 25 46 10 37]
 [25 27 21 42 35]
 [25 21 13 28 63]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.34267, kappa: 0.17833, f1: 0.34158
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.70it/s]
Epoch 9 : Training Loss: 1.12145, acc: 0.36933, kappa: 0.21167, f1: 0.36661, LR: 0.00021, Time elapsed 0.22 mins
[[54 17 22 44 13]
 [36 37 20 32 25]
 [25 13 68 21 23]
 [26 17 21 67 19]
 [22 12 22 43 51]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.36933, kappa: 0.21167, f1: 0.36661
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.39it/s]
Epoch 10 : Training Loss: 0.94855, acc: 0.38933, kappa: 0.23667, f1: 0.38809, LR: 0.00020, Time elapsed 0.22 mins
[[56 17 25 40 12]
 [37 43 22 30 18]
 [24 17 71 24 14]
 [32 14 22 69 13]
 [26 12 26 33 53]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.38933, kappa: 0.23667, f1: 0.38809
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.62it/s]
Epoch 11 : Training Loss: 0.79803, acc: 0.38667, kappa: 0.23333, f1: 0.38722, LR: 0.00020, Time elapsed 0.22 mins
[[53 27 20 23 27]
 [32 56 17 23 22]
 [25 17 55 25 28]
 [28 23 16 64 19]
 [27 16 14 31 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.47it/s]
Epoch 12 : Training Loss: 0.68090, acc: 0.39467, kappa: 0.24333, f1: 0.39026, LR: 0.00019, Time elapsed 0.21 mins
[[51 22 33 24 20]
 [26 47 35 27 15]
 [13 15 85 16 21]
 [17 22 32 57 22]
 [25 18 28 23 56]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.39467, kappa: 0.24333, f1: 0.39026
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.44it/s]
Epoch 13 : Training Loss: 0.63861, acc: 0.41200, kappa: 0.26500, f1: 0.41067, LR: 0.00019, Time elapsed 0.22 mins
[[60 19 30 20 21]
 [31 53 21 26 19]
 [14 15 76 19 26]
 [20 21 21 64 24]
 [21 29 22 22 56]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.41200, kappa: 0.26500, f1: 0.41067
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.35it/s]
Epoch 14 : Training Loss: 0.59609, acc: 0.39600, kappa: 0.24500, f1: 0.38767, LR: 0.00018, Time elapsed 0.21 mins
[[50 29 34 28  9]
 [20 65 25 23 17]
 [13 17 92 14 14]
 [22 32 33 51 12]
 [24 38 29 20 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 15 : Training Loss: 0.54742, acc: 0.41867, kappa: 0.27333, f1: 0.41701, LR: 0.00018, Time elapsed 0.22 mins
[[53 26 26 23 22]
 [24 58 22 24 22]
 [16 22 78 12 22]
 [14 27 26 62 21]
 [16 16 30 25 63]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.41867, kappa: 0.27333, f1: 0.41701
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.87it/s]
Epoch 16 : Training Loss: 0.51874, acc: 0.42000, kappa: 0.27500, f1: 0.41733, LR: 0.00017, Time elapsed 0.21 mins
[[58 22 25 25 20]
 [23 62 26 24 15]
 [17 17 82 21 13]
 [24 24 26 63 13]
 [22 23 30 25 50]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42000, kappa: 0.27500, f1: 0.41733
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.77it/s]
Epoch 17 : Training Loss: 0.49259, acc: 0.42533, kappa: 0.28167, f1: 0.42612, LR: 0.00017, Time elapsed 0.22 mins
[[61 21 19 23 26]
 [28 60 15 25 22]
 [17 15 69 24 25]
 [19 26 16 66 23]
 [20 21 15 31 63]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42533, kappa: 0.28167, f1: 0.42612
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.49it/s]
Epoch 18 : Training Loss: 0.47226, acc: 0.42933, kappa: 0.28667, f1: 0.42913, LR: 0.00016, Time elapsed 0.22 mins
[[67 21 23 21 18]
 [34 64 20 21 11]
 [22 16 73 19 20]
 [21 29 23 57 20]
 [24 19 19 27 61]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42933, kappa: 0.28667, f1: 0.42913
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.58it/s]
Epoch 19 : Training Loss: 0.45831, acc: 0.43867, kappa: 0.29833, f1: 0.43636, LR: 0.00015, Time elapsed 0.22 mins
[[58 24 36 16 16]
 [28 55 28 21 18]
 [16 16 87 15 16]
 [15 26 28 63 18]
 [21 18 25 20 66]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.43867, kappa: 0.29833, f1: 0.43636
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.24it/s]
Epoch 20 : Training Loss: 0.44831, acc: 0.45200, kappa: 0.31500, f1: 0.45181, LR: 0.00015, Time elapsed 0.22 mins
[[61 26 23 20 20]
 [29 68 17 20 16]
 [19 21 75 15 20]
 [17 29 23 65 16]
 [16 17 23 24 70]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.45200, kappa: 0.31500, f1: 0.45181
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.56it/s]
Epoch 21 : Training Loss: 0.43867, acc: 0.44933, kappa: 0.31167, f1: 0.44850, LR: 0.00014, Time elapsed 0.22 mins
[[59 22 23 27 19]
 [27 63 19 26 15]
 [21 17 79 18 15]
 [14 24 21 73 18]
 [21 18 20 28 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.90it/s]
Epoch 22 : Training Loss: 0.43439, acc: 0.44267, kappa: 0.30333, f1: 0.44111, LR: 0.00013, Time elapsed 0.21 mins
[[55 25 26 23 21]
 [25 69 18 25 13]
 [20 14 82 16 18]
 [15 26 28 65 16]
 [21 23 18 27 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.99it/s]
Epoch 23 : Training Loss: 0.43081, acc: 0.42667, kappa: 0.28333, f1: 0.42679, LR: 0.00013, Time elapsed 0.22 mins
[[62 28 24 20 16]
 [33 67 19 15 16]
 [26 22 72 13 17]
 [19 27 23 62 19]
 [25 25 20 23 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.27it/s]
Epoch 24 : Training Loss: 0.42805, acc: 0.44400, kappa: 0.30500, f1: 0.44303, LR: 0.00012, Time elapsed 0.22 mins
[[58 25 20 26 21]
 [27 64 22 23 14]
 [22 16 76 15 21]
 [14 23 25 73 15]
 [12 25 21 30 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.50it/s]
Epoch 25 : Training Loss: 0.42308, acc: 0.44533, kappa: 0.30667, f1: 0.44361, LR: 0.00011, Time elapsed 0.22 mins
[[57 26 25 17 25]
 [26 64 20 22 18]
 [18 17 84 11 20]
 [10 27 26 66 21]
 [17 20 23 27 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.33it/s]
Epoch 26 : Training Loss: 0.42319, acc: 0.45600, kappa: 0.32000, f1: 0.45492, LR: 0.00010, Time elapsed 0.22 mins
[[69 22 24 19 16]
 [36 60 21 20 13]
 [21 14 83 16 16]
 [19 21 27 68 15]
 [19 21 21 27 62]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.45600, kappa: 0.32000, f1: 0.45492
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.01it/s]
Epoch 27 : Training Loss: 0.41981, acc: 0.44667, kappa: 0.30833, f1: 0.44411, LR: 0.00010, Time elapsed 0.22 mins
[[61 24 28 18 19]
 [27 58 25 24 16]
 [19 11 89 15 16]
 [16 22 34 65 13]
 [19 15 30 24 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.93it/s]
Epoch 28 : Training Loss: 0.41744, acc: 0.45067, kappa: 0.31333, f1: 0.45025, LR: 0.00009, Time elapsed 0.22 mins
[[64 24 21 19 22]
 [31 67 16 20 16]
 [21 15 76 14 24]
 [15 27 25 69 14]
 [19 19 22 28 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.67it/s]
Epoch 29 : Training Loss: 0.41484, acc: 0.45333, kappa: 0.31667, f1: 0.45159, LR: 0.00008, Time elapsed 0.22 mins
[[59 22 29 21 19]
 [24 62 22 28 14]
 [16 13 85 17 19]
 [17 21 28 70 14]
 [18 20 21 27 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.44it/s]
Epoch 30 : Training Loss: 0.41417, acc: 0.43733, kappa: 0.29667, f1: 0.43672, LR: 0.00008, Time elapsed 0.22 mins
[[62 26 24 17 21]
 [24 66 20 25 15]
 [20 18 77 14 21]
 [18 29 26 59 18]
 [15 26 21 24 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.61it/s]
Epoch 31 : Training Loss: 0.41307, acc: 0.44800, kappa: 0.31000, f1: 0.44695, LR: 0.00007, Time elapsed 0.22 mins
[[65 21 26 17 21]
 [28 63 21 21 17]
 [20 13 80 16 21]
 [20 26 24 60 20]
 [19 16 25 22 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.21it/s]
Epoch 32 : Training Loss: 0.41232, acc: 0.43467, kappa: 0.29333, f1: 0.43311, LR: 0.00006, Time elapsed 0.21 mins
[[63 23 25 19 20]
 [32 64 20 22 12]
 [20 15 82 15 18]
 [21 26 29 58 16]
 [19 23 27 22 59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.12it/s]
Epoch 33 : Training Loss: 0.41083, acc: 0.44133, kappa: 0.30167, f1: 0.44003, LR: 0.00006, Time elapsed 0.22 mins
[[61 23 27 19 20]
 [32 66 20 19 13]
 [21 13 83 16 17]
 [21 26 28 60 15]
 [20 19 26 24 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.85it/s]
Epoch 34 : Training Loss: 0.41073, acc: 0.44133, kappa: 0.30167, f1: 0.44080, LR: 0.00005, Time elapsed 0.21 mins
[[61 23 25 18 23]
 [25 68 18 20 19]
 [20 17 75 16 22]
 [16 31 26 63 14]
 [17 22 22 25 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.40it/s]
Epoch 35 : Training Loss: 0.40969, acc: 0.44800, kappa: 0.31000, f1: 0.44700, LR: 0.00005, Time elapsed 0.22 mins
[[63 23 24 20 20]
 [25 65 19 25 16]
 [21 12 82 17 18]
 [19 27 26 63 15]
 [19 19 23 26 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.74it/s]
Epoch 36 : Training Loss: 0.40962, acc: 0.44533, kappa: 0.30667, f1: 0.44421, LR: 0.00004, Time elapsed 0.22 mins
[[61 23 28 19 19]
 [24 65 20 22 19]
 [19 15 81 17 18]
 [17 27 28 62 16]
 [18 19 25 23 65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.66it/s]
Epoch 37 : Training Loss: 0.40890, acc: 0.44267, kappa: 0.30333, f1: 0.44176, LR: 0.00004, Time elapsed 0.22 mins
[[63 23 26 18 20]
 [26 64 21 21 18]
 [19 13 79 19 20]
 [18 28 26 61 17]
 [20 16 27 22 65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.95it/s]
Epoch 38 : Training Loss: 0.40856, acc: 0.44267, kappa: 0.30333, f1: 0.44169, LR: 0.00003, Time elapsed 0.21 mins
[[62 24 24 18 22]
 [25 67 21 22 15]
 [19 13 79 19 20]
 [19 29 24 63 15]
 [20 17 28 24 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.44it/s]
Epoch 39 : Training Loss: 0.40761, acc: 0.44267, kappa: 0.30333, f1: 0.44180, LR: 0.00003, Time elapsed 0.22 mins
[[62 22 25 19 22]
 [29 62 22 24 13]
 [20 12 80 18 20]
 [20 23 28 65 14]
 [20 19 23 25 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.59it/s]
Epoch 40 : Training Loss: 0.40794, acc: 0.44133, kappa: 0.30167, f1: 0.44034, LR: 0.00002, Time elapsed 0.22 mins
[[62 21 28 17 22]
 [28 64 22 22 14]
 [20 13 80 18 19]
 [18 26 28 63 15]
 [20 21 22 25 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 41 : Training Loss: 0.40787, acc: 0.44267, kappa: 0.30333, f1: 0.44161, LR: 0.00002, Time elapsed 0.21 mins
[[63 21 27 17 22]
 [30 62 22 19 17]
 [20 11 81 18 20]
 [20 27 25 64 14]
 [21 22 21 24 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.58it/s]
Epoch 42 : Training Loss: 0.40714, acc: 0.44800, kappa: 0.31000, f1: 0.44693, LR: 0.00001, Time elapsed 0.21 mins
[[62 21 26 18 23]
 [26 65 22 20 17]
 [20 12 81 18 19]
 [17 26 27 64 16]
 [19 21 21 25 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.93it/s]
Epoch 43 : Training Loss: 0.40702, acc: 0.44400, kappa: 0.30500, f1: 0.44320, LR: 0.00001, Time elapsed 0.22 mins
[[63 21 26 19 21]
 [29 64 21 20 16]
 [20 13 79 18 20]
 [18 27 26 65 14]
 [20 21 21 26 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.71it/s]
Epoch 44 : Training Loss: 0.40609, acc: 0.44267, kappa: 0.30333, f1: 0.44142, LR: 0.00001, Time elapsed 0.22 mins
[[61 21 26 20 22]
 [29 63 21 20 17]
 [19 12 83 18 18]
 [22 26 25 62 15]
 [20 22 20 25 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.71it/s]
Epoch 45 : Training Loss: 0.40680, acc: 0.44400, kappa: 0.30500, f1: 0.44295, LR: 0.00001, Time elapsed 0.22 mins
[[62 21 26 20 21]
 [29 63 21 20 17]
 [19 12 81 19 19]
 [19 27 25 64 15]
 [19 22 22 24 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.28it/s]
Epoch 46 : Training Loss: 0.40618, acc: 0.44533, kappa: 0.30667, f1: 0.44460, LR: 0.00000, Time elapsed 0.21 mins
[[62 21 26 20 21]
 [29 63 20 23 15]
 [19 12 79 19 21]
 [17 28 26 65 14]
 [18 21 23 23 65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.64it/s]
Epoch 47 : Training Loss: 0.40626, acc: 0.44000, kappa: 0.30000, f1: 0.43921, LR: 0.00000, Time elapsed 0.22 mins
[[60 21 26 20 23]
 [28 64 20 21 17]
 [19 12 78 19 22]
 [18 27 26 64 15]
 [19 23 20 24 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.77it/s]
Epoch 48 : Training Loss: 0.40675, acc: 0.44133, kappa: 0.30167, f1: 0.44030, LR: 0.00000, Time elapsed 0.22 mins
[[61 21 26 20 22]
 [29 62 20 21 18]
 [19 12 80 18 21]
 [19 26 26 64 15]
 [18 22 23 23 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.61it/s]
Epoch 49 : Training Loss: 0.40603, acc: 0.44133, kappa: 0.30167, f1: 0.44030, LR: 0.00000, Time elapsed 0.22 mins
[[61 21 26 20 22]
 [29 62 20 21 18]
 [19 11 80 18 22]
 [19 26 26 64 15]
 [19 21 23 23 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.44it/s]
Epoch 50 : Training Loss: 0.40558, acc: 0.44267, kappa: 0.30333, f1: 0.44171, LR: 0.00000, Time elapsed 0.22 mins
[[62 21 26 20 21]
 [29 63 20 21 17]
 [19 12 80 18 21]
 [20 26 26 63 15]
 [18 22 23 23 64]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.38it/s]
***************************Test results************************
Test Evaluation: acc: 0.47067, kappa: 0.33833, f1: 0.47089
[[71 21 23 21 14]
 [33 63 21 18 15]
 [22 15 72 21 20]
 [28 16 15 79 12]
 [21 17 22 22 68]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch26_acc_0.47067_kappa_0.33833_f1_0.47089.pth
[32m[I 2025-08-30 00:47:24,879][0m Trial 84 finished with value: 0.3383333333333334 and parameters: {'lr': 0.00022254429854263915, 'weight_decay': 0.0005986280987325472, '--dropout': 0.18200349213385644, '--clip_value': 1.9113861802352248}. Best is trial 78 with value: 0.3733333333333333.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.0003326780105360144, weight_decay=7.171533625343417e-05, optimizer='AdamW', clip_value=1.9983627368465933, dropout=0.16812033225898151, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.16812033225898151, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.16812033225898151, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
