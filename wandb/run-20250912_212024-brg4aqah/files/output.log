Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.0003, weight_decay=0.05, optimizer='AdamW', clip_value=1, dropout=0.1, classifier='all_patch_reps', downstream_dataset='PEARL', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/pearl', num_of_classes=2, model_dir='./data/wjq/models_weights/Big/BigFaced', num_workers=16, label_smoothing=0.1, multi_lr=False, frozen=False, use_pretrained_weights=True, foundation_dir='pretrained_weights/pretrained_weights.pth')
The downstream dataset is PEARL
3255 476 874
4605
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (meta_backbone): Sequential(
    (0): Linear(in_features=28, out_features=50, bias=True)
    (1): ELU(alpha=1.0)
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=50, out_features=50, bias=True)
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=19000, out_features=1000, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=200, bias=True)
  )
  (final_classifier): Sequential(
    (0): Linear(in_features=250, out_features=200, bias=True)
    (1): ELU(alpha=1.0)
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=200, out_features=1, bias=True)
    (4): Rearrange('b 1 -> (b 1)')
  )
)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:05<00:00,  8.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.95it/s]
Epoch 1 : Training Loss: 0.53769, acc: 0.59034, pr_auc: 0.57402, roc_auc: 0.62607, LR: 0.00030, Time elapsed 0.10 mins
[[181  57]
 [138 100]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.39it/s]
Val Evaluation: acc: 0.67221, pr_auc: 0.79823, roc_auc: 0.77477
[[356 112]
 [169 237]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.59034, pr_auc: 0.57402, roc_auc: 0.62607
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.22it/s]
Epoch 2 : Training Loss: 0.22001, acc: 0.56723, pr_auc: 0.59578, roc_auc: 0.61943, LR: 0.00030, Time elapsed 0.07 mins
[[186  52]
 [154  84]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.98it/s]
Val Evaluation: acc: 0.63573, pr_auc: 0.81512, roc_auc: 0.81218
[[323 145]
 [170 236]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.45it/s]
Epoch 3 : Training Loss: 0.08262, acc: 0.54412, pr_auc: 0.62625, roc_auc: 0.66254, LR: 0.00030, Time elapsed 0.07 mins
[[195  43]
 [174  64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.17it/s]
Val Evaluation: acc: 0.62179, pr_auc: 0.78887, roc_auc: 0.77281
[[348 120]
 [203 203]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.54412, pr_auc: 0.62625, roc_auc: 0.66254
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.46it/s]
Epoch 4 : Training Loss: 0.03638, acc: 0.58193, pr_auc: 0.66569, roc_auc: 0.71896, LR: 0.00030, Time elapsed 0.07 mins
[[187  51]
 [148  90]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.49it/s]
Val Evaluation: acc: 0.66678, pr_auc: 0.77273, roc_auc: 0.74192
[[344 124]
 [163 243]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.58193, pr_auc: 0.66569, roc_auc: 0.71896
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 49.07it/s]
Epoch 5 : Training Loss: 0.02858, acc: 0.66387, pr_auc: 0.70636, roc_auc: 0.65409, LR: 0.00029, Time elapsed 0.07 mins
[[211  27]
 [133 105]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.20it/s]
Val Evaluation: acc: 0.53632, pr_auc: 0.61342, roc_auc: 0.58205
[[268 200]
 [203 203]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.14it/s]
Epoch 6 : Training Loss: 0.01717, acc: 0.61134, pr_auc: 0.68816, roc_auc: 0.73808, LR: 0.00029, Time elapsed 0.07 mins
[[210  28]
 [157  81]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.32it/s]
Val Evaluation: acc: 0.60818, pr_auc: 0.77180, roc_auc: 0.68437
[[288 180]
 [162 244]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.61134, pr_auc: 0.68816, roc_auc: 0.73808
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.42it/s]
Epoch 7 : Training Loss: 0.00593, acc: 0.67017, pr_auc: 0.74466, roc_auc: 0.73649, LR: 0.00029, Time elapsed 0.07 mins
[[207  31]
 [126 112]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.61it/s]
Val Evaluation: acc: 0.53469, pr_auc: 0.71004, roc_auc: 0.69430
[[278 190]
 [213 193]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.39it/s]
Epoch 8 : Training Loss: 0.00329, acc: 0.57773, pr_auc: 0.67506, roc_auc: 0.70200, LR: 0.00028, Time elapsed 0.07 mins
[[184  54]
 [147  91]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.50it/s]
Val Evaluation: acc: 0.56958, pr_auc: 0.75012, roc_auc: 0.70214
[[268 200]
 [176 230]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.50it/s]
Epoch 9 : Training Loss: 0.00228, acc: 0.56513, pr_auc: 0.65548, roc_auc: 0.68756, LR: 0.00028, Time elapsed 0.07 mins
[[193  45]
 [162  76]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.28it/s]
Val Evaluation: acc: 0.58642, pr_auc: 0.76271, roc_auc: 0.74911
[[278 190]
 [171 235]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.12it/s]
Epoch 10 : Training Loss: 0.00072, acc: 0.64496, pr_auc: 0.70215, roc_auc: 0.72188, LR: 0.00027, Time elapsed 0.07 mins
[[191  47]
 [122 116]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.13it/s]
Val Evaluation: acc: 0.57294, pr_auc: 0.73063, roc_auc: 0.70786
[[270 198]
 [175 231]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.03it/s]
Epoch 11 : Training Loss: 0.00036, acc: 0.59454, pr_auc: 0.69344, roc_auc: 0.69973, LR: 0.00027, Time elapsed 0.07 mins
[[186  52]
 [141  97]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.92it/s]
Val Evaluation: acc: 0.54229, pr_auc: 0.72016, roc_auc: 0.70102
[[239 229]
 [173 233]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.50it/s]
Epoch 12 : Training Loss: 0.00196, acc: 0.65336, pr_auc: 0.70906, roc_auc: 0.72361, LR: 0.00026, Time elapsed 0.07 mins
[[210  28]
 [137 101]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.61it/s]
Val Evaluation: acc: 0.56695, pr_auc: 0.72372, roc_auc: 0.70649
[[269 199]
 [179 227]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.11it/s]
Epoch 13 : Training Loss: 0.00284, acc: 0.67437, pr_auc: 0.76472, roc_auc: 0.76416, LR: 0.00025, Time elapsed 0.07 mins
[[205  33]
 [122 116]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.29it/s]
Val Evaluation: acc: 0.52579, pr_auc: 0.70493, roc_auc: 0.67583
[[242 226]
 [189 217]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.67437, pr_auc: 0.76472, roc_auc: 0.76416
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.23it/s]
Epoch 14 : Training Loss: 0.00080, acc: 0.60924, pr_auc: 0.72204, roc_auc: 0.72507, LR: 0.00025, Time elapsed 0.07 mins
[[187  51]
 [135 103]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.23it/s]
Val Evaluation: acc: 0.58258, pr_auc: 0.72701, roc_auc: 0.71005
[[294 174]
 [188 218]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.51it/s]
Epoch 15 : Training Loss: 0.00065, acc: 0.73109, pr_auc: 0.81468, roc_auc: 0.81406, LR: 0.00024, Time elapsed 0.07 mins
[[229   9]
 [119 119]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.68it/s]
Val Evaluation: acc: 0.55561, pr_auc: 0.67482, roc_auc: 0.67268
[[263 205]
 [183 223]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.73109, pr_auc: 0.81468, roc_auc: 0.81406
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.13it/s]
Epoch 16 : Training Loss: 0.00008, acc: 0.73109, pr_auc: 0.80206, roc_auc: 0.79425, LR: 0.00023, Time elapsed 0.07 mins
[[226  12]
 [116 122]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.49it/s]
Val Evaluation: acc: 0.54625, pr_auc: 0.67163, roc_auc: 0.66820
[[260 208]
 [188 218]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.20it/s]
Epoch 17 : Training Loss: 0.00003, acc: 0.63235, pr_auc: 0.72973, roc_auc: 0.74148, LR: 0.00022, Time elapsed 0.07 mins
[[186  52]
 [123 115]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.97it/s]
Val Evaluation: acc: 0.57557, pr_auc: 0.74418, roc_auc: 0.71574
[[269 199]
 [172 234]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.32it/s]
Epoch 18 : Training Loss: 0.00002, acc: 0.66387, pr_auc: 0.75162, roc_auc: 0.76146, LR: 0.00021, Time elapsed 0.08 mins
[[199  39]
 [121 117]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.26it/s]
Val Evaluation: acc: 0.56851, pr_auc: 0.72671, roc_auc: 0.69702
[[267 201]
 [176 230]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.03it/s]
Epoch 19 : Training Loss: 0.00010, acc: 0.68908, pr_auc: 0.77089, roc_auc: 0.78187, LR: 0.00021, Time elapsed 0.08 mins
[[212  26]
 [122 116]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.85it/s]
Val Evaluation: acc: 0.55208, pr_auc: 0.69965, roc_auc: 0.67794
[[262 206]
 [185 221]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.13it/s]
Epoch 20 : Training Loss: 0.00003, acc: 0.64286, pr_auc: 0.73927, roc_auc: 0.75961, LR: 0.00020, Time elapsed 0.08 mins
[[200  38]
 [132 106]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.13it/s]
Val Evaluation: acc: 0.57015, pr_auc: 0.72288, roc_auc: 0.68919
[[272 196]
 [179 227]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.76it/s]
Epoch 21 : Training Loss: 0.00001, acc: 0.63866, pr_auc: 0.73949, roc_auc: 0.75696, LR: 0.00019, Time elapsed 0.08 mins
[[194  44]
 [128 110]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.45it/s]
Val Evaluation: acc: 0.57032, pr_auc: 0.72261, roc_auc: 0.68890
[[271 197]
 [178 228]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.82it/s]
Epoch 22 : Training Loss: 0.00002, acc: 0.63235, pr_auc: 0.73074, roc_auc: 0.74883, LR: 0.00018, Time elapsed 0.08 mins
[[190  48]
 [127 111]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 44.24it/s]
Val Evaluation: acc: 0.57475, pr_auc: 0.72592, roc_auc: 0.69233
[[274 194]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.28it/s]
Epoch 23 : Training Loss: 0.00002, acc: 0.63025, pr_auc: 0.73112, roc_auc: 0.74791, LR: 0.00017, Time elapsed 0.08 mins
[[189  49]
 [127 111]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 44.11it/s]
Val Evaluation: acc: 0.57459, pr_auc: 0.72639, roc_auc: 0.69306
[[275 193]
 [178 228]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.70it/s]
Epoch 24 : Training Loss: 0.00288, acc: 0.60504, pr_auc: 0.73061, roc_auc: 0.74800, LR: 0.00016, Time elapsed 0.08 mins
[[184  54]
 [134 104]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 44.05it/s]
Val Evaluation: acc: 0.58649, pr_auc: 0.74835, roc_auc: 0.69863
[[270 198]
 [164 242]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.70it/s]
Epoch 25 : Training Loss: 0.00053, acc: 0.65126, pr_auc: 0.76435, roc_auc: 0.77621, LR: 0.00015, Time elapsed 0.08 mins
[[207  31]
 [135 103]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.78it/s]
Val Evaluation: acc: 0.59636, pr_auc: 0.73048, roc_auc: 0.70532
[[285 183]
 [169 237]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.33it/s]
Epoch 26 : Training Loss: 0.00027, acc: 0.61765, pr_auc: 0.71513, roc_auc: 0.73736, LR: 0.00014, Time elapsed 0.08 mins
[[188  50]
 [132 106]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.74it/s]
Val Evaluation: acc: 0.60005, pr_auc: 0.74198, roc_auc: 0.71940
[[285 183]
 [166 240]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.33it/s]
Epoch 27 : Training Loss: 0.00004, acc: 0.67647, pr_auc: 0.77366, roc_auc: 0.77845, LR: 0.00013, Time elapsed 0.08 mins
[[210  28]
 [126 112]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.36it/s]
Val Evaluation: acc: 0.57361, pr_auc: 0.66368, roc_auc: 0.65238
[[281 187]
 [184 222]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.21it/s]
Epoch 28 : Training Loss: 0.00002, acc: 0.60924, pr_auc: 0.71658, roc_auc: 0.73384, LR: 0.00012, Time elapsed 0.08 mins
[[184  54]
 [132 106]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.63it/s]
Val Evaluation: acc: 0.60005, pr_auc: 0.74126, roc_auc: 0.71543
[[285 183]
 [166 240]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.56it/s]
Epoch 29 : Training Loss: 0.00003, acc: 0.62185, pr_auc: 0.73620, roc_auc: 0.75195, LR: 0.00011, Time elapsed 0.08 mins
[[198  40]
 [140  98]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.54it/s]
Val Evaluation: acc: 0.58100, pr_auc: 0.70749, roc_auc: 0.68811
[[281 187]
 [178 228]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.04it/s]
Epoch 30 : Training Loss: 0.00001, acc: 0.62605, pr_auc: 0.74368, roc_auc: 0.75741, LR: 0.00010, Time elapsed 0.08 mins
[[200  38]
 [140  98]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.68it/s]
Val Evaluation: acc: 0.56474, pr_auc: 0.69492, roc_auc: 0.67510
[[275 193]
 [186 220]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.27it/s]
Epoch 31 : Training Loss: 0.00001, acc: 0.63235, pr_auc: 0.74536, roc_auc: 0.75802, LR: 0.00010, Time elapsed 0.08 mins
[[200  38]
 [137 101]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.44it/s]
Val Evaluation: acc: 0.56737, pr_auc: 0.69346, roc_auc: 0.67363
[[274 194]
 [183 223]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.29it/s]
Epoch 32 : Training Loss: 0.00001, acc: 0.63866, pr_auc: 0.74736, roc_auc: 0.75883, LR: 0.00009, Time elapsed 0.08 mins
[[197  41]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.39it/s]
Val Evaluation: acc: 0.56523, pr_auc: 0.69152, roc_auc: 0.67173
[[272 196]
 [183 223]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.43it/s]
Epoch 33 : Training Loss: 0.00001, acc: 0.63445, pr_auc: 0.74516, roc_auc: 0.75739, LR: 0.00008, Time elapsed 0.08 mins
[[197  41]
 [133 105]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.30it/s]
Val Evaluation: acc: 0.56416, pr_auc: 0.69214, roc_auc: 0.67214
[[271 197]
 [183 223]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.99it/s]
Epoch 34 : Training Loss: 0.00001, acc: 0.63866, pr_auc: 0.74531, roc_auc: 0.75722, LR: 0.00007, Time elapsed 0.08 mins
[[198  40]
 [132 106]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.23it/s]
Val Evaluation: acc: 0.56112, pr_auc: 0.69249, roc_auc: 0.67239
[[267 201]
 [182 224]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.04it/s]
Epoch 35 : Training Loss: 0.00001, acc: 0.63866, pr_auc: 0.74562, roc_auc: 0.75771, LR: 0.00006, Time elapsed 0.08 mins
[[198  40]
 [132 106]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.29it/s]
Val Evaluation: acc: 0.56342, pr_auc: 0.69185, roc_auc: 0.67227
[[268 200]
 [181 225]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.93it/s]
Epoch 36 : Training Loss: 0.00001, acc: 0.65336, pr_auc: 0.74799, roc_auc: 0.75957, LR: 0.00006, Time elapsed 0.08 mins
[[202  36]
 [129 109]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.75it/s]
Val Evaluation: acc: 0.56679, pr_auc: 0.68818, roc_auc: 0.67033
[[270 198]
 [180 226]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.33it/s]
Epoch 37 : Training Loss: 0.00000, acc: 0.64496, pr_auc: 0.74630, roc_auc: 0.75817, LR: 0.00005, Time elapsed 0.08 mins
[[200  38]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.58it/s]
Val Evaluation: acc: 0.56802, pr_auc: 0.69004, roc_auc: 0.67163
[[270 198]
 [179 227]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.38it/s]
Epoch 38 : Training Loss: 0.00000, acc: 0.64076, pr_auc: 0.74498, roc_auc: 0.75705, LR: 0.00004, Time elapsed 0.08 mins
[[198  40]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.14it/s]
Val Evaluation: acc: 0.57015, pr_auc: 0.69190, roc_auc: 0.67315
[[272 196]
 [179 227]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.54it/s]
Epoch 39 : Training Loss: 0.00001, acc: 0.63235, pr_auc: 0.74298, roc_auc: 0.75549, LR: 0.00004, Time elapsed 0.08 mins
[[194  44]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.38it/s]
Val Evaluation: acc: 0.57245, pr_auc: 0.69554, roc_auc: 0.67614
[[273 195]
 [178 228]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.54it/s]
Epoch 40 : Training Loss: 0.00000, acc: 0.63025, pr_auc: 0.74222, roc_auc: 0.75496, LR: 0.00003, Time elapsed 0.08 mins
[[193  45]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.44it/s]
Val Evaluation: acc: 0.57475, pr_auc: 0.69693, roc_auc: 0.67715
[[274 194]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.20it/s]
Epoch 41 : Training Loss: 0.00000, acc: 0.63025, pr_auc: 0.74140, roc_auc: 0.75433, LR: 0.00002, Time elapsed 0.08 mins
[[193  45]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.87it/s]
Val Evaluation: acc: 0.57475, pr_auc: 0.69746, roc_auc: 0.67755
[[274 194]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.99it/s]
Epoch 42 : Training Loss: 0.00000, acc: 0.63025, pr_auc: 0.74127, roc_auc: 0.75418, LR: 0.00002, Time elapsed 0.08 mins
[[193  45]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.88it/s]
Val Evaluation: acc: 0.57369, pr_auc: 0.69757, roc_auc: 0.67755
[[273 195]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.14it/s]
Epoch 43 : Training Loss: 0.00000, acc: 0.63025, pr_auc: 0.74095, roc_auc: 0.75394, LR: 0.00002, Time elapsed 0.08 mins
[[193  45]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.70it/s]
Val Evaluation: acc: 0.57369, pr_auc: 0.69797, roc_auc: 0.67782
[[273 195]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.74it/s]
Epoch 44 : Training Loss: 0.00001, acc: 0.63025, pr_auc: 0.74111, roc_auc: 0.75403, LR: 0.00001, Time elapsed 0.08 mins
[[193  45]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.16it/s]
Val Evaluation: acc: 0.57262, pr_auc: 0.69788, roc_auc: 0.67784
[[272 196]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.82it/s]
Epoch 45 : Training Loss: 0.00000, acc: 0.63025, pr_auc: 0.74122, roc_auc: 0.75408, LR: 0.00001, Time elapsed 0.08 mins
[[193  45]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.04it/s]
Val Evaluation: acc: 0.57262, pr_auc: 0.69794, roc_auc: 0.67789
[[272 196]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.44it/s]
Epoch 46 : Training Loss: 0.00000, acc: 0.63025, pr_auc: 0.74110, roc_auc: 0.75403, LR: 0.00001, Time elapsed 0.08 mins
[[193  45]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.68it/s]
Val Evaluation: acc: 0.57369, pr_auc: 0.69809, roc_auc: 0.67796
[[273 195]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.92it/s]
Epoch 47 : Training Loss: 0.00000, acc: 0.63025, pr_auc: 0.74101, roc_auc: 0.75399, LR: 0.00000, Time elapsed 0.08 mins
[[193  45]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.57it/s]
Val Evaluation: acc: 0.57369, pr_auc: 0.69810, roc_auc: 0.67796
[[273 195]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.69it/s]
Epoch 48 : Training Loss: 0.00000, acc: 0.63025, pr_auc: 0.74084, roc_auc: 0.75387, LR: 0.00000, Time elapsed 0.08 mins
[[193  45]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.03it/s]
Val Evaluation: acc: 0.57369, pr_auc: 0.69814, roc_auc: 0.67801
[[273 195]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.77it/s]
Epoch 49 : Training Loss: 0.00000, acc: 0.63025, pr_auc: 0.74084, roc_auc: 0.75387, LR: 0.00000, Time elapsed 0.08 mins
[[193  45]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.14it/s]
Val Evaluation: acc: 0.57369, pr_auc: 0.69814, roc_auc: 0.67799
[[273 195]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.28it/s]
Epoch 50 : Training Loss: 0.00000, acc: 0.63025, pr_auc: 0.74077, roc_auc: 0.75383, LR: 0.00000, Time elapsed 0.08 mins
[[193  45]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.67it/s]
Val Evaluation: acc: 0.57369, pr_auc: 0.69815, roc_auc: 0.67800
[[273 195]
 [177 229]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.80it/s]
***************************Test results************************
Test Evaluation: acc: 0.55561, pr_auc: 0.67482, roc_auc: 0.67268
[[263 205]
 [183 223]]
model save in ./data/wjq/models_weights/Big/BigFaced/epoch15_acc_0.55561_pr_0.67482_roc_0.67268.pth
Done!!!!!
