100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.02it/s]
Epoch 1 : Training Loss: 1.62275, acc: 0.22000, kappa: 0.02500, f1: 0.15425, LR: 0.00003, Time elapsed 0.21 mins
[[ 11  13   0 120   6]
 [  9  10   1 117  13]
 [ 11   9   2 115  13]
 [ 14   5   2 120   9]
 [  8   7   3 110  22]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22000, kappa: 0.02500, f1: 0.15425
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.03it/s]
Epoch 2 : Training Loss: 1.60221, acc: 0.23067, kappa: 0.03833, f1: 0.17930, LR: 0.00003, Time elapsed 0.21 mins
[[  1   4  22  37  86]
 [  4  14  17  21  94]
 [  1   6  20  21 102]
 [  1   3  24  34  88]
 [  0   6  15  25 104]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23067, kappa: 0.03833, f1: 0.17930
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.13it/s]
Epoch 3 : Training Loss: 1.57538, acc: 0.23333, kappa: 0.04167, f1: 0.20395, LR: 0.00003, Time elapsed 0.21 mins
[[32 22 67  8 21]
 [25 24 73  7 21]
 [18 10 89 15 18]
 [24 17 81  7 21]
 [16 19 85  7 23]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23333, kappa: 0.04167, f1: 0.20395
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.07it/s]
Epoch 4 : Training Loss: 1.53555, acc: 0.25467, kappa: 0.06833, f1: 0.24570, LR: 0.00003, Time elapsed 0.21 mins
[[51 16 32 16 35]
 [44 25 27 13 41]
 [29 10 40 25 46]
 [45 11 30 19 45]
 [38 14 26 16 56]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25467, kappa: 0.06833, f1: 0.24570
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.89it/s]
Epoch 5 : Training Loss: 1.48383, acc: 0.23733, kappa: 0.04667, f1: 0.23468, LR: 0.00003, Time elapsed 0.21 mins
[[45 20 27 23 35]
 [35 30 24 19 42]
 [31 18 32 29 40]
 [36 24 26 26 38]
 [33 24 25 23 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.95it/s]
Epoch 6 : Training Loss: 1.41784, acc: 0.24667, kappa: 0.05833, f1: 0.23537, LR: 0.00003, Time elapsed 0.21 mins
[[71 21 13 29 16]
 [60 27 15 18 30]
 [60 14 20 28 28]
 [65 18 11 31 25]
 [57 22 11 24 36]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.80it/s]
Epoch 7 : Training Loss: 1.36236, acc: 0.25333, kappa: 0.06667, f1: 0.24559, LR: 0.00003, Time elapsed 0.21 mins
[[41 13 19 36 41]
 [37 21 11 36 45]
 [36  8 25 41 40]
 [38 12 14 48 38]
 [31 13 18 33 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
Epoch 8 : Training Loss: 1.29972, acc: 0.24000, kappa: 0.05000, f1: 0.23445, LR: 0.00003, Time elapsed 0.22 mins
[[30 21 23 45 31]
 [31 32 14 32 41]
 [25 24 21 48 32]
 [19 30 16 50 35]
 [23 25 15 40 47]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.56it/s]
Epoch 9 : Training Loss: 1.24797, acc: 0.23733, kappa: 0.04667, f1: 0.23466, LR: 0.00003, Time elapsed 0.21 mins
[[46 15 26 39 24]
 [45 28 19 31 27]
 [44 19 26 35 26]
 [41 24 15 43 27]
 [38 24 22 31 35]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.50it/s]
Epoch 10 : Training Loss: 1.18887, acc: 0.23733, kappa: 0.04667, f1: 0.23307, LR: 0.00003, Time elapsed 0.22 mins
[[46 25 21 41 17]
 [43 43 14 30 20]
 [44 25 20 37 24]
 [44 33  9 40 24]
 [40 31 18 32 29]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.94it/s]
Epoch 11 : Training Loss: 1.12953, acc: 0.25200, kappa: 0.06500, f1: 0.24915, LR: 0.00003, Time elapsed 0.21 mins
[[51 22 19 32 26]
 [48 35 14 25 28]
 [50 18 24 33 25]
 [38 25 10 38 39]
 [46 25 13 25 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.97it/s]
Epoch 12 : Training Loss: 1.06429, acc: 0.25333, kappa: 0.06667, f1: 0.25186, LR: 0.00003, Time elapsed 0.21 mins
[[52 22 25 29 22]
 [49 32 21 20 28]
 [51 16 32 27 24]
 [40 18 20 41 31]
 [46 20 21 30 33]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.82it/s]
Epoch 13 : Training Loss: 1.00614, acc: 0.24933, kappa: 0.06167, f1: 0.24515, LR: 0.00003, Time elapsed 0.21 mins
[[37 44 18 22 29]
 [35 54 14 14 33]
 [33 37 29 19 32]
 [26 44 10 24 46]
 [34 38 16 19 43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.87it/s]
Epoch 14 : Training Loss: 0.95691, acc: 0.25867, kappa: 0.07333, f1: 0.25878, LR: 0.00003, Time elapsed 0.21 mins
[[35 20 33 30 32]
 [38 33 21 25 33]
 [35 13 40 28 34]
 [27 19 26 41 37]
 [29 18 29 29 45]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25867, kappa: 0.07333, f1: 0.25878
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.59it/s]
Epoch 15 : Training Loss: 0.90275, acc: 0.25467, kappa: 0.06833, f1: 0.24653, LR: 0.00003, Time elapsed 0.21 mins
[[43 17 20 35 35]
 [38 32 11 38 31]
 [32 19 16 44 39]
 [28 22 12 50 38]
 [37 17 13 33 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.06it/s]
Epoch 16 : Training Loss: 0.83845, acc: 0.24667, kappa: 0.05833, f1: 0.24426, LR: 0.00003, Time elapsed 0.21 mins
[[43 21 21 32 33]
 [39 35 17 27 32]
 [38 21 23 34 34]
 [32 24 20 44 30]
 [39 22 21 28 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.74it/s]
Epoch 17 : Training Loss: 0.81082, acc: 0.25733, kappa: 0.07167, f1: 0.25364, LR: 0.00003, Time elapsed 0.21 mins
[[38 28 20 37 27]
 [30 43 16 33 28]
 [31 30 22 37 30]
 [27 24 17 49 33]
 [25 25 20 39 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.92it/s]
Epoch 18 : Training Loss: 0.76925, acc: 0.26133, kappa: 0.07667, f1: 0.26030, LR: 0.00002, Time elapsed 0.21 mins
[[39 25 27 26 33]
 [38 42 16 26 28]
 [34 29 35 25 27]
 [30 29 19 30 42]
 [34 20 22 24 50]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26133, kappa: 0.07667, f1: 0.26030
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.08it/s]
Epoch 19 : Training Loss: 0.71814, acc: 0.25867, kappa: 0.07333, f1: 0.25774, LR: 0.00002, Time elapsed 0.22 mins
[[34 25 23 41 27]
 [28 41 22 39 20]
 [28 27 33 34 28]
 [22 29 21 48 30]
 [31 21 27 33 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.45it/s]
Epoch 20 : Training Loss: 0.69191, acc: 0.25067, kappa: 0.06333, f1: 0.24856, LR: 0.00002, Time elapsed 0.25 mins
[[47 22 16 39 26]
 [30 38 17 39 26]
 [39 27 24 33 27]
 [41 22 20 39 28]
 [34 25 18 33 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.40it/s]
Epoch 21 : Training Loss: 0.66140, acc: 0.25200, kappa: 0.06500, f1: 0.25025, LR: 0.00002, Time elapsed 0.26 mins
[[43 19 23 32 33]
 [36 35 19 36 24]
 [33 24 27 31 35]
 [34 24 20 38 34]
 [32 24 23 25 46]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.64it/s]
Epoch 22 : Training Loss: 0.63805, acc: 0.25333, kappa: 0.06667, f1: 0.25349, LR: 0.00002, Time elapsed 0.26 mins
[[41 17 29 37 26]
 [33 36 18 33 30]
 [36 22 32 32 28]
 [34 20 20 41 35]
 [34 19 26 31 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.70it/s]
Epoch 23 : Training Loss: 0.61021, acc: 0.25733, kappa: 0.07167, f1: 0.25649, LR: 0.00002, Time elapsed 0.26 mins
[[38 24 22 40 26]
 [33 41 18 39 19]
 [30 26 32 36 26]
 [25 24 24 48 29]
 [32 20 30 34 34]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.23it/s]
Epoch 24 : Training Loss: 0.59468, acc: 0.25200, kappa: 0.06500, f1: 0.24982, LR: 0.00002, Time elapsed 0.25 mins
[[52 21 23 27 27]
 [41 36 18 34 21]
 [45 22 27 28 28]
 [46 24 15 37 28]
 [43 20 22 28 37]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.80it/s]
Epoch 25 : Training Loss: 0.57744, acc: 0.26000, kappa: 0.07500, f1: 0.25995, LR: 0.00002, Time elapsed 0.25 mins
[[39 30 25 28 28]
 [36 43 18 32 21]
 [33 33 37 23 24]
 [30 30 23 41 26]
 [29 30 25 31 35]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.17it/s]
Epoch 26 : Training Loss: 0.55766, acc: 0.24533, kappa: 0.05667, f1: 0.24505, LR: 0.00002, Time elapsed 0.26 mins
[[41 22 30 29 28]
 [33 40 20 35 22]
 [30 30 31 29 30]
 [32 30 19 36 33]
 [31 22 31 30 36]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.87it/s]
Epoch 27 : Training Loss: 0.54579, acc: 0.25600, kappa: 0.07000, f1: 0.25541, LR: 0.00002, Time elapsed 0.26 mins
[[42 29 20 35 24]
 [38 33 18 41 20]
 [37 23 31 34 25]
 [37 26 16 46 25]
 [32 22 20 36 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.00it/s]
Epoch 28 : Training Loss: 0.53782, acc: 0.26000, kappa: 0.07500, f1: 0.25732, LR: 0.00001, Time elapsed 0.26 mins
[[48 22 23 38 19]
 [41 36 15 37 21]
 [38 27 30 31 24]
 [40 27 14 50 19]
 [40 21 25 33 31]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.17it/s]
Epoch 29 : Training Loss: 0.52676, acc: 0.26400, kappa: 0.08000, f1: 0.26292, LR: 0.00001, Time elapsed 0.25 mins
[[47 16 20 38 29]
 [36 34 18 36 26]
 [37 19 31 31 32]
 [34 23 22 41 30]
 [32 18 23 32 45]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26400, kappa: 0.08000, f1: 0.26292
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.69it/s]
Epoch 30 : Training Loss: 0.51591, acc: 0.27333, kappa: 0.09167, f1: 0.27311, LR: 0.00001, Time elapsed 0.25 mins
[[39 27 22 31 31]
 [28 43 16 33 30]
 [28 28 36 29 29]
 [25 32 18 40 35]
 [28 22 24 29 47]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27333, kappa: 0.09167, f1: 0.27311
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.73it/s]
Epoch 31 : Training Loss: 0.50987, acc: 0.25067, kappa: 0.06333, f1: 0.25056, LR: 0.00001, Time elapsed 0.26 mins
[[37 25 28 27 33]
 [26 39 18 37 30]
 [33 24 33 31 29]
 [26 32 24 38 30]
 [28 23 25 33 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.94it/s]
Epoch 32 : Training Loss: 0.50191, acc: 0.26800, kappa: 0.08500, f1: 0.26819, LR: 0.00001, Time elapsed 0.26 mins
[[45 25 24 30 26]
 [35 39 17 39 20]
 [34 29 36 28 23]
 [32 28 19 40 31]
 [32 21 23 33 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.72it/s]
Epoch 33 : Training Loss: 0.49467, acc: 0.26000, kappa: 0.07500, f1: 0.25950, LR: 0.00001, Time elapsed 0.25 mins
[[39 27 25 28 31]
 [30 43 18 31 28]
 [29 31 32 29 29]
 [27 31 17 40 35]
 [30 23 24 32 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.92it/s]
Epoch 34 : Training Loss: 0.49006, acc: 0.26667, kappa: 0.08333, f1: 0.26652, LR: 0.00001, Time elapsed 0.25 mins
[[44 24 26 28 28]
 [28 45 17 34 26]
 [31 26 35 29 29]
 [33 32 16 38 31]
 [32 24 26 30 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.93it/s]
Epoch 35 : Training Loss: 0.48211, acc: 0.27333, kappa: 0.09167, f1: 0.27385, LR: 0.00001, Time elapsed 0.25 mins
[[42 22 22 31 33]
 [30 40 17 37 26]
 [31 23 39 31 26]
 [27 30 20 40 33]
 [28 22 25 31 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.01it/s]
Epoch 36 : Training Loss: 0.47945, acc: 0.26933, kappa: 0.08667, f1: 0.26989, LR: 0.00001, Time elapsed 0.26 mins
[[42 23 26 31 28]
 [28 42 18 36 26]
 [31 21 38 30 30]
 [32 30 21 38 29]
 [29 21 26 32 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.92it/s]
Epoch 37 : Training Loss: 0.47286, acc: 0.27867, kappa: 0.09833, f1: 0.27937, LR: 0.00001, Time elapsed 0.26 mins
[[43 20 26 32 29]
 [29 43 20 31 27]
 [33 22 40 26 29]
 [33 26 22 38 31]
 [30 17 26 32 45]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27867, kappa: 0.09833, f1: 0.27937
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.90it/s]
Epoch 38 : Training Loss: 0.47046, acc: 0.26933, kappa: 0.08667, f1: 0.26853, LR: 0.00001, Time elapsed 0.26 mins
[[41 23 20 35 31]
 [27 42 15 41 25]
 [29 25 30 36 30]
 [27 28 17 45 33]
 [29 20 23 34 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.68it/s]
Epoch 39 : Training Loss: 0.46797, acc: 0.27067, kappa: 0.08833, f1: 0.27047, LR: 0.00000, Time elapsed 0.26 mins
[[47 19 21 35 28]
 [33 40 17 35 25]
 [37 20 32 30 31]
 [33 23 22 41 31]
 [36 17 25 29 43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.07it/s]
Epoch 40 : Training Loss: 0.46560, acc: 0.26800, kappa: 0.08500, f1: 0.26788, LR: 0.00000, Time elapsed 0.25 mins
[[44 19 25 32 30]
 [29 41 17 36 27]
 [35 21 33 29 32]
 [31 27 24 37 31]
 [31 20 23 30 46]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.48it/s]
Epoch 41 : Training Loss: 0.46488, acc: 0.27333, kappa: 0.09167, f1: 0.27392, LR: 0.00000, Time elapsed 0.25 mins
[[43 20 24 32 31]
 [25 44 16 39 26]
 [32 22 35 30 31]
 [30 27 24 39 30]
 [30 18 25 33 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.89it/s]
Epoch 42 : Training Loss: 0.45953, acc: 0.27600, kappa: 0.09500, f1: 0.27600, LR: 0.00000, Time elapsed 0.25 mins
[[39 25 22 33 31]
 [27 45 15 38 25]
 [29 24 35 32 30]
 [27 29 21 43 30]
 [29 21 23 32 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.84it/s]
Epoch 43 : Training Loss: 0.45742, acc: 0.27333, kappa: 0.09167, f1: 0.27396, LR: 0.00000, Time elapsed 0.25 mins
[[42 20 22 35 31]
 [31 42 15 36 26]
 [34 19 35 32 30]
 [31 25 22 42 30]
 [31 19 24 32 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.97it/s]
Epoch 44 : Training Loss: 0.45636, acc: 0.27067, kappa: 0.08833, f1: 0.27035, LR: 0.00000, Time elapsed 0.25 mins
[[41 27 21 32 29]
 [29 44 16 34 27]
 [32 23 33 31 31]
 [27 31 21 41 30]
 [29 22 23 32 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.91it/s]
Epoch 45 : Training Loss: 0.45484, acc: 0.27067, kappa: 0.08833, f1: 0.27034, LR: 0.00000, Time elapsed 0.26 mins
[[42 25 22 33 28]
 [31 44 14 36 25]
 [35 21 31 33 30]
 [31 26 18 43 32]
 [30 20 25 32 43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.81it/s]
Epoch 46 : Training Loss: 0.45540, acc: 0.27733, kappa: 0.09667, f1: 0.27772, LR: 0.00000, Time elapsed 0.25 mins
[[42 24 24 32 28]
 [27 45 18 36 24]
 [30 22 36 32 30]
 [30 24 22 43 31]
 [29 20 26 33 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.80it/s]
Epoch 47 : Training Loss: 0.45401, acc: 0.27600, kappa: 0.09500, f1: 0.27664, LR: 0.00000, Time elapsed 0.26 mins
[[40 22 24 33 31]
 [28 45 16 35 26]
 [30 22 37 32 29]
 [29 25 22 42 32]
 [29 20 26 32 43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.98it/s]
Epoch 48 : Training Loss: 0.45213, acc: 0.27733, kappa: 0.09667, f1: 0.27791, LR: 0.00000, Time elapsed 0.25 mins
[[44 20 24 32 30]
 [30 44 14 36 26]
 [33 20 35 32 30]
 [31 25 20 42 32]
 [31 18 26 32 43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.09it/s]
Epoch 49 : Training Loss: 0.45294, acc: 0.26933, kappa: 0.08667, f1: 0.26985, LR: 0.00000, Time elapsed 0.25 mins
[[37 22 25 33 33]
 [27 44 15 36 28]
 [30 21 35 33 31]
 [30 25 20 42 33]
 [28 19 26 33 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.88it/s]
Epoch 50 : Training Loss: 0.45017, acc: 0.27067, kappa: 0.08833, f1: 0.27115, LR: 0.00000, Time elapsed 0.26 mins
[[39 22 25 33 31]
 [29 44 14 36 27]
 [31 23 35 31 30]
 [30 25 21 42 32]
 [29 19 26 33 43]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.95it/s]
***************************Test results************************
Test Evaluation: acc: 0.26667, kappa: 0.08333, f1: 0.26344
[[57 19 25 27 22]
 [42 38 21 27 22]
 [33 25 34 22 36]
 [40 31 16 27 36]
 [38 17 22 29 44]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch37_acc_0.26667_kappa_0.08333_f1_0.26344.pth
[32m[I 2025-08-29 15:50:36,696][0m Trial 36 finished with value: 0.08333333333333337 and parameters: {'lr': 3.376575857287442e-05, 'weight_decay': 0.015243198307006408, '--dropout': 0.1875563457735575, '--clip_value': 1.9331780495189743}. Best is trial 35 with value: 0.36.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=5.998654380510801e-05, weight_decay=0.011343272874178209, optimizer='AdamW', clip_value=1.9147319799237246, dropout=0.19993285441089045, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.19993285441089045, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.19993285441089045, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
