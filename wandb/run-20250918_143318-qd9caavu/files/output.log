498 125 129
752
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (meta_backbone): Sequential(
    (0): Linear(in_features=28, out_features=100, bias=True)
    (1): ELU(alpha=1.0)
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=100, out_features=200, bias=True)
  )
  (arranger): Rearrange('b c s d -> b (c s) d')
  (attention): ParamAttention(
    (Wq): Linear(in_features=200, out_features=200, bias=False)
    (Wk): Linear(in_features=200, out_features=200, bias=False)
    (Wv): Linear(in_features=200, out_features=200, bias=False)
    (drop): Dropout(p=0.1, inplace=False)
  )
  (classifier): Sequential(
    (0): Linear(in_features=200, out_features=1, bias=True)
    (1): Rearrange('b 1 -> (b 1)')
  )
)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:06<00:00,  2.51it/s]
Epoch 1 : Training Loss: 0.69461, LR: 0.00010, Time elapsed 0.11 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00,  9.74it/s]
val Evaluation: acc: 0.50000, pr_auc: 0.44051, roc_auc: 0.32276
[[57  0]
 [68  0]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00,  8.49it/s]
test Evaluation: acc: 0.50000, pr_auc: 0.33087, roc_auc: 0.31376
[[74  0]
 [55  0]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.50000, pr_auc: 0.44051, roc_auc: 0.32276
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.69it/s]
Epoch 2 : Training Loss: 0.69178, LR: 0.00010, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.51it/s]
val Evaluation: acc: 0.50000, pr_auc: 0.38632, roc_auc: 0.17260
[[57  0]
 [68  0]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 18.01it/s]
test Evaluation: acc: 0.50000, pr_auc: 0.42670, roc_auc: 0.42457
[[74  0]
 [55  0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.62it/s]
Epoch 3 : Training Loss: 0.65740, LR: 0.00010, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.29it/s]
val Evaluation: acc: 0.43369, pr_auc: 0.49407, roc_auc: 0.36275
[[31 26]
 [46 22]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.86it/s]
test Evaluation: acc: 0.45344, pr_auc: 0.39427, roc_auc: 0.48698
[[55 19]
 [46  9]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.43369, pr_auc: 0.49407, roc_auc: 0.36275
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.55it/s]
Epoch 4 : Training Loss: 0.44477, LR: 0.00010, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.00it/s]
val Evaluation: acc: 0.37745, pr_auc: 0.57253, roc_auc: 0.66228
[[38 19]
 [62  6]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.57it/s]
test Evaluation: acc: 0.37838, pr_auc: 0.41699, roc_auc: 0.51351
[[56 18]
 [55  0]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.37745, pr_auc: 0.57253, roc_auc: 0.66228
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.58it/s]
Epoch 5 : Training Loss: 0.30790, LR: 0.00010, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.88it/s]
val Evaluation: acc: 0.35539, pr_auc: 0.57378, roc_auc: 0.66460
[[38 19]
 [65  3]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.45it/s]
test Evaluation: acc: 0.53292, pr_auc: 0.44242, roc_auc: 0.57641
[[56 18]
 [38 17]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.35539, pr_auc: 0.57378, roc_auc: 0.66460
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.44it/s]
Epoch 6 : Training Loss: 0.17942, LR: 0.00010, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.65it/s]
val Evaluation: acc: 0.40686, pr_auc: 0.57234, roc_auc: 0.66176
[[38 19]
 [58 10]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.25it/s]
test Evaluation: acc: 0.45111, pr_auc: 0.45764, roc_auc: 0.59509
[[56 18]
 [47  8]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.52it/s]
Epoch 7 : Training Loss: 0.13422, LR: 0.00010, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.64it/s]
val Evaluation: acc: 0.37887, pr_auc: 0.57392, roc_auc: 0.66538
[[39 18]
 [63  5]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.21it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.40147, roc_auc: 0.50934
[[57 17]
 [41 14]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.37887, pr_auc: 0.57392, roc_auc: 0.66538
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.42it/s]
Epoch 8 : Training Loss: 0.09583, LR: 0.00009, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.59it/s]
val Evaluation: acc: 0.40828, pr_auc: 0.57088, roc_auc: 0.65996
[[39 18]
 [59  9]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.16it/s]
test Evaluation: acc: 0.51474, pr_auc: 0.40574, roc_auc: 0.52432
[[56 18]
 [40 15]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.41it/s]
Epoch 9 : Training Loss: 0.06853, LR: 0.00009, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.63it/s]
val Evaluation: acc: 0.35681, pr_auc: 0.56230, roc_auc: 0.64370
[[39 18]
 [66  2]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.19it/s]
test Evaluation: acc: 0.38747, pr_auc: 0.42322, roc_auc: 0.55504
[[56 18]
 [54  1]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.43it/s]
Epoch 10 : Training Loss: 0.07259, LR: 0.00009, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.31it/s]
val Evaluation: acc: 0.44453, pr_auc: 0.54584, roc_auc: 0.60965
[[49  8]
 [66  2]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.02it/s]
test Evaluation: acc: 0.52150, pr_auc: 0.42489, roc_auc: 0.57002
[[57 17]
 [40 15]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.37it/s]
Epoch 11 : Training Loss: 0.06079, LR: 0.00009, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.33it/s]
val Evaluation: acc: 0.45472, pr_auc: 0.57120, roc_auc: 0.61894
[[51  6]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.91it/s]
test Evaluation: acc: 0.51916, pr_auc: 0.45672, roc_auc: 0.61794
[[58 16]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.35it/s]
Epoch 12 : Training Loss: 0.03659, LR: 0.00009, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.39it/s]
val Evaluation: acc: 0.45472, pr_auc: 0.54481, roc_auc: 0.59030
[[51  6]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.90it/s]
test Evaluation: acc: 0.51916, pr_auc: 0.44287, roc_auc: 0.58796
[[58 16]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.33it/s]
Epoch 13 : Training Loss: 0.02614, LR: 0.00008, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.24it/s]
val Evaluation: acc: 0.35539, pr_auc: 0.53001, roc_auc: 0.57508
[[38 19]
 [65  3]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.73it/s]
test Evaluation: acc: 0.54201, pr_auc: 0.42882, roc_auc: 0.56511
[[56 18]
 [37 18]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.37it/s]
Epoch 14 : Training Loss: 0.02830, LR: 0.00008, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.59it/s]
val Evaluation: acc: 0.47988, pr_auc: 0.57028, roc_auc: 0.64706
[[48  9]
 [60  8]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.21it/s]
test Evaluation: acc: 0.52150, pr_auc: 0.43427, roc_auc: 0.57666
[[57 17]
 [40 15]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.33it/s]
Epoch 15 : Training Loss: 0.10205, LR: 0.00008, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.18it/s]
val Evaluation: acc: 0.34069, pr_auc: 0.52275, roc_auc: 0.56244
[[38 19]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.69it/s]
test Evaluation: acc: 0.54201, pr_auc: 0.42220, roc_auc: 0.54668
[[56 18]
 [37 18]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.36it/s]
Epoch 16 : Training Loss: 0.01491, LR: 0.00008, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.40it/s]
val Evaluation: acc: 0.37010, pr_auc: 0.54963, roc_auc: 0.62178
[[38 19]
 [63  5]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.10it/s]
test Evaluation: acc: 0.52383, pr_auc: 0.43155, roc_auc: 0.57125
[[56 18]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.37it/s]
Epoch 17 : Training Loss: 0.02152, LR: 0.00007, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.52it/s]
val Evaluation: acc: 0.36275, pr_auc: 0.54724, roc_auc: 0.61713
[[38 19]
 [64  4]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.99it/s]
test Evaluation: acc: 0.53059, pr_auc: 0.44206, roc_auc: 0.59214
[[57 17]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.20it/s]
Epoch 18 : Training Loss: 0.01357, LR: 0.00007, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.32it/s]
val Evaluation: acc: 0.39216, pr_auc: 0.56142, roc_auc: 0.64319
[[38 19]
 [60  8]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.93it/s]
test Evaluation: acc: 0.52383, pr_auc: 0.43650, roc_auc: 0.58575
[[56 18]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.33it/s]
Epoch 19 : Training Loss: 0.03131, LR: 0.00007, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.43it/s]
val Evaluation: acc: 0.39332, pr_auc: 0.52176, roc_auc: 0.55728
[[44 13]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.65it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.43693, roc_auc: 0.56904
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.39it/s]
Epoch 20 : Training Loss: 0.01838, LR: 0.00007, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.21it/s]
val Evaluation: acc: 0.47962, pr_auc: 0.59351, roc_auc: 0.62410
[[53  4]
 [66  2]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.63it/s]
test Evaluation: acc: 0.49423, pr_auc: 0.40755, roc_auc: 0.51720
[[57 17]
 [43 12]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.36it/s]
Epoch 21 : Training Loss: 0.03243, LR: 0.00006, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 13.98it/s]
val Evaluation: acc: 0.44453, pr_auc: 0.55004, roc_auc: 0.60088
[[49  8]
 [66  2]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.33it/s]
test Evaluation: acc: 0.53059, pr_auc: 0.42710, roc_auc: 0.55995
[[57 17]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.24it/s]
Epoch 22 : Training Loss: 0.00767, LR: 0.00006, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.15it/s]
val Evaluation: acc: 0.34069, pr_auc: 0.52473, roc_auc: 0.56192
[[38 19]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.09it/s]
test Evaluation: acc: 0.54877, pr_auc: 0.42663, roc_auc: 0.56216
[[57 17]
 [37 18]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.31it/s]
Epoch 23 : Training Loss: 0.01298, LR: 0.00006, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.25it/s]
val Evaluation: acc: 0.47227, pr_auc: 0.51997, roc_auc: 0.54257
[[53  4]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.76it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.45526, roc_auc: 0.60688
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.31it/s]
Epoch 24 : Training Loss: 0.00961, LR: 0.00005, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.15it/s]
val Evaluation: acc: 0.44595, pr_auc: 0.55548, roc_auc: 0.58695
[[50  7]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.77it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.43657, roc_auc: 0.57838
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.34it/s]
Epoch 25 : Training Loss: 0.01182, LR: 0.00005, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.38it/s]
val Evaluation: acc: 0.41086, pr_auc: 0.53818, roc_auc: 0.58591
[[46 11]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.09it/s]
test Evaluation: acc: 0.53059, pr_auc: 0.43613, roc_auc: 0.57617
[[57 17]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.31it/s]
Epoch 26 : Training Loss: 0.00459, LR: 0.00005, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.01it/s]
val Evaluation: acc: 0.43718, pr_auc: 0.53272, roc_auc: 0.56760
[[49  8]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.01it/s]
test Evaluation: acc: 0.53059, pr_auc: 0.44376, roc_auc: 0.58796
[[57 17]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.33it/s]
Epoch 27 : Training Loss: 0.01570, LR: 0.00004, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 15.44it/s]
val Evaluation: acc: 0.40209, pr_auc: 0.53955, roc_auc: 0.59288
[[45 12]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 18.09it/s]
test Evaluation: acc: 0.52383, pr_auc: 0.43859, roc_auc: 0.58305
[[56 18]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.16it/s]
Epoch 28 : Training Loss: 0.04037, LR: 0.00004, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.05it/s]
val Evaluation: acc: 0.43718, pr_auc: 0.53528, roc_auc: 0.57456
[[49  8]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.87it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.43960, roc_auc: 0.57936
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.31it/s]
Epoch 29 : Training Loss: 0.01057, LR: 0.00004, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.64it/s]
val Evaluation: acc: 0.41963, pr_auc: 0.54405, roc_auc: 0.59520
[[47 10]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.94it/s]
test Evaluation: acc: 0.53059, pr_auc: 0.43869, roc_auc: 0.58059
[[57 17]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.31it/s]
Epoch 30 : Training Loss: 0.00290, LR: 0.00004, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.11it/s]
val Evaluation: acc: 0.40944, pr_auc: 0.54242, roc_auc: 0.59572
[[45 12]
 [66  2]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.15it/s]
test Evaluation: acc: 0.53292, pr_auc: 0.44115, roc_auc: 0.59165
[[56 18]
 [38 17]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.36it/s]
Epoch 31 : Training Loss: 0.00136, LR: 0.00003, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 13.84it/s]
val Evaluation: acc: 0.46349, pr_auc: 0.54030, roc_auc: 0.56940
[[52  5]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.15it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.44295, roc_auc: 0.58550
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.34it/s]
Epoch 32 : Training Loss: 0.00015, LR: 0.00003, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.24it/s]
val Evaluation: acc: 0.43718, pr_auc: 0.53402, roc_auc: 0.57147
[[49  8]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.25it/s]
test Evaluation: acc: 0.53059, pr_auc: 0.44135, roc_auc: 0.58231
[[57 17]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.25it/s]
Epoch 33 : Training Loss: 0.00028, LR: 0.00003, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 13.75it/s]
val Evaluation: acc: 0.42841, pr_auc: 0.53976, roc_auc: 0.58385
[[48  9]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.42it/s]
test Evaluation: acc: 0.53059, pr_auc: 0.43973, roc_auc: 0.58084
[[57 17]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.26it/s]
Epoch 34 : Training Loss: 0.00016, LR: 0.00002, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.04it/s]
val Evaluation: acc: 0.42841, pr_auc: 0.53058, roc_auc: 0.56527
[[48  9]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.65it/s]
test Evaluation: acc: 0.53059, pr_auc: 0.44079, roc_auc: 0.58133
[[57 17]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.33it/s]
Epoch 35 : Training Loss: 0.00007, LR: 0.00002, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.22it/s]
val Evaluation: acc: 0.42841, pr_auc: 0.52634, roc_auc: 0.55341
[[48  9]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.83it/s]
test Evaluation: acc: 0.53059, pr_auc: 0.44065, roc_auc: 0.58108
[[57 17]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.36it/s]
Epoch 36 : Training Loss: 0.00432, LR: 0.00002, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.40it/s]
val Evaluation: acc: 0.40209, pr_auc: 0.51234, roc_auc: 0.53096
[[45 12]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.72it/s]
test Evaluation: acc: 0.53059, pr_auc: 0.44062, roc_auc: 0.58157
[[57 17]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.32it/s]
Epoch 37 : Training Loss: 0.00132, LR: 0.00002, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.29it/s]
val Evaluation: acc: 0.44595, pr_auc: 0.51720, roc_auc: 0.53431
[[50  7]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.49it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.44624, roc_auc: 0.58993
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.33it/s]
Epoch 38 : Training Loss: 0.00335, LR: 0.00001, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.82it/s]
val Evaluation: acc: 0.41963, pr_auc: 0.52419, roc_auc: 0.55237
[[47 10]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.51it/s]
test Evaluation: acc: 0.53059, pr_auc: 0.44163, roc_auc: 0.58403
[[57 17]
 [39 16]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.33it/s]
Epoch 39 : Training Loss: 0.00013, LR: 0.00001, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.32it/s]
val Evaluation: acc: 0.40209, pr_auc: 0.52437, roc_auc: 0.55650
[[45 12]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.52it/s]
test Evaluation: acc: 0.53968, pr_auc: 0.44086, roc_auc: 0.58378
[[57 17]
 [38 17]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.25it/s]
Epoch 40 : Training Loss: 0.00021, LR: 0.00001, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 13.91it/s]
val Evaluation: acc: 0.44595, pr_auc: 0.52539, roc_auc: 0.54721
[[50  7]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.83it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.44470, roc_auc: 0.58845
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.34it/s]
Epoch 41 : Training Loss: 0.00214, LR: 0.00001, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.23it/s]
val Evaluation: acc: 0.43718, pr_auc: 0.53276, roc_auc: 0.55960
[[49  8]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.78it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.44146, roc_auc: 0.58305
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.34it/s]
Epoch 42 : Training Loss: 0.00205, LR: 0.00001, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.20it/s]
val Evaluation: acc: 0.46349, pr_auc: 0.53240, roc_auc: 0.55366
[[52  5]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.10it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.44399, roc_auc: 0.58698
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.23it/s]
Epoch 43 : Training Loss: 0.00038, LR: 0.00001, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 13.99it/s]
val Evaluation: acc: 0.44595, pr_auc: 0.52933, roc_auc: 0.55547
[[50  7]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.34it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.44183, roc_auc: 0.58428
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.33it/s]
Epoch 44 : Training Loss: 0.00002, LR: 0.00000, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.91it/s]
val Evaluation: acc: 0.42841, pr_auc: 0.52982, roc_auc: 0.56115
[[48  9]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.11it/s]
test Evaluation: acc: 0.52150, pr_auc: 0.44147, roc_auc: 0.58415
[[57 17]
 [40 15]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.31it/s]
Epoch 45 : Training Loss: 0.02073, LR: 0.00000, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.05it/s]
val Evaluation: acc: 0.46349, pr_auc: 0.53371, roc_auc: 0.55908
[[52  5]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.54it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.44120, roc_auc: 0.58305
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.29it/s]
Epoch 46 : Training Loss: 0.00013, LR: 0.00000, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.18it/s]
val Evaluation: acc: 0.46349, pr_auc: 0.53969, roc_auc: 0.55986
[[52  5]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.66it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.44062, roc_auc: 0.58084
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.28it/s]
Epoch 47 : Training Loss: 0.00010, LR: 0.00000, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.80it/s]
val Evaluation: acc: 0.46349, pr_auc: 0.54048, roc_auc: 0.55805
[[52  5]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.33it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.44299, roc_auc: 0.58477
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.04it/s]
Epoch 48 : Training Loss: 0.00015, LR: 0.00000, Time elapsed 0.07 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 13.74it/s]
val Evaluation: acc: 0.46349, pr_auc: 0.53951, roc_auc: 0.55753
[[52  5]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.65it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.44311, roc_auc: 0.58550
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.28it/s]
Epoch 49 : Training Loss: 0.00090, LR: 0.00000, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 13.97it/s]
val Evaluation: acc: 0.46349, pr_auc: 0.53749, roc_auc: 0.55676
[[52  5]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 17.24it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.44342, roc_auc: 0.58600
[[57 17]
 [41 14]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 16/16 [00:03<00:00,  4.39it/s]
Epoch 50 : Training Loss: 0.00370, LR: 0.00000, Time elapsed 0.06 mins
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:00<00:00, 14.02it/s]
val Evaluation: acc: 0.46349, pr_auc: 0.53624, roc_auc: 0.55547
[[52  5]
 [67  1]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.38it/s]
test Evaluation: acc: 0.51241, pr_auc: 0.44360, roc_auc: 0.58649
[[57 17]
 [41 14]]
***************************Test************************
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 5/5 [00:00<00:00, 16.61it/s]
***************************Test results************************
Test Evaluation: acc: 0.51241, pr_auc: 0.40147, roc_auc: 0.50934
[[57 17]
 [41 14]]
model save in ./data/wjq/models_weights/Big/BigFaced/epoch50_acc_0.51241_pr_0.40147_roc_0.50934.pth
