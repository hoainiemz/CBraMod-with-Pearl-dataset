100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.16it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.14it/s]
Epoch 1 : Training Loss: 1.61214, acc: 0.24133, kappa: 0.05167, f1: 0.19980, LR: 0.00001, Time elapsed 0.30 mins
[[42  3  2 41 62]
 [39 10  1 36 64]
 [26  7  2 41 74]
 [32  4  2 52 60]
 [31  3  1 40 75]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24133, kappa: 0.05167, f1: 0.19980
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.54it/s]
Epoch 2 : Training Loss: 1.59833, acc: 0.24000, kappa: 0.05000, f1: 0.23254, LR: 0.00001, Time elapsed 0.33 mins
[[39 24 18 31 38]
 [41 25 16 29 39]
 [29 17 21 34 49]
 [34 23 13 37 43]
 [31 16 15 30 58]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:20<00:00,  3.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.16it/s]
Epoch 3 : Training Loss: 1.58488, acc: 0.25333, kappa: 0.06667, f1: 0.24947, LR: 0.00001, Time elapsed 0.35 mins
[[37 33 11 49 20]
 [38 33 10 42 27]
 [24 26 23 43 34]
 [23 37  9 56 25]
 [21 27  8 53 41]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25333, kappa: 0.06667, f1: 0.24947
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.45it/s]
Epoch 4 : Training Loss: 1.57216, acc: 0.25200, kappa: 0.06500, f1: 0.24798, LR: 0.00001, Time elapsed 0.31 mins
[[57 16 27 30 20]
 [50 27 29 19 25]
 [39 18 34 26 33]
 [48 19 27 31 25]
 [40 16 24 30 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.13it/s]
Epoch 5 : Training Loss: 1.56040, acc: 0.27333, kappa: 0.09167, f1: 0.26599, LR: 0.00001, Time elapsed 0.34 mins
[[33 33 10 55 19]
 [24 47 11 37 31]
 [11 31 20 42 46]
 [18 35 16 58 23]
 [15 35 11 42 47]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27333, kappa: 0.09167, f1: 0.26599
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.27it/s]
Epoch 6 : Training Loss: 1.54353, acc: 0.27333, kappa: 0.09167, f1: 0.26244, LR: 0.00001, Time elapsed 0.32 mins
[[44 17 13 42 34]
 [41 31 12 21 45]
 [27 17 19 31 56]
 [27 19 15 43 46]
 [28 21  6 27 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.26it/s]
Epoch 7 : Training Loss: 1.53593, acc: 0.25600, kappa: 0.07000, f1: 0.25332, LR: 0.00001, Time elapsed 0.31 mins
[[31 22 26 41 30]
 [28 31 29 22 40]
 [19 16 37 33 45]
 [21 23 30 38 38]
 [17 20 19 39 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.13it/s]
Epoch 8 : Training Loss: 1.52093, acc: 0.25200, kappa: 0.06500, f1: 0.24426, LR: 0.00001, Time elapsed 0.33 mins
[[53 17  9 49 22]
 [55 24  9 36 26]
 [41 17 20 38 34]
 [34 26 16 46 28]
 [39 17 11 37 46]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.26it/s]
Epoch 9 : Training Loss: 1.49723, acc: 0.26000, kappa: 0.07500, f1: 0.25854, LR: 0.00001, Time elapsed 0.34 mins
[[39 24 21 46 20]
 [35 30 18 37 30]
 [30 19 35 32 34]
 [28 22 27 49 24]
 [28 18 24 38 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.46it/s]
Epoch 10 : Training Loss: 1.47685, acc: 0.24933, kappa: 0.06167, f1: 0.23104, LR: 0.00001, Time elapsed 0.33 mins
[[40 21  8 39 42]
 [42 24  4 36 44]
 [28 19 11 33 59]
 [27 24 10 43 46]
 [23 14  6 38 69]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.65it/s]
Epoch 11 : Training Loss: 1.45731, acc: 0.25333, kappa: 0.06667, f1: 0.24825, LR: 0.00001, Time elapsed 0.34 mins
[[46 17 11 34 42]
 [45 27 12 21 45]
 [35 15 29 22 49]
 [34 18 21 30 47]
 [39 16 15 22 58]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.94it/s]
Epoch 12 : Training Loss: 1.43602, acc: 0.24933, kappa: 0.06167, f1: 0.24294, LR: 0.00001, Time elapsed 0.33 mins
[[52 29 14 26 29]
 [47 38 11 19 35]
 [39 24 20 25 42]
 [30 35 19 30 36]
 [38 26 14 25 47]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.51it/s]
Epoch 13 : Training Loss: 1.41267, acc: 0.24933, kappa: 0.06167, f1: 0.24027, LR: 0.00001, Time elapsed 0.33 mins
[[47 12 27 26 38]
 [50 17 27 15 41]
 [34 11 35 21 49]
 [36 10 26 31 47]
 [33  6 25 29 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.07it/s]
Epoch 14 : Training Loss: 1.39492, acc: 0.24933, kappa: 0.06167, f1: 0.23968, LR: 0.00001, Time elapsed 0.33 mins
[[46 20  8 35 41]
 [44 25  7 29 45]
 [31 19 17 29 54]
 [26 26 11 45 42]
 [30 16 12 38 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.84it/s]
Epoch 15 : Training Loss: 1.37260, acc: 0.23467, kappa: 0.04333, f1: 0.22509, LR: 0.00001, Time elapsed 0.33 mins
[[44 21 12 27 46]
 [55 27  9 13 46]
 [36 19 19 17 59]
 [33 27 13 26 51]
 [40 16 12 22 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.23it/s]
Epoch 16 : Training Loss: 1.34500, acc: 0.25333, kappa: 0.06667, f1: 0.24534, LR: 0.00001, Time elapsed 0.34 mins
[[53 15 11 37 34]
 [52 25 13 27 33]
 [42 14 20 34 40]
 [36 15 16 47 36]
 [40 14 13 38 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.60it/s]
Epoch 17 : Training Loss: 1.32922, acc: 0.24267, kappa: 0.05333, f1: 0.23429, LR: 0.00001, Time elapsed 0.33 mins
[[29 14 22 26 59]
 [41 24 23 16 46]
 [25 16 31 18 60]
 [23 20 24 31 52]
 [22 13 17 31 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.00it/s]
Epoch 18 : Training Loss: 1.30644, acc: 0.24000, kappa: 0.05000, f1: 0.23393, LR: 0.00001, Time elapsed 0.33 mins
[[44 25 14 27 40]
 [50 31 13 19 37]
 [37 22 23 20 48]
 [30 31 21 27 41]
 [36 22 12 25 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.35it/s]
Epoch 19 : Training Loss: 1.29177, acc: 0.23467, kappa: 0.04333, f1: 0.22689, LR: 0.00000, Time elapsed 0.34 mins
[[26 22 19 35 48]
 [36 27 17 26 44]
 [22 22 23 30 53]
 [18 28 18 40 46]
 [21 19 13 37 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.55it/s]
Epoch 20 : Training Loss: 1.27761, acc: 0.24400, kappa: 0.05500, f1: 0.23890, LR: 0.00000, Time elapsed 0.33 mins
[[42 17 17 33 41]
 [49 28 14 19 40]
 [39 16 24 20 51]
 [32 21 17 33 47]
 [34 17 12 31 56]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.47it/s]
Epoch 21 : Training Loss: 1.25551, acc: 0.25333, kappa: 0.06667, f1: 0.24969, LR: 0.00000, Time elapsed 0.32 mins
[[43 17 18 35 37]
 [47 26 15 23 39]
 [37 14 28 26 45]
 [30 21 17 42 40]
 [34 13 16 36 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.20it/s]
Epoch 22 : Training Loss: 1.23073, acc: 0.25067, kappa: 0.06333, f1: 0.24812, LR: 0.00000, Time elapsed 0.34 mins
[[48 22 15 35 30]
 [53 29 14 22 32]
 [45 18 27 25 35]
 [42 24 16 37 31]
 [39 18 15 31 47]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.44it/s]
Epoch 23 : Training Loss: 1.21695, acc: 0.23867, kappa: 0.04833, f1: 0.23344, LR: 0.00000, Time elapsed 0.32 mins
[[39 23 16 33 39]
 [46 28 13 19 44]
 [37 17 22 22 52]
 [33 23 16 35 43]
 [35 17 13 30 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.65it/s]
Epoch 24 : Training Loss: 1.20822, acc: 0.24267, kappa: 0.05333, f1: 0.23948, LR: 0.00000, Time elapsed 0.33 mins
[[40 19 22 30 39]
 [47 27 20 14 42]
 [34 17 34 17 48]
 [32 22 22 28 46]
 [35 17 19 26 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.46it/s]
Epoch 25 : Training Loss: 1.19244, acc: 0.23867, kappa: 0.04833, f1: 0.23569, LR: 0.00000, Time elapsed 0.33 mins
[[41 22 17 31 39]
 [52 26 15 16 41]
 [36 15 31 17 51]
 [38 21 16 28 47]
 [38 16 16 27 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.98it/s]
Epoch 26 : Training Loss: 1.18119, acc: 0.23867, kappa: 0.04833, f1: 0.23137, LR: 0.00000, Time elapsed 0.31 mins
[[33 19 19 29 50]
 [41 28 13 15 53]
 [31 15 25 17 62]
 [33 20 17 28 52]
 [32 15 15 23 65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.65it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.22it/s]
Epoch 27 : Training Loss: 1.16720, acc: 0.24133, kappa: 0.05167, f1: 0.23565, LR: 0.00000, Time elapsed 0.34 mins
[[47 19 15 31 38]
 [56 27 13 15 39]
 [39 17 24 20 50]
 [41 19 16 29 45]
 [42 16 13 25 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.26it/s]
Epoch 28 : Training Loss: 1.14816, acc: 0.24533, kappa: 0.05667, f1: 0.24425, LR: 0.00000, Time elapsed 0.32 mins
[[38 22 21 31 38]
 [49 28 17 21 35]
 [35 16 31 24 44]
 [32 22 18 39 39]
 [36 18 15 33 48]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.74it/s]
Epoch 29 : Training Loss: 1.13476, acc: 0.24133, kappa: 0.05167, f1: 0.23827, LR: 0.00000, Time elapsed 0.34 mins
[[42 24 15 31 38]
 [50 31 12 17 40]
 [41 17 26 20 46]
 [39 23 14 29 45]
 [38 19 11 29 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.02it/s]
Epoch 30 : Training Loss: 1.13045, acc: 0.24667, kappa: 0.05833, f1: 0.24425, LR: 0.00000, Time elapsed 0.34 mins
[[38 25 18 32 37]
 [43 35 13 19 40]
 [35 17 26 25 47]
 [35 24 16 33 42]
 [35 21 12 29 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.50it/s]
Epoch 31 : Training Loss: 1.10404, acc: 0.25200, kappa: 0.06500, f1: 0.24792, LR: 0.00000, Time elapsed 0.34 mins
[[42 23 15 33 37]
 [44 33 11 24 38]
 [36 15 23 28 48]
 [35 23 14 37 41]
 [36 19 12 29 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.75it/s]
Epoch 32 : Training Loss: 1.09749, acc: 0.24933, kappa: 0.06167, f1: 0.24817, LR: 0.00000, Time elapsed 0.34 mins
[[36 25 18 32 39]
 [40 35 15 24 36]
 [33 17 29 25 46]
 [30 27 18 37 38]
 [32 22 14 32 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.61it/s]
Epoch 33 : Training Loss: 1.08718, acc: 0.24933, kappa: 0.06167, f1: 0.24834, LR: 0.00000, Time elapsed 0.32 mins
[[42 23 21 28 36]
 [49 35 15 19 32]
 [37 16 32 21 44]
 [42 25 22 29 32]
 [38 20 19 24 49]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.21it/s]
Epoch 34 : Training Loss: 1.08264, acc: 0.25200, kappa: 0.06500, f1: 0.24917, LR: 0.00000, Time elapsed 0.34 mins
[[36 26 17 31 40]
 [40 38  9 21 42]
 [33 18 26 24 49]
 [28 32 18 35 37]
 [30 23 14 29 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.65it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.31it/s]
Epoch 35 : Training Loss: 1.06570, acc: 0.25200, kappa: 0.06500, f1: 0.25121, LR: 0.00000, Time elapsed 0.34 mins
[[41 23 22 28 36]
 [45 36 18 19 32]
 [37 15 33 21 44]
 [34 27 24 31 34]
 [34 20 22 26 48]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.75it/s]
Epoch 36 : Training Loss: 1.06080, acc: 0.25067, kappa: 0.06333, f1: 0.24642, LR: 0.00000, Time elapsed 0.31 mins
[[43 18 20 31 38]
 [47 28 15 21 39]
 [38 15 29 20 48]
 [39 19 21 31 40]
 [36 15 15 27 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.02it/s]
Epoch 37 : Training Loss: 1.04777, acc: 0.25333, kappa: 0.06667, f1: 0.25185, LR: 0.00000, Time elapsed 0.22 mins
[[38 21 20 34 37]
 [39 31 20 26 34]
 [34 15 32 26 43]
 [29 23 22 39 37]
 [29 20 17 34 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.24it/s]
Epoch 38 : Training Loss: 1.05113, acc: 0.25733, kappa: 0.07167, f1: 0.25556, LR: 0.00000, Time elapsed 0.31 mins
[[47 18 21 30 34]
 [51 31 17 21 30]
 [40 14 32 22 42]
 [43 19 23 33 32]
 [37 17 19 27 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.21it/s]
Epoch 39 : Training Loss: 1.03731, acc: 0.25733, kappa: 0.07167, f1: 0.25531, LR: 0.00000, Time elapsed 0.35 mins
[[38 26 21 27 38]
 [40 38 18 21 33]
 [35 16 32 21 46]
 [30 27 24 31 38]
 [30 21 19 26 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.34it/s]
Epoch 40 : Training Loss: 1.02891, acc: 0.25200, kappa: 0.06500, f1: 0.25110, LR: 0.00000, Time elapsed 0.34 mins
[[39 23 18 33 37]
 [45 32 14 25 34]
 [38 14 30 27 41]
 [37 22 20 38 33]
 [35 18 17 30 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.45it/s]
Epoch 41 : Training Loss: 1.02687, acc: 0.25733, kappa: 0.07167, f1: 0.25613, LR: 0.00000, Time elapsed 0.34 mins
[[42 22 19 30 37]
 [46 32 16 23 33]
 [38 14 32 22 44]
 [37 23 20 36 34]
 [34 20 17 28 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.43it/s]
Epoch 42 : Training Loss: 1.02327, acc: 0.26000, kappa: 0.07500, f1: 0.25776, LR: 0.00000, Time elapsed 0.34 mins
[[44 19 16 32 39]
 [47 31 15 23 34]
 [40 15 28 26 41]
 [39 22 16 40 33]
 [38 17 15 28 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.92it/s]
Epoch 43 : Training Loss: 1.01605, acc: 0.26133, kappa: 0.07667, f1: 0.25996, LR: 0.00000, Time elapsed 0.33 mins
[[45 20 18 29 38]
 [49 32 15 22 32]
 [40 14 31 24 41]
 [38 21 19 37 35]
 [37 17 17 28 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.00it/s]
Epoch 44 : Training Loss: 1.01694, acc: 0.25733, kappa: 0.07167, f1: 0.25621, LR: 0.00000, Time elapsed 0.31 mins
[[43 23 20 29 35]
 [47 33 17 23 30]
 [40 15 30 26 39]
 [36 24 20 39 31]
 [34 19 18 31 48]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.24it/s]
Epoch 45 : Training Loss: 1.01665, acc: 0.25467, kappa: 0.06833, f1: 0.25233, LR: 0.00000, Time elapsed 0.33 mins
[[39 26 17 28 40]
 [45 37 14 18 36]
 [37 15 30 21 47]
 [33 25 21 30 41]
 [30 22 16 27 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.45it/s]
Epoch 46 : Training Loss: 1.00689, acc: 0.25733, kappa: 0.07167, f1: 0.25573, LR: 0.00000, Time elapsed 0.33 mins
[[37 26 17 30 40]
 [43 33 15 24 35]
 [35 14 33 23 45]
 [32 23 21 35 39]
 [29 21 17 28 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.78it/s]
Epoch 47 : Training Loss: 1.00427, acc: 0.25200, kappa: 0.06500, f1: 0.25091, LR: 0.00000, Time elapsed 0.33 mins
[[37 26 18 30 39]
 [45 34 15 21 35]
 [36 14 32 24 44]
 [32 26 20 34 38]
 [30 21 19 28 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.01it/s]
Epoch 48 : Training Loss: 1.01182, acc: 0.25867, kappa: 0.07333, f1: 0.25735, LR: 0.00000, Time elapsed 0.34 mins
[[45 22 19 29 35]
 [49 33 17 21 30]
 [38 14 32 24 42]
 [38 23 22 34 33]
 [37 17 19 27 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.12it/s]
Epoch 49 : Training Loss: 1.00345, acc: 0.25467, kappa: 0.06833, f1: 0.25368, LR: 0.00000, Time elapsed 0.33 mins
[[38 25 18 30 39]
 [44 36 16 21 33]
 [36 15 31 24 44]
 [32 25 21 35 37]
 [30 21 20 28 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.12it/s]
Epoch 50 : Training Loss: 1.00346, acc: 0.24933, kappa: 0.06167, f1: 0.24798, LR: 0.00000, Time elapsed 0.33 mins
[[37 25 18 30 40]
 [41 33 14 25 37]
 [36 14 31 24 45]
 [32 24 20 34 40]
 [31 21 18 28 52]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.45it/s]
***************************Test results************************
Test Evaluation: acc: 0.28133, kappa: 0.10167, f1: 0.27486
[[28 30 13 41 38]
 [22 42 12 42 32]
 [20 27 29 34 40]
 [15 37 11 64 23]
 [16 26 19 41 48]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch5_acc_0.28133_kappa_0.10167_f1_0.27486.pth
[32m[I 2025-08-29 01:46:14,624][0m Trial 4 finished with value: 0.10166666666666668 and parameters: {'lr': 6.624310605949985e-06, 'weight_decay': 0.00029229052129200957, '--dropout': 0.08638900372842316, '--clip_value': 0.9368437102970628}. Best is trial 3 with value: 0.3583333333333333.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=4.480975918214949e-05, weight_decay=4.523529917658779e-06, optimizer='AdamW', clip_value=1.0495427649405376, dropout=0.058428929707043636, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.058428929707043636, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.058428929707043636, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
