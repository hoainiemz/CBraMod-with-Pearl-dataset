100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.60it/s]
Epoch 1 : Training Loss: 1.61073, acc: 0.20400, kappa: 0.00500, f1: 0.13038, LR: 0.00000, Time elapsed 0.21 mins
[[117   5  18   9   1]
 [108   3  23  15   1]
 [118   0  15  15   2]
 [115   3  14  18   0]
 [130   1  13   6   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20400, kappa: 0.00500, f1: 0.13038
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.18it/s]
Epoch 2 : Training Loss: 1.60765, acc: 0.21200, kappa: 0.01500, f1: 0.15530, LR: 0.00000, Time elapsed 0.21 mins
[[105   8  16  21   0]
 [109   9  19  13   0]
 [105   3  18  24   0]
 [104   4  15  27   0]
 [119   3  10  18   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21200, kappa: 0.01500, f1: 0.15530
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
Epoch 3 : Training Loss: 1.60478, acc: 0.21467, kappa: 0.01833, f1: 0.16182, LR: 0.00000, Time elapsed 0.22 mins
[[ 93   6  24  24   3]
 [109   1  23  14   3]
 [ 91   1  29  27   2]
 [ 90   2  17  36   5]
 [ 98   1  20  29   2]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21467, kappa: 0.01833, f1: 0.16182
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.91it/s]
Epoch 4 : Training Loss: 1.60266, acc: 0.21733, kappa: 0.02167, f1: 0.18114, LR: 0.00000, Time elapsed 0.21 mins
[[32 10 75 23 10]
 [35  8 77 19 11]
 [29  2 85 26  8]
 [36  3 73 31  7]
 [30  4 79 30  7]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21733, kappa: 0.02167, f1: 0.18114
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.06it/s]
Epoch 5 : Training Loss: 1.60014, acc: 0.24000, kappa: 0.05000, f1: 0.22633, LR: 0.00000, Time elapsed 0.21 mins
[[53 10 45 23 19]
 [50 13 44 20 23]
 [35  5 56 29 25]
 [48  7 41 32 22]
 [47  5 47 25 26]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24000, kappa: 0.05000, f1: 0.22633
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.02it/s]
Epoch 6 : Training Loss: 1.59812, acc: 0.22933, kappa: 0.03667, f1: 0.20198, LR: 0.00000, Time elapsed 0.21 mins
[[72 11 26 34  7]
 [75  9 32 26  8]
 [59  8 44 30  9]
 [67  9 28 37  9]
 [68  5 32 35 10]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.85it/s]
Epoch 7 : Training Loss: 1.59540, acc: 0.24267, kappa: 0.05333, f1: 0.23584, LR: 0.00000, Time elapsed 0.21 mins
[[41 35 34 33  7]
 [39 44 39 19  9]
 [35 26 46 28 15]
 [41 30 34 36  9]
 [39 20 40 36 15]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24267, kappa: 0.05333, f1: 0.23584
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.78it/s]
Epoch 8 : Training Loss: 1.59098, acc: 0.25333, kappa: 0.06667, f1: 0.24905, LR: 0.00000, Time elapsed 0.22 mins
[[21 36 38 32 23]
 [15 47 42 22 24]
 [12 24 47 38 29]
 [13 31 40 41 25]
 [10 26 41 39 34]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25333, kappa: 0.06667, f1: 0.24905
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.11it/s]
Epoch 9 : Training Loss: 1.58901, acc: 0.25333, kappa: 0.06667, f1: 0.25177, LR: 0.00000, Time elapsed 0.21 mins
[[35 39 35 26 15]
 [36 47 38 14 15]
 [29 20 46 29 26]
 [33 30 36 33 18]
 [30 27 38 26 29]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.70it/s]
Epoch 10 : Training Loss: 1.58537, acc: 0.24533, kappa: 0.05667, f1: 0.23839, LR: 0.00000, Time elapsed 0.21 mins
[[37 30 47 22 14]
 [30 40 55 11 14]
 [22 18 60 26 24]
 [30 25 52 26 17]
 [32 21 54 22 21]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 11 : Training Loss: 1.58125, acc: 0.29200, kappa: 0.11500, f1: 0.28642, LR: 0.00000, Time elapsed 0.21 mins
[[27 44 29 33 17]
 [17 66 26 19 22]
 [11 35 41 31 32]
 [18 45 23 43 21]
 [13 42 21 32 42]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.29200, kappa: 0.11500, f1: 0.28642
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.99it/s]
Epoch 12 : Training Loss: 1.57911, acc: 0.26933, kappa: 0.08667, f1: 0.26823, LR: 0.00000, Time elapsed 0.21 mins
[[43 33 19 40 15]
 [45 44 24 23 14]
 [34 21 36 35 24]
 [40 28 20 50 12]
 [37 25 18 41 29]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.43it/s]
Epoch 13 : Training Loss: 1.57485, acc: 0.27733, kappa: 0.09667, f1: 0.27560, LR: 0.00000, Time elapsed 0.21 mins
[[40 34 18 40 18]
 [30 51 23 25 21]
 [27 21 33 38 31]
 [33 33 19 49 16]
 [27 32 16 40 35]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.59it/s]
Epoch 14 : Training Loss: 1.57206, acc: 0.27600, kappa: 0.09500, f1: 0.27265, LR: 0.00000, Time elapsed 0.22 mins
[[34 41 24 37 14]
 [26 59 30 20 15]
 [25 32 42 28 23]
 [27 42 33 42  6]
 [24 41 21 34 30]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.76it/s]
Epoch 15 : Training Loss: 1.56705, acc: 0.28267, kappa: 0.10333, f1: 0.28054, LR: 0.00000, Time elapsed 0.21 mins
[[36 33 21 46 14]
 [25 53 24 32 16]
 [23 26 35 43 23]
 [29 32 24 54 11]
 [23 30 16 47 34]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.92it/s]
Epoch 16 : Training Loss: 1.56765, acc: 0.25733, kappa: 0.07167, f1: 0.25680, LR: 0.00000, Time elapsed 0.21 mins
[[44 32 20 39 15]
 [40 43 23 24 20]
 [38 22 31 30 29]
 [39 31 25 41 14]
 [31 30 15 40 34]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.95it/s]
Epoch 17 : Training Loss: 1.56233, acc: 0.26800, kappa: 0.08500, f1: 0.26549, LR: 0.00000, Time elapsed 0.21 mins
[[29 39 28 34 20]
 [22 54 30 20 24]
 [21 31 40 21 37]
 [22 40 30 38 20]
 [19 36 21 34 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.86it/s]
Epoch 18 : Training Loss: 1.55791, acc: 0.26933, kappa: 0.08667, f1: 0.26898, LR: 0.00000, Time elapsed 0.22 mins
[[39 33 24 39 15]
 [32 46 33 21 18]
 [30 26 42 27 25]
 [33 30 33 42 12]
 [24 30 23 40 33]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.79it/s]
Epoch 19 : Training Loss: 1.55436, acc: 0.26133, kappa: 0.07667, f1: 0.25947, LR: 0.00000, Time elapsed 0.21 mins
[[44 37 21 28 20]
 [37 48 15 22 28]
 [35 31 31 18 35]
 [40 35 22 30 23]
 [29 35 16 27 43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.46it/s]
Epoch 20 : Training Loss: 1.55461, acc: 0.27067, kappa: 0.08833, f1: 0.26514, LR: 0.00000, Time elapsed 0.21 mins
[[32 38 12 56 12]
 [29 51 15 39 16]
 [27 24 27 50 22]
 [31 32 16 62  9]
 [21 32 11 55 31]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.36it/s]
Epoch 21 : Training Loss: 1.55292, acc: 0.26667, kappa: 0.08333, f1: 0.26162, LR: 0.00000, Time elapsed 0.21 mins
[[38 40 19 44  9]
 [35 56 20 32  7]
 [34 33 38 28 17]
 [38 38 23 47  4]
 [32 37 19 41 21]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.91it/s]
Epoch 22 : Training Loss: 1.54904, acc: 0.27067, kappa: 0.08833, f1: 0.26643, LR: 0.00000, Time elapsed 0.21 mins
[[32 40 13 54 11]
 [28 53 15 40 14]
 [21 32 29 48 20]
 [27 36 23 58  6]
 [17 35 13 54 31]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.95it/s]
Epoch 23 : Training Loss: 1.54672, acc: 0.27600, kappa: 0.09500, f1: 0.27392, LR: 0.00000, Time elapsed 0.21 mins
[[32 38 17 48 15]
 [27 52 21 30 20]
 [26 27 36 35 26]
 [28 33 28 52  9]
 [19 34 16 46 35]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.45it/s]
Epoch 24 : Training Loss: 1.54593, acc: 0.26533, kappa: 0.08167, f1: 0.26474, LR: 0.00000, Time elapsed 0.21 mins
[[39 36 17 45 13]
 [31 49 20 30 20]
 [33 27 38 27 25]
 [40 32 28 43  7]
 [29 33 19 39 30]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.07it/s]
Epoch 25 : Training Loss: 1.54534, acc: 0.26267, kappa: 0.07833, f1: 0.26287, LR: 0.00000, Time elapsed 0.21 mins
[[39 34 18 37 22]
 [34 45 17 24 30]
 [32 29 38 19 32]
 [39 29 28 32 22]
 [27 33 18 29 43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.53it/s]
Epoch 26 : Training Loss: 1.54080, acc: 0.26667, kappa: 0.08333, f1: 0.26748, LR: 0.00000, Time elapsed 0.21 mins
[[38 35 15 43 19]
 [33 47 17 26 27]
 [33 26 36 27 28]
 [39 30 27 40 14]
 [24 34 14 39 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.82it/s]
Epoch 27 : Training Loss: 1.53920, acc: 0.26133, kappa: 0.07667, f1: 0.25917, LR: 0.00000, Time elapsed 0.21 mins
[[39 39 15 46 11]
 [30 56 20 28 16]
 [34 34 35 23 24]
 [42 39 25 38  6]
 [31 36 19 36 28]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.62it/s]
Epoch 28 : Training Loss: 1.53764, acc: 0.25733, kappa: 0.07167, f1: 0.25697, LR: 0.00000, Time elapsed 0.21 mins
[[42 32 14 49 13]
 [37 46 16 30 21]
 [43 24 29 28 26]
 [44 35 20 43  8]
 [30 33 14 40 33]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.21it/s]
Epoch 29 : Training Loss: 1.53465, acc: 0.26800, kappa: 0.08500, f1: 0.26740, LR: 0.00000, Time elapsed 0.21 mins
[[41 27 17 50 15]
 [33 45 13 37 22]
 [33 22 32 34 29]
 [39 28 22 50 11]
 [24 28 14 51 33]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.01it/s]
Epoch 30 : Training Loss: 1.52958, acc: 0.26267, kappa: 0.07833, f1: 0.26015, LR: 0.00000, Time elapsed 0.22 mins
[[36 35 15 48 16]
 [31 50 14 34 21]
 [30 31 29 28 32]
 [33 36 20 49 12]
 [23 36 14 44 33]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.82it/s]
Epoch 31 : Training Loss: 1.53104, acc: 0.26800, kappa: 0.08500, f1: 0.26789, LR: 0.00000, Time elapsed 0.21 mins
[[39 26 19 45 21]
 [34 44 17 27 28]
 [35 22 32 25 36]
 [36 29 24 42 19]
 [24 31 15 36 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 32 : Training Loss: 1.52965, acc: 0.26933, kappa: 0.08667, f1: 0.26850, LR: 0.00000, Time elapsed 0.21 mins
[[38 29 17 49 17]
 [32 46 12 32 28]
 [34 24 30 28 34]
 [36 29 21 47 17]
 [20 33 15 41 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.26it/s]
Epoch 33 : Training Loss: 1.52612, acc: 0.26800, kappa: 0.08500, f1: 0.26631, LR: 0.00000, Time elapsed 0.21 mins
[[38 31 17 51 13]
 [31 50 16 35 18]
 [31 30 33 29 27]
 [34 34 22 49 11]
 [22 33 17 47 31]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.89it/s]
Epoch 34 : Training Loss: 1.52664, acc: 0.26933, kappa: 0.08667, f1: 0.26987, LR: 0.00000, Time elapsed 0.21 mins
[[38 27 20 45 20]
 [33 43 20 30 24]
 [35 21 36 27 31]
 [36 28 24 44 18]
 [22 30 20 37 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.97it/s]
Epoch 35 : Training Loss: 1.52389, acc: 0.26800, kappa: 0.08500, f1: 0.26878, LR: 0.00000, Time elapsed 0.21 mins
[[36 27 22 46 19]
 [31 45 24 27 23]
 [33 24 37 26 30]
 [36 30 26 40 18]
 [22 32 18 35 43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.86it/s]
Epoch 36 : Training Loss: 1.52203, acc: 0.26267, kappa: 0.07833, f1: 0.26222, LR: 0.00000, Time elapsed 0.21 mins
[[37 29 17 48 19]
 [34 45 16 31 24]
 [35 27 31 27 30]
 [36 30 21 46 17]
 [23 32 16 41 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.18it/s]
Epoch 37 : Training Loss: 1.52012, acc: 0.26800, kappa: 0.08500, f1: 0.26605, LR: 0.00000, Time elapsed 0.21 mins
[[38 30 17 51 14]
 [32 45 14 39 20]
 [37 26 30 29 28]
 [35 30 20 54 11]
 [22 30 15 49 34]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.39it/s]
Epoch 38 : Training Loss: 1.51740, acc: 0.26800, kappa: 0.08500, f1: 0.26790, LR: 0.00000, Time elapsed 0.21 mins
[[43 23 19 47 18]
 [40 38 15 32 25]
 [39 20 33 28 30]
 [40 23 21 48 18]
 [25 27 18 41 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.02it/s]
Epoch 39 : Training Loss: 1.51651, acc: 0.26667, kappa: 0.08333, f1: 0.26561, LR: 0.00000, Time elapsed 0.21 mins
[[36 30 17 51 16]
 [32 46 15 33 24]
 [37 26 30 27 30]
 [34 28 23 49 16]
 [23 33 17 38 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.98it/s]
Epoch 40 : Training Loss: 1.51515, acc: 0.26400, kappa: 0.08000, f1: 0.26470, LR: 0.00000, Time elapsed 0.21 mins
[[39 24 23 45 19]
 [32 40 29 26 23]
 [37 22 38 24 29]
 [36 24 29 41 20]
 [23 29 21 37 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.79it/s]
Epoch 41 : Training Loss: 1.51056, acc: 0.26667, kappa: 0.08333, f1: 0.26660, LR: 0.00000, Time elapsed 0.21 mins
[[41 25 20 47 17]
 [35 43 17 30 25]
 [40 22 32 26 30]
 [38 24 24 45 19]
 [24 32 18 37 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.88it/s]
Epoch 42 : Training Loss: 1.51025, acc: 0.26000, kappa: 0.07500, f1: 0.25968, LR: 0.00000, Time elapsed 0.21 mins
[[45 21 22 43 19]
 [38 34 27 23 28]
 [42 20 34 23 31]
 [39 22 25 40 24]
 [31 25 20 32 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.68it/s]
Epoch 43 : Training Loss: 1.50930, acc: 0.26000, kappa: 0.07500, f1: 0.25984, LR: 0.00000, Time elapsed 0.21 mins
[[38 26 21 45 20]
 [33 43 15 31 28]
 [38 24 31 27 30]
 [36 25 22 44 23]
 [26 30 17 38 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.55it/s]
Epoch 44 : Training Loss: 1.51013, acc: 0.26667, kappa: 0.08333, f1: 0.26553, LR: 0.00000, Time elapsed 0.21 mins
[[37 27 20 48 18]
 [32 44 16 34 24]
 [39 24 31 27 29]
 [35 27 23 51 14]
 [24 31 18 40 37]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.90it/s]
Epoch 45 : Training Loss: 1.50751, acc: 0.26533, kappa: 0.08167, f1: 0.26500, LR: 0.00000, Time elapsed 0.21 mins
[[41 25 21 43 20]
 [34 42 18 28 28]
 [38 24 32 24 32]
 [36 26 22 44 22]
 [26 32 17 35 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.03it/s]
Epoch 46 : Training Loss: 1.50635, acc: 0.25733, kappa: 0.07167, f1: 0.25710, LR: 0.00000, Time elapsed 0.21 mins
[[37 27 21 45 20]
 [31 40 23 29 27]
 [36 24 33 25 32]
 [33 26 24 44 23]
 [23 31 19 38 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.95it/s]
Epoch 47 : Training Loss: 1.50231, acc: 0.25600, kappa: 0.07000, f1: 0.25581, LR: 0.00000, Time elapsed 0.21 mins
[[37 27 21 45 20]
 [33 41 20 29 27]
 [38 25 31 24 32]
 [34 26 24 42 24]
 [24 31 17 37 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.88it/s]
Epoch 48 : Training Loss: 1.50348, acc: 0.26133, kappa: 0.07667, f1: 0.26064, LR: 0.00000, Time elapsed 0.21 mins
[[42 20 22 46 20]
 [33 36 24 29 28]
 [38 22 32 22 36]
 [33 23 25 44 25]
 [23 28 20 37 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.03it/s]
Epoch 49 : Training Loss: 1.50202, acc: 0.26400, kappa: 0.08000, f1: 0.26329, LR: 0.00000, Time elapsed 0.21 mins
[[42 23 21 45 19]
 [33 40 20 30 27]
 [40 24 31 22 33]
 [33 25 23 45 24]
 [27 30 18 35 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.70it/s]
Epoch 50 : Training Loss: 1.49757, acc: 0.26400, kappa: 0.08000, f1: 0.26242, LR: 0.00000, Time elapsed 0.22 mins
[[41 24 20 47 18]
 [33 39 19 32 27]
 [38 24 29 25 34]
 [32 25 23 49 21]
 [22 30 19 39 40]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.29it/s]
***************************Test results************************
Test Evaluation: acc: 0.28933, kappa: 0.11167, f1: 0.28393
[[23 36 27 28 36]
 [17 56 24 32 21]
 [12 40 41 28 29]
 [11 45 16 50 28]
 [13 34 20 36 47]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch11_acc_0.28933_kappa_0.11167_f1_0.28393.pth
[32m[I 2025-08-29 20:24:21,141][0m Trial 60 finished with value: 0.11166666666666669 and parameters: {'lr': 1.1564377446595138e-06, 'weight_decay': 0.00011423127631579305, '--dropout': 0.1594835198483876, '--clip_value': 1.703953026764187}. Best is trial 35 with value: 0.36.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.0002381447030558637, weight_decay=0.007590361534830006, optimizer='AdamW', clip_value=1.8060253276971128, dropout=0.19996766095352753, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.19996766095352753, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.19996766095352753, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
