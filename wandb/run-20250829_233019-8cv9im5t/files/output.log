100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.40it/s]
Epoch 1 : Training Loss: 1.74873, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00024, Time elapsed 0.22 mins
[[  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.43it/s]
Epoch 2 : Training Loss: 1.64339, acc: 0.22533, kappa: 0.03167, f1: 0.15560, LR: 0.00024, Time elapsed 0.21 mins
[[  0  14  29 107   0]
 [  0  23  24 103   0]
 [  0  10  37 103   0]
 [  0   5  36 109   0]
 [  0  12  28 110   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22533, kappa: 0.03167, f1: 0.15560
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.66it/s]
Epoch 3 : Training Loss: 1.63152, acc: 0.21467, kappa: 0.01833, f1: 0.11657, LR: 0.00024, Time elapsed 0.21 mins
[[121   0  29   0   0]
 [118   0  32   0   0]
 [110   0  40   0   0]
 [111   0  39   0   0]
 [124   0  26   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.52it/s]
Epoch 4 : Training Loss: 1.62332, acc: 0.23867, kappa: 0.04833, f1: 0.18830, LR: 0.00024, Time elapsed 0.22 mins
[[ 5 44 57 44  0]
 [ 6 55 51 38  0]
 [ 4 39 73 34  0]
 [ 5 36 63 46  0]
 [10 38 70 32  0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23867, kappa: 0.04833, f1: 0.18830
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.73it/s]
Epoch 5 : Training Loss: 1.61437, acc: 0.23733, kappa: 0.04667, f1: 0.18522, LR: 0.00024, Time elapsed 0.21 mins
[[31 86 23 10  0]
 [26 99 21  4  0]
 [30 76 37  7  0]
 [40 70 29 11  0]
 [40 80 24  6  0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.51it/s]
Epoch 6 : Training Loss: 1.59670, acc: 0.21333, kappa: 0.01667, f1: 0.14912, LR: 0.00024, Time elapsed 0.21 mins
[[118  12   6   2  12]
 [124  16   1   0   9]
 [108   4  17   0  21]
 [126   8   3   0  13]
 [127  11   3   0   9]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.34it/s]
Epoch 7 : Training Loss: 1.56732, acc: 0.26800, kappa: 0.08500, f1: 0.21192, LR: 0.00023, Time elapsed 0.22 mins
[[12 84 44  8  2]
 [ 9 95 38  3  5]
 [ 6 59 74  8  3]
 [18 60 51 14  7]
 [12 75 50  7  6]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26800, kappa: 0.08500, f1: 0.21192
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.66it/s]
Epoch 8 : Training Loss: 1.49303, acc: 0.33467, kappa: 0.16833, f1: 0.33291, LR: 0.00023, Time elapsed 0.21 mins
[[37 21 23 42 27]
 [30 46 19 43 12]
 [15  9 61 33 32]
 [21 18 28 64 19]
 [29 18 26 34 43]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.33467, kappa: 0.16833, f1: 0.33291
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
Epoch 9 : Training Loss: 1.36685, acc: 0.36800, kappa: 0.21000, f1: 0.36672, LR: 0.00023, Time elapsed 0.22 mins
[[51 20 18 36 25]
 [33 41 23 32 21]
 [27  9 74 14 26]
 [32 20 18 56 24]
 [22 25 23 26 54]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.36800, kappa: 0.21000, f1: 0.36672
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.39it/s]
Epoch 10 : Training Loss: 1.20588, acc: 0.36933, kappa: 0.21167, f1: 0.36806, LR: 0.00022, Time elapsed 0.21 mins
[[42 35 21 28 24]
 [19 68 19 25 19]
 [18 31 56 13 32]
 [21 35 20 59 15]
 [24 36 16 22 52]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.36933, kappa: 0.21167, f1: 0.36806
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.47it/s]
Epoch 11 : Training Loss: 1.02549, acc: 0.39200, kappa: 0.24000, f1: 0.39060, LR: 0.00022, Time elapsed 0.21 mins
[[50 20 18 36 26]
 [35 46 17 30 22]
 [25 10 63 21 31]
 [16 24 18 70 22]
 [18 18 17 32 65]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.39200, kappa: 0.24000, f1: 0.39060
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.61it/s]
Epoch 12 : Training Loss: 0.88360, acc: 0.42133, kappa: 0.27667, f1: 0.42117, LR: 0.00021, Time elapsed 0.22 mins
[[68 26 16 18 22]
 [33 61 17 25 14]
 [19 19 77 17 18]
 [29 30 24 52 15]
 [25 34 16 17 58]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42133, kappa: 0.27667, f1: 0.42117
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.07it/s]
Epoch 13 : Training Loss: 0.76564, acc: 0.43200, kappa: 0.29000, f1: 0.43061, LR: 0.00021, Time elapsed 0.21 mins
[[59 32 17 23 19]
 [30 51 24 25 20]
 [20 15 77 16 22]
 [23 16 25 72 14]
 [21 19 27 18 65]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.43200, kappa: 0.29000, f1: 0.43061
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.05it/s]
Epoch 14 : Training Loss: 0.68412, acc: 0.45333, kappa: 0.31667, f1: 0.45153, LR: 0.00020, Time elapsed 0.21 mins
[[64 27 15 21 23]
 [21 69 19 24 17]
 [16 18 84 17 15]
 [14 27 26 70 13]
 [25 29 21 22 53]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.45333, kappa: 0.31667, f1: 0.45153
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.67it/s]
Epoch 15 : Training Loss: 0.61100, acc: 0.42533, kappa: 0.28167, f1: 0.42681, LR: 0.00019, Time elapsed 0.21 mins
[[64 31 17 18 20]
 [30 63 20 20 17]
 [21 17 67 17 28]
 [31 24 17 63 15]
 [31 28 14 15 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.07it/s]
Epoch 16 : Training Loss: 0.57746, acc: 0.44533, kappa: 0.30667, f1: 0.44571, LR: 0.00019, Time elapsed 0.22 mins
[[66 22 17 22 23]
 [26 60 16 30 18]
 [19 19 70 22 20]
 [20 21 13 77 19]
 [26 24 10 29 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.76it/s]
Epoch 17 : Training Loss: 0.54372, acc: 0.46133, kappa: 0.32667, f1: 0.46071, LR: 0.00018, Time elapsed 0.21 mins
[[71 20 18 25 16]
 [30 64 23 21 12]
 [18 19 81 19 13]
 [26 19 21 74 10]
 [35 25 15 19 56]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.46133, kappa: 0.32667, f1: 0.46071
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.56it/s]
Epoch 18 : Training Loss: 0.51423, acc: 0.45467, kappa: 0.31833, f1: 0.45460, LR: 0.00017, Time elapsed 0.22 mins
[[75 15 18 22 20]
 [40 57 21 20 12]
 [27 17 80 15 11]
 [28 11 24 71 16]
 [38 16 18 20 58]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.53it/s]
Epoch 19 : Training Loss: 0.49269, acc: 0.45333, kappa: 0.31667, f1: 0.45383, LR: 0.00017, Time elapsed 0.22 mins
[[64 22 15 24 25]
 [28 62 21 23 16]
 [17 17 82 13 21]
 [23 22 15 67 23]
 [28 22 12 23 65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.37it/s]
Epoch 20 : Training Loss: 0.47064, acc: 0.46400, kappa: 0.33000, f1: 0.46086, LR: 0.00016, Time elapsed 0.22 mins
[[73 15 18 26 18]
 [33 52 17 26 22]
 [18 16 80 22 14]
 [14 13 18 83 22]
 [28 14 24 24 60]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.46400, kappa: 0.33000, f1: 0.46086
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.60it/s]
Epoch 21 : Training Loss: 0.46047, acc: 0.47600, kappa: 0.34500, f1: 0.47578, LR: 0.00015, Time elapsed 0.22 mins
[[80 18 15 21 16]
 [36 61 15 18 20]
 [25 15 81 11 18]
 [22 17 20 77 14]
 [39 22 14 17 58]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.47600, kappa: 0.34500, f1: 0.47578
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.76it/s]
Epoch 22 : Training Loss: 0.45360, acc: 0.45467, kappa: 0.31833, f1: 0.45257, LR: 0.00015, Time elapsed 0.21 mins
[[66 22 16 30 16]
 [24 62 16 35 13]
 [13 23 78 21 15]
 [20 17 17 84 12]
 [30 25 15 29 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 23 : Training Loss: 0.44489, acc: 0.47733, kappa: 0.34667, f1: 0.47553, LR: 0.00014, Time elapsed 0.21 mins
[[74 23 16 21 16]
 [28 72 20 16 14]
 [23 19 82 12 14]
 [19 17 23 77 14]
 [28 28 20 21 53]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.47733, kappa: 0.34667, f1: 0.47553
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.68it/s]
Epoch 24 : Training Loss: 0.43764, acc: 0.48800, kappa: 0.36000, f1: 0.48582, LR: 0.00013, Time elapsed 0.22 mins
[[73 21 18 23 15]
 [28 61 25 22 14]
 [18 19 84 17 12]
 [13 16 19 86 16]
 [25 20 21 22 62]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.48800, kappa: 0.36000, f1: 0.48582
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.96it/s]
Epoch 25 : Training Loss: 0.43392, acc: 0.48133, kappa: 0.35167, f1: 0.47859, LR: 0.00012, Time elapsed 0.21 mins
[[67 21 17 29 16]
 [30 59 20 26 15]
 [15 18 83 19 15]
 [14 13 17 90 16]
 [29 19 20 20 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.80it/s]
Epoch 26 : Training Loss: 0.42944, acc: 0.47200, kappa: 0.34000, f1: 0.46930, LR: 0.00012, Time elapsed 0.22 mins
[[71 22 16 24 17]
 [26 60 22 27 15]
 [18 17 82 18 15]
 [18 16 17 86 13]
 [28 27 17 23 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.51it/s]
Epoch 27 : Training Loss: 0.42663, acc: 0.47733, kappa: 0.34667, f1: 0.47560, LR: 0.00011, Time elapsed 0.21 mins
[[72 23 16 24 15]
 [25 63 23 26 13]
 [22 16 81 19 12]
 [16 21 16 85 12]
 [30 25 16 22 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.43it/s]
Epoch 28 : Training Loss: 0.42361, acc: 0.46933, kappa: 0.33667, f1: 0.46899, LR: 0.00010, Time elapsed 0.21 mins
[[71 18 17 25 19]
 [32 60 19 24 15]
 [23 15 77 17 18]
 [20 17 19 79 15]
 [29 21 16 19 65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.74it/s]
Epoch 29 : Training Loss: 0.42116, acc: 0.47200, kappa: 0.34000, f1: 0.47171, LR: 0.00009, Time elapsed 0.22 mins
[[67 20 19 22 22]
 [29 62 21 24 14]
 [19 22 75 14 20]
 [18 19 16 84 13]
 [27 25 17 15 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.00it/s]
Epoch 30 : Training Loss: 0.42110, acc: 0.48533, kappa: 0.35667, f1: 0.48397, LR: 0.00009, Time elapsed 0.22 mins
[[70 20 16 24 20]
 [27 59 21 27 16]
 [20 16 83 16 15]
 [20 15 15 85 15]
 [26 20 17 20 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 31 : Training Loss: 0.41928, acc: 0.47733, kappa: 0.34667, f1: 0.47604, LR: 0.00008, Time elapsed 0.21 mins
[[68 21 22 21 18]
 [27 59 26 21 17]
 [19 17 83 13 18]
 [15 16 21 84 14]
 [30 24 19 13 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 32 : Training Loss: 0.41749, acc: 0.49200, kappa: 0.36500, f1: 0.49204, LR: 0.00007, Time elapsed 0.21 mins
[[75 23 16 20 16]
 [32 62 21 21 14]
 [20 17 78 14 21]
 [19 16 18 83 14]
 [27 23 15 14 71]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.49200, kappa: 0.36500, f1: 0.49204
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.79it/s]
Epoch 33 : Training Loss: 0.41684, acc: 0.48933, kappa: 0.36167, f1: 0.48861, LR: 0.00006, Time elapsed 0.22 mins
[[72 23 17 25 13]
 [27 66 20 23 14]
 [21 18 83 14 14]
 [16 17 20 84 13]
 [30 27 18 13 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.43it/s]
Epoch 34 : Training Loss: 0.41567, acc: 0.47733, kappa: 0.34667, f1: 0.47605, LR: 0.00006, Time elapsed 0.21 mins
[[70 23 16 30 11]
 [29 62 20 25 14]
 [22 14 76 20 18]
 [16 16 18 88 12]
 [30 23 16 19 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.62it/s]
Epoch 35 : Training Loss: 0.41519, acc: 0.48133, kappa: 0.35167, f1: 0.48006, LR: 0.00005, Time elapsed 0.22 mins
[[70 24 18 24 14]
 [29 62 22 23 14]
 [18 16 84 16 16]
 [17 16 21 83 13]
 [30 24 19 15 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.63it/s]
Epoch 36 : Training Loss: 0.41355, acc: 0.48533, kappa: 0.35667, f1: 0.48440, LR: 0.00005, Time elapsed 0.21 mins
[[70 24 17 25 14]
 [30 64 21 24 11]
 [22 19 84 13 12]
 [19 14 19 86 12]
 [31 25 18 16 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.71it/s]
Epoch 37 : Training Loss: 0.41293, acc: 0.48267, kappa: 0.35333, f1: 0.48126, LR: 0.00004, Time elapsed 0.21 mins
[[74 22 19 23 12]
 [32 62 23 22 11]
 [23 16 83 14 14]
 [20 14 18 85 13]
 [32 25 20 15 58]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.57it/s]
Epoch 38 : Training Loss: 0.41295, acc: 0.48000, kappa: 0.35000, f1: 0.47915, LR: 0.00003, Time elapsed 0.21 mins
[[69 21 21 24 15]
 [28 64 24 22 12]
 [23 18 80 13 16]
 [18 14 20 85 13]
 [28 24 21 15 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.66it/s]
Epoch 39 : Training Loss: 0.41238, acc: 0.48267, kappa: 0.35333, f1: 0.48157, LR: 0.00003, Time elapsed 0.21 mins
[[71 20 21 22 16]
 [26 64 22 22 16]
 [20 17 83 14 16]
 [20 13 21 82 14]
 [29 21 25 13 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.67it/s]
Epoch 40 : Training Loss: 0.41125, acc: 0.48133, kappa: 0.35167, f1: 0.48024, LR: 0.00002, Time elapsed 0.21 mins
[[71 23 20 24 12]
 [26 66 21 24 13]
 [22 18 78 14 18]
 [17 13 20 85 15]
 [27 24 24 14 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.45it/s]
Epoch 41 : Training Loss: 0.40994, acc: 0.48267, kappa: 0.35333, f1: 0.48201, LR: 0.00002, Time elapsed 0.22 mins
[[70 23 21 23 13]
 [27 68 21 23 11]
 [20 19 81 15 15]
 [20 15 20 82 13]
 [28 24 23 14 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.42it/s]
Epoch 42 : Training Loss: 0.41100, acc: 0.48800, kappa: 0.36000, f1: 0.48642, LR: 0.00002, Time elapsed 0.21 mins
[[72 20 20 25 13]
 [26 65 20 25 14]
 [20 17 82 15 16]
 [19 13 18 86 14]
 [28 23 24 14 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.98it/s]
Epoch 43 : Training Loss: 0.40955, acc: 0.48133, kappa: 0.35167, f1: 0.47985, LR: 0.00001, Time elapsed 0.21 mins
[[69 23 19 26 13]
 [26 64 21 23 16]
 [22 18 79 14 17]
 [17 13 18 88 14]
 [29 23 22 15 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.21it/s]
Epoch 44 : Training Loss: 0.40971, acc: 0.48133, kappa: 0.35167, f1: 0.47971, LR: 0.00001, Time elapsed 0.21 mins
[[71 21 19 24 15]
 [27 62 20 25 16]
 [21 18 81 14 16]
 [18 14 19 86 13]
 [28 23 23 15 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.71it/s]
Epoch 45 : Training Loss: 0.40948, acc: 0.47867, kappa: 0.34833, f1: 0.47733, LR: 0.00001, Time elapsed 0.21 mins
[[70 21 21 24 14]
 [28 64 20 23 15]
 [20 18 81 15 16]
 [19 14 20 84 13]
 [28 24 24 14 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.23it/s]
Epoch 46 : Training Loss: 0.40960, acc: 0.47600, kappa: 0.34500, f1: 0.47505, LR: 0.00000, Time elapsed 0.21 mins
[[72 20 20 24 14]
 [28 64 21 22 15]
 [21 18 78 15 18]
 [20 15 19 83 13]
 [30 24 23 13 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.64it/s]
Epoch 47 : Training Loss: 0.40986, acc: 0.48267, kappa: 0.35333, f1: 0.48117, LR: 0.00000, Time elapsed 0.22 mins
[[73 20 19 24 14]
 [29 63 20 23 15]
 [21 18 80 15 16]
 [18 14 19 86 13]
 [29 24 24 13 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.74it/s]
Epoch 48 : Training Loss: 0.40949, acc: 0.48400, kappa: 0.35500, f1: 0.48228, LR: 0.00000, Time elapsed 0.22 mins
[[71 20 20 24 15]
 [28 64 20 23 15]
 [20 18 81 15 16]
 [18 14 18 87 13]
 [27 24 24 15 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.67it/s]
Epoch 49 : Training Loss: 0.40876, acc: 0.48000, kappa: 0.35000, f1: 0.47832, LR: 0.00000, Time elapsed 0.21 mins
[[71 20 20 24 15]
 [27 63 20 24 16]
 [21 18 80 15 16]
 [18 14 19 86 13]
 [27 24 24 15 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.87it/s]
Epoch 50 : Training Loss: 0.40948, acc: 0.48267, kappa: 0.35333, f1: 0.48105, LR: 0.00000, Time elapsed 0.22 mins
[[71 20 20 24 15]
 [27 64 20 23 16]
 [20 18 81 15 16]
 [18 14 19 86 13]
 [28 24 24 14 60]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.67it/s]
***************************Test results************************
Test Evaluation: acc: 0.49867, kappa: 0.37333, f1: 0.49683
[[81 15 14 26 14]
 [21 72 21 14 22]
 [17 14 73 19 27]
 [29 18 19 59 25]
 [18 17 12 14 89]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch32_acc_0.49867_kappa_0.37333_f1_0.49683.pth
[32m[I 2025-08-29 23:41:17,358][0m Trial 78 finished with value: 0.3733333333333333 and parameters: {'lr': 0.0002448582643881465, 'weight_decay': 7.842111054032177e-06, '--dropout': 0.18262922861739567, '--clip_value': 1.901848934587955}. Best is trial 78 with value: 0.3733333333333333.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.00017249436169288076, weight_decay=7.4153245724676915e-06, optimizer='AdamW', clip_value=1.9050155653005314, dropout=0.194654741785827, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.194654741785827, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.194654741785827, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
