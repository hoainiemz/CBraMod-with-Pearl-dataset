100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.22it/s]
Epoch 1 : Training Loss: 1.61166, acc: 0.22800, kappa: 0.03500, f1: 0.21347, LR: 0.00001, Time elapsed 0.22 mins
[[49 38 19 40  4]
 [50 43 18 34  5]
 [50 31 30 35  4]
 [49 44 13 42  2]
 [45 31 20 47  7]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22800, kappa: 0.03500, f1: 0.21347
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.66it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.93it/s]
Epoch 2 : Training Loss: 1.59726, acc: 0.25600, kappa: 0.07000, f1: 0.23070, LR: 0.00001, Time elapsed 0.19 mins
[[32 25  4 71 18]
 [28 33  8 60 21]
 [26 19  8 64 33]
 [24 21  3 85 17]
 [21 18  5 72 34]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25600, kappa: 0.07000, f1: 0.23070
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.70it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.90it/s]
Epoch 3 : Training Loss: 1.58261, acc: 0.24133, kappa: 0.05167, f1: 0.21498, LR: 0.00001, Time elapsed 0.19 mins
[[84 12  6 28 20]
 [87 12  8 16 27]
 [61 12 14 28 35]
 [75 15 10 30 20]
 [70 10  6 23 41]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.66it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.90it/s]
Epoch 4 : Training Loss: 1.56383, acc: 0.25867, kappa: 0.07333, f1: 0.25350, LR: 0.00001, Time elapsed 0.19 mins
[[59 21 31 27 12]
 [52 30 31 18 19]
 [34 19 46 25 26]
 [46 26 33 27 18]
 [47 17 28 26 32]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25867, kappa: 0.07333, f1: 0.25350
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.66it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.93it/s]
Epoch 5 : Training Loss: 1.54575, acc: 0.24400, kappa: 0.05500, f1: 0.23475, LR: 0.00001, Time elapsed 0.19 mins
[[36 30 21 25 38]
 [42 33 19 17 39]
 [26 23 25 14 62]
 [30 29 20 23 48]
 [26 30 11 17 66]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.64it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.85it/s]
Epoch 6 : Training Loss: 1.52175, acc: 0.25200, kappa: 0.06500, f1: 0.22874, LR: 0.00001, Time elapsed 0.19 mins
[[52 14 12 30 42]
 [51 20 11 17 51]
 [30 14 14 20 72]
 [38 12 17 25 58]
 [35  8  8 21 78]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.62it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.96it/s]
Epoch 7 : Training Loss: 1.49244, acc: 0.23200, kappa: 0.04000, f1: 0.20780, LR: 0.00001, Time elapsed 0.19 mins
[[37 10 20 20 63]
 [41 18 18 17 56]
 [24  8 18 19 81]
 [32 10 21 17 70]
 [29  6 14 17 84]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.60it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.83it/s]
Epoch 8 : Training Loss: 1.47645, acc: 0.25467, kappa: 0.06833, f1: 0.25094, LR: 0.00001, Time elapsed 0.19 mins
[[39 19 22 29 41]
 [44 29 24 22 31]
 [25 21 33 23 48]
 [26 20 27 33 44]
 [24 14 33 22 57]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.59it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.73it/s]
Epoch 9 : Training Loss: 1.44340, acc: 0.23733, kappa: 0.04667, f1: 0.21971, LR: 0.00001, Time elapsed 0.19 mins
[[46 18 12 22 52]
 [61 25 10 10 44]
 [38 15 16 17 64]
 [39 20 13 20 58]
 [38 14  9 18 71]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.58it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.39it/s]
Epoch 10 : Training Loss: 1.40907, acc: 0.25467, kappa: 0.06833, f1: 0.24544, LR: 0.00001, Time elapsed 0.19 mins
[[42 16  9 39 44]
 [46 33  5 28 38]
 [32 19 16 27 56]
 [31 21 10 40 48]
 [29 16  9 36 60]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.62it/s]
Epoch 11 : Training Loss: 1.38462, acc: 0.24933, kappa: 0.06167, f1: 0.23938, LR: 0.00001, Time elapsed 0.19 mins
[[44 15 13 34 44]
 [45 25 14 21 45]
 [31 17 19 25 58]
 [26 18 18 37 51]
 [27 17  8 36 62]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.73it/s]
Epoch 12 : Training Loss: 1.34802, acc: 0.23200, kappa: 0.04000, f1: 0.21303, LR: 0.00001, Time elapsed 0.19 mins
[[27 16 15 23 69]
 [35 24 11 17 63]
 [25 16 15 17 77]
 [22 20 13 28 67]
 [23 15 11 21 80]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.52it/s]
Epoch 13 : Training Loss: 1.32484, acc: 0.24133, kappa: 0.05167, f1: 0.23946, LR: 0.00001, Time elapsed 0.19 mins
[[33 23 22 30 42]
 [45 35 16 22 32]
 [29 19 26 28 48]
 [26 27 21 38 38]
 [30 20 17 34 49]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.47it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.27it/s]
Epoch 14 : Training Loss: 1.27911, acc: 0.24000, kappa: 0.05000, f1: 0.23225, LR: 0.00001, Time elapsed 0.19 mins
[[28 27 22 24 49]
 [40 36 14 18 42]
 [29 20 24 20 57]
 [23 34 21 28 44]
 [24 23 13 26 64]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.43it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.31it/s]
Epoch 15 : Training Loss: 1.25877, acc: 0.24533, kappa: 0.05667, f1: 0.24194, LR: 0.00001, Time elapsed 0.19 mins
[[39 25 18 27 41]
 [44 34 11 27 34]
 [32 20 24 23 51]
 [29 33 16 35 37]
 [30 27  8 33 52]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.43it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.39it/s]
Epoch 16 : Training Loss: 1.23292, acc: 0.24667, kappa: 0.05833, f1: 0.24384, LR: 0.00001, Time elapsed 0.19 mins
[[40 28 18 27 37]
 [41 37 12 27 33]
 [36 20 24 26 44]
 [32 35 18 35 30]
 [33 25 11 32 49]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.42it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.34it/s]
Epoch 17 : Training Loss: 1.20025, acc: 0.23333, kappa: 0.04167, f1: 0.23058, LR: 0.00001, Time elapsed 0.19 mins
[[33 23 21 27 46]
 [49 27 11 25 38]
 [34 16 29 23 48]
 [34 20 27 32 37]
 [34 12 18 32 54]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.41it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.37it/s]
Epoch 18 : Training Loss: 1.17449, acc: 0.23867, kappa: 0.04833, f1: 0.23148, LR: 0.00001, Time elapsed 0.19 mins
[[42 21 15 32 40]
 [47 26  7 30 40]
 [38 16 18 29 49]
 [33 25 13 42 37]
 [40 15  8 36 51]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.41it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.36it/s]
Epoch 19 : Training Loss: 1.14272, acc: 0.23733, kappa: 0.04667, f1: 0.23405, LR: 0.00001, Time elapsed 0.19 mins
[[27 28 29 26 40]
 [33 32 17 32 36]
 [25 19 30 29 47]
 [26 29 26 35 34]
 [28 22 16 30 54]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.39it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.46it/s]
Epoch 20 : Training Loss: 1.11966, acc: 0.23067, kappa: 0.03833, f1: 0.22727, LR: 0.00001, Time elapsed 0.19 mins
[[33 24 31 25 37]
 [42 25 19 26 38]
 [30 17 35 21 47]
 [30 25 30 28 37]
 [34 15 22 27 52]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.41it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.40it/s]
Epoch 21 : Training Loss: 1.10800, acc: 0.25333, kappa: 0.06667, f1: 0.25031, LR: 0.00001, Time elapsed 0.19 mins
[[36 25 22 31 36]
 [41 30 11 31 37]
 [34 16 27 29 44]
 [32 27 12 44 35]
 [33 19 13 32 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.41it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.41it/s]
Epoch 22 : Training Loss: 1.08683, acc: 0.24133, kappa: 0.05167, f1: 0.23683, LR: 0.00001, Time elapsed 0.19 mins
[[27 29 31 25 38]
 [31 32 16 24 47]
 [23 20 34 21 52]
 [23 32 24 30 41]
 [24 25 19 24 58]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.30it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.52it/s]
Epoch 23 : Training Loss: 1.06965, acc: 0.24533, kappa: 0.05667, f1: 0.24354, LR: 0.00001, Time elapsed 0.20 mins
[[30 25 34 32 29]
 [34 28 24 33 31]
 [24 17 41 34 34]
 [21 24 30 41 34]
 [25 18 28 35 44]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.37it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.81it/s]
Epoch 24 : Training Loss: 1.04295, acc: 0.24533, kappa: 0.05667, f1: 0.24475, LR: 0.00001, Time elapsed 0.20 mins
[[37 27 27 32 27]
 [44 31 17 29 29]
 [35 16 34 30 35]
 [32 23 26 33 36]
 [32 16 20 33 49]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.34it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.24it/s]
Epoch 25 : Training Loss: 1.01554, acc: 0.24667, kappa: 0.05833, f1: 0.24546, LR: 0.00001, Time elapsed 0.20 mins
[[39 26 29 29 27]
 [47 31 16 29 27]
 [36 17 31 29 37]
 [25 27 23 37 38]
 [33 21 22 27 47]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.34it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.36it/s]
Epoch 26 : Training Loss: 1.01075, acc: 0.26000, kappa: 0.07500, f1: 0.25934, LR: 0.00001, Time elapsed 0.20 mins
[[45 30 20 27 28]
 [51 39  9 25 26]
 [39 17 30 28 36]
 [33 30 18 35 34]
 [36 29 13 26 46]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26000, kappa: 0.07500, f1: 0.25934
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.34it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.33it/s]
Epoch 27 : Training Loss: 0.99198, acc: 0.24933, kappa: 0.06167, f1: 0.24802, LR: 0.00001, Time elapsed 0.20 mins
[[32 29 27 26 36]
 [39 41 15 26 29]
 [28 21 33 25 43]
 [23 32 25 32 38]
 [26 23 21 31 49]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.29it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.78it/s]
Epoch 28 : Training Loss: 0.97998, acc: 0.25067, kappa: 0.06333, f1: 0.24834, LR: 0.00000, Time elapsed 0.20 mins
[[30 29 26 28 37]
 [36 41 16 27 30]
 [24 22 32 30 42]
 [21 33 25 33 38]
 [22 26 21 29 52]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.20it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.27it/s]
Epoch 29 : Training Loss: 0.95228, acc: 0.25467, kappa: 0.06833, f1: 0.25332, LR: 0.00000, Time elapsed 0.20 mins
[[32 27 31 27 33]
 [38 38 22 23 29]
 [27 19 40 26 38]
 [24 31 28 31 36]
 [28 22 25 25 50]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.10it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.54it/s]
Epoch 30 : Training Loss: 0.93533, acc: 0.24533, kappa: 0.05667, f1: 0.24485, LR: 0.00000, Time elapsed 0.20 mins
[[31 29 27 32 31]
 [38 34 17 29 32]
 [26 22 38 28 36]
 [22 32 26 35 35]
 [27 21 23 33 46]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.05it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.19it/s]
Epoch 31 : Training Loss: 0.92389, acc: 0.25200, kappa: 0.06500, f1: 0.25007, LR: 0.00000, Time elapsed 0.21 mins
[[38 27 27 28 30]
 [38 38 14 24 36]
 [33 20 32 25 40]
 [28 32 22 29 39]
 [34 23 15 26 52]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.98it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.34it/s]
Epoch 32 : Training Loss: 0.91022, acc: 0.25733, kappa: 0.07167, f1: 0.25553, LR: 0.00000, Time elapsed 0.21 mins
[[36 26 25 31 32]
 [33 37 18 27 35]
 [28 21 35 26 40]
 [26 31 24 31 38]
 [26 20 19 31 54]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.14it/s]
Epoch 33 : Training Loss: 0.89613, acc: 0.25733, kappa: 0.07167, f1: 0.25738, LR: 0.00000, Time elapsed 0.21 mins
[[34 28 24 37 27]
 [32 42 20 29 27]
 [25 22 37 30 36]
 [25 31 26 35 33]
 [29 23 22 31 45]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.98it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.26it/s]
Epoch 34 : Training Loss: 0.87955, acc: 0.25600, kappa: 0.07000, f1: 0.25482, LR: 0.00000, Time elapsed 0.21 mins
[[37 29 26 30 28]
 [37 43 18 23 29]
 [29 23 35 26 37]
 [29 34 25 29 33]
 [28 26 21 27 48]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.04it/s]
Epoch 35 : Training Loss: 0.87639, acc: 0.25333, kappa: 0.06667, f1: 0.25357, LR: 0.00000, Time elapsed 0.21 mins
[[34 28 25 36 27]
 [32 42 19 31 26]
 [23 23 37 33 34]
 [25 33 26 34 32]
 [25 23 26 33 43]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.91it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.97it/s]
Epoch 36 : Training Loss: 0.85828, acc: 0.26000, kappa: 0.07500, f1: 0.25958, LR: 0.00000, Time elapsed 0.21 mins
[[35 29 26 32 28]
 [33 39 23 30 25]
 [25 23 40 27 35]
 [23 32 28 34 33]
 [23 24 26 30 47]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.95it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.08it/s]
Epoch 37 : Training Loss: 0.86087, acc: 0.25600, kappa: 0.07000, f1: 0.25371, LR: 0.00000, Time elapsed 0.21 mins
[[38 26 24 31 31]
 [35 42 19 27 27]
 [31 24 29 26 40]
 [28 34 22 31 35]
 [29 25 16 28 52]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 38 : Training Loss: 0.85330, acc: 0.25600, kappa: 0.07000, f1: 0.25446, LR: 0.00000, Time elapsed 0.21 mins
[[38 27 24 32 29]
 [33 40 19 28 30]
 [29 23 32 26 40]
 [27 34 24 31 34]
 [29 23 18 29 51]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.12it/s]
Epoch 39 : Training Loss: 0.84232, acc: 0.25733, kappa: 0.07167, f1: 0.25534, LR: 0.00000, Time elapsed 0.21 mins
[[36 28 23 33 30]
 [31 42 18 28 31]
 [28 24 33 24 41]
 [27 34 23 29 37]
 [28 24 17 28 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.82it/s]
Epoch 40 : Training Loss: 0.83891, acc: 0.25600, kappa: 0.07000, f1: 0.25498, LR: 0.00000, Time elapsed 0.21 mins
[[36 27 23 33 31]
 [34 40 20 27 29]
 [31 20 33 27 39]
 [29 32 23 32 34]
 [33 22 16 28 51]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.73it/s]
Epoch 41 : Training Loss: 0.83114, acc: 0.25067, kappa: 0.06333, f1: 0.25107, LR: 0.00000, Time elapsed 0.21 mins
[[33 29 25 37 26]
 [32 41 21 31 25]
 [25 23 39 31 32]
 [26 33 25 34 32]
 [29 25 24 31 41]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.87it/s]
Epoch 42 : Training Loss: 0.81117, acc: 0.24800, kappa: 0.06000, f1: 0.24753, LR: 0.00000, Time elapsed 0.21 mins
[[35 28 23 36 28]
 [32 43 19 29 27]
 [28 24 32 30 36]
 [27 34 23 31 35]
 [32 26 17 30 45]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.88it/s]
Epoch 43 : Training Loss: 0.81445, acc: 0.25200, kappa: 0.06500, f1: 0.25109, LR: 0.00000, Time elapsed 0.21 mins
[[34 27 23 36 30]
 [32 41 20 30 27]
 [25 23 32 29 41]
 [26 33 21 34 36]
 [26 26 19 31 48]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.12it/s]
Epoch 44 : Training Loss: 0.81053, acc: 0.25200, kappa: 0.06500, f1: 0.25187, LR: 0.00000, Time elapsed 0.21 mins
[[35 27 24 33 31]
 [32 42 20 29 27]
 [27 21 35 29 38]
 [27 33 23 32 35]
 [30 24 20 31 45]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.78it/s]
Epoch 45 : Training Loss: 0.81452, acc: 0.25733, kappa: 0.07167, f1: 0.25630, LR: 0.00000, Time elapsed 0.21 mins
[[36 25 22 36 31]
 [32 40 19 30 29]
 [28 21 32 30 39]
 [27 31 23 34 35]
 [27 21 20 31 51]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.10it/s]
Epoch 46 : Training Loss: 0.81016, acc: 0.25467, kappa: 0.06833, f1: 0.25196, LR: 0.00000, Time elapsed 0.21 mins
[[36 27 23 33 31]
 [32 43 19 28 28]
 [31 21 29 27 42]
 [27 34 22 29 38]
 [29 24 16 27 54]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.20it/s]
Epoch 47 : Training Loss: 0.80713, acc: 0.25467, kappa: 0.06833, f1: 0.25441, LR: 0.00000, Time elapsed 0.21 mins
[[37 26 25 33 29]
 [32 41 20 30 27]
 [27 21 35 29 38]
 [27 33 24 32 34]
 [31 24 20 29 46]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.28it/s]
Epoch 48 : Training Loss: 0.80929, acc: 0.25333, kappa: 0.06667, f1: 0.25236, LR: 0.00000, Time elapsed 0.21 mins
[[35 25 24 34 32]
 [32 40 21 29 28]
 [29 21 33 29 38]
 [26 31 25 32 36]
 [30 23 18 29 50]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
Epoch 49 : Training Loss: 0.79595, acc: 0.25067, kappa: 0.06333, f1: 0.24993, LR: 0.00000, Time elapsed 0.21 mins
[[36 26 23 35 30]
 [33 40 21 30 26]
 [31 21 30 31 37]
 [28 30 23 35 34]
 [33 24 17 29 47]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.76it/s]
Epoch 50 : Training Loss: 0.79295, acc: 0.25067, kappa: 0.06333, f1: 0.25008, LR: 0.00000, Time elapsed 0.21 mins
[[37 27 24 33 29]
 [33 41 20 29 27]
 [29 21 32 29 39]
 [28 33 24 32 33]
 [33 24 18 29 46]]
***************************Test************************
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.01it/s]
***************************Test results************************
Test Evaluation: acc: 0.23867, kappa: 0.04833, f1: 0.22963
[[51 26 15 21 37]
 [48 35 14 19 34]
 [42 31 16 28 33]
 [42 32 17 26 33]
 [34 23 14 28 51]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch26_acc_0.23867_kappa_0.04833_f1_0.22963.pth
[32m[I 2025-08-29 06:14:26,403][0m Trial 0 finished with value: 0.04833333333333334 and parameters: {'lr': 1.0253509690168497e-05, 'weight_decay': 0.029334453957883984, '--dropout': 0.146398788362281, '--clip_value': 1.397987726295555}. Best is trial 0 with value: 0.04833333333333334.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=2.636875533972305e-06, weight_decay=5.407712220288122e-06, optimizer='AdamW', clip_value=1.7992642186624028, dropout=0.011616722433639893, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.011616722433639893, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.011616722433639893, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
