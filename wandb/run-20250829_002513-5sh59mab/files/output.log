100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.93it/s]
Epoch 1 : Training Loss: 1.61592, acc: 0.22400, kappa: 0.03000, f1: 0.19519, LR: 0.00001, Time elapsed 0.22 mins
[[11 61 17  9 52]
 [16 51 15  6 62]
 [ 8 48 22  9 63]
 [ 8 51 18 11 62]
 [11 44 15  7 73]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22400, kappa: 0.03000, f1: 0.19519
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.84it/s]
Epoch 2 : Training Loss: 1.59570, acc: 0.23867, kappa: 0.04833, f1: 0.22550, LR: 0.00001, Time elapsed 0.19 mins
[[58 31 11 31 19]
 [51 34 10 25 30]
 [44 20 10 32 44]
 [45 31  9 41 24]
 [45 26  7 36 36]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23867, kappa: 0.04833, f1: 0.22550
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 22.01it/s]
Epoch 3 : Training Loss: 1.58434, acc: 0.27733, kappa: 0.09667, f1: 0.27467, LR: 0.00001, Time elapsed 0.19 mins
[[49 28 16 41 16]
 [38 44 18 30 20]
 [34 21 31 37 27]
 [33 27 21 52 17]
 [31 24 17 46 32]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27733, kappa: 0.09667, f1: 0.27467
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.86it/s]
Epoch 4 : Training Loss: 1.56668, acc: 0.24533, kappa: 0.05667, f1: 0.23409, LR: 0.00001, Time elapsed 0.19 mins
[[55 16 14 35 30]
 [44 27 16 18 45]
 [42 15 17 21 55]
 [45 15 19 28 43]
 [39 13  9 32 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.85it/s]
Epoch 5 : Training Loss: 1.55266, acc: 0.25867, kappa: 0.07333, f1: 0.24566, LR: 0.00001, Time elapsed 0.19 mins
[[78 11 18 27 16]
 [70 20 23 15 22]
 [63  8 32 17 30]
 [70  7 20 26 27]
 [67  9 14 22 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.72it/s]
Epoch 6 : Training Loss: 1.52508, acc: 0.25200, kappa: 0.06500, f1: 0.22631, LR: 0.00001, Time elapsed 0.19 mins
[[53 18  3 33 43]
 [52 23  6 22 47]
 [40 13  7 29 61]
 [43 14  7 34 52]
 [35 13  1 29 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.72it/s]
Epoch 7 : Training Loss: 1.49569, acc: 0.24933, kappa: 0.06167, f1: 0.24214, LR: 0.00001, Time elapsed 0.19 mins
[[52 14 25 30 29]
 [47 19 20 26 38]
 [37  8 30 27 48]
 [37  9 29 37 38]
 [38 10 22 31 49]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.58it/s]
Epoch 8 : Training Loss: 1.47458, acc: 0.25867, kappa: 0.07333, f1: 0.24220, LR: 0.00001, Time elapsed 0.19 mins
[[52 14 17 27 40]
 [50 21 13 16 50]
 [42  7 21 20 60]
 [40  7 19 27 57]
 [40 12  5 20 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.79it/s]
Epoch 9 : Training Loss: 1.44886, acc: 0.26933, kappa: 0.08667, f1: 0.25548, LR: 0.00001, Time elapsed 0.19 mins
[[45 17  7 38 43]
 [44 31  9 27 39]
 [34 15 15 29 57]
 [35 16 11 41 47]
 [29 17  6 28 70]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.74it/s]
Epoch 10 : Training Loss: 1.42119, acc: 0.26133, kappa: 0.07667, f1: 0.25409, LR: 0.00001, Time elapsed 0.19 mins
[[44 25  8 37 36]
 [47 31 12 26 34]
 [33 16 21 31 49]
 [33 25 14 40 38]
 [30 20 10 30 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:10<00:00,  6.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.68it/s]
Epoch 11 : Training Loss: 1.38712, acc: 0.24400, kappa: 0.05500, f1: 0.23560, LR: 0.00001, Time elapsed 0.19 mins
[[48 14 15 32 41]
 [51 23 16 21 39]
 [39 14 23 25 49]
 [42 16 17 31 44]
 [40 12 15 25 58]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.45it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.65it/s]
Epoch 12 : Training Loss: 1.35973, acc: 0.24667, kappa: 0.05833, f1: 0.23671, LR: 0.00001, Time elapsed 0.19 mins
[[45 12 11 34 48]
 [52 23  8 24 43]
 [35 11 19 29 56]
 [36  9 16 37 52]
 [35 14 11 29 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.43it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.55it/s]
Epoch 13 : Training Loss: 1.33023, acc: 0.26000, kappa: 0.07500, f1: 0.25076, LR: 0.00001, Time elapsed 0.19 mins
[[45 13 13 38 41]
 [48 23 12 32 35]
 [34 13 21 36 46]
 [33 11 14 50 42]
 [37  8 12 37 56]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.40it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.45it/s]
Epoch 14 : Training Loss: 1.29699, acc: 0.23867, kappa: 0.04833, f1: 0.22706, LR: 0.00001, Time elapsed 0.19 mins
[[37 16 19 24 54]
 [45 25 11 16 53]
 [29 20 21 24 56]
 [28 22 14 27 59]
 [30 19 10 22 69]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  6.32it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 21.59it/s]
Epoch 15 : Training Loss: 1.27318, acc: 0.24933, kappa: 0.06167, f1: 0.24511, LR: 0.00001, Time elapsed 0.20 mins
[[46 23 16 29 36]
 [49 34 13 21 33]
 [35 20 24 30 41]
 [34 30 16 31 39]
 [41 22 10 25 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.35it/s]
Epoch 16 : Training Loss: 1.25203, acc: 0.24533, kappa: 0.05667, f1: 0.24295, LR: 0.00001, Time elapsed 0.21 mins
[[38 16 28 28 40]
 [42 28 20 17 43]
 [28 16 33 26 47]
 [31 16 23 32 48]
 [34 14 19 30 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.12it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.54it/s]
Epoch 17 : Training Loss: 1.21603, acc: 0.25067, kappa: 0.06333, f1: 0.24960, LR: 0.00001, Time elapsed 0.30 mins
[[37 16 24 38 35]
 [37 32 17 33 31]
 [29 18 30 36 37]
 [29 21 22 44 34]
 [30 15 25 35 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.14it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.09it/s]
Epoch 18 : Training Loss: 1.19873, acc: 0.25333, kappa: 0.06667, f1: 0.24949, LR: 0.00001, Time elapsed 0.30 mins
[[40 16 17 41 36]
 [37 29 13 34 37]
 [31 16 25 37 41]
 [32 17 18 43 40]
 [33 14 14 36 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.01it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.43it/s]
Epoch 19 : Training Loss: 1.16368, acc: 0.24533, kappa: 0.05667, f1: 0.24453, LR: 0.00001, Time elapsed 0.31 mins
[[42 16 26 30 36]
 [49 30 17 19 35]
 [36 15 32 27 40]
 [36 20 23 33 38]
 [39 12 22 30 47]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.01it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.51it/s]
Epoch 20 : Training Loss: 1.14052, acc: 0.25467, kappa: 0.06833, f1: 0.25123, LR: 0.00001, Time elapsed 0.31 mins
[[41 21 22 29 37]
 [41 32 12 24 41]
 [32 20 29 27 42]
 [33 23 18 32 44]
 [34 15 14 30 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.10it/s]
Epoch 21 : Training Loss: 1.11637, acc: 0.25467, kappa: 0.06833, f1: 0.24907, LR: 0.00001, Time elapsed 0.31 mins
[[40 19 23 30 38]
 [40 27 13 28 42]
 [34 17 28 27 44]
 [34 21 19 35 41]
 [33 13 16 27 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.00it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.86it/s]
Epoch 22 : Training Loss: 1.10077, acc: 0.25200, kappa: 0.06500, f1: 0.24964, LR: 0.00001, Time elapsed 0.31 mins
[[35 20 23 35 37]
 [35 32 14 30 39]
 [30 18 30 30 42]
 [31 21 21 37 40]
 [30 14 19 32 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.88it/s]
Epoch 23 : Training Loss: 1.07580, acc: 0.24933, kappa: 0.06167, f1: 0.24672, LR: 0.00001, Time elapsed 0.32 mins
[[31 27 21 33 38]
 [33 38 15 28 36]
 [29 20 30 29 42]
 [28 23 23 32 44]
 [27 19 19 29 56]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.46it/s]
Epoch 24 : Training Loss: 1.06173, acc: 0.25200, kappa: 0.06500, f1: 0.24617, LR: 0.00001, Time elapsed 0.33 mins
[[27 27 19 34 43]
 [31 35 13 24 47]
 [24 19 30 31 46]
 [20 24 25 33 48]
 [23 20 14 29 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.21it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.53it/s]
Epoch 25 : Training Loss: 1.03289, acc: 0.25600, kappa: 0.07000, f1: 0.25562, LR: 0.00001, Time elapsed 0.30 mins
[[41 22 18 36 33]
 [43 36 15 25 31]
 [37 15 32 28 38]
 [36 22 23 32 37]
 [34 15 20 30 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.77it/s]
Epoch 26 : Training Loss: 1.01653, acc: 0.25333, kappa: 0.06667, f1: 0.24894, LR: 0.00001, Time elapsed 0.33 mins
[[31 28 20 32 39]
 [30 37 13 26 44]
 [33 16 31 28 42]
 [30 24 24 28 44]
 [30 16 16 25 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.84it/s]
Epoch 27 : Training Loss: 1.00415, acc: 0.25467, kappa: 0.06833, f1: 0.25361, LR: 0.00001, Time elapsed 0.33 mins
[[40 23 16 40 31]
 [37 37 11 35 30]
 [35 15 27 35 38]
 [33 24 23 34 36]
 [34 16 14 33 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.10it/s]
Epoch 28 : Training Loss: 0.98593, acc: 0.26133, kappa: 0.07667, f1: 0.25673, LR: 0.00000, Time elapsed 0.33 mins
[[27 23 25 28 47]
 [30 42 20 21 37]
 [26 15 37 28 44]
 [26 24 31 27 42]
 [24 18 20 25 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.44it/s]
Epoch 29 : Training Loss: 0.96685, acc: 0.26400, kappa: 0.08000, f1: 0.26231, LR: 0.00000, Time elapsed 0.34 mins
[[35 28 15 36 36]
 [36 38 18 32 26]
 [30 15 31 34 40]
 [32 25 23 37 33]
 [25 22 14 32 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.78it/s]
Epoch 30 : Training Loss: 0.95155, acc: 0.26133, kappa: 0.07667, f1: 0.25864, LR: 0.00000, Time elapsed 0.32 mins
[[34 19 22 37 38]
 [34 34 17 30 35]
 [28 15 35 31 41]
 [26 23 28 33 40]
 [26 20 16 28 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.15it/s]
Epoch 31 : Training Loss: 0.94025, acc: 0.26267, kappa: 0.07833, f1: 0.26170, LR: 0.00000, Time elapsed 0.31 mins
[[36 19 26 36 33]
 [34 34 21 32 29]
 [29 13 38 33 37]
 [28 24 31 34 33]
 [24 16 24 31 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.26it/s]
Epoch 32 : Training Loss: 0.93674, acc: 0.26133, kappa: 0.07667, f1: 0.25959, LR: 0.00000, Time elapsed 0.33 mins
[[35 25 22 32 36]
 [34 39 18 25 34]
 [28 16 35 29 42]
 [30 24 29 31 36]
 [26 20 19 29 56]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.87it/s]
Epoch 33 : Training Loss: 0.91664, acc: 0.25467, kappa: 0.06833, f1: 0.25375, LR: 0.00000, Time elapsed 0.31 mins
[[36 31 21 30 32]
 [37 39 18 26 30]
 [29 19 35 28 39]
 [34 25 26 30 35]
 [28 23 19 29 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.66it/s]
Epoch 34 : Training Loss: 0.90888, acc: 0.25467, kappa: 0.06833, f1: 0.25074, LR: 0.00000, Time elapsed 0.33 mins
[[40 21 24 28 37]
 [37 34 20 20 39]
 [32 13 33 29 43]
 [34 23 28 25 40]
 [33 15 19 24 59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.66it/s]
Epoch 35 : Training Loss: 0.89913, acc: 0.26400, kappa: 0.08000, f1: 0.26220, LR: 0.00000, Time elapsed 0.34 mins
[[42 25 20 33 30]
 [37 39 16 26 32]
 [30 16 31 34 39]
 [32 25 25 31 37]
 [27 19 19 30 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.61it/s]
Epoch 36 : Training Loss: 0.88092, acc: 0.26133, kappa: 0.07667, f1: 0.26143, LR: 0.00000, Time elapsed 0.33 mins
[[39 25 24 36 26]
 [33 40 19 31 27]
 [29 17 33 36 35]
 [30 26 28 36 30]
 [24 23 21 34 48]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.00it/s]
Epoch 37 : Training Loss: 0.87379, acc: 0.26800, kappa: 0.08500, f1: 0.26781, LR: 0.00000, Time elapsed 0.34 mins
[[40 29 25 30 26]
 [37 40 22 25 26]
 [27 16 40 30 37]
 [32 24 30 32 32]
 [28 21 22 30 49]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.33it/s]
Epoch 38 : Training Loss: 0.86954, acc: 0.26133, kappa: 0.07667, f1: 0.26150, LR: 0.00000, Time elapsed 0.31 mins
[[40 22 26 32 30]
 [37 36 23 28 26]
 [28 15 40 32 35]
 [31 23 29 33 34]
 [29 19 23 32 47]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.92it/s]
Epoch 39 : Training Loss: 0.86085, acc: 0.26533, kappa: 0.08167, f1: 0.26515, LR: 0.00000, Time elapsed 0.34 mins
[[40 20 25 36 29]
 [36 37 21 27 29]
 [29 15 38 31 37]
 [31 22 30 32 35]
 [29 18 20 31 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.37it/s]
Epoch 40 : Training Loss: 0.85667, acc: 0.26400, kappa: 0.08000, f1: 0.26330, LR: 0.00000, Time elapsed 0.32 mins
[[39 23 25 33 30]
 [36 38 18 27 31]
 [27 16 37 31 39]
 [31 23 28 31 37]
 [27 22 17 31 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.43it/s]
Epoch 41 : Training Loss: 0.85181, acc: 0.26400, kappa: 0.08000, f1: 0.26421, LR: 0.00000, Time elapsed 0.34 mins
[[40 25 24 35 26]
 [36 38 19 29 28]
 [28 16 37 34 35]
 [32 24 27 33 34]
 [28 21 18 33 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.70it/s]
Epoch 42 : Training Loss: 0.83546, acc: 0.26267, kappa: 0.07833, f1: 0.26216, LR: 0.00000, Time elapsed 0.32 mins
[[39 22 24 36 29]
 [36 37 18 28 31]
 [27 16 36 33 38]
 [31 23 27 32 37]
 [30 19 18 30 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.65it/s]
Epoch 43 : Training Loss: 0.84622, acc: 0.27600, kappa: 0.09500, f1: 0.27478, LR: 0.00000, Time elapsed 0.33 mins
[[38 29 23 32 28]
 [34 45 17 25 29]
 [26 19 37 29 39]
 [30 24 27 32 37]
 [27 24 17 27 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.71it/s]
Epoch 44 : Training Loss: 0.82552, acc: 0.27333, kappa: 0.09167, f1: 0.27311, LR: 0.00000, Time elapsed 0.32 mins
[[40 28 24 33 25]
 [36 41 19 28 26]
 [27 17 39 30 37]
 [31 23 29 33 34]
 [28 23 18 29 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.08it/s]
Epoch 45 : Training Loss: 0.81694, acc: 0.27067, kappa: 0.08833, f1: 0.26907, LR: 0.00000, Time elapsed 0.32 mins
[[37 27 25 32 29]
 [36 43 18 23 30]
 [26 18 37 28 41]
 [31 24 28 30 37]
 [28 22 18 26 56]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.45it/s]
Epoch 46 : Training Loss: 0.81622, acc: 0.26933, kappa: 0.08667, f1: 0.26915, LR: 0.00000, Time elapsed 0.32 mins
[[37 30 24 33 26]
 [36 47 19 25 23]
 [27 20 37 33 33]
 [31 25 28 31 35]
 [28 23 20 29 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.26it/s]
Epoch 47 : Training Loss: 0.81701, acc: 0.26933, kappa: 0.08667, f1: 0.26920, LR: 0.00000, Time elapsed 0.33 mins
[[38 24 25 35 28]
 [36 41 18 27 28]
 [25 16 38 35 36]
 [30 23 28 32 37]
 [27 21 20 29 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.73it/s]
Epoch 48 : Training Loss: 0.82431, acc: 0.26800, kappa: 0.08500, f1: 0.26771, LR: 0.00000, Time elapsed 0.33 mins
[[38 25 25 34 28]
 [36 42 19 26 27]
 [26 18 38 31 37]
 [31 23 28 31 37]
 [28 22 19 29 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.65it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.63it/s]
Epoch 49 : Training Loss: 0.81218, acc: 0.26800, kappa: 0.08500, f1: 0.26798, LR: 0.00000, Time elapsed 0.34 mins
[[37 26 25 35 27]
 [36 42 18 27 27]
 [26 17 38 33 36]
 [31 23 27 32 37]
 [27 23 18 30 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.68it/s]
Epoch 50 : Training Loss: 0.81526, acc: 0.27200, kappa: 0.09000, f1: 0.27104, LR: 0.00000, Time elapsed 0.33 mins
[[37 26 24 34 29]
 [36 44 18 24 28]
 [26 18 38 30 38]
 [31 24 28 30 37]
 [30 21 19 25 55]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.74it/s]
***************************Test results************************
Test Evaluation: acc: 0.25600, kappa: 0.07000, f1: 0.25408
[[39 23 18 42 28]
 [37 42 17 36 18]
 [30 20 30 43 27]
 [34 28 17 52 19]
 [35 22 19 45 29]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch3_acc_0.25600_kappa_0.07000_f1_0.25408.pth
[32m[I 2025-08-29 00:39:31,169][0m Trial 0 finished with value: 0.06999999999999995 and parameters: {'lr': 1.0253509690168497e-05, 'weight_decay': 0.029334453957883984, '--dropout': 0.146398788362281, '--clip_value': 1.397987726295555}. Best is trial 0 with value: 0.06999999999999995.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=2.636875533972305e-06, weight_decay=5.407712220288122e-06, optimizer='AdamW', clip_value=1.7992642186624028, dropout=0.011616722433639893, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.011616722433639893, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.011616722433639893, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
