Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.0003, weight_decay=0.05, optimizer='AdamW', clip_value=1, dropout=0.1, classifier='all_patch_reps', downstream_dataset='PEARL', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/pearl', num_of_classes=2, model_dir='./data/wjq/models_weights/Big/BigFaced', num_workers=16, label_smoothing=0.1, multi_lr=False, frozen=False, use_pretrained_weights=True, foundation_dir='pretrained_weights/pretrained_weights.pth')
The downstream dataset is PEARL
3255 476 874
4605
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (meta_backbone): Sequential(
    (0): Linear(in_features=28, out_features=50, bias=True)
    (1): ELU(alpha=1.0)
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=50, out_features=100, bias=True)
    (4): ELU(alpha=1.0)
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=100, out_features=100, bias=True)
    (7): ELU(alpha=1.0)
    (8): Dropout(p=0.1, inplace=False)
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=19000, out_features=1000, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=100, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1, inplace=False)
  )
  (final_classifier): Sequential(
    (0): Linear(in_features=100, out_features=100, bias=True)
    (1): ELU(alpha=1.0)
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=100, out_features=1, bias=True)
    (4): Rearrange('b 1 -> (b 1)')
  )
)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:05<00:00,  8.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 43.88it/s]
Epoch 1 : Training Loss: 0.57734, acc: 0.51050, pr_auc: 0.55915, roc_auc: 0.64453, LR: 0.00030, Time elapsed 0.10 mins
[[211  27]
 [206  32]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.21it/s]
Val Evaluation: acc: 0.71762, pr_auc: 0.73073, roc_auc: 0.72831
[[440  28]
 [205 201]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.51050, pr_auc: 0.55915, roc_auc: 0.64453
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 12.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.72it/s]
Epoch 2 : Training Loss: 0.23566, acc: 0.53571, pr_auc: 0.53702, roc_auc: 0.54398, LR: 0.00030, Time elapsed 0.07 mins
[[193  45]
 [176  62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.88it/s]
Val Evaluation: acc: 0.75694, pr_auc: 0.83469, roc_auc: 0.82129
[[433  35]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 49.81it/s]
Epoch 3 : Training Loss: 0.10587, acc: 0.59664, pr_auc: 0.67563, roc_auc: 0.67760, LR: 0.00030, Time elapsed 0.07 mins
[[176  62]
 [130 108]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.60it/s]
Val Evaluation: acc: 0.65666, pr_auc: 0.84138, roc_auc: 0.84352
[[323 145]
 [153 253]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.59664, pr_auc: 0.67563, roc_auc: 0.67760
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 49.00it/s]
Epoch 4 : Training Loss: 0.06536, acc: 0.57353, pr_auc: 0.62129, roc_auc: 0.58508, LR: 0.00030, Time elapsed 0.07 mins
[[213  25]
 [178  60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.77it/s]
Val Evaluation: acc: 0.74569, pr_auc: 0.81738, roc_auc: 0.78160
[[434  34]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.12it/s]
Epoch 5 : Training Loss: 0.02974, acc: 0.66387, pr_auc: 0.66356, roc_auc: 0.60873, LR: 0.00029, Time elapsed 0.07 mins
[[225  13]
 [147  91]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.81it/s]
Val Evaluation: acc: 0.67625, pr_auc: 0.75863, roc_auc: 0.68639
[[369  99]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 49.03it/s]
Epoch 6 : Training Loss: 0.01404, acc: 0.61555, pr_auc: 0.71022, roc_auc: 0.73692, LR: 0.00029, Time elapsed 0.07 mins
[[187  51]
 [132 106]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.98it/s]
Val Evaluation: acc: 0.63719, pr_auc: 0.81783, roc_auc: 0.78862
[[314 154]
 [161 245]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.61555, pr_auc: 0.71022, roc_auc: 0.73692
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.95it/s]
Epoch 7 : Training Loss: 0.01311, acc: 0.68487, pr_auc: 0.73520, roc_auc: 0.68606, LR: 0.00029, Time elapsed 0.07 mins
[[206  32]
 [118 120]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.02it/s]
Val Evaluation: acc: 0.57220, pr_auc: 0.66770, roc_auc: 0.65582
[[267 201]
 [173 233]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.70it/s]
Epoch 8 : Training Loss: 0.00497, acc: 0.69538, pr_auc: 0.73140, roc_auc: 0.67292, LR: 0.00028, Time elapsed 0.08 mins
[[212  26]
 [119 119]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.04it/s]
Val Evaluation: acc: 0.49301, pr_auc: 0.62104, roc_auc: 0.58681
[[224 244]
 [200 206]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.94it/s]
Epoch 9 : Training Loss: 0.00407, acc: 0.70168, pr_auc: 0.74727, roc_auc: 0.74650, LR: 0.00028, Time elapsed 0.08 mins
[[217  21]
 [121 117]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.97it/s]
Val Evaluation: acc: 0.55486, pr_auc: 0.73164, roc_auc: 0.70449
[[245 223]
 [168 238]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.70168, pr_auc: 0.74727, roc_auc: 0.74650
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.39it/s]
Epoch 10 : Training Loss: 0.00731, acc: 0.64076, pr_auc: 0.71470, roc_auc: 0.71700, LR: 0.00027, Time elapsed 0.08 mins
[[200  38]
 [133 105]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.35it/s]
Val Evaluation: acc: 0.59808, pr_auc: 0.76714, roc_auc: 0.73573
[[282 186]
 [165 241]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.82it/s]
Epoch 11 : Training Loss: 0.00243, acc: 0.71639, pr_auc: 0.72894, roc_auc: 0.65717, LR: 0.00027, Time elapsed 0.08 mins
[[224  14]
 [121 117]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.63it/s]
Val Evaluation: acc: 0.56465, pr_auc: 0.66919, roc_auc: 0.64364
[[268 200]
 [180 226]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 49.15it/s]
Epoch 12 : Training Loss: 0.00013, acc: 0.63866, pr_auc: 0.68405, roc_auc: 0.64224, LR: 0.00026, Time elapsed 0.08 mins
[[203  35]
 [137 101]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.16it/s]
Val Evaluation: acc: 0.58042, pr_auc: 0.73820, roc_auc: 0.68614
[[277 191]
 [175 231]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.37it/s]
Epoch 13 : Training Loss: 0.00029, acc: 0.68697, pr_auc: 0.70210, roc_auc: 0.65648, LR: 0.00025, Time elapsed 0.08 mins
[[218  20]
 [129 109]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.30it/s]
Val Evaluation: acc: 0.59701, pr_auc: 0.74748, roc_auc: 0.72813
[[281 187]
 [165 241]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.71it/s]
Epoch 14 : Training Loss: 0.00086, acc: 0.65336, pr_auc: 0.70305, roc_auc: 0.67117, LR: 0.00025, Time elapsed 0.08 mins
[[192  46]
 [119 119]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.29it/s]
Val Evaluation: acc: 0.60143, pr_auc: 0.73671, roc_auc: 0.69092
[[269 199]
 [151 255]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.95it/s]
Epoch 15 : Training Loss: 0.00015, acc: 0.67857, pr_auc: 0.70873, roc_auc: 0.66272, LR: 0.00024, Time elapsed 0.08 mins
[[204  34]
 [119 119]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.93it/s]
Val Evaluation: acc: 0.61179, pr_auc: 0.74969, roc_auc: 0.71694
[[281 187]
 [153 253]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.17it/s]
Epoch 16 : Training Loss: 0.00161, acc: 0.64286, pr_auc: 0.71222, roc_auc: 0.63155, LR: 0.00023, Time elapsed 0.08 mins
[[195  43]
 [127 111]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.01it/s]
Val Evaluation: acc: 0.60382, pr_auc: 0.77613, roc_auc: 0.71889
[[277 191]
 [156 250]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.37it/s]
Epoch 17 : Training Loss: 0.00009, acc: 0.68277, pr_auc: 0.72051, roc_auc: 0.63325, LR: 0.00022, Time elapsed 0.08 mins
[[213  25]
 [126 112]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.05it/s]
Val Evaluation: acc: 0.57952, pr_auc: 0.72802, roc_auc: 0.67918
[[275 193]
 [174 232]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.99it/s]
Epoch 18 : Training Loss: 0.00002, acc: 0.65336, pr_auc: 0.70251, roc_auc: 0.61929, LR: 0.00021, Time elapsed 0.08 mins
[[200  38]
 [127 111]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.82it/s]
Val Evaluation: acc: 0.58674, pr_auc: 0.75726, roc_auc: 0.70322
[[276 192]
 [169 237]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.66it/s]
Epoch 19 : Training Loss: 0.00002, acc: 0.66597, pr_auc: 0.71475, roc_auc: 0.63083, LR: 0.00021, Time elapsed 0.08 mins
[[200  38]
 [121 117]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.62it/s]
Val Evaluation: acc: 0.58863, pr_auc: 0.74934, roc_auc: 0.69279
[[272 196]
 [164 242]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.28it/s]
Epoch 20 : Training Loss: 0.00002, acc: 0.68277, pr_auc: 0.72974, roc_auc: 0.63768, LR: 0.00020, Time elapsed 0.08 mins
[[206  32]
 [119 119]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.15it/s]
Val Evaluation: acc: 0.58205, pr_auc: 0.71495, roc_auc: 0.66230
[[267 201]
 [165 241]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.57it/s]
Epoch 21 : Training Loss: 0.00027, acc: 0.60294, pr_auc: 0.68695, roc_auc: 0.64507, LR: 0.00019, Time elapsed 0.08 mins
[[195  43]
 [146  92]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.82it/s]
Val Evaluation: acc: 0.61237, pr_auc: 0.78366, roc_auc: 0.74893
[[285 183]
 [156 250]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.54it/s]
Epoch 22 : Training Loss: 0.00006, acc: 0.70168, pr_auc: 0.72572, roc_auc: 0.68262, LR: 0.00018, Time elapsed 0.08 mins
[[226  12]
 [130 108]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.82it/s]
Val Evaluation: acc: 0.58806, pr_auc: 0.73171, roc_auc: 0.69425
[[283 185]
 [174 232]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.50it/s]
Epoch 23 : Training Loss: 0.00002, acc: 0.68487, pr_auc: 0.71408, roc_auc: 0.67064, LR: 0.00017, Time elapsed 0.08 mins
[[221  17]
 [133 105]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.94it/s]
Val Evaluation: acc: 0.59053, pr_auc: 0.74488, roc_auc: 0.70639
[[283 185]
 [172 234]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.58it/s]
Epoch 24 : Training Loss: 0.00002, acc: 0.67857, pr_auc: 0.70519, roc_auc: 0.66479, LR: 0.00016, Time elapsed 0.08 mins
[[216  22]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.41it/s]
Val Evaluation: acc: 0.59299, pr_auc: 0.75053, roc_auc: 0.70958
[[283 185]
 [170 236]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.41it/s]
Epoch 25 : Training Loss: 0.00002, acc: 0.66387, pr_auc: 0.70494, roc_auc: 0.65822, LR: 0.00015, Time elapsed 0.08 mins
[[217  21]
 [139  99]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.27it/s]
Val Evaluation: acc: 0.59283, pr_auc: 0.76709, roc_auc: 0.72563
[[284 184]
 [171 235]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.16it/s]
Epoch 26 : Training Loss: 0.00006, acc: 0.68067, pr_auc: 0.71633, roc_auc: 0.66749, LR: 0.00014, Time elapsed 0.08 mins
[[213  25]
 [127 111]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.95it/s]
Val Evaluation: acc: 0.59315, pr_auc: 0.75628, roc_auc: 0.70523
[[282 186]
 [169 237]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.09it/s]
Epoch 27 : Training Loss: 0.00001, acc: 0.67857, pr_auc: 0.71751, roc_auc: 0.66625, LR: 0.00013, Time elapsed 0.08 mins
[[212  26]
 [127 111]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.08it/s]
Val Evaluation: acc: 0.59439, pr_auc: 0.75575, roc_auc: 0.70429
[[282 186]
 [168 238]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.46it/s]
Epoch 28 : Training Loss: 0.00001, acc: 0.67437, pr_auc: 0.71368, roc_auc: 0.66088, LR: 0.00012, Time elapsed 0.08 mins
[[210  28]
 [127 111]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.84it/s]
Val Evaluation: acc: 0.59192, pr_auc: 0.75901, roc_auc: 0.70736
[[282 186]
 [170 236]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.55it/s]
Epoch 29 : Training Loss: 0.00001, acc: 0.67647, pr_auc: 0.71765, roc_auc: 0.66176, LR: 0.00011, Time elapsed 0.08 mins
[[208  30]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.40it/s]
Val Evaluation: acc: 0.59439, pr_auc: 0.75944, roc_auc: 0.70730
[[282 186]
 [168 238]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.90it/s]
Epoch 30 : Training Loss: 0.00001, acc: 0.68067, pr_auc: 0.72162, roc_auc: 0.66297, LR: 0.00010, Time elapsed 0.08 mins
[[209  29]
 [123 115]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.90it/s]
Val Evaluation: acc: 0.59192, pr_auc: 0.75314, roc_auc: 0.70117
[[282 186]
 [170 236]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.29it/s]
Epoch 31 : Training Loss: 0.00001, acc: 0.68067, pr_auc: 0.72239, roc_auc: 0.66298, LR: 0.00010, Time elapsed 0.08 mins
[[209  29]
 [123 115]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.71it/s]
Val Evaluation: acc: 0.58979, pr_auc: 0.75066, roc_auc: 0.69866
[[280 188]
 [170 236]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.75it/s]
Epoch 32 : Training Loss: 0.00001, acc: 0.67857, pr_auc: 0.71640, roc_auc: 0.65869, LR: 0.00009, Time elapsed 0.08 mins
[[208  30]
 [123 115]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 44.49it/s]
Val Evaluation: acc: 0.59225, pr_auc: 0.75651, roc_auc: 0.70448
[[280 188]
 [168 238]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.37it/s]
Epoch 33 : Training Loss: 0.00001, acc: 0.67437, pr_auc: 0.71541, roc_auc: 0.65820, LR: 0.00008, Time elapsed 0.08 mins
[[206  32]
 [123 115]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 44.03it/s]
Val Evaluation: acc: 0.59455, pr_auc: 0.75847, roc_auc: 0.70630
[[281 187]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.14it/s]
Epoch 34 : Training Loss: 0.00001, acc: 0.67227, pr_auc: 0.71400, roc_auc: 0.65666, LR: 0.00007, Time elapsed 0.08 mins
[[206  32]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 44.47it/s]
Val Evaluation: acc: 0.59455, pr_auc: 0.75942, roc_auc: 0.70728
[[281 187]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.03it/s]
Epoch 35 : Training Loss: 0.00001, acc: 0.67437, pr_auc: 0.71485, roc_auc: 0.65652, LR: 0.00006, Time elapsed 0.08 mins
[[206  32]
 [123 115]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.86it/s]
Val Evaluation: acc: 0.59455, pr_auc: 0.75918, roc_auc: 0.70698
[[281 187]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.22it/s]
Epoch 36 : Training Loss: 0.00001, acc: 0.67437, pr_auc: 0.71467, roc_auc: 0.65633, LR: 0.00006, Time elapsed 0.08 mins
[[206  32]
 [123 115]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.69it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.75903, roc_auc: 0.70666
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 10.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.11it/s]
Epoch 37 : Training Loss: 0.00001, acc: 0.67227, pr_auc: 0.71331, roc_auc: 0.65483, LR: 0.00005, Time elapsed 0.08 mins
[[206  32]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.10it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.75948, roc_auc: 0.70701
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.49it/s]
Epoch 38 : Training Loss: 0.00001, acc: 0.67227, pr_auc: 0.71297, roc_auc: 0.65409, LR: 0.00004, Time elapsed 0.08 mins
[[206  32]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.80it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.75968, roc_auc: 0.70723
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 10.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 42.77it/s]
Epoch 39 : Training Loss: 0.00001, acc: 0.67227, pr_auc: 0.71325, roc_auc: 0.65315, LR: 0.00004, Time elapsed 0.09 mins
[[206  32]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 41.87it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.76020, roc_auc: 0.70762
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 10.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.76it/s]
Epoch 40 : Training Loss: 0.00001, acc: 0.67227, pr_auc: 0.71250, roc_auc: 0.65234, LR: 0.00003, Time elapsed 0.08 mins
[[206  32]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.96it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.76068, roc_auc: 0.70810
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 10.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 42.06it/s]
Epoch 41 : Training Loss: 0.00001, acc: 0.67227, pr_auc: 0.71230, roc_auc: 0.65190, LR: 0.00002, Time elapsed 0.08 mins
[[206  32]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 40.12it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.76077, roc_auc: 0.70816
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 10.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 43.60it/s]
Epoch 42 : Training Loss: 0.00001, acc: 0.67017, pr_auc: 0.71158, roc_auc: 0.65119, LR: 0.00002, Time elapsed 0.08 mins
[[205  33]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 41.94it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.76129, roc_auc: 0.70860
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 10.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 42.89it/s]
Epoch 43 : Training Loss: 0.00000, acc: 0.67017, pr_auc: 0.71142, roc_auc: 0.65110, LR: 0.00002, Time elapsed 0.08 mins
[[205  33]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 41.06it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.76151, roc_auc: 0.70879
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 10.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 42.65it/s]
Epoch 44 : Training Loss: 0.00000, acc: 0.67017, pr_auc: 0.71132, roc_auc: 0.65094, LR: 0.00001, Time elapsed 0.08 mins
[[205  33]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 41.77it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.76163, roc_auc: 0.70892
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 10.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 42.33it/s]
Epoch 45 : Training Loss: 0.00000, acc: 0.67017, pr_auc: 0.71124, roc_auc: 0.65084, LR: 0.00001, Time elapsed 0.08 mins
[[205  33]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 41.54it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.76167, roc_auc: 0.70895
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 10.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 43.17it/s]
Epoch 46 : Training Loss: 0.00001, acc: 0.67017, pr_auc: 0.71114, roc_auc: 0.65067, LR: 0.00001, Time elapsed 0.08 mins
[[205  33]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 41.14it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.76170, roc_auc: 0.70898
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 43.48it/s]
Epoch 47 : Training Loss: 0.00001, acc: 0.67017, pr_auc: 0.71088, roc_auc: 0.65041, LR: 0.00000, Time elapsed 0.08 mins
[[205  33]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.86it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.76197, roc_auc: 0.70921
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 10.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 42.98it/s]
Epoch 48 : Training Loss: 0.00000, acc: 0.67017, pr_auc: 0.71088, roc_auc: 0.65040, LR: 0.00000, Time elapsed 0.08 mins
[[205  33]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 41.83it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.76198, roc_auc: 0.70921
[[280 188]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 10.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 40.95it/s]
Epoch 49 : Training Loss: 0.00001, acc: 0.67017, pr_auc: 0.71083, roc_auc: 0.65032, LR: 0.00000, Time elapsed 0.08 mins
[[205  33]
 [124 114]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 41.74it/s]
Val Evaluation: acc: 0.59348, pr_auc: 0.76199, roc_auc: 0.70922
[[280 188]
 [167 239]]
 78%|███████████████████████████████████████████████████████████████████████████████████▏                      | 40/51 [00:03<00:01, 10.73it/s]
Traceback (most recent call last):
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_main.py", line 170, in <module>
    main()
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_main.py", line 156, in main
    t.train_for_binaryclass()
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_trainer.py", line 179, in train_for_binaryclass
    loss.backward()
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/_tensor.py", line 647, in backward
    torch.autograd.backward(
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/autograd/__init__.py", line 354, in backward
    _engine_run_backward(
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/autograd/graph.py", line 829, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
