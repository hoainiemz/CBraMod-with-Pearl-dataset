3103 679 823
4605
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=19000, out_features=1000, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=200, out_features=1, bias=True)
    (8): Rearrange('b 1 -> (b 1)')
  )
)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:18<00:00, 10.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:03<00:00, 49.71it/s]
Epoch 1 : Training Loss: 0.49790, acc: 0.88813, pr_auc: 0.95783, roc_auc: 0.96306, LR: 0.00030, Time elapsed 0.38 mins
[[1484  167]
 [ 178 1274]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:00<00:00, 44.17it/s]
val Evaluation: acc: 0.45461, pr_auc: 0.57078, roc_auc: 0.49779
[[118 220]
 [150 191]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.45461, pr_auc: 0.57078, roc_auc: 0.49779
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:15<00:00, 12.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:04<00:00, 47.41it/s]
Epoch 2 : Training Loss: 0.24738, acc: 0.96030, pr_auc: 0.99312, roc_auc: 0.99391, LR: 0.00029, Time elapsed 0.33 mins
[[1587   64]
 [  59 1393]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 33.53it/s]
val Evaluation: acc: 0.54741, pr_auc: 0.52409, roc_auc: 0.56174
[[150 188]
 [119 222]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.54741, pr_auc: 0.52409, roc_auc: 0.56174
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 30.00it/s]
Epoch 3 : Training Loss: 0.15759, acc: 0.97905, pr_auc: 0.99783, roc_auc: 0.99791, LR: 0.00028, Time elapsed 0.45 mins
[[1600   51]
 [  16 1436]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 31.80it/s]
val Evaluation: acc: 0.57832, pr_auc: 0.57153, roc_auc: 0.56131
[[159 179]
 [107 234]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 29.85it/s]
Epoch 4 : Training Loss: 0.12701, acc: 0.98960, pr_auc: 0.99923, roc_auc: 0.99933, LR: 0.00027, Time elapsed 0.44 mins
[[1636   15]
 [  17 1435]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 29.54it/s]
val Evaluation: acc: 0.53996, pr_auc: 0.71344, roc_auc: 0.60641
[[141 197]
 [115 226]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.53996, pr_auc: 0.71344, roc_auc: 0.60641
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 30.69it/s]
Epoch 5 : Training Loss: 0.07422, acc: 0.99102, pr_auc: 0.99950, roc_auc: 0.99956, LR: 0.00026, Time elapsed 0.44 mins
[[1635   16]
 [  12 1440]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 30.63it/s]
val Evaluation: acc: 0.54440, pr_auc: 0.71220, roc_auc: 0.58794
[[144 194]
 [115 226]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 31.26it/s]
Epoch 6 : Training Loss: 0.05827, acc: 0.99525, pr_auc: 0.99987, roc_auc: 0.99988, LR: 0.00024, Time elapsed 0.44 mins
[[1641   10]
 [   5 1447]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 30.04it/s]
val Evaluation: acc: 0.57990, pr_auc: 0.77059, roc_auc: 0.64917
[[168 170]
 [115 226]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.57990, pr_auc: 0.77059, roc_auc: 0.64917
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 30.74it/s]
Epoch 7 : Training Loss: 0.04333, acc: 0.99784, pr_auc: 0.99998, roc_auc: 0.99998, LR: 0.00022, Time elapsed 0.45 mins
[[1645    6]
 [   1 1451]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 31.95it/s]
val Evaluation: acc: 0.51777, pr_auc: 0.65163, roc_auc: 0.54061
[[126 212]
 [115 226]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 29.84it/s]
Epoch 8 : Training Loss: 0.02560, acc: 0.99767, pr_auc: 0.99997, roc_auc: 0.99998, LR: 0.00020, Time elapsed 0.45 mins
[[1649    2]
 [   5 1447]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 31.49it/s]
val Evaluation: acc: 0.50184, pr_auc: 0.50635, roc_auc: 0.43197
[[141 197]
 [141 200]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 29.82it/s]
Epoch 9 : Training Loss: 0.01967, acc: 0.99784, pr_auc: 0.99997, roc_auc: 0.99998, LR: 0.00017, Time elapsed 0.44 mins
[[1645    6]
 [   1 1451]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 31.18it/s]
val Evaluation: acc: 0.53256, pr_auc: 0.66194, roc_auc: 0.54173
[[136 202]
 [115 226]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 30.83it/s]
Epoch 10 : Training Loss: 0.02105, acc: 0.99802, pr_auc: 0.99999, roc_auc: 0.99999, LR: 0.00015, Time elapsed 0.44 mins
[[1649    2]
 [   4 1448]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 30.40it/s]
val Evaluation: acc: 0.52235, pr_auc: 0.60872, roc_auc: 0.48030
[[140 198]
 [126 215]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 31.24it/s]
Epoch 11 : Training Loss: 0.00823, acc: 0.99897, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00013, Time elapsed 0.44 mins
[[1651    0]
 [   3 1449]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 30.43it/s]
val Evaluation: acc: 0.52535, pr_auc: 0.60693, roc_auc: 0.48165
[[145 193]
 [129 212]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 30.45it/s]
Epoch 12 : Training Loss: 0.00720, acc: 0.99966, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00010, Time elapsed 0.44 mins
[[1651    0]
 [   1 1451]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 32.72it/s]
val Evaluation: acc: 0.54889, pr_auc: 0.57527, roc_auc: 0.48102
[[151 187]
 [119 222]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 30.07it/s]
Epoch 13 : Training Loss: 0.00067, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00008, Time elapsed 0.45 mins
[[1651    0]
 [   0 1452]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 30.34it/s]
val Evaluation: acc: 0.53853, pr_auc: 0.60010, roc_auc: 0.48097
[[144 194]
 [119 222]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:19<00:00, 10.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 32.22it/s]
Epoch 14 : Training Loss: 0.00256, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00006, Time elapsed 0.42 mins
[[1651    0]
 [   0 1452]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 31.37it/s]
val Evaluation: acc: 0.54886, pr_auc: 0.62933, roc_auc: 0.50619
[[149 189]
 [117 224]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 31.27it/s]
Epoch 15 : Training Loss: 0.00053, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00004, Time elapsed 0.44 mins
[[1651    0]
 [   0 1452]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 33.78it/s]
val Evaluation: acc: 0.53852, pr_auc: 0.64821, roc_auc: 0.52005
[[143 195]
 [118 223]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 31.62it/s]
Epoch 16 : Training Loss: 0.00017, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00003, Time elapsed 0.45 mins
[[1651    0]
 [   0 1452]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 34.19it/s]
val Evaluation: acc: 0.53407, pr_auc: 0.64186, roc_auc: 0.51005
[[139 199]
 [117 224]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 30.26it/s]
Epoch 17 : Training Loss: 0.00001, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00002, Time elapsed 0.44 mins
[[1651    0]
 [   0 1452]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 29.30it/s]
val Evaluation: acc: 0.52968, pr_auc: 0.61159, roc_auc: 0.48366
[[140 198]
 [121 220]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 30.62it/s]
Epoch 18 : Training Loss: 0.00001, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00001, Time elapsed 0.44 mins
[[1651    0]
 [   0 1452]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 30.83it/s]
val Evaluation: acc: 0.53261, pr_auc: 0.61276, roc_auc: 0.48508
[[140 198]
 [119 222]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 31.82it/s]
Epoch 19 : Training Loss: 0.00001, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00000, Time elapsed 0.44 mins
[[1651    0]
 [   0 1452]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 29.18it/s]
val Evaluation: acc: 0.53261, pr_auc: 0.61194, roc_auc: 0.48473
[[140 198]
 [119 222]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 30.86it/s]
Epoch 20 : Training Loss: 0.00137, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00000, Time elapsed 0.45 mins
[[1651    0]
 [   0 1452]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 43/43 [00:01<00:00, 34.09it/s]
val Evaluation: acc: 0.53261, pr_auc: 0.61153, roc_auc: 0.48524
[[140 198]
 [119 222]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 52/52 [00:01<00:00, 30.29it/s]
***************************Test results************************
Test Evaluation: acc: 0.67018, pr_auc: 0.68004, roc_auc: 0.75689
[[344 110]
 [154 215]]
model save in ./data/wjq/models_weights/Big/BigFaced/epoch20_acc_0.67018_pr_0.68004_roc_0.75689.pth
[34m[1mwandb[0m: wandb.init() called while a run is active and reinit is set to 'default', so returning the previous run.
3090 705 810
4605
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=19000, out_features=1000, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=200, out_features=1, bias=True)
    (8): Rearrange('b 1 -> (b 1)')
  )
)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:21<00:00,  8.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 31.73it/s]
Epoch 1 : Training Loss: 0.47892, acc: 0.90619, pr_auc: 0.96222, roc_auc: 0.96802, LR: 0.00030, Time elapsed 0.46 mins
[[1411  208]
 [  87 1384]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:01<00:00, 29.93it/s]
val Evaluation: acc: 0.40211, pr_auc: 0.36043, roc_auc: 0.26756
[[ 85 269]
 [153 198]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.40211, pr_auc: 0.36043, roc_auc: 0.26756
  0%|                                                                                                                  | 0/194 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 1 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:21<00:00,  9.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 30.79it/s]
Epoch 2 : Training Loss: 0.17857, acc: 0.96472, pr_auc: 0.99326, roc_auc: 0.99435, LR: 0.00029, Time elapsed 0.46 mins
[[1551   68]
 [  42 1429]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:01<00:00, 31.91it/s]
val Evaluation: acc: 0.35442, pr_auc: 0.39373, roc_auc: 0.35934
[[141 213]
 [242 109]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.35442, pr_auc: 0.39373, roc_auc: 0.35934
  0%|                                                                                                                  | 0/194 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 2 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 29.84it/s]
Epoch 3 : Training Loss: 0.12470, acc: 0.98869, pr_auc: 0.99820, roc_auc: 0.99879, LR: 0.00028, Time elapsed 0.45 mins
[[1611    8]
 [  26 1445]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:01<00:00, 32.44it/s]
val Evaluation: acc: 0.30580, pr_auc: 0.38219, roc_auc: 0.34070
[[157 197]
 [292  59]]
  0%|                                                                                                                  | 0/194 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 3 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:20<00:00,  9.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 194/194 [00:06<00:00, 30.00it/s]
Epoch 4 : Training Loss: 0.08196, acc: 0.99101, pr_auc: 0.99855, roc_auc: 0.99859, LR: 0.00027, Time elapsed 0.44 mins
[[1602   17]
 [  11 1460]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 45/45 [00:01<00:00, 40.37it/s]
val Evaluation: acc: 0.51705, pr_auc: 0.49000, roc_auc: 0.51125
[[240 114]
 [226 125]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.51705, pr_auc: 0.49000, roc_auc: 0.51125
  0%|                                                                                                                  | 0/194 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 4 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
 22%|███████████████████████▎                                                                                 | 43/194 [00:03<00:13, 11.58it/s]
Traceback (most recent call last):
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_kfold_pearl.py", line 110, in <module>
    main()
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_kfold_pearl.py", line 86, in main
    acc_, pr_auc_, roc_auc_ = t.train_for_binaryclass()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_trainer_kfold.py", line 83, in train_for_binaryclass
    x = (x[0].cuda(), x[1].cuda())
                      ^^^^^^^^^^^
KeyboardInterrupt
Exception ignored in atexit callback: <function _start_and_connect_service.<locals>.teardown_atexit at 0x7a1cb00e7a60>
Traceback (most recent call last):
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/wandb/sdk/lib/service/service_connection.py", line 54, in teardown_atexit
    conn.teardown(hooks.exit_code)
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/wandb/sdk/lib/service/service_connection.py", line 182, in teardown
    self._router.join()
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/wandb/sdk/interface/router.py", line 75, in join
    self._thread.join()
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/threading.py", line 1149, in join
    self._wait_for_tstate_lock()
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/threading.py", line 1169, in _wait_for_tstate_lock
    if lock.acquire(block, timeout):
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt:
