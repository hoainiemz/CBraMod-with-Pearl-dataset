100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.71it/s]
Epoch 1 : Training Loss: 1.68395, acc: 0.20000, kappa: 0.00000, f1: 0.07609, LR: 0.00019, Time elapsed 0.26 mins
[[  4   1   0   0 145]
 [ 11   0   0   0 139]
 [  6   0   0   0 144]
 [  3   0   0   0 147]
 [  3   1   0   0 146]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.05it/s]
Epoch 2 : Training Loss: 1.64194, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00019, Time elapsed 0.25 mins
[[  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.67it/s]
Epoch 3 : Training Loss: 1.63332, acc: 0.24000, kappa: 0.05000, f1: 0.16027, LR: 0.00019, Time elapsed 0.26 mins
[[  0  92   1  11  46]
 [  0 111   2   1  36]
 [  0  76   2  11  61]
 [  0  88   2  13  47]
 [  0  85   2   9  54]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24000, kappa: 0.05000, f1: 0.16027
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.94it/s]
Epoch 4 : Training Loss: 1.60388, acc: 0.22133, kappa: 0.02667, f1: 0.17844, LR: 0.00019, Time elapsed 0.25 mins
[[37 48  0  2 63]
 [32 50  4  1 63]
 [28 41  7  3 71]
 [28 48  2  1 71]
 [35 40  1  3 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.75it/s]
Epoch 5 : Training Loss: 1.55877, acc: 0.30133, kappa: 0.12667, f1: 0.27976, LR: 0.00019, Time elapsed 0.26 mins
[[24 56  4 29 37]
 [16 86  3 14 31]
 [20 47 20 19 44]
 [17 46  5 34 48]
 [16 48  4 20 62]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.30133, kappa: 0.12667, f1: 0.27976
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.85it/s]
Epoch 6 : Training Loss: 1.45760, acc: 0.32933, kappa: 0.16167, f1: 0.32905, LR: 0.00018, Time elapsed 0.26 mins
[[42 36 21 25 26]
 [31 50 24 24 21]
 [18 16 55 17 44]
 [30 20 24 45 31]
 [25 22 24 24 55]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.32933, kappa: 0.16167, f1: 0.32905
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.95it/s]
Epoch 7 : Training Loss: 1.24642, acc: 0.37600, kappa: 0.22000, f1: 0.37337, LR: 0.00018, Time elapsed 0.26 mins
[[51 42 20 12 25]
 [26 66 18 13 27]
 [20 21 57  9 43]
 [26 24 28 40 32]
 [22 27 22 11 68]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.37600, kappa: 0.22000, f1: 0.37337
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.88it/s]
Epoch 8 : Training Loss: 0.99515, acc: 0.37067, kappa: 0.21333, f1: 0.36546, LR: 0.00018, Time elapsed 0.25 mins
[[44 28 24 19 35]
 [27 50 18 20 35]
 [21 15 57 17 40]
 [20 23 25 44 38]
 [20 16 20 11 83]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.81it/s]
Epoch 9 : Training Loss: 0.76353, acc: 0.40267, kappa: 0.25333, f1: 0.39918, LR: 0.00018, Time elapsed 0.26 mins
[[56 28 16 38 12]
 [25 59 26 29 11]
 [15 16 81 24 14]
 [25 23 23 65 14]
 [38 22 25 24 41]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.40267, kappa: 0.25333, f1: 0.39918
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.85it/s]
Epoch 10 : Training Loss: 0.64399, acc: 0.40533, kappa: 0.25667, f1: 0.40437, LR: 0.00017, Time elapsed 0.26 mins
[[58 19 19 29 25]
 [38 47 16 26 23]
 [23 13 68 20 26]
 [23 16 21 60 30]
 [24 20 18 17 71]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.40533, kappa: 0.25667, f1: 0.40437
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.83it/s]
Epoch 11 : Training Loss: 0.57534, acc: 0.39733, kappa: 0.24667, f1: 0.39453, LR: 0.00017, Time elapsed 0.26 mins
[[61 27 29 18 15]
 [35 48 32 16 19]
 [25  6 80 19 20]
 [19 21 36 53 21]
 [27 21 28 18 56]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.89it/s]
Epoch 12 : Training Loss: 0.54284, acc: 0.39200, kappa: 0.24000, f1: 0.39074, LR: 0.00016, Time elapsed 0.25 mins
[[69 31 16 22 12]
 [36 53 21 23 17]
 [24 23 52 22 29]
 [25 20 19 69 17]
 [31 28 12 28 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.86it/s]
Epoch 13 : Training Loss: 0.52076, acc: 0.41467, kappa: 0.26833, f1: 0.41507, LR: 0.00016, Time elapsed 0.25 mins
[[61 25 22 25 17]
 [29 54 21 21 25]
 [22 19 70 16 23]
 [20 30 15 64 21]
 [21 27 18 22 62]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.41467, kappa: 0.26833, f1: 0.41507
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.90it/s]
Epoch 14 : Training Loss: 0.49367, acc: 0.41200, kappa: 0.26500, f1: 0.41098, LR: 0.00016, Time elapsed 0.26 mins
[[73 26 25 17  9]
 [36 54 25 15 20]
 [28 11 70 16 25]
 [28 24 24 52 22]
 [40 16 18 16 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.81it/s]
Epoch 15 : Training Loss: 0.47684, acc: 0.41067, kappa: 0.26333, f1: 0.40992, LR: 0.00015, Time elapsed 0.26 mins
[[76 28 19 17 10]
 [37 59 22 17 15]
 [34 14 66 15 21]
 [31 25 18 52 24]
 [33 27 14 21 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.98it/s]
Epoch 16 : Training Loss: 0.46011, acc: 0.40133, kappa: 0.25167, f1: 0.40085, LR: 0.00015, Time elapsed 0.26 mins
[[69 30 24 19  8]
 [29 55 25 16 25]
 [22 17 62 21 28]
 [26 25 21 57 21]
 [24 22 22 24 58]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.50it/s]
Epoch 17 : Training Loss: 0.44405, acc: 0.42000, kappa: 0.27500, f1: 0.41796, LR: 0.00014, Time elapsed 0.26 mins
[[64 21 15 23 27]
 [27 52 21 19 31]
 [17 15 63 17 38]
 [22 23 20 55 30]
 [18 18 15 18 81]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42000, kappa: 0.27500, f1: 0.41796
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.16it/s]
Epoch 18 : Training Loss: 0.43215, acc: 0.40800, kappa: 0.26000, f1: 0.40797, LR: 0.00014, Time elapsed 0.26 mins
[[62 23 22 25 18]
 [30 56 22 17 25]
 [24 13 61 26 26]
 [19 24 21 66 20]
 [28 26 17 18 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.37it/s]
Epoch 19 : Training Loss: 0.42497, acc: 0.42267, kappa: 0.27833, f1: 0.42189, LR: 0.00013, Time elapsed 0.26 mins
[[68 19 22 25 16]
 [32 56 26 14 22]
 [19 12 74 18 27]
 [24 17 25 58 26]
 [32 24 19 14 61]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42267, kappa: 0.27833, f1: 0.42189
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.41it/s]
Epoch 20 : Training Loss: 0.41923, acc: 0.42800, kappa: 0.28500, f1: 0.42700, LR: 0.00012, Time elapsed 0.26 mins
[[65 18 23 29 15]
 [32 52 22 24 20]
 [19  9 73 27 22]
 [22 19 22 70 17]
 [29 16 21 23 61]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42800, kappa: 0.28500, f1: 0.42700
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.81it/s]
Epoch 21 : Training Loss: 0.41483, acc: 0.42400, kappa: 0.28000, f1: 0.42426, LR: 0.00012, Time elapsed 0.26 mins
[[66 22 20 28 14]
 [31 60 21 17 21]
 [21 18 65 20 26]
 [22 23 20 63 22]
 [30 23 15 18 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.65it/s]
Epoch 22 : Training Loss: 0.41214, acc: 0.42533, kappa: 0.28167, f1: 0.42497, LR: 0.00011, Time elapsed 0.26 mins
[[57 21 25 31 16]
 [30 58 22 19 21]
 [19 12 71 20 28]
 [22 17 21 70 20]
 [26 19 20 22 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.29it/s]
Epoch 23 : Training Loss: 0.41061, acc: 0.42533, kappa: 0.28167, f1: 0.42430, LR: 0.00011, Time elapsed 0.26 mins
[[65 20 22 30 13]
 [32 51 25 21 21]
 [19 14 67 20 30]
 [20 21 20 70 19]
 [24 21 17 22 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.61it/s]
Epoch 24 : Training Loss: 0.40907, acc: 0.42400, kappa: 0.28000, f1: 0.42292, LR: 0.00010, Time elapsed 0.26 mins
[[59 25 27 27 12]
 [31 55 24 20 20]
 [16 12 75 19 28]
 [20 19 24 68 19]
 [25 21 18 25 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.70it/s]
Epoch 25 : Training Loss: 0.40790, acc: 0.42933, kappa: 0.28667, f1: 0.42790, LR: 0.00010, Time elapsed 0.26 mins
[[65 24 24 22 15]
 [32 52 26 18 22]
 [17 10 76 23 24]
 [24 15 27 61 23]
 [25 17 17 23 68]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42933, kappa: 0.28667, f1: 0.42790
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.03it/s]
Epoch 26 : Training Loss: 0.40629, acc: 0.42000, kappa: 0.27500, f1: 0.41943, LR: 0.00009, Time elapsed 0.26 mins
[[63 24 24 27 12]
 [32 57 25 18 18]
 [19 12 71 21 27]
 [22 19 23 67 19]
 [27 21 17 28 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.96it/s]
Epoch 27 : Training Loss: 0.40553, acc: 0.40533, kappa: 0.25667, f1: 0.40521, LR: 0.00008, Time elapsed 0.25 mins
[[54 29 24 30 13]
 [32 56 21 19 22]
 [15 18 68 19 30]
 [21 22 21 65 21]
 [26 17 13 33 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.15it/s]
Epoch 28 : Training Loss: 0.40414, acc: 0.41467, kappa: 0.26833, f1: 0.41442, LR: 0.00008, Time elapsed 0.25 mins
[[59 26 22 27 16]
 [31 56 24 19 20]
 [15 19 67 19 30]
 [20 18 22 67 23]
 [27 18 13 30 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.00it/s]
Epoch 29 : Training Loss: 0.40479, acc: 0.41067, kappa: 0.26333, f1: 0.40943, LR: 0.00007, Time elapsed 0.25 mins
[[55 25 25 30 15]
 [33 53 25 19 20]
 [16 16 71 20 27]
 [21 18 20 72 19]
 [27 19 15 32 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.25it/s]
Epoch 30 : Training Loss: 0.40323, acc: 0.41467, kappa: 0.26833, f1: 0.41401, LR: 0.00007, Time elapsed 0.26 mins
[[61 27 23 25 14]
 [36 54 24 18 18]
 [18 15 71 19 27]
 [22 19 24 68 17]
 [28 17 16 32 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.04it/s]
Epoch 31 : Training Loss: 0.40275, acc: 0.42933, kappa: 0.28667, f1: 0.42898, LR: 0.00006, Time elapsed 0.26 mins
[[64 24 22 27 13]
 [33 55 24 19 19]
 [18 16 70 18 28]
 [23 18 21 69 19]
 [27 15 14 30 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.77it/s]
Epoch 32 : Training Loss: 0.40234, acc: 0.43067, kappa: 0.28833, f1: 0.43041, LR: 0.00006, Time elapsed 0.26 mins
[[63 22 25 28 12]
 [31 59 24 17 19]
 [15 17 74 18 26]
 [22 21 24 64 19]
 [27 19 12 29 63]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.43067, kappa: 0.28833, f1: 0.43041
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.03it/s]
Epoch 33 : Training Loss: 0.40172, acc: 0.42533, kappa: 0.28167, f1: 0.42493, LR: 0.00005, Time elapsed 0.25 mins
[[57 26 25 27 15]
 [30 60 23 17 20]
 [15 15 72 18 30]
 [20 21 24 64 21]
 [22 18 13 31 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.98it/s]
Epoch 34 : Training Loss: 0.40164, acc: 0.41067, kappa: 0.26333, f1: 0.40994, LR: 0.00004, Time elapsed 0.25 mins
[[56 24 29 27 14]
 [33 57 25 16 19]
 [15 17 73 18 27]
 [21 21 25 63 20]
 [26 19 18 28 59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.86it/s]
Epoch 35 : Training Loss: 0.40103, acc: 0.42533, kappa: 0.28167, f1: 0.42478, LR: 0.00004, Time elapsed 0.25 mins
[[61 25 25 25 14]
 [34 55 23 18 20]
 [16 12 75 19 28]
 [22 16 25 64 23]
 [28 17 12 29 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.09it/s]
Epoch 36 : Training Loss: 0.40072, acc: 0.41200, kappa: 0.26500, f1: 0.41162, LR: 0.00004, Time elapsed 0.25 mins
[[60 24 26 27 13]
 [35 53 23 20 19]
 [18 16 71 18 27]
 [23 17 25 64 21]
 [30 15 15 29 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.86it/s]
Epoch 37 : Training Loss: 0.40093, acc: 0.41333, kappa: 0.26667, f1: 0.41278, LR: 0.00003, Time elapsed 0.25 mins
[[57 27 25 29 12]
 [36 53 23 20 18]
 [16 13 73 20 28]
 [24 18 24 68 16]
 [29 15 14 33 59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.68it/s]
Epoch 38 : Training Loss: 0.40051, acc: 0.41333, kappa: 0.26667, f1: 0.41306, LR: 0.00003, Time elapsed 0.26 mins
[[58 27 25 28 12]
 [32 55 23 19 21]
 [16 16 71 19 28]
 [21 21 24 64 20]
 [28 18 12 30 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.87it/s]
Epoch 39 : Training Loss: 0.39979, acc: 0.41600, kappa: 0.27000, f1: 0.41589, LR: 0.00002, Time elapsed 0.25 mins
[[58 29 24 25 14]
 [33 57 24 17 19]
 [15 17 71 18 29]
 [23 21 23 65 18]
 [29 19 14 27 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.95it/s]
Epoch 40 : Training Loss: 0.39968, acc: 0.41333, kappa: 0.26667, f1: 0.41301, LR: 0.00002, Time elapsed 0.26 mins
[[58 28 23 27 14]
 [32 55 24 19 20]
 [16 15 71 20 28]
 [22 21 21 67 19]
 [31 17 14 29 59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.04it/s]
Epoch 41 : Training Loss: 0.39942, acc: 0.40667, kappa: 0.25833, f1: 0.40625, LR: 0.00002, Time elapsed 0.25 mins
[[53 29 26 27 15]
 [32 55 24 18 21]
 [15 16 72 19 28]
 [23 21 23 63 20]
 [29 19 13 27 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.88it/s]
Epoch 42 : Training Loss: 0.39963, acc: 0.41333, kappa: 0.26667, f1: 0.41293, LR: 0.00001, Time elapsed 0.25 mins
[[58 28 25 26 13]
 [31 55 24 19 21]
 [15 16 72 19 28]
 [22 20 22 65 21]
 [31 16 13 30 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.86it/s]
Epoch 43 : Training Loss: 0.39944, acc: 0.41067, kappa: 0.26333, f1: 0.41021, LR: 0.00001, Time elapsed 0.26 mins
[[56 28 26 28 12]
 [32 55 24 19 20]
 [16 15 72 19 28]
 [22 21 22 65 20]
 [28 17 14 31 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.83it/s]
Epoch 44 : Training Loss: 0.39910, acc: 0.40933, kappa: 0.26167, f1: 0.40886, LR: 0.00001, Time elapsed 0.25 mins
[[56 27 25 29 13]
 [32 55 24 19 20]
 [16 15 72 19 28]
 [22 21 22 64 21]
 [27 18 15 30 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.95it/s]
Epoch 45 : Training Loss: 0.39936, acc: 0.41867, kappa: 0.27333, f1: 0.41811, LR: 0.00001, Time elapsed 0.26 mins
[[58 26 25 27 14]
 [32 54 24 20 20]
 [16 15 72 19 28]
 [20 21 22 66 21]
 [26 16 12 32 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.04it/s]
Epoch 46 : Training Loss: 0.39938, acc: 0.41867, kappa: 0.27333, f1: 0.41807, LR: 0.00000, Time elapsed 0.25 mins
[[58 26 26 28 12]
 [32 55 24 18 21]
 [15 16 72 19 28]
 [20 19 23 67 21]
 [27 17 12 32 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.03it/s]
Epoch 47 : Training Loss: 0.39927, acc: 0.41867, kappa: 0.27333, f1: 0.41829, LR: 0.00000, Time elapsed 0.26 mins
[[59 26 25 25 15]
 [32 56 24 18 20]
 [16 15 72 19 28]
 [21 20 23 65 21]
 [27 17 12 32 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.14it/s]
Epoch 48 : Training Loss: 0.39891, acc: 0.41733, kappa: 0.27167, f1: 0.41685, LR: 0.00000, Time elapsed 0.25 mins
[[58 26 25 25 16]
 [32 55 24 18 21]
 [16 15 72 19 28]
 [21 20 23 65 21]
 [26 17 12 32 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.86it/s]
Epoch 49 : Training Loss: 0.39918, acc: 0.41733, kappa: 0.27167, f1: 0.41688, LR: 0.00000, Time elapsed 0.25 mins
[[59 26 25 25 15]
 [32 55 24 18 21]
 [16 15 72 19 28]
 [21 20 23 65 21]
 [27 17 12 32 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.69it/s]
Epoch 50 : Training Loss: 0.39903, acc: 0.41867, kappa: 0.27333, f1: 0.41827, LR: 0.00000, Time elapsed 0.25 mins
[[58 25 26 27 14]
 [32 56 24 18 20]
 [16 15 72 19 28]
 [21 20 23 65 21]
 [26 17 12 32 63]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.49it/s]
***************************Test results************************
Test Evaluation: acc: 0.44000, kappa: 0.30000, f1: 0.43924
[[65 23 20 16 26]
 [23 77 17 14 19]
 [22 26 61 15 26]
 [33 27 13 56 21]
 [24 24 15 16 71]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch32_acc_0.44000_kappa_0.30000_f1_0.43924.pth
[32m[I 2025-08-29 16:55:11,751][0m Trial 41 finished with value: 0.30000000000000004 and parameters: {'lr': 0.0001898794395661031, 'weight_decay': 0.002991324064234094, '--dropout': 0.18011039076294474, '--clip_value': 1.7311397125994081}. Best is trial 35 with value: 0.36.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.00021629502792802944, weight_decay=0.006243566538610468, optimizer='AdamW', clip_value=1.7880410296210014, dropout=0.17827077359651053, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.17827077359651053, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.17827077359651053, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
