100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.57it/s]
Epoch 1 : Training Loss: 1.69500, acc: 0.21600, kappa: 0.02000, f1: 0.12341, LR: 0.00018, Time elapsed 0.34 mins
[[ 0 74  0  0 76]
 [ 0 84  0  0 66]
 [ 0 78  0  0 72]
 [ 0 84  0  0 66]
 [ 0 72  0  0 78]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21600, kappa: 0.02000, f1: 0.12341
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.55it/s]
Epoch 2 : Training Loss: 1.62877, acc: 0.21600, kappa: 0.02000, f1: 0.16517, LR: 0.00018, Time elapsed 0.32 mins
[[12 13 48  2 75]
 [12 14 48  0 76]
 [ 5 11 51  2 81]
 [ 5 12 60  0 73]
 [ 4  8 53  0 85]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.38it/s]
Epoch 3 : Training Loss: 1.61703, acc: 0.23067, kappa: 0.03833, f1: 0.15581, LR: 0.00017, Time elapsed 0.34 mins
[[  4  28   9   2 107]
 [  9  38  14   0  89]
 [  1  24  10   0 115]
 [  4  18  12   1 115]
 [  5  17   8   0 120]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23067, kappa: 0.03833, f1: 0.15581
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.39it/s]
Epoch 4 : Training Loss: 1.60210, acc: 0.24533, kappa: 0.05667, f1: 0.18392, LR: 0.00017, Time elapsed 0.32 mins
[[ 12  21   3  13 101]
 [  8  34   2   8  98]
 [  2  30   2   3 113]
 [  4  21   1  16 108]
 [  6  13   4   7 120]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24533, kappa: 0.05667, f1: 0.18392
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.17it/s]
Epoch 5 : Training Loss: 1.56009, acc: 0.29067, kappa: 0.11333, f1: 0.27461, LR: 0.00017, Time elapsed 0.32 mins
[[14 40  9 62 25]
 [26 58  8 43 15]
 [ 9 28 34 62 17]
 [15 33 11 79 12]
 [ 5 31 14 67 33]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.29067, kappa: 0.11333, f1: 0.27461
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.65it/s]
Epoch 6 : Training Loss: 1.47705, acc: 0.32267, kappa: 0.15333, f1: 0.30989, LR: 0.00017, Time elapsed 0.34 mins
[[17 26 43 35 29]
 [12 55 46 20 17]
 [10 18 72 31 19]
 [13 26 39 59 13]
 [11 18 56 26 39]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.32267, kappa: 0.15333, f1: 0.30989
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.37it/s]
Epoch 7 : Training Loss: 1.33309, acc: 0.36400, kappa: 0.20500, f1: 0.35595, LR: 0.00017, Time elapsed 0.33 mins
[[26 17 23 53 31]
 [18 45 13 52 22]
 [11 12 62 39 26]
 [14 13 15 82 26]
 [14 18 19 41 58]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.36400, kappa: 0.20500, f1: 0.35595
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.31it/s]
Epoch 8 : Training Loss: 1.13237, acc: 0.36933, kappa: 0.21167, f1: 0.36482, LR: 0.00017, Time elapsed 0.33 mins
[[64 20  9 29 28]
 [37 49 12 24 28]
 [28 17 34 24 47]
 [31 25  8 61 25]
 [36 19  7 19 69]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.36933, kappa: 0.21167, f1: 0.36482
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.41it/s]
Epoch 9 : Training Loss: 0.89692, acc: 0.40800, kappa: 0.26000, f1: 0.40384, LR: 0.00016, Time elapsed 0.34 mins
[[81  5 20 28 16]
 [42 39 27 26 16]
 [32  8 66 21 23]
 [38 11 23 66 12]
 [44 15 19 18 54]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.40800, kappa: 0.26000, f1: 0.40384
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.01it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.54it/s]
Epoch 10 : Training Loss: 0.73781, acc: 0.40533, kappa: 0.25667, f1: 0.40327, LR: 0.00016, Time elapsed 0.31 mins
[[81 16 14 20 19]
 [43 46 20 27 14]
 [30 13 63 24 20]
 [33 27 13 63 14]
 [41 20 14 24 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.48it/s]
Epoch 11 : Training Loss: 0.61589, acc: 0.42667, kappa: 0.28333, f1: 0.42584, LR: 0.00016, Time elapsed 0.35 mins
[[58 21 23 29 19]
 [21 54 26 29 20]
 [16 12 72 26 24]
 [29 20 17 64 20]
 [22 21 19 16 72]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42667, kappa: 0.28333, f1: 0.42584
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.70it/s]
Epoch 12 : Training Loss: 0.55333, acc: 0.41867, kappa: 0.27333, f1: 0.41869, LR: 0.00015, Time elapsed 0.33 mins
[[55 25 24 21 25]
 [23 57 27 23 20]
 [24 13 70 10 33]
 [26 18 21 65 20]
 [27 20 18 18 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.27it/s]
Epoch 13 : Training Loss: 0.51332, acc: 0.44400, kappa: 0.30500, f1: 0.44532, LR: 0.00015, Time elapsed 0.30 mins
[[71 23 22 16 18]
 [32 55 21 22 20]
 [30 14 71 13 22]
 [28 21 15 71 15]
 [39 17 17 12 65]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.44400, kappa: 0.30500, f1: 0.44532
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.34it/s]
Epoch 14 : Training Loss: 0.48792, acc: 0.42533, kappa: 0.28167, f1: 0.42479, LR: 0.00014, Time elapsed 0.33 mins
[[61 16 28 17 28]
 [24 53 29 24 20]
 [24 14 66 11 35]
 [22 23 20 64 21]
 [29 21 13 12 75]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.59it/s]
Epoch 15 : Training Loss: 0.46869, acc: 0.45067, kappa: 0.31333, f1: 0.45002, LR: 0.00014, Time elapsed 0.33 mins
[[58 27 17 26 22]
 [26 65 20 20 19]
 [21 20 60 14 35]
 [26 22 10 71 21]
 [22 24  6 14 84]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.45067, kappa: 0.31333, f1: 0.45002
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.30it/s]
Epoch 16 : Training Loss: 0.45684, acc: 0.44000, kappa: 0.30000, f1: 0.43864, LR: 0.00014, Time elapsed 0.33 mins
[[52 20 19 33 26]
 [26 57 25 26 16]
 [21 16 67 22 24]
 [23 19 10 84 14]
 [28 20  9 23 70]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.49it/s]
Epoch 17 : Training Loss: 0.44674, acc: 0.44667, kappa: 0.30833, f1: 0.44448, LR: 0.00013, Time elapsed 0.33 mins
[[69 10 25 24 22]
 [33 47 27 25 18]
 [25 10 81 12 22]
 [32 16 20 64 18]
 [31 12 20 13 74]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.01it/s]
Epoch 18 : Training Loss: 0.43625, acc: 0.45333, kappa: 0.31667, f1: 0.45219, LR: 0.00013, Time elapsed 0.33 mins
[[57 19 31 26 17]
 [31 54 23 27 15]
 [21  9 83 15 22]
 [26 17 22 72 13]
 [26 16 17 17 74]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.45333, kappa: 0.31667, f1: 0.45219
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.76it/s]
Epoch 19 : Training Loss: 0.42985, acc: 0.45867, kappa: 0.32333, f1: 0.45824, LR: 0.00012, Time elapsed 0.33 mins
[[63 18 23 25 21]
 [28 59 24 22 17]
 [22 12 74 13 29]
 [25 24 11 69 21]
 [21 17 11 22 79]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.45867, kappa: 0.32333, f1: 0.45824
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.52it/s]
Epoch 20 : Training Loss: 0.42040, acc: 0.48267, kappa: 0.35333, f1: 0.47989, LR: 0.00012, Time elapsed 0.33 mins
[[55 18 25 26 26]
 [24 61 21 22 22]
 [21  8 79 14 28]
 [18 17 14 78 23]
 [17  9 15 20 89]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.48267, kappa: 0.35333, f1: 0.47989
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.91it/s]
Epoch 21 : Training Loss: 0.41508, acc: 0.44267, kappa: 0.30333, f1: 0.44317, LR: 0.00011, Time elapsed 0.34 mins
[[54 24 30 19 23]
 [22 67 25 15 21]
 [28 14 71  9 28]
 [26 20 17 63 24]
 [30 16 10 17 77]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.61it/s]
Epoch 22 : Training Loss: 0.41127, acc: 0.46667, kappa: 0.33333, f1: 0.46418, LR: 0.00011, Time elapsed 0.33 mins
[[50 21 30 26 23]
 [14 69 21 24 22]
 [16 16 83 12 23]
 [23 24 14 76 13]
 [23 14 20 21 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.62it/s]
Epoch 23 : Training Loss: 0.40781, acc: 0.47200, kappa: 0.34000, f1: 0.47176, LR: 0.00010, Time elapsed 0.33 mins
[[70 17 23 22 18]
 [24 61 23 20 22]
 [23 14 73 13 27]
 [24 20 14 73 19]
 [26 13 15 19 77]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.40it/s]
Epoch 24 : Training Loss: 0.40438, acc: 0.46800, kappa: 0.33500, f1: 0.46853, LR: 0.00009, Time elapsed 0.33 mins
[[64 20 25 22 19]
 [21 67 23 22 17]
 [24 11 74 16 25]
 [27 21 12 75 15]
 [27 19 11 22 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.30it/s]
Epoch 25 : Training Loss: 0.40255, acc: 0.46267, kappa: 0.32833, f1: 0.46325, LR: 0.00009, Time elapsed 0.33 mins
[[63 19 29 21 18]
 [20 66 23 24 17]
 [24 10 80 15 21]
 [34 17 13 70 16]
 [27 16 19 20 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.41it/s]
Epoch 26 : Training Loss: 0.40119, acc: 0.45867, kappa: 0.32333, f1: 0.45891, LR: 0.00008, Time elapsed 0.33 mins
[[58 22 27 22 21]
 [20 68 24 22 16]
 [23 10 71 18 28]
 [29 16 12 73 20]
 [24 19 13 20 74]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.16it/s]
Epoch 27 : Training Loss: 0.40023, acc: 0.46533, kappa: 0.33167, f1: 0.46621, LR: 0.00008, Time elapsed 0.33 mins
[[63 24 20 23 20]
 [22 69 22 20 17]
 [23 11 73 15 28]
 [30 17 13 72 18]
 [26 16 14 22 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.09it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.46it/s]
Epoch 28 : Training Loss: 0.39956, acc: 0.46267, kappa: 0.32833, f1: 0.46316, LR: 0.00007, Time elapsed 0.30 mins
[[63 20 23 24 20]
 [25 64 19 24 18]
 [20 12 72 17 29]
 [27 15 12 76 20]
 [27 15 14 22 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.35it/s]
Epoch 29 : Training Loss: 0.39858, acc: 0.46933, kappa: 0.33667, f1: 0.47052, LR: 0.00007, Time elapsed 0.33 mins
[[64 21 23 22 20]
 [22 70 20 20 18]
 [23 10 73 16 28]
 [29 17 11 74 19]
 [29 16 14 20 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.07it/s]
Epoch 30 : Training Loss: 0.39775, acc: 0.47200, kappa: 0.34000, f1: 0.47152, LR: 0.00006, Time elapsed 0.34 mins
[[56 23 29 22 20]
 [18 71 24 18 19]
 [21 11 77 14 27]
 [22 17 15 77 19]
 [26 16 13 22 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.08it/s]
Epoch 31 : Training Loss: 0.39761, acc: 0.45733, kappa: 0.32167, f1: 0.45714, LR: 0.00006, Time elapsed 0.31 mins
[[58 22 27 25 18]
 [21 65 24 22 18]
 [20 12 73 14 31]
 [27 16 13 75 19]
 [24 17 14 23 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.63it/s]
Epoch 32 : Training Loss: 0.39740, acc: 0.47467, kappa: 0.34333, f1: 0.47540, LR: 0.00005, Time elapsed 0.34 mins
[[64 23 22 21 20]
 [22 71 18 20 19]
 [20 13 71 14 32]
 [30 17 11 74 18]
 [24 18 10 22 76]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.10it/s]
Epoch 33 : Training Loss: 0.39714, acc: 0.46667, kappa: 0.33333, f1: 0.46769, LR: 0.00005, Time elapsed 0.33 mins
[[65 22 23 20 20]
 [22 68 23 16 21]
 [24 12 71 12 31]
 [32 15 11 72 20]
 [24 18 12 22 74]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.30it/s]
Epoch 34 : Training Loss: 0.39669, acc: 0.45600, kappa: 0.32000, f1: 0.45674, LR: 0.00004, Time elapsed 0.33 mins
[[61 22 25 22 20]
 [26 63 20 21 20]
 [24 10 71 15 30]
 [30 15 14 72 19]
 [26 16 14 19 75]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.35it/s]
Epoch 35 : Training Loss: 0.39645, acc: 0.47200, kappa: 0.34000, f1: 0.47199, LR: 0.00004, Time elapsed 0.33 mins
[[62 20 28 21 19]
 [22 64 24 20 20]
 [22  9 75 13 31]
 [27 16 12 75 20]
 [24 16 12 20 78]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.35it/s]
Epoch 36 : Training Loss: 0.39586, acc: 0.47333, kappa: 0.34167, f1: 0.47422, LR: 0.00003, Time elapsed 0.33 mins
[[64 23 24 19 20]
 [22 68 22 19 19]
 [23  9 77 14 27]
 [28 16 15 72 19]
 [29 16 13 18 74]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.40it/s]
Epoch 37 : Training Loss: 0.39608, acc: 0.46533, kappa: 0.33167, f1: 0.46599, LR: 0.00003, Time elapsed 0.32 mins
[[61 23 23 21 22]
 [21 68 21 22 18]
 [22 10 72 14 32]
 [28 16 12 73 21]
 [26 18 11 20 75]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.60it/s]
Epoch 38 : Training Loss: 0.39557, acc: 0.46400, kappa: 0.33000, f1: 0.46453, LR: 0.00002, Time elapsed 0.34 mins
[[61 22 23 23 21]
 [21 67 22 22 18]
 [23 10 71 14 32]
 [27 14 13 76 20]
 [26 19 11 21 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.45it/s]
Epoch 39 : Training Loss: 0.39538, acc: 0.46667, kappa: 0.33333, f1: 0.46692, LR: 0.00002, Time elapsed 0.30 mins
[[61 21 24 23 21]
 [20 68 22 23 17]
 [21 10 72 15 32]
 [26 16 12 76 20]
 [25 19 12 21 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.80it/s]
Epoch 40 : Training Loss: 0.39552, acc: 0.46133, kappa: 0.32667, f1: 0.46177, LR: 0.00002, Time elapsed 0.32 mins
[[57 22 24 26 21]
 [19 71 21 21 18]
 [21 10 72 14 33]
 [28 16 13 74 19]
 [26 17 13 22 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.41it/s]
Epoch 41 : Training Loss: 0.39513, acc: 0.46800, kappa: 0.33500, f1: 0.46791, LR: 0.00001, Time elapsed 0.33 mins
[[60 22 25 23 20]
 [20 67 24 20 19]
 [21 10 74 14 31]
 [26 16 13 77 18]
 [23 18 13 23 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.64it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.86it/s]
Epoch 42 : Training Loss: 0.39499, acc: 0.46667, kappa: 0.33333, f1: 0.46724, LR: 0.00001, Time elapsed 0.34 mins
[[61 22 24 22 21]
 [22 67 22 21 18]
 [22 10 74 14 30]
 [27 16 12 76 19]
 [27 16 14 21 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.29it/s]
Epoch 43 : Training Loss: 0.39509, acc: 0.46800, kappa: 0.33500, f1: 0.46857, LR: 0.00001, Time elapsed 0.33 mins
[[61 22 26 20 21]
 [22 67 23 20 18]
 [22 10 76 14 28]
 [28 15 14 75 18]
 [27 16 14 21 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.20it/s]
Epoch 44 : Training Loss: 0.39505, acc: 0.46400, kappa: 0.33000, f1: 0.46419, LR: 0.00001, Time elapsed 0.33 mins
[[60 23 24 22 21]
 [23 66 23 20 18]
 [22 10 73 15 30]
 [26 16 13 76 19]
 [24 18 13 22 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.28it/s]
Epoch 45 : Training Loss: 0.39494, acc: 0.46933, kappa: 0.33667, f1: 0.46975, LR: 0.00001, Time elapsed 0.34 mins
[[61 23 24 21 21]
 [22 69 20 21 18]
 [22 10 72 15 31]
 [26 16 12 76 20]
 [24 16 14 22 74]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.20it/s]
Epoch 46 : Training Loss: 0.39479, acc: 0.46533, kappa: 0.33167, f1: 0.46591, LR: 0.00000, Time elapsed 0.34 mins
[[61 23 24 21 21]
 [22 67 21 21 19]
 [22 10 73 14 31]
 [27 16 12 75 20]
 [26 16 14 21 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.18it/s]
Epoch 47 : Training Loss: 0.39461, acc: 0.46667, kappa: 0.33333, f1: 0.46719, LR: 0.00000, Time elapsed 0.35 mins
[[61 23 24 21 21]
 [20 69 21 22 18]
 [22 10 72 15 31]
 [27 16 12 75 20]
 [26 16 14 21 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.46it/s]
Epoch 48 : Training Loss: 0.39465, acc: 0.46133, kappa: 0.32667, f1: 0.46176, LR: 0.00000, Time elapsed 0.33 mins
[[61 23 24 21 21]
 [20 67 22 22 19]
 [21 10 72 15 32]
 [27 16 13 73 21]
 [26 16 14 21 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.39it/s]
Epoch 49 : Training Loss: 0.39471, acc: 0.46400, kappa: 0.33000, f1: 0.46449, LR: 0.00000, Time elapsed 0.32 mins
[[61 23 24 21 21]
 [20 68 21 22 19]
 [22 10 72 15 31]
 [27 16 13 74 20]
 [26 16 14 21 73]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.89it/s]
Epoch 50 : Training Loss: 0.39453, acc: 0.46400, kappa: 0.33000, f1: 0.46449, LR: 0.00000, Time elapsed 0.35 mins
[[61 23 24 21 21]
 [20 68 21 22 19]
 [22 10 72 15 31]
 [27 16 13 74 20]
 [26 16 14 21 73]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.22it/s]
***************************Test results************************
Test Evaluation: acc: 0.48667, kappa: 0.35833, f1: 0.48675
[[71 18 10 22 29]
 [23 69 18 19 21]
 [19 13 70 19 29]
 [22 16 19 76 17]
 [18 16 18 19 79]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch20_acc_0.48667_kappa_0.35833_f1_0.48675.pth
[32m[I 2025-08-29 01:29:34,518][0m Trial 3 finished with value: 0.3583333333333333 and parameters: {'lr': 0.0001764971584817573, 'weight_decay': 9.948901058090736e-06, '--dropout': 0.03636499344142013, '--clip_value': 0.7751067647801507}. Best is trial 3 with value: 0.3583333333333333.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=6.624310605949985e-06, weight_decay=0.00029229052129200957, optimizer='AdamW', clip_value=0.9368437102970628, dropout=0.08638900372842316, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.08638900372842316, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.08638900372842316, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
