3554 1051
4605
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=19000, out_features=1000, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=200, out_features=1, bias=True)
    (8): Rearrange('b 1 -> (b 1)')
  )
)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:06<00:00,  8.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 45.53it/s]
Epoch 1 : Training Loss: 0.51704, acc: 0.85175, pr_auc: 0.93984, roc_auc: 0.94449, LR: 0.00030, Time elapsed 0.13 mins
[[1638  217]
 [ 305 1394]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 46.16it/s]
Test Evaluation: acc: 0.59301, pr_auc: 0.48046, roc_auc: 0.56026
[[451 137]
 [269 194]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.21it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.94it/s]
Epoch 2 : Training Loss: 0.27788, acc: 0.93488, pr_auc: 0.98699, roc_auc: 0.98741, LR: 0.00029, Time elapsed 0.10 mins
[[1680  175]
 [  61 1638]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.50it/s]
Test Evaluation: acc: 0.58772, pr_auc: 0.47092, roc_auc: 0.56923
[[300 288]
 [155 308]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.09it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.70it/s]
Epoch 3 : Training Loss: 0.14467, acc: 0.97329, pr_auc: 0.99727, roc_auc: 0.99735, LR: 0.00028, Time elapsed 0.10 mins
[[1781   74]
 [  23 1676]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.79it/s]
Test Evaluation: acc: 0.53267, pr_auc: 0.40896, roc_auc: 0.47559
[[234 354]
 [154 309]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.11it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.60it/s]
Epoch 4 : Training Loss: 0.10711, acc: 0.96523, pr_auc: 0.99519, roc_auc: 0.99565, LR: 0.00027, Time elapsed 0.10 mins
[[1833   22]
 [  98 1601]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.14it/s]
Test Evaluation: acc: 0.53271, pr_auc: 0.45437, roc_auc: 0.49561
[[295 293]
 [202 261]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 11.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.19it/s]
Epoch 5 : Training Loss: 0.09330, acc: 0.96564, pr_auc: 0.99465, roc_auc: 0.99444, LR: 0.00026, Time elapsed 0.10 mins
[[1757   98]
 [  27 1672]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.32it/s]
Test Evaluation: acc: 0.49769, pr_auc: 0.52262, roc_auc: 0.54444
[[170 418]
 [136 327]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.01it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.48it/s]
Epoch 6 : Training Loss: 0.05750, acc: 0.98578, pr_auc: 0.99861, roc_auc: 0.99877, LR: 0.00024, Time elapsed 0.10 mins
[[1823   32]
 [  19 1680]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.25it/s]
Test Evaluation: acc: 0.56051, pr_auc: 0.49038, roc_auc: 0.51280
[[315 273]
 [192 271]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 11.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.75it/s]
Epoch 7 : Training Loss: 0.04837, acc: 0.99448, pr_auc: 0.99981, roc_auc: 0.99983, LR: 0.00022, Time elapsed 0.10 mins
[[1852    3]
 [  16 1683]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.63it/s]
Test Evaluation: acc: 0.53221, pr_auc: 0.51254, roc_auc: 0.52522
[[236 352]
 [156 307]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.20it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.90it/s]
Epoch 8 : Training Loss: 0.02540, acc: 0.99662, pr_auc: 0.99993, roc_auc: 0.99994, LR: 0.00020, Time elapsed 0.10 mins
[[1849    6]
 [   6 1693]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.13it/s]
Test Evaluation: acc: 0.44336, pr_auc: 0.40781, roc_auc: 0.42102
[[115 473]
 [143 320]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.59it/s]
Epoch 9 : Training Loss: 0.02206, acc: 0.99711, pr_auc: 0.99988, roc_auc: 0.99990, LR: 0.00017, Time elapsed 0.10 mins
[[1853    2]
 [   8 1691]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 46.80it/s]
Test Evaluation: acc: 0.54721, pr_auc: 0.43624, roc_auc: 0.47750
[[293 295]
 [187 276]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 11.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.16it/s]
Epoch 10 : Training Loss: 0.01099, acc: 0.99973, pr_auc: 0.99998, roc_auc: 0.99998, LR: 0.00015, Time elapsed 0.10 mins
[[1854    1]
 [   0 1699]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 46.38it/s]
Test Evaluation: acc: 0.50283, pr_auc: 0.45523, roc_auc: 0.46099
[[237 351]
 [184 279]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.52it/s]
Epoch 11 : Training Loss: 0.00955, acc: 0.99946, pr_auc: 0.99999, roc_auc: 0.99999, LR: 0.00013, Time elapsed 0.10 mins
[[1853    2]
 [   0 1699]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.03it/s]
Test Evaluation: acc: 0.43527, pr_auc: 0.47261, roc_auc: 0.44794
[[122 466]
 [156 307]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:05<00:00, 11.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 45.31it/s]
Epoch 12 : Training Loss: 0.00750, acc: 0.99973, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00010, Time elapsed 0.11 mins
[[1854    1]
 [   0 1699]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 45.68it/s]
Test Evaluation: acc: 0.44337, pr_auc: 0.43881, roc_auc: 0.42431
[[162 426]
 [180 283]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 11.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 45.30it/s]
Epoch 13 : Training Loss: 0.00238, acc: 0.99892, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00008, Time elapsed 0.10 mins
[[1851    4]
 [   0 1699]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 45.26it/s]
Test Evaluation: acc: 0.46538, pr_auc: 0.54024, roc_auc: 0.49387
[[132 456]
 [136 327]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 11.26it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 45.31it/s]
Epoch 14 : Training Loss: 0.00355, acc: 0.99946, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00006, Time elapsed 0.10 mins
[[1853    2]
 [   0 1699]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 45.01it/s]
Test Evaluation: acc: 0.49105, pr_auc: 0.54707, roc_auc: 0.53335
[[166 422]
 [139 324]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 11.64it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.49it/s]
Epoch 15 : Training Loss: 0.00241, acc: 0.99973, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00004, Time elapsed 0.10 mins
[[1854    1]
 [   0 1699]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.02it/s]
Test Evaluation: acc: 0.53644, pr_auc: 0.49727, roc_auc: 0.51191
[[227 361]
 [145 318]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 11.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.09it/s]
Epoch 16 : Training Loss: 0.00031, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00003, Time elapsed 0.10 mins
[[1855    0]
 [   0 1699]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 45.90it/s]
Test Evaluation: acc: 0.52362, pr_auc: 0.50134, roc_auc: 0.50949
[[217 371]
 [149 314]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 11.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.14it/s]
Epoch 17 : Training Loss: 0.00022, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00002, Time elapsed 0.10 mins
[[1855    0]
 [   0 1699]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 46.04it/s]
Test Evaluation: acc: 0.49110, pr_auc: 0.49818, roc_auc: 0.49893
[[194 394]
 [161 302]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.06it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.08it/s]
Epoch 18 : Training Loss: 0.00012, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00001, Time elapsed 0.10 mins
[[1855    0]
 [   0 1699]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 46.25it/s]
Test Evaluation: acc: 0.48138, pr_auc: 0.49001, roc_auc: 0.49023
[[194 394]
 [170 293]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.03it/s]
Epoch 19 : Training Loss: 0.00031, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00000, Time elapsed 0.10 mins
[[1855    0]
 [   0 1699]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 46.44it/s]
Test Evaluation: acc: 0.47651, pr_auc: 0.48849, roc_auc: 0.48583
[[187 401]
 [169 294]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.13it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.14it/s]
Epoch 20 : Training Loss: 0.00021, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00000, Time elapsed 0.10 mins
[[1855    0]
 [   0 1699]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 46.45it/s]
Test Evaluation: acc: 0.48639, pr_auc: 0.49049, roc_auc: 0.48961
[[191 397]
 [163 300]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.00it/s]
***************************Test results************************
Test Evaluation: acc: 0.48639, pr_auc: 0.49049, roc_auc: 0.48961
[[191 397]
 [163 300]]
model save in ./data/wjq/models_weights/Big/BigFaced/epoch20_acc_0.48639_pr_0.49049_roc_0.48961.pth
[34m[1mwandb[0m: wandb.init() called while a run is active and reinit is set to 'default', so returning the previous run.
7122 2088
9210
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=19000, out_features=1000, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1, inplace=False)
    (7): Linear(in_features=200, out_features=1, bias=True)
    (8): Rearrange('b 1 -> (b 1)')
  )
)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 46.20it/s]
Epoch 1 : Training Loss: 0.43721, acc: 0.86086, pr_auc: 0.96225, roc_auc: 0.96749, LR: 0.00030, Time elapsed 0.20 mins
[[3557  169]
 [ 791 2605]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 44.94it/s]
Test Evaluation: acc: 0.75765, pr_auc: 0.84917, roc_auc: 0.87495
[[1019  141]
 [ 337  591]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 1 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 45.79it/s]
Epoch 2 : Training Loss: 0.18261, acc: 0.96956, pr_auc: 0.99668, roc_auc: 0.99680, LR: 0.00029, Time elapsed 0.20 mins
[[3554  172]
 [  50 3346]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 45.83it/s]
Test Evaluation: acc: 0.93793, pr_auc: 0.98860, roc_auc: 0.98952
[[1046  114]
 [  24  904]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 2 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 46.16it/s]
Epoch 3 : Training Loss: 0.08742, acc: 0.98007, pr_auc: 0.99773, roc_auc: 0.99809, LR: 0.00028, Time elapsed 0.20 mins
[[3617  109]
 [  36 3360]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 46.00it/s]
Test Evaluation: acc: 0.95539, pr_auc: 0.99241, roc_auc: 0.99415
[[1069   91]
 [  10  918]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 3 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 45.17it/s]
Epoch 4 : Training Loss: 0.07972, acc: 0.97987, pr_auc: 0.99721, roc_auc: 0.99744, LR: 0.00027, Time elapsed 0.21 mins
[[3644   82]
 [  62 3334]]
  0%|                                                                                                                   | 0/33 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 4 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 45.48it/s]
Test Evaluation: acc: 0.95280, pr_auc: 0.98666, roc_auc: 0.98890
[[1098   62]
 [  38  890]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 45.18it/s]
Epoch 5 : Training Loss: 0.05201, acc: 0.99657, pr_auc: 0.99993, roc_auc: 0.99993, LR: 0.00026, Time elapsed 0.20 mins
[[3707   19]
 [   6 3390]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 45.31it/s]
Test Evaluation: acc: 0.99138, pr_auc: 0.99953, roc_auc: 0.99959
[[1145   15]
 [   4  924]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 5 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 46.07it/s]
Epoch 6 : Training Loss: 0.03016, acc: 0.99765, pr_auc: 0.99995, roc_auc: 0.99995, LR: 0.00024, Time elapsed 0.20 mins
[[3714   12]
 [   5 3391]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 45.80it/s]
Test Evaluation: acc: 0.99515, pr_auc: 0.99989, roc_auc: 0.99991
[[1150   10]
 [   1  927]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 6 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 45.38it/s]
Epoch 7 : Training Loss: 0.02175, acc: 0.99640, pr_auc: 0.99968, roc_auc: 0.99976, LR: 0.00022, Time elapsed 0.20 mins
[[3720    6]
 [  19 3377]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 45.71it/s]
Test Evaluation: acc: 0.99558, pr_auc: 0.99897, roc_auc: 0.99937
[[1156    4]
 [   5  923]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 7 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 45.11it/s]
Epoch 8 : Training Loss: 0.01233, acc: 0.99987, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00020, Time elapsed 0.20 mins
[[3725    1]
 [   0 3396]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 45.00it/s]
Test Evaluation: acc: 0.99957, pr_auc: 1.00000, roc_auc: 1.00000
[[1159    1]
 [   0  928]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 8 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 44.60it/s]
Epoch 9 : Training Loss: 0.01321, acc: 0.99958, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00017, Time elapsed 0.20 mins
[[3724    2]
 [   1 3395]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 44.72it/s]
Test Evaluation: acc: 0.99860, pr_auc: 0.99999, roc_auc: 0.99999
[[1158    2]
 [   1  927]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 9 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 44.71it/s]
Epoch 10 : Training Loss: 0.00569, acc: 0.99987, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00015, Time elapsed 0.20 mins
[[3725    1]
 [   0 3396]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 44.77it/s]
Test Evaluation: acc: 0.99957, pr_auc: 1.00000, roc_auc: 1.00000
[[1159    1]
 [   0  928]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 10 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
 36%|█████████████████████████████████████▌                                                                   | 40/112 [00:03<00:06, 11.71it/s]
Traceback (most recent call last):
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_kfold_pearl.py", line 105, in <module>
    main()
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_kfold_pearl.py", line 81, in main
    acc_, pr_auc_, roc_auc_ = t.train_for_binaryclass()
                              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_trainer_kfold.py", line 84, in train_for_binaryclass
    pred = self.model(x)
           ^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/models/model_for_pearl.py", line 130, in forward
    feats = self.backbone(x[0])
            ^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/models/cbramod.py", line 29, in forward
    feats = self.encoder(patch_emb)
            ^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/models/criss_cross_transformer.py", line 29, in forward
    output = mod(output, src_mask=mask)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/models/criss_cross_transformer.py", line 90, in forward
    x = x + self._sa_block(self.norm1(x), src_mask, src_key_padding_mask, is_causal=is_causal)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/models/criss_cross_transformer.py", line 112, in _sa_block
    x = torch.concat((xs, xt), dim=3)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt
