3085 695 825
4605
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (meta_backbone): Sequential(
    (0): Linear(in_features=28, out_features=50, bias=True)
    (1): ELU(alpha=1.0)
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=50, out_features=100, bias=True)
    (4): ELU(alpha=1.0)
    (5): Dropout(p=0.1, inplace=False)
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=19000, out_features=1000, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=100, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1, inplace=False)
  )
  (final_classifier): Sequential(
    (0): Linear(in_features=100, out_features=100, bias=True)
    (1): ELU(alpha=1.0)
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=100, out_features=1, bias=True)
    (4): Rearrange('b 1 -> (b 1)')
  )
)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:10<00:00,  4.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 19.96it/s]
Epoch 1 : Training Loss: 0.54776, acc: 0.85269, pr_auc: 0.93748, roc_auc: 0.94117, LR: 0.00030, Time elapsed 0.22 mins
[[1312  301]
 [ 159 1313]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 20.69it/s]
val Evaluation: acc: 0.30453, pr_auc: 0.59051, roc_auc: 0.39131
[[ 65 281]
 [202 147]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.30453, pr_auc: 0.59051, roc_auc: 0.39131
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:09<00:00,  5.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 20.94it/s]
Epoch 2 : Training Loss: 0.39728, acc: 0.92437, pr_auc: 0.97287, roc_auc: 0.97408, LR: 0.00029, Time elapsed 0.19 mins
[[1449  164]
 [  73 1399]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 30.21it/s]
val Evaluation: acc: 0.61292, pr_auc: 0.75296, roc_auc: 0.70778
[[210 136]
 [133 216]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.61292, pr_auc: 0.75296, roc_auc: 0.70778
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:09<00:00,  5.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 20.38it/s]
Epoch 3 : Training Loss: 0.22782, acc: 0.95649, pr_auc: 0.99294, roc_auc: 0.99287, LR: 0.00028, Time elapsed 0.20 mins
[[1534   79]
 [  56 1416]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 18.99it/s]
val Evaluation: acc: 0.57675, pr_auc: 0.70553, roc_auc: 0.62107
[[181 165]
 [129 220]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 20.06it/s]
Epoch 4 : Training Loss: 0.14235, acc: 0.98233, pr_auc: 0.99638, roc_auc: 0.99619, LR: 0.00027, Time elapsed 0.18 mins
[[1579   34]
 [  21 1451]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 22.55it/s]
val Evaluation: acc: 0.58254, pr_auc: 0.66395, roc_auc: 0.63706
[[186 160]
 [130 219]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 20.93it/s]
Epoch 5 : Training Loss: 0.07898, acc: 0.98962, pr_auc: 0.99948, roc_auc: 0.99949, LR: 0.00026, Time elapsed 0.18 mins
[[1608    5]
 [  26 1446]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 19.48it/s]
val Evaluation: acc: 0.57976, pr_auc: 0.57506, roc_auc: 0.55897
[[193 153]
 [139 210]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 21.25it/s]
Epoch 6 : Training Loss: 0.06155, acc: 0.98662, pr_auc: 0.99944, roc_auc: 0.99946, LR: 0.00024, Time elapsed 0.18 mins
[[1583   30]
 [  12 1460]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 19.94it/s]
val Evaluation: acc: 0.52720, pr_auc: 0.65701, roc_auc: 0.60493
[[229 117]
 [212 137]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 19.92it/s]
Epoch 7 : Training Loss: 0.04477, acc: 0.98919, pr_auc: 0.99942, roc_auc: 0.99948, LR: 0.00022, Time elapsed 0.18 mins
[[1588   25]
 [   9 1463]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 20.47it/s]
val Evaluation: acc: 0.62886, pr_auc: 0.56848, roc_auc: 0.56459
[[224 122]
 [136 213]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 20.64it/s]
Epoch 8 : Training Loss: 0.02630, acc: 0.99635, pr_auc: 0.99986, roc_auc: 0.99986, LR: 0.00020, Time elapsed 0.18 mins
[[1610    3]
 [   8 1464]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 22.66it/s]
val Evaluation: acc: 0.50262, pr_auc: 0.61249, roc_auc: 0.60832
[[211 135]
 [211 138]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 21.08it/s]
Epoch 9 : Training Loss: 0.01752, acc: 0.99703, pr_auc: 0.99990, roc_auc: 0.99990, LR: 0.00017, Time elapsed 0.18 mins
[[1610    3]
 [   6 1466]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 19.69it/s]
val Evaluation: acc: 0.52669, pr_auc: 0.63394, roc_auc: 0.59326
[[188 158]
 [171 178]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 19.45it/s]
Epoch 10 : Training Loss: 0.01270, acc: 0.99805, pr_auc: 0.99995, roc_auc: 0.99995, LR: 0.00015, Time elapsed 0.18 mins
[[1610    3]
 [   3 1469]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 23.09it/s]
val Evaluation: acc: 0.61321, pr_auc: 0.62056, roc_auc: 0.66543
[[233 113]
 [156 193]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 21.09it/s]
Epoch 11 : Training Loss: 0.01629, acc: 0.99762, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00013, Time elapsed 0.18 mins
[[1613    0]
 [   7 1465]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 20.70it/s]
val Evaluation: acc: 0.54676, pr_auc: 0.55427, roc_auc: 0.58237
[[189 157]
 [158 191]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 19.90it/s]
Epoch 12 : Training Loss: 0.00483, acc: 0.99932, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00010, Time elapsed 0.18 mins
[[1613    0]
 [   2 1470]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 18.94it/s]
val Evaluation: acc: 0.61759, pr_auc: 0.64346, roc_auc: 0.67360
[[240 106]
 [160 189]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 20.66it/s]
Epoch 13 : Training Loss: 0.00457, acc: 0.99932, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00008, Time elapsed 0.18 mins
[[1613    0]
 [   2 1470]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 21.15it/s]
val Evaluation: acc: 0.60860, pr_auc: 0.62050, roc_auc: 0.65151
[[208 138]
 [134 215]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 21.16it/s]
Epoch 14 : Training Loss: 0.00390, acc: 0.99966, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00006, Time elapsed 0.18 mins
[[1613    0]
 [   1 1471]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 19.21it/s]
val Evaluation: acc: 0.51976, pr_auc: 0.62306, roc_auc: 0.61725
[[207 139]
 [195 154]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 19.99it/s]
Epoch 15 : Training Loss: 0.00119, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00004, Time elapsed 0.18 mins
[[1613    0]
 [   0 1472]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 36.23it/s]
val Evaluation: acc: 0.56124, pr_auc: 0.61146, roc_auc: 0.61263
[[201 145]
 [160 189]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 20.10it/s]
Epoch 16 : Training Loss: 0.00088, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00003, Time elapsed 0.18 mins
[[1613    0]
 [   0 1472]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 22.81it/s]
val Evaluation: acc: 0.54267, pr_auc: 0.61575, roc_auc: 0.60926
[[206 140]
 [178 171]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 21.54it/s]
Epoch 17 : Training Loss: 0.00053, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00002, Time elapsed 0.18 mins
[[1613    0]
 [   0 1472]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 18.98it/s]
val Evaluation: acc: 0.57419, pr_auc: 0.62052, roc_auc: 0.61909
[[206 140]
 [156 193]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 21.53it/s]
Epoch 18 : Training Loss: 0.00050, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00001, Time elapsed 0.18 mins
[[1613    0]
 [   0 1472]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 19.92it/s]
val Evaluation: acc: 0.55266, pr_auc: 0.62464, roc_auc: 0.61831
[[203 143]
 [168 181]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 19.69it/s]
Epoch 19 : Training Loss: 0.00039, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00000, Time elapsed 0.18 mins
[[1613    0]
 [   0 1472]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 19.14it/s]
val Evaluation: acc: 0.54982, pr_auc: 0.62166, roc_auc: 0.61925
[[205 141]
 [172 177]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:08<00:00,  5.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 49/49 [00:02<00:00, 21.70it/s]
Epoch 20 : Training Loss: 0.00026, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00000, Time elapsed 0.18 mins
[[1613    0]
 [   0 1472]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 11/11 [00:00<00:00, 19.94it/s]
val Evaluation: acc: 0.55126, pr_auc: 0.62286, roc_auc: 0.61981
[[205 141]
 [171 178]]
***************************Test************************
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 13/13 [00:00<00:00, 13.16it/s]
***************************Test results************************
Test Evaluation: acc: 0.56168, pr_auc: 0.52170, roc_auc: 0.52111
[[301 183]
 [170 171]]
model save in ./data/wjq/models_weights/Big/BigFaced/epoch20_acc_0.56168_pr_0.52170_roc_0.52111.pth
