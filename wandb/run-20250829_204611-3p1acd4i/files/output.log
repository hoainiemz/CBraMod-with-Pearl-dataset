100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.51it/s]
Epoch 1 : Training Loss: 1.78004, acc: 0.20800, kappa: 0.01000, f1: 0.13585, LR: 0.00029, Time elapsed 0.21 mins
[[ 99  44   0   7   0]
 [ 89  45   0  16   0]
 [ 99  45   0   6   0]
 [101  37   0  12   0]
 [101  39   0  10   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20800, kappa: 0.01000, f1: 0.13585
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.34it/s]
Epoch 2 : Training Loss: 1.64696, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00029, Time elapsed 0.21 mins
[[  0   0   0 150   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.53it/s]
Epoch 3 : Training Loss: 1.63676, acc: 0.20000, kappa: 0.00000, f1: 0.07357, LR: 0.00029, Time elapsed 0.22 mins
[[  3 147   0   0   0]
 [  3 147   0   0   0]
 [  1 149   0   0   0]
 [  1 149   0   0   0]
 [  2 148   0   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.76it/s]
Epoch 4 : Training Loss: 1.62706, acc: 0.20133, kappa: 0.00167, f1: 0.06945, LR: 0.00028, Time elapsed 0.22 mins
[[  0   0   0 150   0]
 [  0   1   0 149   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]
 [  0   1   0 149   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.29it/s]
Epoch 5 : Training Loss: 1.63084, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00028, Time elapsed 0.21 mins
[[  0 150   0   0   0]
 [  0 150   0   0   0]
 [  0 150   0   0   0]
 [  0 150   0   0   0]
 [  0 150   0   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.36it/s]
Epoch 6 : Training Loss: 1.62996, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00028, Time elapsed 0.22 mins
[[150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.69it/s]
Epoch 7 : Training Loss: 1.63103, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00028, Time elapsed 0.21 mins
[[150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 8 : Training Loss: 1.63441, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00027, Time elapsed 0.22 mins
[[  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.53it/s]
Epoch 9 : Training Loss: 1.62203, acc: 0.20133, kappa: 0.00167, f1: 0.07612, LR: 0.00027, Time elapsed 0.21 mins
[[147   0   0   3   0]
 [148   0   0   2   0]
 [147   0   0   3   0]
 [146   0   0   4   0]
 [148   0   0   2   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.82it/s]
Epoch 10 : Training Loss: 1.63306, acc: 0.19867, kappa: -0.00167, f1: 0.07320, LR: 0.00026, Time elapsed 0.21 mins
[[  3   0   0   0 147]
 [  5   0   0   0 145]
 [  0   0   0   0 150]
 [  1   0   0   0 149]
 [  4   0   0   0 146]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 11 : Training Loss: 1.62352, acc: 0.20267, kappa: 0.00333, f1: 0.08894, LR: 0.00026, Time elapsed 0.21 mins
[[  0   0   8   0 142]
 [  0   3   3   0 144]
 [  0   0   7   0 143]
 [  0   0   5   0 145]
 [  0   1   7   0 142]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.63it/s]
Epoch 12 : Training Loss: 1.62365, acc: 0.18267, kappa: -0.02167, f1: 0.09045, LR: 0.00025, Time elapsed 0.21 mins
[[  0   0 126   0  24]
 [  0   0 132   0  18]
 [  0   0 116   0  34]
 [  0   0 123   0  27]
 [  0   0 129   0  21]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.98it/s]
Epoch 13 : Training Loss: 1.62822, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00024, Time elapsed 0.21 mins
[[  0   0   0 150   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.69it/s]
Epoch 14 : Training Loss: 1.62571, acc: 0.20133, kappa: 0.00167, f1: 0.06945, LR: 0.00024, Time elapsed 0.21 mins
[[150   0   0   0   0]
 [149   0   0   0   1]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [149   0   0   0   1]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.72it/s]
Epoch 15 : Training Loss: 1.62197, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00023, Time elapsed 0.21 mins
[[150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.11it/s]
Epoch 16 : Training Loss: 1.62114, acc: 0.20000, kappa: 0.00000, f1: 0.06689, LR: 0.00022, Time elapsed 0.22 mins
[[  0   0   0   0 150]
 [  3   0   0   0 147]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.89it/s]
Epoch 17 : Training Loss: 1.62206, acc: 0.19200, kappa: -0.01000, f1: 0.06683, LR: 0.00021, Time elapsed 0.21 mins
[[  0 149   0   1   0]
 [  1 143   0   3   3]
 [  0 149   0   1   0]
 [  0 149   0   1   0]
 [  0 150   0   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.00it/s]
Epoch 18 : Training Loss: 1.61644, acc: 0.20000, kappa: 0.00000, f1: 0.06689, LR: 0.00021, Time elapsed 0.21 mins
[[  0   0   0 150   0]
 [  3   0   0 147   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.80it/s]
Epoch 19 : Training Loss: 1.61996, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00020, Time elapsed 0.21 mins
[[  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.94it/s]
Epoch 20 : Training Loss: 1.62153, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00019, Time elapsed 0.21 mins
[[  0   0 150   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.28it/s]
Epoch 21 : Training Loss: 1.61839, acc: 0.19733, kappa: -0.00333, f1: 0.08120, LR: 0.00018, Time elapsed 0.21 mins
[[141   6   0   0   3]
 [137   7   0   0   6]
 [147   3   0   0   0]
 [146   3   0   0   1]
 [144   6   0   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.55it/s]
Epoch 22 : Training Loss: 1.61666, acc: 0.20133, kappa: 0.00167, f1: 0.06954, LR: 0.00017, Time elapsed 0.21 mins
[[  0   0 150   0   0]
 [  2   1 147   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.62it/s]
Epoch 23 : Training Loss: 1.61652, acc: 0.19600, kappa: -0.00500, f1: 0.08445, LR: 0.00016, Time elapsed 0.21 mins
[[ 10   0   0   0 140]
 [ 19   0   0   0 131]
 [  3   0   0   0 147]
 [  6   0   0   0 144]
 [ 13   0   0   0 137]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.90it/s]
Epoch 24 : Training Loss: 1.61433, acc: 0.20000, kappa: 0.00000, f1: 0.06711, LR: 0.00015, Time elapsed 0.21 mins
[[  0   0 150   0   0]
 [  4   0 144   0   2]
 [  0   0 150   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.51it/s]
Epoch 25 : Training Loss: 1.61262, acc: 0.21733, kappa: 0.02167, f1: 0.12069, LR: 0.00015, Time elapsed 0.21 mins
[[ 16   4 129   1   0]
 [ 26   9 111   1   3]
 [ 12   1 137   0   0]
 [ 11   4 133   1   1]
 [ 15   5 129   1   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21733, kappa: 0.02167, f1: 0.12069
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.70it/s]
Epoch 26 : Training Loss: 1.61075, acc: 0.20933, kappa: 0.01167, f1: 0.10809, LR: 0.00014, Time elapsed 0.22 mins
[[  0 132  17   0   1]
 [  2 132  13   0   3]
 [  0 126  24   0   0]
 [  0 128  22   0   0]
 [  0 132  17   0   1]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.32it/s]
Epoch 27 : Training Loss: 1.60073, acc: 0.22400, kappa: 0.03000, f1: 0.17869, LR: 0.00013, Time elapsed 0.22 mins
[[37 12 15 86  0]
 [37 13 11 89  0]
 [28  2 27 93  0]
 [32  5 22 91  0]
 [36 11 21 82  0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22400, kappa: 0.03000, f1: 0.17869
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
Epoch 28 : Training Loss: 1.58078, acc: 0.25467, kappa: 0.06833, f1: 0.20534, LR: 0.00012, Time elapsed 0.21 mins
[[11 17 30  4 88]
 [12 31 23  2 82]
 [ 3 20 49  0 78]
 [ 7 13 31  1 98]
 [ 5 14 32  0 99]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25467, kappa: 0.06833, f1: 0.20534
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.78it/s]
Epoch 29 : Training Loss: 1.55185, acc: 0.25733, kappa: 0.07167, f1: 0.22644, LR: 0.00011, Time elapsed 0.21 mins
[[28 45 14  1 62]
 [30 57 13  1 49]
 [16 25 35  0 74]
 [24 31 14  1 80]
 [20 40 18  0 72]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25733, kappa: 0.07167, f1: 0.22644
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.63it/s]
Epoch 30 : Training Loss: 1.48876, acc: 0.28667, kappa: 0.10833, f1: 0.27191, LR: 0.00010, Time elapsed 0.22 mins
[[29 21 18  8 74]
 [31 31 16 17 55]
 [15  8 57  4 66]
 [21  7 25 16 81]
 [23 14 22  9 82]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28667, kappa: 0.10833, f1: 0.27191
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.89it/s]
Epoch 31 : Training Loss: 1.41724, acc: 0.32400, kappa: 0.15500, f1: 0.32277, LR: 0.00009, Time elapsed 0.21 mins
[[50 16 28 37 19]
 [42 37 24 31 16]
 [23  8 61 29 29]
 [29 12 30 54 25]
 [26 13 28 42 41]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.32400, kappa: 0.15500, f1: 0.32277
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.69it/s]
Epoch 32 : Training Loss: 1.29719, acc: 0.32533, kappa: 0.15667, f1: 0.32637, LR: 0.00008, Time elapsed 0.21 mins
[[41 26 22 39 22]
 [30 46 17 33 24]
 [24 11 53 19 43]
 [26 16 21 52 35]
 [24 17 22 35 52]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.32533, kappa: 0.15667, f1: 0.32637
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.85it/s]
Epoch 33 : Training Loss: 1.14543, acc: 0.36000, kappa: 0.20000, f1: 0.35896, LR: 0.00008, Time elapsed 0.21 mins
[[51 14 23 40 22]
 [35 42 19 34 20]
 [18 10 66 28 28]
 [26 11 23 65 25]
 [29 15 23 37 46]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.36000, kappa: 0.20000, f1: 0.35896
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.82it/s]
Epoch 34 : Training Loss: 0.96463, acc: 0.38667, kappa: 0.23333, f1: 0.38384, LR: 0.00007, Time elapsed 0.21 mins
[[56 22 14 43 15]
 [35 62 13 25 15]
 [22 27 49 20 32]
 [21 19 19 78 13]
 [26 31  7 41 45]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.38667, kappa: 0.23333, f1: 0.38384
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 35 : Training Loss: 0.81685, acc: 0.41333, kappa: 0.26667, f1: 0.41165, LR: 0.00006, Time elapsed 0.21 mins
[[50 22 15 41 22]
 [34 58 17 29 12]
 [18 10 72 20 30]
 [18 14 19 80 19]
 [25 15 23 37 50]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.41333, kappa: 0.26667, f1: 0.41165
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 36 : Training Loss: 0.68508, acc: 0.40933, kappa: 0.26167, f1: 0.40297, LR: 0.00005, Time elapsed 0.21 mins
[[45 20 19 49 17]
 [26 59 20 33 12]
 [16 20 67 21 26]
 [15 17 12 92 14]
 [27 23 17 39 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.51it/s]
Epoch 37 : Training Loss: 0.60955, acc: 0.40933, kappa: 0.26167, f1: 0.40866, LR: 0.00005, Time elapsed 0.21 mins
[[54 31 16 32 17]
 [30 58 20 28 14]
 [15 23 66 18 28]
 [19 21 14 75 21]
 [21 26 18 31 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.94it/s]
Epoch 38 : Training Loss: 0.55675, acc: 0.41867, kappa: 0.27333, f1: 0.41499, LR: 0.00004, Time elapsed 0.21 mins
[[53 25 13 40 19]
 [27 60 13 37 13]
 [21 16 58 28 27]
 [16 15  9 93 17]
 [26 20 13 41 50]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.41867, kappa: 0.27333, f1: 0.41499
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 39 : Training Loss: 0.52663, acc: 0.43467, kappa: 0.29333, f1: 0.43083, LR: 0.00003, Time elapsed 0.21 mins
[[47 22 15 50 16]
 [21 64 12 41 12]
 [18 21 69 24 18]
 [15 16  9 96 14]
 [20 24 11 45 50]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.43467, kappa: 0.29333, f1: 0.43083
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.85it/s]
Epoch 40 : Training Loss: 0.50897, acc: 0.41733, kappa: 0.27167, f1: 0.41526, LR: 0.00003, Time elapsed 0.21 mins
[[52 16 11 53 18]
 [26 58 13 39 14]
 [16 21 57 23 33]
 [15 16  9 91 19]
 [19 18 11 47 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.79it/s]
Epoch 41 : Training Loss: 0.49216, acc: 0.42667, kappa: 0.28333, f1: 0.42423, LR: 0.00002, Time elapsed 0.21 mins
[[48 21 11 50 20]
 [20 58 13 44 15]
 [16 17 61 26 30]
 [14 12  9 94 21]
 [18 18 10 45 59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.80it/s]
Epoch 42 : Training Loss: 0.48296, acc: 0.43200, kappa: 0.29000, f1: 0.43008, LR: 0.00002, Time elapsed 0.21 mins
[[53 18 11 51 17]
 [23 56 12 44 15]
 [16 16 64 29 25]
 [15 11 10 96 18]
 [25 17  9 44 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.91it/s]
Epoch 43 : Training Loss: 0.47386, acc: 0.43067, kappa: 0.28833, f1: 0.42887, LR: 0.00001, Time elapsed 0.21 mins
[[55 14 10 53 18]
 [23 55 13 43 16]
 [17 13 64 31 25]
 [14 12 11 95 18]
 [25 17 12 42 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.97it/s]
Epoch 44 : Training Loss: 0.47185, acc: 0.42800, kappa: 0.28500, f1: 0.42674, LR: 0.00001, Time elapsed 0.22 mins
[[51 15  9 58 17]
 [23 58 12 43 14]
 [15 16 62 31 26]
 [14 13  8 97 18]
 [20 18  8 51 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.86it/s]
Epoch 45 : Training Loss: 0.46422, acc: 0.42533, kappa: 0.28167, f1: 0.42400, LR: 0.00001, Time elapsed 0.21 mins
[[51 18 10 55 16]
 [22 58 13 44 13]
 [14 16 62 31 27]
 [14 13 10 94 19]
 [21 16 11 48 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.94it/s]
Epoch 46 : Training Loss: 0.46231, acc: 0.43600, kappa: 0.29500, f1: 0.43477, LR: 0.00001, Time elapsed 0.21 mins
[[54 14 10 55 17]
 [21 59 13 44 13]
 [15 15 65 29 26]
 [15 11  9 97 18]
 [20 15 12 51 52]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.43600, kappa: 0.29500, f1: 0.43477
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.74it/s]
Epoch 47 : Training Loss: 0.46349, acc: 0.42667, kappa: 0.28333, f1: 0.42534, LR: 0.00000, Time elapsed 0.21 mins
[[53 17  8 56 16]
 [22 59 12 44 13]
 [16 15 61 31 27]
 [14 12  9 96 19]
 [20 17 11 51 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.74it/s]
Epoch 48 : Training Loss: 0.45856, acc: 0.42933, kappa: 0.28667, f1: 0.42765, LR: 0.00000, Time elapsed 0.21 mins
[[53 17  8 56 16]
 [22 58 13 44 13]
 [17 15 62 31 25]
 [14 12 10 97 17]
 [20 16 11 51 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.17it/s]
Epoch 49 : Training Loss: 0.46033, acc: 0.42800, kappa: 0.28500, f1: 0.42644, LR: 0.00000, Time elapsed 0.22 mins
[[52 17  9 56 16]
 [21 58 14 45 12]
 [17 15 63 30 25]
 [14 12 10 96 18]
 [20 16 11 51 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 50 : Training Loss: 0.46025, acc: 0.43067, kappa: 0.28833, f1: 0.42968, LR: 0.00000, Time elapsed 0.21 mins
[[53 17  8 56 16]
 [21 59 13 45 12]
 [17 15 63 30 25]
 [14 12 10 96 18]
 [20 15 11 52 52]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.52it/s]
***************************Test results************************
Test Evaluation: acc: 0.43467, kappa: 0.29333, f1: 0.43224
[[57 11 11 51 20]
 [21 59 14 41 15]
 [17 15 56 40 22]
 [16  9  8 99 18]
 [15 18 13 49 55]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch46_acc_0.43467_kappa_0.29333_f1_0.43224.pth
[32m[I 2025-08-29 20:57:06,640][0m Trial 63 finished with value: 0.29333333333333333 and parameters: {'lr': 0.0002891102875802313, 'weight_decay': 0.002406628966941515, '--dropout': 0.17129482998089918, '--clip_value': 1.9716273572515572}. Best is trial 35 with value: 0.36.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.00022285850959901583, weight_decay=0.005176678894960057, optimizer='AdamW', clip_value=1.8887806399556057, dropout=0.1852470583417279, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1852470583417279, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1852470583417279, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
