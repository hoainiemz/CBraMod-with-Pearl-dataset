100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.39it/s]
Epoch 1 : Training Loss: 1.88868, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00033, Time elapsed 0.21 mins
[[  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.72it/s]
Epoch 2 : Training Loss: 1.62675, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00033, Time elapsed 0.21 mins
[[  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.09it/s]
Epoch 3 : Training Loss: 1.62145, acc: 0.18933, kappa: -0.01333, f1: 0.10628, LR: 0.00033, Time elapsed 0.21 mins
[[  0   0  57  93   0]
 [  0   0  60  90   0]
 [  0   0  44 106   0]
 [  0   0  53  97   0]
 [  0   0  48 101   1]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.91it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.60it/s]
Epoch 4 : Training Loss: 1.62295, acc: 0.22533, kappa: 0.03167, f1: 0.16263, LR: 0.00032, Time elapsed 0.21 mins
[[ 0 48 80 22  0]
 [ 0 55 81 14  0]
 [ 0 34 88 28  0]
 [ 0 43 81 25  1]
 [ 0 42 91 16  1]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22533, kappa: 0.03167, f1: 0.16263
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.93it/s]
Epoch 5 : Training Loss: 1.62727, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00032, Time elapsed 0.21 mins
[[  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 6 : Training Loss: 1.61973, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00032, Time elapsed 0.21 mins
[[  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.44it/s]
Epoch 7 : Training Loss: 1.61706, acc: 0.22533, kappa: 0.03167, f1: 0.15679, LR: 0.00031, Time elapsed 0.21 mins
[[  2  14   1  27 106]
 [  3  23   0  26  98]
 [  4  13   1  20 112]
 [  1   9   1  28 111]
 [  1  10   0  24 115]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.02it/s]
Epoch 8 : Training Loss: 1.61047, acc: 0.22800, kappa: 0.03500, f1: 0.16444, LR: 0.00031, Time elapsed 0.21 mins
[[  4  16   6 116   8]
 [  8  28  11  90  13]
 [  9  13  15 109   4]
 [  3  14  10 119   4]
 [  2  21   8 114   5]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22800, kappa: 0.03500, f1: 0.16444
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.90it/s]
Epoch 9 : Training Loss: 1.59607, acc: 0.24400, kappa: 0.05500, f1: 0.18295, LR: 0.00030, Time elapsed 0.21 mins
[[54 20  2 74  0]
 [47 36  0 67  0]
 [47 23  2 78  0]
 [42 15  1 91  1]
 [49 17  2 82  0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24400, kappa: 0.05500, f1: 0.18295
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.99it/s]
Epoch 10 : Training Loss: 1.56744, acc: 0.27200, kappa: 0.09000, f1: 0.25195, LR: 0.00030, Time elapsed 0.22 mins
[[80  7 33 19 11]
 [77 20 27 17  9]
 [65  4 58 18  5]
 [69  6 38 28  9]
 [69  3 43 17 18]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27200, kappa: 0.09000, f1: 0.25195
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.11it/s]
Epoch 11 : Training Loss: 1.49142, acc: 0.27333, kappa: 0.09167, f1: 0.25203, LR: 0.00029, Time elapsed 0.21 mins
[[22 33 54 12 29]
 [16 47 50  7 30]
 [18 19 84  4 25]
 [22 23 60 15 30]
 [18 23 69  3 37]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27333, kappa: 0.09167, f1: 0.25203
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.63it/s]
Epoch 12 : Training Loss: 1.40089, acc: 0.28533, kappa: 0.10667, f1: 0.28164, LR: 0.00028, Time elapsed 0.21 mins
[[48 41 17 18 26]
 [41 60  9 13 27]
 [43 28 34 12 33]
 [38 45  7 26 34]
 [35 41 13 15 46]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28533, kappa: 0.10667, f1: 0.28164
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.87it/s]
Epoch 13 : Training Loss: 1.22020, acc: 0.35333, kappa: 0.19167, f1: 0.35499, LR: 0.00028, Time elapsed 0.21 mins
[[59 20 21 32 18]
 [39 53 19 23 16]
 [34 20 57 18 21]
 [39 30 18 45 18]
 [38 24 16 21 51]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.35333, kappa: 0.19167, f1: 0.35499
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.05it/s]
Epoch 14 : Training Loss: 1.01794, acc: 0.37333, kappa: 0.21667, f1: 0.37528, LR: 0.00027, Time elapsed 0.21 mins
[[63 27 14 26 20]
 [39 60 14 23 14]
 [36 20 56 19 19]
 [32 35 16 47 20]
 [43 27 15 11 54]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.37333, kappa: 0.21667, f1: 0.37528
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.02it/s]
Epoch 15 : Training Loss: 0.83722, acc: 0.39333, kappa: 0.24167, f1: 0.39306, LR: 0.00026, Time elapsed 0.21 mins
[[68 14 17 26 25]
 [39 45 10 34 22]
 [33 11 49 26 31]
 [35 16 12 63 24]
 [41 13  4 22 70]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.39333, kappa: 0.24167, f1: 0.39306
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.74it/s]
Epoch 16 : Training Loss: 0.67654, acc: 0.41467, kappa: 0.26833, f1: 0.41680, LR: 0.00025, Time elapsed 0.22 mins
[[61 24 13 29 23]
 [28 62 13 29 18]
 [30 15 58 28 19]
 [27 26 13 64 20]
 [34 20 11 19 66]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.41467, kappa: 0.26833, f1: 0.41680
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.32it/s]
Epoch 17 : Training Loss: 0.59576, acc: 0.42000, kappa: 0.27500, f1: 0.42016, LR: 0.00024, Time elapsed 0.21 mins
[[58 19 22 25 26]
 [28 57 14 28 23]
 [23  8 72 21 26]
 [18 23 20 59 30]
 [20 19 17 25 69]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42000, kappa: 0.27500, f1: 0.42016
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.51it/s]
Epoch 18 : Training Loss: 0.52738, acc: 0.39867, kappa: 0.24833, f1: 0.39707, LR: 0.00024, Time elapsed 0.21 mins
[[52 24 29 23 22]
 [27 56 26 25 16]
 [25  9 83 20 13]
 [31 18 28 55 18]
 [33 14 29 21 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.90it/s]
Epoch 19 : Training Loss: 0.49085, acc: 0.40667, kappa: 0.25833, f1: 0.40969, LR: 0.00023, Time elapsed 0.21 mins
[[75 19 12 22 22]
 [40 62 10 26 12]
 [38 14 54 23 21]
 [40 19 10 56 25]
 [48 16  9 19 58]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 20 : Training Loss: 0.46308, acc: 0.43867, kappa: 0.29833, f1: 0.43958, LR: 0.00022, Time elapsed 0.21 mins
[[73 18 13 26 20]
 [34 57 14 34 11]
 [31 14 68 21 16]
 [25 18 14 74 19]
 [38 13 15 27 57]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.43867, kappa: 0.29833, f1: 0.43958
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 21 : Training Loss: 0.43576, acc: 0.46400, kappa: 0.33000, f1: 0.46384, LR: 0.00021, Time elapsed 0.21 mins
[[67 17 23 27 16]
 [27 56 19 36 12]
 [28  9 78 23 12]
 [21 15 17 79 18]
 [26 12 21 23 68]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.46400, kappa: 0.33000, f1: 0.46384
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.92it/s]
Epoch 22 : Training Loss: 0.42196, acc: 0.45867, kappa: 0.32333, f1: 0.45901, LR: 0.00020, Time elapsed 0.21 mins
[[69 18 21 24 18]
 [26 65 14 34 11]
 [25  9 80 22 14]
 [22 15 19 71 23]
 [29 15 23 24 59]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.09it/s]
Epoch 23 : Training Loss: 0.41000, acc: 0.46000, kappa: 0.32500, f1: 0.46163, LR: 0.00019, Time elapsed 0.21 mins
[[69 25 15 20 21]
 [27 70 14 28 11]
 [31 13 70 18 18]
 [25 19 14 68 24]
 [31 15 18 18 68]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.92it/s]
Epoch 24 : Training Loss: 0.40716, acc: 0.47067, kappa: 0.33833, f1: 0.47158, LR: 0.00018, Time elapsed 0.21 mins
[[75 21 18 17 19]
 [28 63 15 28 16]
 [31  9 73 21 16]
 [22 17 17 70 24]
 [32 13 14 19 72]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.47067, kappa: 0.33833, f1: 0.47158
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.60it/s]
Epoch 25 : Training Loss: 0.40288, acc: 0.45333, kappa: 0.31667, f1: 0.45431, LR: 0.00017, Time elapsed 0.21 mins
[[70 25 15 19 21]
 [28 62 15 32 13]
 [30  9 75 20 16]
 [23 17 16 68 26]
 [29 15 19 22 65]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.98it/s]
Epoch 26 : Training Loss: 0.40024, acc: 0.46000, kappa: 0.32500, f1: 0.45984, LR: 0.00015, Time elapsed 0.21 mins
[[68 23 18 20 21]
 [25 57 21 34 13]
 [27  8 79 19 17]
 [22 16 15 72 25]
 [30 11 19 21 69]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.03it/s]
Epoch 27 : Training Loss: 0.39989, acc: 0.44267, kappa: 0.30333, f1: 0.44421, LR: 0.00014, Time elapsed 0.21 mins
[[68 22 14 25 21]
 [28 60 13 35 14]
 [34  9 71 20 16]
 [21 18 15 70 26]
 [34 14 19 20 63]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
Epoch 28 : Training Loss: 0.39871, acc: 0.45467, kappa: 0.31833, f1: 0.45535, LR: 0.00013, Time elapsed 0.21 mins
[[66 23 16 21 24]
 [24 61 18 31 16]
 [27  9 77 20 17]
 [22 17 13 71 27]
 [32 13 21 18 66]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.28it/s]
Epoch 29 : Training Loss: 0.39824, acc: 0.45467, kappa: 0.31833, f1: 0.45556, LR: 0.00012, Time elapsed 0.21 mins
[[70 22 16 21 21]
 [25 62 17 32 14]
 [32  8 74 22 14]
 [21 18 13 72 26]
 [34 14 20 19 63]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.98it/s]
Epoch 30 : Training Loss: 0.39663, acc: 0.44800, kappa: 0.31000, f1: 0.44963, LR: 0.00011, Time elapsed 0.21 mins
[[69 23 14 21 23]
 [27 59 14 35 15]
 [29 10 74 20 17]
 [24 17 10 69 30]
 [31 17 16 21 65]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.03it/s]
Epoch 31 : Training Loss: 0.39647, acc: 0.46000, kappa: 0.32500, f1: 0.46067, LR: 0.00010, Time elapsed 0.21 mins
[[72 22 14 20 22]
 [25 60 15 35 15]
 [31  8 78 18 15]
 [23 17 13 73 24]
 [34 13 20 21 62]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.54it/s]
Epoch 32 : Training Loss: 0.39658, acc: 0.45867, kappa: 0.32333, f1: 0.45997, LR: 0.00010, Time elapsed 0.21 mins
[[73 22 15 18 22]
 [28 62 15 30 15]
 [32  7 76 18 17]
 [26 17 13 68 26]
 [34 13 21 17 65]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.35it/s]
Epoch 33 : Training Loss: 0.39589, acc: 0.45067, kappa: 0.31333, f1: 0.45181, LR: 0.00009, Time elapsed 0.21 mins
[[71 22 15 19 23]
 [26 62 15 31 16]
 [28 11 73 20 18]
 [26 19 12 68 25]
 [34 17 19 16 64]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.78it/s]
Epoch 34 : Training Loss: 0.39525, acc: 0.45467, kappa: 0.31833, f1: 0.45595, LR: 0.00008, Time elapsed 0.21 mins
[[72 22 15 21 20]
 [29 64 14 32 11]
 [30 11 73 20 16]
 [24 20 12 70 24]
 [32 17 18 21 62]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.13it/s]
Epoch 35 : Training Loss: 0.39503, acc: 0.45467, kappa: 0.31833, f1: 0.45544, LR: 0.00007, Time elapsed 0.21 mins
[[70 22 17 22 19]
 [26 60 14 34 16]
 [30  8 78 18 16]
 [22 18 14 70 26]
 [32 14 19 22 63]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.56it/s]
Epoch 36 : Training Loss: 0.39533, acc: 0.45067, kappa: 0.31333, f1: 0.45190, LR: 0.00006, Time elapsed 0.21 mins
[[72 23 15 20 20]
 [28 60 15 32 15]
 [31  9 75 19 16]
 [27 17 12 68 26]
 [35 14 20 18 63]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.97it/s]
Epoch 37 : Training Loss: 0.39503, acc: 0.45600, kappa: 0.32000, f1: 0.45771, LR: 0.00005, Time elapsed 0.21 mins
[[69 24 15 21 21]
 [25 64 14 33 14]
 [30  9 75 21 15]
 [26 19 11 68 26]
 [31 15 19 19 66]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.62it/s]
Epoch 38 : Training Loss: 0.39433, acc: 0.46400, kappa: 0.33000, f1: 0.46526, LR: 0.00005, Time elapsed 0.21 mins
[[71 22 17 19 21]
 [27 63 14 31 15]
 [28 10 75 20 17]
 [23 18 13 68 28]
 [32 12 17 18 71]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.79it/s]
Epoch 39 : Training Loss: 0.39348, acc: 0.45733, kappa: 0.32167, f1: 0.45843, LR: 0.00004, Time elapsed 0.21 mins
[[72 23 15 20 20]
 [25 62 14 34 15]
 [28  8 77 21 16]
 [24 19 12 69 26]
 [33 14 19 21 63]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.08it/s]
Epoch 40 : Training Loss: 0.39512, acc: 0.45867, kappa: 0.32333, f1: 0.45993, LR: 0.00003, Time elapsed 0.21 mins
[[70 22 17 20 21]
 [23 65 14 32 16]
 [29  9 76 19 17]
 [24 19 12 68 27]
 [32 15 19 19 65]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.34it/s]
Epoch 41 : Training Loss: 0.39417, acc: 0.45333, kappa: 0.31667, f1: 0.45440, LR: 0.00003, Time elapsed 0.21 mins
[[70 22 17 20 21]
 [26 61 14 34 15]
 [29  8 77 20 16]
 [24 19 12 68 27]
 [32 14 20 20 64]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.75it/s]
Epoch 42 : Training Loss: 0.39415, acc: 0.45467, kappa: 0.31833, f1: 0.45620, LR: 0.00002, Time elapsed 0.21 mins
[[71 22 16 22 19]
 [26 61 14 35 14]
 [28  9 75 22 16]
 [25 19 11 69 26]
 [33 16 16 20 65]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.54it/s]
Epoch 43 : Training Loss: 0.39372, acc: 0.45333, kappa: 0.31667, f1: 0.45408, LR: 0.00002, Time elapsed 0.21 mins
[[72 22 17 19 20]
 [26 60 16 33 15]
 [30  8 77 18 17]
 [24 18 13 67 28]
 [35 13 20 18 64]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.75it/s]
Epoch 44 : Training Loss: 0.39361, acc: 0.45333, kappa: 0.31667, f1: 0.45397, LR: 0.00001, Time elapsed 0.21 mins
[[72 22 16 21 19]
 [25 60 15 35 15]
 [30  8 76 19 17]
 [23 18 13 70 26]
 [33 16 19 20 62]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.50it/s]
Epoch 45 : Training Loss: 0.39433, acc: 0.44800, kappa: 0.31000, f1: 0.44912, LR: 0.00001, Time elapsed 0.21 mins
[[67 22 17 22 22]
 [26 59 14 36 15]
 [28  9 76 19 18]
 [23 18 11 69 29]
 [32 16 19 18 65]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
Epoch 46 : Training Loss: 0.39402, acc: 0.45733, kappa: 0.32167, f1: 0.45829, LR: 0.00001, Time elapsed 0.21 mins
[[71 22 16 20 21]
 [25 61 15 34 15]
 [30  8 77 18 17]
 [23 18 12 69 28]
 [33 16 19 17 65]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.45it/s]
Epoch 47 : Training Loss: 0.39320, acc: 0.45467, kappa: 0.31833, f1: 0.45557, LR: 0.00000, Time elapsed 0.21 mins
[[72 22 16 21 19]
 [26 61 14 34 15]
 [30  8 77 18 17]
 [24 18 12 69 27]
 [34 16 20 18 62]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.12it/s]
Epoch 48 : Training Loss: 0.39399, acc: 0.45467, kappa: 0.31833, f1: 0.45567, LR: 0.00000, Time elapsed 0.21 mins
[[72 22 16 20 20]
 [26 61 14 34 15]
 [30  9 76 18 17]
 [24 18 12 69 27]
 [34 16 19 18 63]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.46it/s]
Epoch 49 : Training Loss: 0.39337, acc: 0.45733, kappa: 0.32167, f1: 0.45846, LR: 0.00000, Time elapsed 0.21 mins
[[71 22 16 21 20]
 [26 61 14 34 15]
 [30  8 77 18 17]
 [24 18 12 69 27]
 [33 16 19 17 65]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.76it/s]
Epoch 50 : Training Loss: 0.39406, acc: 0.45733, kappa: 0.32167, f1: 0.45835, LR: 0.00000, Time elapsed 0.21 mins
[[72 22 16 21 19]
 [26 61 14 34 15]
 [30  8 77 18 17]
 [24 18 12 69 27]
 [33 16 19 18 64]]
***************************Test************************
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.42it/s]
***************************Test results************************
Test Evaluation: acc: 0.45867, kappa: 0.32333, f1: 0.46034
[[68 23 10 30 19]
 [31 69 11 20 19]
 [25 13 75 18 19]
 [23 12 25 66 24]
 [30 17 16 21 66]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch24_acc_0.45867_kappa_0.32333_f1_0.46034.pth
[32m[I 2025-08-29 10:47:09,066][0m Trial 11 finished with value: 0.32333333333333336 and parameters: {'lr': 0.000329506796423039, 'weight_decay': 2.5843128549611832e-05, '--dropout': 0.0019235182379259974, '--clip_value': 1.5716749878944212}. Best is trial 11 with value: 0.32333333333333336.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.0004105357607644983, weight_decay=4.352798550971123e-05, optimizer='AdamW', clip_value=1.5457338475101416, dropout=0.034056977935112864, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.034056977935112864, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.034056977935112864, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
