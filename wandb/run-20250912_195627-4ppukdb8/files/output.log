Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.0001, weight_decay=0.05, optimizer='AdamW', clip_value=1, dropout=0.1, classifier='all_patch_reps', downstream_dataset='PEARL', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/pearl', num_of_classes=2, model_dir='./data/wjq/models_weights/Big/BigFaced', num_workers=16, label_smoothing=0.1, multi_lr=False, frozen=False, use_pretrained_weights=True, foundation_dir='pretrained_weights/pretrained_weights.pth')
The downstream dataset is PEARL
3255 476 874
4605
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (meta_backbone): Sequential(
    (0): Linear(in_features=28, out_features=50, bias=True)
    (1): ELU(alpha=1.0)
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=50, out_features=100, bias=True)
    (4): ELU(alpha=1.0)
    (5): Dropout(p=0.1, inplace=False)
    (6): Linear(in_features=100, out_features=100, bias=True)
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=19000, out_features=1000, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1, inplace=False)
    (4): Linear(in_features=1000, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1, inplace=False)
  )
  (final_classifier): Sequential(
    (0): Linear(in_features=300, out_features=200, bias=True)
    (1): ELU(alpha=1.0)
    (2): Dropout(p=0.1, inplace=False)
    (3): Linear(in_features=200, out_features=1, bias=True)
    (4): Rearrange('b 1 -> (b 1)')
  )
)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:06<00:00,  8.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 42.26it/s]
Epoch 1 : Training Loss: 0.59544, acc: 0.57143, pr_auc: 0.53913, roc_auc: 0.53418, LR: 0.00010, Time elapsed 0.11 mins
[[160  78]
 [126 112]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 44.44it/s]
Test Evaluation: acc: 0.63029, pr_auc: 0.76596, roc_auc: 0.69229
[[311 157]
 [164 242]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.57143, pr_auc: 0.53913, roc_auc: 0.53418
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.88it/s]
Epoch 2 : Training Loss: 0.35149, acc: 0.51681, pr_auc: 0.50181, roc_auc: 0.51167, LR: 0.00010, Time elapsed 0.08 mins
[[195  43]
 [187  51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.93it/s]
Test Evaluation: acc: 0.73206, pr_auc: 0.79389, roc_auc: 0.77496
[[427  41]
 [182 224]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.16it/s]
Epoch 3 : Training Loss: 0.19689, acc: 0.47689, pr_auc: 0.46396, roc_auc: 0.45564, LR: 0.00010, Time elapsed 0.08 mins
[[135 103]
 [146  92]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.90it/s]
Test Evaluation: acc: 0.67254, pr_auc: 0.78332, roc_auc: 0.78744
[[354 114]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.83it/s]
Epoch 4 : Training Loss: 0.11666, acc: 0.47899, pr_auc: 0.50207, roc_auc: 0.51861, LR: 0.00010, Time elapsed 0.07 mins
[[168  70]
 [178  60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.36it/s]
Test Evaluation: acc: 0.67107, pr_auc: 0.75607, roc_auc: 0.76217
[[363 105]
 [176 230]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.78it/s]
Epoch 5 : Training Loss: 0.09747, acc: 0.56092, pr_auc: 0.58922, roc_auc: 0.65868, LR: 0.00010, Time elapsed 0.07 mins
[[158  80]
 [129 109]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 47.09it/s]
Test Evaluation: acc: 0.68767, pr_auc: 0.81839, roc_auc: 0.78553
[[299 169]
 [107 299]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.56092, pr_auc: 0.58922, roc_auc: 0.65868
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.51it/s]
Epoch 6 : Training Loss: 0.06603, acc: 0.53151, pr_auc: 0.57657, roc_auc: 0.59989, LR: 0.00010, Time elapsed 0.08 mins
[[202  36]
 [187  51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.64it/s]
Test Evaluation: acc: 0.69191, pr_auc: 0.71997, roc_auc: 0.67324
[[424  44]
 [212 194]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.15it/s]
Epoch 7 : Training Loss: 0.04454, acc: 0.52731, pr_auc: 0.54093, roc_auc: 0.54899, LR: 0.00010, Time elapsed 0.08 mins
[[164  74]
 [151  87]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.25it/s]
Test Evaluation: acc: 0.65068, pr_auc: 0.80518, roc_auc: 0.77320
[[337 131]
 [170 236]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.24it/s]
Epoch 8 : Training Loss: 0.03504, acc: 0.53782, pr_auc: 0.56591, roc_auc: 0.59154, LR: 0.00009, Time elapsed 0.08 mins
[[202  36]
 [184  54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.16it/s]
Test Evaluation: acc: 0.68103, pr_auc: 0.77622, roc_auc: 0.73657
[[385  83]
 [187 219]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.76it/s]
Epoch 9 : Training Loss: 0.02076, acc: 0.58403, pr_auc: 0.63188, roc_auc: 0.65347, LR: 0.00009, Time elapsed 0.08 mins
[[186  52]
 [146  92]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.67it/s]
Test Evaluation: acc: 0.67739, pr_auc: 0.79893, roc_auc: 0.77002
[[362 106]
 [170 236]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.87it/s]
Epoch 10 : Training Loss: 0.01666, acc: 0.56933, pr_auc: 0.60864, roc_auc: 0.61136, LR: 0.00009, Time elapsed 0.08 mins
[[184  54]
 [151  87]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.06it/s]
Test Evaluation: acc: 0.60952, pr_auc: 0.74659, roc_auc: 0.72490
[[310 158]
 [180 226]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.09it/s]
Epoch 11 : Training Loss: 0.00331, acc: 0.57143, pr_auc: 0.62470, roc_auc: 0.61971, LR: 0.00009, Time elapsed 0.08 mins
[[207  31]
 [173  65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.14it/s]
Test Evaluation: acc: 0.61035, pr_auc: 0.75137, roc_auc: 0.71876
[[320 148]
 [188 218]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.68it/s]
Epoch 12 : Training Loss: 0.00338, acc: 0.55252, pr_auc: 0.64009, roc_auc: 0.67438, LR: 0.00009, Time elapsed 0.08 mins
[[181  57]
 [156  82]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.43it/s]
Test Evaluation: acc: 0.64501, pr_auc: 0.78562, roc_auc: 0.76268
[[334 134]
 [172 234]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.55252, pr_auc: 0.64009, roc_auc: 0.67438
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.30it/s]
Epoch 13 : Training Loss: 0.00216, acc: 0.56723, pr_auc: 0.63213, roc_auc: 0.65571, LR: 0.00008, Time elapsed 0.08 mins
[[190  48]
 [158  80]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.60it/s]
Test Evaluation: acc: 0.61856, pr_auc: 0.76545, roc_auc: 0.73074
[[315 153]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.35it/s]
Epoch 14 : Training Loss: 0.00109, acc: 0.60294, pr_auc: 0.67427, roc_auc: 0.66078, LR: 0.00008, Time elapsed 0.08 mins
[[171  67]
 [122 116]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.24it/s]
Test Evaluation: acc: 0.62412, pr_auc: 0.78726, roc_auc: 0.76184
[[296 172]
 [156 250]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.07it/s]
Epoch 15 : Training Loss: 0.00050, acc: 0.63025, pr_auc: 0.64855, roc_auc: 0.59779, LR: 0.00008, Time elapsed 0.08 mins
[[193  45]
 [131 107]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.86it/s]
Test Evaluation: acc: 0.61371, pr_auc: 0.76707, roc_auc: 0.74186
[[307 161]
 [174 232]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.12it/s]
Epoch 16 : Training Loss: 0.00242, acc: 0.55462, pr_auc: 0.64375, roc_auc: 0.66184, LR: 0.00008, Time elapsed 0.08 mins
[[186  52]
 [160  78]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.14it/s]
Test Evaluation: acc: 0.63245, pr_auc: 0.76237, roc_auc: 0.74695
[[328 140]
 [177 229]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.55it/s]
Epoch 17 : Training Loss: 0.00144, acc: 0.52521, pr_auc: 0.60748, roc_auc: 0.64291, LR: 0.00007, Time elapsed 0.08 mins
[[200  38]
 [188  50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.98it/s]
Test Evaluation: acc: 0.64487, pr_auc: 0.76690, roc_auc: 0.74283
[[350 118]
 [186 220]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 48.01it/s]
Epoch 18 : Training Loss: 0.00021, acc: 0.62185, pr_auc: 0.64718, roc_auc: 0.60600, LR: 0.00007, Time elapsed 0.08 mins
[[185  53]
 [127 111]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.06it/s]
Test Evaluation: acc: 0.60228, pr_auc: 0.75203, roc_auc: 0.74036
[[294 174]
 [172 234]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.66it/s]
Epoch 19 : Training Loss: 0.00011, acc: 0.59664, pr_auc: 0.64117, roc_auc: 0.61652, LR: 0.00007, Time elapsed 0.08 mins
[[179  59]
 [133 105]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 46.34it/s]
Test Evaluation: acc: 0.61378, pr_auc: 0.76045, roc_auc: 0.75161
[[299 169]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.22it/s]
Epoch 20 : Training Loss: 0.00107, acc: 0.61345, pr_auc: 0.67584, roc_auc: 0.68800, LR: 0.00007, Time elapsed 0.08 mins
[[189  49]
 [135 103]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.84it/s]
Test Evaluation: acc: 0.60581, pr_auc: 0.73432, roc_auc: 0.72975
[[295 173]
 [170 236]]
roc_auc increasing....saving weights !!
Val Evaluation: acc: 0.61345, pr_auc: 0.67584, roc_auc: 0.68800
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.07it/s]
Epoch 21 : Training Loss: 0.00054, acc: 0.58613, pr_auc: 0.65090, roc_auc: 0.67317, LR: 0.00006, Time elapsed 0.08 mins
[[183  55]
 [142  96]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.79it/s]
Test Evaluation: acc: 0.62052, pr_auc: 0.77808, roc_auc: 0.74982
[[303 165]
 [165 241]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.32it/s]
Epoch 22 : Training Loss: 0.00039, acc: 0.58613, pr_auc: 0.64706, roc_auc: 0.66457, LR: 0.00006, Time elapsed 0.08 mins
[[184  54]
 [143  95]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.05it/s]
Test Evaluation: acc: 0.57704, pr_auc: 0.77808, roc_auc: 0.74574
[[260 208]
 [163 243]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 47.25it/s]
Epoch 23 : Training Loss: 0.00024, acc: 0.61345, pr_auc: 0.66440, roc_auc: 0.67088, LR: 0.00006, Time elapsed 0.08 mins
[[174  64]
 [120 118]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 44.86it/s]
Test Evaluation: acc: 0.59430, pr_auc: 0.77695, roc_auc: 0.75179
[[275 193]
 [162 244]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.44it/s]
Epoch 24 : Training Loss: 0.00014, acc: 0.56513, pr_auc: 0.64929, roc_auc: 0.68456, LR: 0.00005, Time elapsed 0.08 mins
[[185  53]
 [154  84]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 45.11it/s]
Test Evaluation: acc: 0.61995, pr_auc: 0.75569, roc_auc: 0.73682
[[314 154]
 [175 231]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.09it/s]
Epoch 25 : Training Loss: 0.00006, acc: 0.62395, pr_auc: 0.68249, roc_auc: 0.66314, LR: 0.00005, Time elapsed 0.08 mins
[[181  57]
 [122 116]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 44.07it/s]
Test Evaluation: acc: 0.60235, pr_auc: 0.76018, roc_auc: 0.73985
[[286 182]
 [165 241]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 46.01it/s]
Epoch 26 : Training Loss: 0.00004, acc: 0.62185, pr_auc: 0.66512, roc_auc: 0.65955, LR: 0.00005, Time elapsed 0.08 mins
[[185  53]
 [127 111]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.56it/s]
Test Evaluation: acc: 0.59283, pr_auc: 0.74207, roc_auc: 0.72541
[[284 184]
 [171 235]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.25it/s]
Epoch 27 : Training Loss: 0.00001, acc: 0.59034, pr_auc: 0.66064, roc_auc: 0.66344, LR: 0.00004, Time elapsed 0.08 mins
[[183  55]
 [140  98]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.35it/s]
Test Evaluation: acc: 0.60310, pr_auc: 0.75438, roc_auc: 0.73504
[[289 179]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.76it/s]
Epoch 28 : Training Loss: 0.00001, acc: 0.60084, pr_auc: 0.66418, roc_auc: 0.66251, LR: 0.00004, Time elapsed 0.08 mins
[[183  55]
 [135 103]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.99it/s]
Test Evaluation: acc: 0.59989, pr_auc: 0.75387, roc_auc: 0.73447
[[286 182]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.20it/s]
Epoch 29 : Training Loss: 0.00001, acc: 0.59244, pr_auc: 0.66027, roc_auc: 0.66369, LR: 0.00004, Time elapsed 0.08 mins
[[185  53]
 [141  97]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 41.58it/s]
Test Evaluation: acc: 0.60186, pr_auc: 0.75284, roc_auc: 0.73355
[[289 179]
 [168 238]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.18it/s]
Epoch 30 : Training Loss: 0.00001, acc: 0.59244, pr_auc: 0.66134, roc_auc: 0.66379, LR: 0.00004, Time elapsed 0.08 mins
[[185  53]
 [141  97]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.93it/s]
Test Evaluation: acc: 0.60186, pr_auc: 0.75453, roc_auc: 0.73499
[[289 179]
 [168 238]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.11it/s]
Epoch 31 : Training Loss: 0.00001, acc: 0.59034, pr_auc: 0.66106, roc_auc: 0.66542, LR: 0.00003, Time elapsed 0.08 mins
[[185  53]
 [142  96]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.95it/s]
Test Evaluation: acc: 0.60737, pr_auc: 0.75746, roc_auc: 0.73744
[[293 175]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.11it/s]
Epoch 32 : Training Loss: 0.00001, acc: 0.59244, pr_auc: 0.66017, roc_auc: 0.66464, LR: 0.00003, Time elapsed 0.08 mins
[[185  53]
 [141  97]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.56it/s]
Test Evaluation: acc: 0.60614, pr_auc: 0.75181, roc_auc: 0.73395
[[293 175]
 [168 238]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.61it/s]
Epoch 33 : Training Loss: 0.00001, acc: 0.59034, pr_auc: 0.65780, roc_auc: 0.66450, LR: 0.00003, Time elapsed 0.08 mins
[[185  53]
 [142  96]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.09it/s]
Test Evaluation: acc: 0.60737, pr_auc: 0.75371, roc_auc: 0.73537
[[293 175]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.55it/s]
Epoch 34 : Training Loss: 0.00001, acc: 0.59034, pr_auc: 0.65697, roc_auc: 0.66409, LR: 0.00002, Time elapsed 0.08 mins
[[185  53]
 [142  96]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.52it/s]
Test Evaluation: acc: 0.60844, pr_auc: 0.75445, roc_auc: 0.73590
[[294 174]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.86it/s]
Epoch 35 : Training Loss: 0.00001, acc: 0.59034, pr_auc: 0.65928, roc_auc: 0.66472, LR: 0.00002, Time elapsed 0.08 mins
[[185  53]
 [142  96]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.98it/s]
Test Evaluation: acc: 0.60630, pr_auc: 0.75595, roc_auc: 0.73685
[[292 176]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.94it/s]
Epoch 36 : Training Loss: 0.00001, acc: 0.59034, pr_auc: 0.65596, roc_auc: 0.66515, LR: 0.00002, Time elapsed 0.08 mins
[[185  53]
 [142  96]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.89it/s]
Test Evaluation: acc: 0.61057, pr_auc: 0.75666, roc_auc: 0.73719
[[296 172]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.18it/s]
Epoch 37 : Training Loss: 0.00001, acc: 0.59034, pr_auc: 0.65608, roc_auc: 0.66492, LR: 0.00002, Time elapsed 0.08 mins
[[185  53]
 [142  96]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.89it/s]
Test Evaluation: acc: 0.61057, pr_auc: 0.75649, roc_auc: 0.73712
[[296 172]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.57it/s]
Epoch 38 : Training Loss: 0.00000, acc: 0.59034, pr_auc: 0.65795, roc_auc: 0.66450, LR: 0.00001, Time elapsed 0.08 mins
[[185  53]
 [142  96]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.99it/s]
Test Evaluation: acc: 0.61057, pr_auc: 0.75634, roc_auc: 0.73703
[[296 172]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 43.86it/s]
Epoch 39 : Training Loss: 0.00001, acc: 0.58824, pr_auc: 0.65449, roc_auc: 0.66456, LR: 0.00001, Time elapsed 0.08 mins
[[185  53]
 [143  95]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.50it/s]
Test Evaluation: acc: 0.61271, pr_auc: 0.75722, roc_auc: 0.73770
[[298 170]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.41it/s]
Epoch 40 : Training Loss: 0.00001, acc: 0.58824, pr_auc: 0.65455, roc_auc: 0.66483, LR: 0.00001, Time elapsed 0.08 mins
[[185  53]
 [143  95]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.27it/s]
Test Evaluation: acc: 0.61271, pr_auc: 0.75810, roc_auc: 0.73831
[[298 170]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.58it/s]
Epoch 41 : Training Loss: 0.00001, acc: 0.58824, pr_auc: 0.65377, roc_auc: 0.66469, LR: 0.00001, Time elapsed 0.08 mins
[[185  53]
 [143  95]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 41.59it/s]
Test Evaluation: acc: 0.61271, pr_auc: 0.75817, roc_auc: 0.73830
[[298 170]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.33it/s]
Epoch 42 : Training Loss: 0.00001, acc: 0.59034, pr_auc: 0.65429, roc_auc: 0.66556, LR: 0.00001, Time elapsed 0.08 mins
[[185  53]
 [142  96]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.63it/s]
Test Evaluation: acc: 0.61164, pr_auc: 0.75822, roc_auc: 0.73872
[[297 171]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.82it/s]
Epoch 43 : Training Loss: 0.00001, acc: 0.59244, pr_auc: 0.65511, roc_auc: 0.66455, LR: 0.00001, Time elapsed 0.08 mins
[[185  53]
 [141  97]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.26it/s]
Test Evaluation: acc: 0.60951, pr_auc: 0.75927, roc_auc: 0.73967
[[295 173]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.61it/s]
Epoch 44 : Training Loss: 0.00001, acc: 0.59244, pr_auc: 0.65576, roc_auc: 0.66468, LR: 0.00000, Time elapsed 0.08 mins
[[185  53]
 [141  97]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.97it/s]
Test Evaluation: acc: 0.60951, pr_auc: 0.75911, roc_auc: 0.73951
[[295 173]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.30it/s]
Epoch 45 : Training Loss: 0.00001, acc: 0.59244, pr_auc: 0.65532, roc_auc: 0.66463, LR: 0.00000, Time elapsed 0.08 mins
[[185  53]
 [141  97]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.53it/s]
Test Evaluation: acc: 0.60951, pr_auc: 0.75900, roc_auc: 0.73946
[[295 173]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.33it/s]
Epoch 46 : Training Loss: 0.00001, acc: 0.59244, pr_auc: 0.65513, roc_auc: 0.66458, LR: 0.00000, Time elapsed 0.08 mins
[[185  53]
 [141  97]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.08it/s]
Test Evaluation: acc: 0.60951, pr_auc: 0.75892, roc_auc: 0.73945
[[295 173]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.32it/s]
Epoch 47 : Training Loss: 0.00000, acc: 0.59244, pr_auc: 0.65503, roc_auc: 0.66455, LR: 0.00000, Time elapsed 0.08 mins
[[185  53]
 [141  97]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.77it/s]
Test Evaluation: acc: 0.60951, pr_auc: 0.75900, roc_auc: 0.73947
[[295 173]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.24it/s]
Epoch 48 : Training Loss: 0.00001, acc: 0.59244, pr_auc: 0.65512, roc_auc: 0.66455, LR: 0.00000, Time elapsed 0.08 mins
[[185  53]
 [141  97]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.71it/s]
Test Evaluation: acc: 0.60951, pr_auc: 0.75908, roc_auc: 0.73951
[[295 173]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 44.82it/s]
Epoch 49 : Training Loss: 0.00001, acc: 0.59244, pr_auc: 0.65530, roc_auc: 0.66462, LR: 0.00000, Time elapsed 0.08 mins
[[185  53]
 [141  97]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.88it/s]
Test Evaluation: acc: 0.60951, pr_auc: 0.75902, roc_auc: 0.73943
[[295 173]
 [167 239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:04<00:00, 11.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8/8 [00:00<00:00, 45.02it/s]
Epoch 50 : Training Loss: 0.00001, acc: 0.59034, pr_auc: 0.65537, roc_auc: 0.66476, LR: 0.00000, Time elapsed 0.08 mins
[[185  53]
 [142  96]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 43.14it/s]
Test Evaluation: acc: 0.60951, pr_auc: 0.75890, roc_auc: 0.73932
[[295 173]
 [167 239]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 14/14 [00:00<00:00, 42.41it/s]
***************************Test results************************
Test Evaluation: acc: 0.60581, pr_auc: 0.73432, roc_auc: 0.72975
[[295 173]
 [170 236]]
model save in ./data/wjq/models_weights/Big/BigFaced/epoch20_acc_0.60581_pr_0.73432_roc_0.72975.pth
Done!!!!!
