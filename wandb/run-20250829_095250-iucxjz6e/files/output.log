100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.94it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.77it/s]
Epoch 1 : Training Loss: 1.62372, acc: 0.20800, kappa: 0.01000, f1: 0.09163, LR: 0.00004, Time elapsed 0.21 mins
[[  4   5   0   0 141]
 [  7   6   2   0 135]
 [  2   1   0   0 147]
 [  2   2   1   0 145]
 [  2   2   0   0 146]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20800, kappa: 0.01000, f1: 0.09163
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.26it/s]
Epoch 2 : Training Loss: 1.60310, acc: 0.21200, kappa: 0.01500, f1: 0.12322, LR: 0.00004, Time elapsed 0.21 mins
[[ 0 78  0 72  0]
 [ 2 93  0 54  1]
 [ 1 64  0 84  1]
 [ 0 85  0 65  0]
 [ 1 69  0 79  1]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21200, kappa: 0.01500, f1: 0.12322
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 3 : Training Loss: 1.58193, acc: 0.25733, kappa: 0.07167, f1: 0.23616, LR: 0.00004, Time elapsed 0.21 mins
[[55 34 36 11 14]
 [46 40 37 10 17]
 [36 29 66  4 15]
 [48 35 43  8 16]
 [49 32 38  7 24]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25733, kappa: 0.07167, f1: 0.23616
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.04it/s]
Epoch 4 : Training Loss: 1.54072, acc: 0.23467, kappa: 0.04333, f1: 0.22132, LR: 0.00004, Time elapsed 0.21 mins
[[26 29  6 44 45]
 [32 48  5 32 33]
 [35 27 10 35 43]
 [27 36  5 37 45]
 [29 28  8 30 55]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.19it/s]
Epoch 5 : Training Loss: 1.47984, acc: 0.25200, kappa: 0.06500, f1: 0.24972, LR: 0.00004, Time elapsed 0.21 mins
[[56 23 17 25 29]
 [55 34 11 23 27]
 [45 22 28 26 29]
 [46 23 14 34 33]
 [56 18 14 25 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.44it/s]
Epoch 6 : Training Loss: 1.42219, acc: 0.25067, kappa: 0.06333, f1: 0.25109, LR: 0.00004, Time elapsed 0.21 mins
[[40 20 30 37 23]
 [45 29 19 36 21]
 [32 16 40 35 27]
 [34 21 20 42 33]
 [40 14 20 39 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.20it/s]
Epoch 7 : Training Loss: 1.35610, acc: 0.24933, kappa: 0.06167, f1: 0.24023, LR: 0.00004, Time elapsed 0.21 mins
[[51 23 10 31 35]
 [51 32  3 29 35]
 [44 20 15 31 40]
 [42 19  6 37 46]
 [52 16  9 21 52]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.91it/s]
Epoch 8 : Training Loss: 1.28492, acc: 0.24933, kappa: 0.06167, f1: 0.24515, LR: 0.00004, Time elapsed 0.21 mins
[[25 29 31 26 39]
 [27 40 27 21 35]
 [21 25 47 20 37]
 [22 23 33 25 47]
 [29 25 27 19 50]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 9 : Training Loss: 1.22051, acc: 0.24533, kappa: 0.05667, f1: 0.24369, LR: 0.00004, Time elapsed 0.21 mins
[[29 30 27 29 35]
 [38 37 14 31 30]
 [25 25 30 28 42]
 [28 26 14 37 45]
 [32 23 17 27 51]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.58it/s]
Epoch 10 : Training Loss: 1.13761, acc: 0.23733, kappa: 0.04667, f1: 0.23720, LR: 0.00004, Time elapsed 0.21 mins
[[35 26 25 26 38]
 [39 36 21 29 25]
 [28 18 35 26 43]
 [34 20 22 27 47]
 [37 24 20 24 45]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.20it/s]
Epoch 11 : Training Loss: 1.07839, acc: 0.24533, kappa: 0.05667, f1: 0.24675, LR: 0.00004, Time elapsed 0.21 mins
[[38 32 17 34 29]
 [48 36 11 31 24]
 [35 21 31 28 35]
 [37 21 17 35 40]
 [44 20 13 29 44]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.25it/s]
Epoch 12 : Training Loss: 1.00360, acc: 0.24400, kappa: 0.05500, f1: 0.24182, LR: 0.00003, Time elapsed 0.21 mins
[[27 35 19 37 32]
 [22 42  9 45 32]
 [19 27 28 31 45]
 [21 30 16 38 45]
 [28 28 16 30 48]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
Epoch 13 : Training Loss: 0.93477, acc: 0.22800, kappa: 0.03500, f1: 0.22472, LR: 0.00003, Time elapsed 0.21 mins
[[28 17 25 47 33]
 [33 24 18 44 31]
 [22 16 29 43 40]
 [30 11 19 47 43]
 [32 16 24 35 43]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.09it/s]
Epoch 14 : Training Loss: 0.87073, acc: 0.24400, kappa: 0.05500, f1: 0.24378, LR: 0.00003, Time elapsed 0.21 mins
[[37 29 19 33 32]
 [27 42 12 38 31]
 [23 27 28 33 39]
 [30 28 11 34 47]
 [35 23 22 28 42]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.61it/s]
Epoch 15 : Training Loss: 0.81413, acc: 0.26133, kappa: 0.07667, f1: 0.26204, LR: 0.00003, Time elapsed 0.21 mins
[[44 23 16 40 27]
 [32 41 15 39 23]
 [29 24 33 35 29]
 [38 18 18 43 33]
 [40 19 22 34 35]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26133, kappa: 0.07667, f1: 0.26204
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.08it/s]
Epoch 16 : Training Loss: 0.76178, acc: 0.27200, kappa: 0.09000, f1: 0.27193, LR: 0.00003, Time elapsed 0.21 mins
[[34 29 25 38 24]
 [24 45 21 36 24]
 [19 29 43 25 34]
 [24 24 23 39 40]
 [32 21 31 23 43]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27200, kappa: 0.09000, f1: 0.27193
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.64it/s]
Epoch 17 : Training Loss: 0.70750, acc: 0.27200, kappa: 0.09000, f1: 0.27186, LR: 0.00003, Time elapsed 0.21 mins
[[35 35 22 33 25]
 [27 44 20 39 20]
 [17 28 43 31 31]
 [21 26 29 41 33]
 [27 27 31 24 41]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.74it/s]
Epoch 18 : Training Loss: 0.67947, acc: 0.26667, kappa: 0.08333, f1: 0.26525, LR: 0.00003, Time elapsed 0.21 mins
[[36 35 27 35 17]
 [28 52 16 35 19]
 [22 33 36 32 27]
 [25 32 19 42 32]
 [31 29 28 28 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.92it/s]
Epoch 19 : Training Loss: 0.64136, acc: 0.24933, kappa: 0.06167, f1: 0.24890, LR: 0.00003, Time elapsed 0.21 mins
[[38 22 28 28 34]
 [33 36 13 38 30]
 [23 24 31 29 43]
 [27 24 21 37 41]
 [36 17 25 27 45]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.14it/s]
Epoch 20 : Training Loss: 0.60748, acc: 0.25467, kappa: 0.06833, f1: 0.25466, LR: 0.00003, Time elapsed 0.21 mins
[[41 29 27 27 26]
 [40 35 22 33 20]
 [26 25 40 29 30]
 [29 27 26 33 35]
 [41 18 25 24 42]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.67it/s]
Epoch 21 : Training Loss: 0.58210, acc: 0.26800, kappa: 0.08500, f1: 0.26736, LR: 0.00003, Time elapsed 0.21 mins
[[43 33 26 27 21]
 [35 41 20 35 19]
 [23 27 48 28 24]
 [29 26 29 35 31]
 [37 21 35 23 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.91it/s]
Epoch 22 : Training Loss: 0.56559, acc: 0.25333, kappa: 0.06667, f1: 0.25405, LR: 0.00002, Time elapsed 0.21 mins
[[40 21 28 33 28]
 [35 35 22 42 16]
 [26 20 43 31 30]
 [32 28 25 36 29]
 [44 16 27 27 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.94it/s]
Epoch 23 : Training Loss: 0.54278, acc: 0.26533, kappa: 0.08167, f1: 0.26543, LR: 0.00002, Time elapsed 0.21 mins
[[37 26 26 33 28]
 [36 36 20 37 21]
 [20 18 48 29 35]
 [23 26 26 36 39]
 [37 15 33 23 42]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 24 : Training Loss: 0.53187, acc: 0.26533, kappa: 0.08167, f1: 0.26512, LR: 0.00002, Time elapsed 0.21 mins
[[47 26 21 33 23]
 [36 38 16 39 21]
 [26 22 38 31 33]
 [34 26 18 43 29]
 [46 17 28 26 33]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
Epoch 25 : Training Loss: 0.51168, acc: 0.26533, kappa: 0.08167, f1: 0.26540, LR: 0.00002, Time elapsed 0.21 mins
[[37 18 23 37 35]
 [33 32 17 37 31]
 [24 16 41 28 41]
 [29 23 19 42 37]
 [36 12 27 28 47]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.95it/s]
Epoch 26 : Training Loss: 0.50414, acc: 0.26800, kappa: 0.08500, f1: 0.26832, LR: 0.00002, Time elapsed 0.21 mins
[[48 26 20 34 22]
 [40 42 11 38 19]
 [32 25 38 27 28]
 [31 26 16 42 35]
 [49 18 23 29 31]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.76it/s]
Epoch 27 : Training Loss: 0.48599, acc: 0.26933, kappa: 0.08667, f1: 0.26945, LR: 0.00002, Time elapsed 0.21 mins
[[42 29 22 36 21]
 [40 43 12 39 16]
 [28 27 38 32 25]
 [36 23 16 47 28]
 [41 22 26 29 32]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 28 : Training Loss: 0.48511, acc: 0.26667, kappa: 0.08333, f1: 0.26668, LR: 0.00002, Time elapsed 0.21 mins
[[36 27 26 29 32]
 [36 43 17 29 25]
 [23 26 38 25 38]
 [28 22 20 35 45]
 [35 18 26 23 48]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.85it/s]
Epoch 29 : Training Loss: 0.47740, acc: 0.27467, kappa: 0.09333, f1: 0.27534, LR: 0.00002, Time elapsed 0.21 mins
[[42 25 22 33 28]
 [33 39 19 36 23]
 [22 23 45 26 34]
 [33 20 22 41 34]
 [36 17 33 25 39]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27467, kappa: 0.09333, f1: 0.27534
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
Epoch 30 : Training Loss: 0.46478, acc: 0.27333, kappa: 0.09167, f1: 0.27226, LR: 0.00001, Time elapsed 0.21 mins
[[36 34 27 35 18]
 [25 47 22 42 14]
 [22 25 44 30 29]
 [23 27 29 46 25]
 [37 21 31 29 32]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.95it/s]
Epoch 31 : Training Loss: 0.46288, acc: 0.27867, kappa: 0.09833, f1: 0.27894, LR: 0.00001, Time elapsed 0.21 mins
[[41 26 20 35 28]
 [39 39 17 39 16]
 [24 23 39 28 36]
 [27 22 19 48 34]
 [38 16 26 28 42]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27867, kappa: 0.09833, f1: 0.27894
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 32 : Training Loss: 0.45536, acc: 0.27067, kappa: 0.08833, f1: 0.27117, LR: 0.00001, Time elapsed 0.21 mins
[[35 28 24 38 25]
 [34 41 17 38 20]
 [23 26 45 29 27]
 [29 28 22 45 26]
 [37 18 29 29 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.05it/s]
Epoch 33 : Training Loss: 0.44964, acc: 0.26267, kappa: 0.07833, f1: 0.26410, LR: 0.00001, Time elapsed 0.21 mins
[[34 28 20 35 33]
 [32 43 15 36 24]
 [24 22 41 29 34]
 [30 26 19 38 37]
 [37 15 31 26 41]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 34 : Training Loss: 0.44471, acc: 0.26800, kappa: 0.08500, f1: 0.26841, LR: 0.00001, Time elapsed 0.21 mins
[[40 33 20 33 24]
 [35 42 19 38 16]
 [26 26 47 25 26]
 [36 25 22 40 27]
 [38 21 30 29 32]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.11it/s]
Epoch 35 : Training Loss: 0.44216, acc: 0.27200, kappa: 0.09000, f1: 0.27289, LR: 0.00001, Time elapsed 0.21 mins
[[40 30 19 34 27]
 [28 43 19 44 16]
 [21 28 41 30 30]
 [29 28 18 42 33]
 [32 21 26 33 38]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.60it/s]
Epoch 36 : Training Loss: 0.43853, acc: 0.26400, kappa: 0.08000, f1: 0.26511, LR: 0.00001, Time elapsed 0.21 mins
[[37 30 23 34 26]
 [34 43 17 38 18]
 [21 24 41 27 37]
 [31 27 21 38 33]
 [40 13 30 28 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.37it/s]
Epoch 37 : Training Loss: 0.43783, acc: 0.27067, kappa: 0.08833, f1: 0.27117, LR: 0.00001, Time elapsed 0.21 mins
[[37 32 22 30 29]
 [33 49 13 35 20]
 [29 24 40 25 32]
 [28 28 21 40 33]
 [35 21 30 27 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.08it/s]
Epoch 38 : Training Loss: 0.43217, acc: 0.26800, kappa: 0.08500, f1: 0.26880, LR: 0.00001, Time elapsed 0.21 mins
[[35 29 21 38 27]
 [29 43 18 40 20]
 [21 24 44 29 32]
 [28 26 23 42 31]
 [35 19 28 31 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.16it/s]
Epoch 39 : Training Loss: 0.43103, acc: 0.27733, kappa: 0.09667, f1: 0.27767, LR: 0.00001, Time elapsed 0.21 mins
[[32 35 21 35 27]
 [30 46 17 38 19]
 [22 31 45 24 28]
 [27 27 18 44 34]
 [34 19 28 28 41]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.15it/s]
Epoch 40 : Training Loss: 0.42864, acc: 0.28000, kappa: 0.10000, f1: 0.28084, LR: 0.00000, Time elapsed 0.21 mins
[[38 27 25 35 25]
 [32 41 18 37 22]
 [26 21 47 25 31]
 [28 24 22 43 33]
 [37 17 28 27 41]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28000, kappa: 0.10000, f1: 0.28084
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.67it/s]
Epoch 41 : Training Loss: 0.42706, acc: 0.27733, kappa: 0.09667, f1: 0.27840, LR: 0.00000, Time elapsed 0.21 mins
[[40 27 20 35 28]
 [33 38 17 42 20]
 [25 19 44 32 30]
 [33 22 21 46 28]
 [38 13 27 32 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.01it/s]
Epoch 42 : Training Loss: 0.42716, acc: 0.27467, kappa: 0.09333, f1: 0.27529, LR: 0.00000, Time elapsed 0.21 mins
[[34 33 22 34 27]
 [30 42 18 41 19]
 [21 29 47 26 27]
 [29 25 23 43 30]
 [35 19 26 30 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.13it/s]
Epoch 43 : Training Loss: 0.42612, acc: 0.27600, kappa: 0.09500, f1: 0.27657, LR: 0.00000, Time elapsed 0.21 mins
[[36 33 20 34 27]
 [28 43 18 44 17]
 [21 30 45 26 28]
 [28 27 20 45 30]
 [36 20 26 30 38]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.13it/s]
Epoch 44 : Training Loss: 0.42348, acc: 0.26667, kappa: 0.08333, f1: 0.26756, LR: 0.00000, Time elapsed 0.21 mins
[[36 30 20 33 31]
 [30 41 19 41 19]
 [22 28 43 27 30]
 [29 25 22 41 33]
 [38 16 27 30 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 45 : Training Loss: 0.42336, acc: 0.27733, kappa: 0.09667, f1: 0.27774, LR: 0.00000, Time elapsed 0.21 mins
[[39 29 22 35 25]
 [28 41 20 45 16]
 [23 28 43 30 26]
 [31 25 20 47 27]
 [37 18 26 31 38]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.09it/s]
Epoch 46 : Training Loss: 0.42153, acc: 0.27200, kappa: 0.09000, f1: 0.27281, LR: 0.00000, Time elapsed 0.21 mins
[[38 28 21 35 28]
 [30 41 19 42 18]
 [24 26 42 30 28]
 [30 24 21 44 31]
 [39 16 27 29 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.29it/s]
Epoch 47 : Training Loss: 0.42234, acc: 0.27333, kappa: 0.09167, f1: 0.27386, LR: 0.00000, Time elapsed 0.21 mins
[[36 31 22 34 27]
 [29 42 20 40 19]
 [22 29 46 26 27]
 [30 23 25 42 30]
 [37 18 28 28 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.13it/s]
Epoch 48 : Training Loss: 0.42157, acc: 0.27200, kappa: 0.09000, f1: 0.27289, LR: 0.00000, Time elapsed 0.21 mins
[[36 31 20 35 28]
 [28 42 20 42 18]
 [22 26 44 27 31]
 [30 23 23 42 32]
 [36 17 26 31 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.71it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.11it/s]
Epoch 49 : Training Loss: 0.42043, acc: 0.27733, kappa: 0.09667, f1: 0.27801, LR: 0.00000, Time elapsed 0.22 mins
[[37 31 20 34 28]
 [27 43 19 43 18]
 [22 28 45 27 28]
 [29 25 22 44 30]
 [36 17 27 31 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.90it/s]
Epoch 50 : Training Loss: 0.42151, acc: 0.27733, kappa: 0.09667, f1: 0.27811, LR: 0.00000, Time elapsed 0.21 mins
[[36 31 21 34 28]
 [28 43 19 42 18]
 [22 24 47 29 28]
 [29 25 23 43 30]
 [36 17 28 30 39]]
***************************Test************************
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
***************************Test results************************
Test Evaluation: acc: 0.27867, kappa: 0.09833, f1: 0.27720
[[52 22 29 24 23]
 [36 34 25 24 31]
 [33 28 40 21 28]
 [33 23 21 38 35]
 [31 20 26 28 45]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch40_acc_0.27867_kappa_0.09833_f1_0.27720.pth
[32m[I 2025-08-29 10:03:40,856][0m Trial 7 finished with value: 0.09833333333333338 and parameters: {'lr': 3.971084710792477e-05, 'weight_decay': 1.6529856983237873e-06, '--dropout': 0.12150897038028768, '--clip_value': 0.7557861855309373}. Best is trial 3 with value: 0.2683333333333333.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=1.4982086432155468e-06, weight_decay=0.02875972156225962, optimizer='AdamW', clip_value=1.7125960221746916, dropout=0.19312640661491187, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.19312640661491187, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.19312640661491187, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
