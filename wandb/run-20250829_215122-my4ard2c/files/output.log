100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.71it/s]
Epoch 1 : Training Loss: 1.69177, acc: 0.20533, kappa: 0.00667, f1: 0.09839, LR: 0.00018, Time elapsed 0.21 mins
[[  0   9   7   2 132]
 [  0   8   7   1 134]
 [  0   4   5   0 141]
 [  0   8   4   1 137]
 [  0   6   3   1 140]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20533, kappa: 0.00667, f1: 0.09839
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.08it/s]
Epoch 2 : Training Loss: 1.64713, acc: 0.22133, kappa: 0.02667, f1: 0.13134, LR: 0.00018, Time elapsed 0.21 mins
[[  1   5  26   0 118]
 [  1   9  26   1 113]
 [  0   3  26   0 121]
 [  1   4  20   0 125]
 [  0   6  14   0 130]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22133, kappa: 0.02667, f1: 0.13134
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.01it/s]
Epoch 3 : Training Loss: 1.62007, acc: 0.24000, kappa: 0.05000, f1: 0.22113, LR: 0.00018, Time elapsed 0.22 mins
[[44 16 65 14 11]
 [49 26 56  9 10]
 [37 15 75 12 11]
 [37 19 57 17 20]
 [41 13 64 14 18]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24000, kappa: 0.05000, f1: 0.22113
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.16it/s]
Epoch 4 : Training Loss: 1.60181, acc: 0.23867, kappa: 0.04833, f1: 0.18674, LR: 0.00018, Time elapsed 0.21 mins
[[ 7 17 44  5 77]
 [13 21 27  4 85]
 [ 7 10 48  3 82]
 [ 6 22 35  4 83]
 [ 7 14 28  2 99]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.77it/s]
Epoch 5 : Training Loss: 1.53852, acc: 0.26800, kappa: 0.08500, f1: 0.26399, LR: 0.00018, Time elapsed 0.22 mins
[[30 23 34 46 17]
 [29 36 33 33 19]
 [14 16 49 47 24]
 [24 23 28 56 19]
 [28 27 25 40 30]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26800, kappa: 0.08500, f1: 0.26399
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.79it/s]
Epoch 6 : Training Loss: 1.42573, acc: 0.30533, kappa: 0.13167, f1: 0.28719, LR: 0.00017, Time elapsed 0.22 mins
[[25 66 10 34 15]
 [23 99  7 14  7]
 [14 64 29 21 22]
 [21 62  8 40 19]
 [21 60 10 23 36]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.30533, kappa: 0.13167, f1: 0.28719
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 7 : Training Loss: 1.19993, acc: 0.34267, kappa: 0.17833, f1: 0.33857, LR: 0.00017, Time elapsed 0.21 mins
[[39 21 32 35 23]
 [30 41 31 31 17]
 [15 17 73 25 20]
 [26 17 28 57 22]
 [28 20 35 20 47]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.34267, kappa: 0.17833, f1: 0.33857
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.11it/s]
Epoch 8 : Training Loss: 0.91329, acc: 0.33333, kappa: 0.16667, f1: 0.33379, LR: 0.00017, Time elapsed 0.21 mins
[[43 22 19 38 28]
 [40 50 15 28 17]
 [25 25 42 27 31]
 [33 24 16 59 18]
 [33 24 14 23 56]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.26it/s]
Epoch 9 : Training Loss: 0.73037, acc: 0.34800, kappa: 0.18500, f1: 0.34611, LR: 0.00017, Time elapsed 0.21 mins
[[47 19 24 44 16]
 [35 41 20 37 17]
 [23 11 63 32 21]
 [26 18 26 67 13]
 [29 26 17 35 43]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.34800, kappa: 0.18500, f1: 0.34611
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.45it/s]
Epoch 10 : Training Loss: 0.62247, acc: 0.36667, kappa: 0.20833, f1: 0.36614, LR: 0.00016, Time elapsed 0.21 mins
[[44 31 24 20 31]
 [35 62 21 15 17]
 [18 20 64 16 32]
 [26 33 19 46 26]
 [25 34 17 15 59]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.36667, kappa: 0.20833, f1: 0.36614
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.24it/s]
Epoch 11 : Training Loss: 0.56817, acc: 0.37467, kappa: 0.21833, f1: 0.37462, LR: 0.00016, Time elapsed 0.21 mins
[[59 27 15 28 21]
 [33 48 28 19 22]
 [19 16 64 23 28]
 [34 25 17 57 17]
 [27 20 20 30 53]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.37467, kappa: 0.21833, f1: 0.37462
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.35it/s]
Epoch 12 : Training Loss: 0.53440, acc: 0.39067, kappa: 0.23833, f1: 0.38985, LR: 0.00016, Time elapsed 0.22 mins
[[52 19 19 25 35]
 [34 55 22 16 23]
 [14 27 62 20 27]
 [22 22 23 54 29]
 [23 15 17 25 70]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.39067, kappa: 0.23833, f1: 0.38985
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.82it/s]
Epoch 13 : Training Loss: 0.50711, acc: 0.36667, kappa: 0.20833, f1: 0.36621, LR: 0.00015, Time elapsed 0.21 mins
[[54 25 24 21 26]
 [32 60 18 13 27]
 [27 18 64 11 30]
 [33 24 22 40 31]
 [34 27 17 15 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.96it/s]
Epoch 14 : Training Loss: 0.48632, acc: 0.35200, kappa: 0.19000, f1: 0.35068, LR: 0.00015, Time elapsed 0.22 mins
[[45 30 19 27 29]
 [28 64 19 19 20]
 [18 29 58 15 30]
 [28 40 22 40 20]
 [23 36 16 18 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.56it/s]
Epoch 15 : Training Loss: 0.46595, acc: 0.36533, kappa: 0.20667, f1: 0.36433, LR: 0.00014, Time elapsed 0.21 mins
[[41 23 26 33 27]
 [28 62 22 19 19]
 [20 19 66 17 28]
 [22 26 22 55 25]
 [30 31 21 18 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.18it/s]
Epoch 16 : Training Loss: 0.45196, acc: 0.37067, kappa: 0.21333, f1: 0.36990, LR: 0.00014, Time elapsed 0.21 mins
[[46 26 18 27 33]
 [25 51 24 18 32]
 [13 18 63 23 33]
 [22 21 28 56 23]
 [23 25 19 21 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 17 : Training Loss: 0.43961, acc: 0.37467, kappa: 0.21833, f1: 0.36963, LR: 0.00013, Time elapsed 0.21 mins
[[38 28 25 37 22]
 [26 50 31 22 21]
 [13 12 79 26 20]
 [22 23 26 65 14]
 [22 28 25 26 49]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.09it/s]
Epoch 18 : Training Loss: 0.43066, acc: 0.38000, kappa: 0.22500, f1: 0.37782, LR: 0.00013, Time elapsed 0.21 mins
[[54 23 24 27 22]
 [37 45 27 21 20]
 [19 12 77 22 20]
 [26 23 25 57 19]
 [30 24 23 21 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.26it/s]
Epoch 19 : Training Loss: 0.42501, acc: 0.38133, kappa: 0.22667, f1: 0.38122, LR: 0.00012, Time elapsed 0.21 mins
[[53 25 21 26 25]
 [33 49 22 22 24]
 [23 14 66 19 28]
 [25 22 19 60 24]
 [25 24 23 20 58]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.34it/s]
Epoch 20 : Training Loss: 0.41777, acc: 0.37867, kappa: 0.22333, f1: 0.37753, LR: 0.00012, Time elapsed 0.21 mins
[[51 27 17 27 28]
 [31 44 25 26 24]
 [17 16 75 18 24]
 [27 24 22 56 21]
 [26 22 17 27 58]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.00it/s]
Epoch 21 : Training Loss: 0.41369, acc: 0.37200, kappa: 0.21500, f1: 0.37000, LR: 0.00011, Time elapsed 0.22 mins
[[47 27 22 31 23]
 [27 55 20 24 24]
 [15 17 76 18 24]
 [27 22 25 55 21]
 [23 30 25 26 46]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.35it/s]
Epoch 22 : Training Loss: 0.41235, acc: 0.36533, kappa: 0.20667, f1: 0.36643, LR: 0.00011, Time elapsed 0.22 mins
[[53 25 17 26 29]
 [31 48 18 27 26]
 [23 14 69 17 27]
 [38 20 16 53 23]
 [29 29 21 20 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.52it/s]
Epoch 23 : Training Loss: 0.40928, acc: 0.37600, kappa: 0.22000, f1: 0.37502, LR: 0.00010, Time elapsed 0.21 mins
[[51 27 20 26 26]
 [29 50 24 24 23]
 [19 16 74 19 22]
 [28 24 22 54 22]
 [27 26 23 21 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.40it/s]
Epoch 24 : Training Loss: 0.40784, acc: 0.38400, kappa: 0.23000, f1: 0.38227, LR: 0.00010, Time elapsed 0.21 mins
[[45 27 22 29 27]
 [27 50 28 19 26]
 [18  9 75 18 30]
 [22 23 21 59 25]
 [27 23 22 19 59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.24it/s]
Epoch 25 : Training Loss: 0.40617, acc: 0.38800, kappa: 0.23500, f1: 0.38761, LR: 0.00009, Time elapsed 0.21 mins
[[55 29 16 25 25]
 [28 53 22 23 24]
 [19 16 74 15 26]
 [26 23 22 56 23]
 [28 25 23 21 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.64it/s]
Epoch 26 : Training Loss: 0.40583, acc: 0.38800, kappa: 0.23500, f1: 0.38619, LR: 0.00009, Time elapsed 0.22 mins
[[48 24 21 28 29]
 [26 55 25 25 19]
 [15 14 77 19 25]
 [22 24 24 58 22]
 [27 28 24 18 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.48it/s]
Epoch 27 : Training Loss: 0.40426, acc: 0.39733, kappa: 0.24667, f1: 0.39786, LR: 0.00008, Time elapsed 0.22 mins
[[57 23 15 28 27]
 [32 54 19 25 20]
 [20 13 70 18 29]
 [25 22 18 62 23]
 [26 27 20 22 55]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.39733, kappa: 0.24667, f1: 0.39786
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.22it/s]
Epoch 28 : Training Loss: 0.40425, acc: 0.39600, kappa: 0.24500, f1: 0.39608, LR: 0.00007, Time elapsed 0.21 mins
[[55 23 18 24 30]
 [30 53 21 23 23]
 [19 13 70 20 28]
 [23 21 21 60 25]
 [25 26 19 21 59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.29it/s]
Epoch 29 : Training Loss: 0.40276, acc: 0.38667, kappa: 0.23333, f1: 0.38572, LR: 0.00007, Time elapsed 0.21 mins
[[48 25 19 27 31]
 [31 49 22 27 21]
 [18 11 73 19 29]
 [22 21 20 63 24]
 [27 24 22 20 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.93it/s]
Epoch 30 : Training Loss: 0.40265, acc: 0.38400, kappa: 0.23000, f1: 0.38265, LR: 0.00006, Time elapsed 0.21 mins
[[48 25 18 31 28]
 [31 49 22 29 19]
 [16 13 75 19 27]
 [22 21 21 63 23]
 [25 26 21 25 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.20it/s]
Epoch 31 : Training Loss: 0.40197, acc: 0.38533, kappa: 0.23167, f1: 0.38489, LR: 0.00006, Time elapsed 0.21 mins
[[51 24 18 30 27]
 [32 52 21 25 20]
 [20 15 72 16 27]
 [24 21 23 61 21]
 [25 28 20 24 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.48it/s]
Epoch 32 : Training Loss: 0.40132, acc: 0.38933, kappa: 0.23667, f1: 0.38773, LR: 0.00005, Time elapsed 0.21 mins
[[45 21 21 34 29]
 [31 50 23 26 20]
 [18 11 75 19 27]
 [22 20 22 63 23]
 [25 23 19 24 59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.42it/s]
Epoch 33 : Training Loss: 0.40126, acc: 0.39067, kappa: 0.23833, f1: 0.38974, LR: 0.00005, Time elapsed 0.21 mins
[[52 25 19 26 28]
 [31 50 22 27 20]
 [18 14 76 16 26]
 [23 23 21 60 23]
 [28 25 22 20 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.30it/s]
Epoch 34 : Training Loss: 0.40034, acc: 0.38133, kappa: 0.22667, f1: 0.38192, LR: 0.00004, Time elapsed 0.21 mins
[[53 25 13 29 30]
 [32 50 18 28 22]
 [18 17 72 17 26]
 [24 22 20 59 25]
 [28 26 19 25 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.05it/s]
Epoch 35 : Training Loss: 0.40003, acc: 0.38533, kappa: 0.23167, f1: 0.38655, LR: 0.00004, Time elapsed 0.21 mins
[[54 26 12 29 29]
 [32 53 18 27 20]
 [19 16 69 18 28]
 [27 23 18 59 23]
 [28 26 18 24 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.59it/s]
Epoch 36 : Training Loss: 0.39966, acc: 0.38267, kappa: 0.22833, f1: 0.38199, LR: 0.00003, Time elapsed 0.22 mins
[[52 24 19 29 26]
 [30 51 23 25 21]
 [17 15 73 17 28]
 [25 22 21 57 25]
 [24 26 22 24 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.36it/s]
Epoch 37 : Training Loss: 0.39937, acc: 0.38000, kappa: 0.22500, f1: 0.37919, LR: 0.00003, Time elapsed 0.22 mins
[[54 26 17 29 24]
 [31 50 23 26 20]
 [17 15 73 18 27]
 [24 23 23 56 24]
 [24 27 23 24 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.68it/s]
Epoch 38 : Training Loss: 0.39909, acc: 0.38267, kappa: 0.22833, f1: 0.38287, LR: 0.00003, Time elapsed 0.21 mins
[[55 26 14 28 27]
 [31 51 23 25 20]
 [18 14 71 19 28]
 [27 21 20 57 25]
 [28 26 19 24 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.05it/s]
Epoch 39 : Training Loss: 0.39905, acc: 0.39067, kappa: 0.23833, f1: 0.38960, LR: 0.00002, Time elapsed 0.21 mins
[[51 23 19 29 28]
 [30 52 22 25 21]
 [16 12 76 19 27]
 [22 23 21 61 23]
 [25 27 22 23 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.94it/s]
Epoch 40 : Training Loss: 0.39877, acc: 0.39467, kappa: 0.24333, f1: 0.39426, LR: 0.00002, Time elapsed 0.22 mins
[[56 22 18 27 27]
 [31 52 20 25 22]
 [18 12 75 19 26]
 [24 23 19 60 24]
 [26 26 22 23 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.94it/s]
Epoch 41 : Training Loss: 0.39877, acc: 0.39200, kappa: 0.24000, f1: 0.39154, LR: 0.00001, Time elapsed 0.21 mins
[[52 24 20 27 27]
 [31 53 20 25 21]
 [17 14 72 20 27]
 [20 23 21 62 24]
 [24 27 20 24 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.58it/s]
Epoch 42 : Training Loss: 0.39858, acc: 0.39600, kappa: 0.24500, f1: 0.39501, LR: 0.00001, Time elapsed 0.22 mins
[[53 24 19 28 26]
 [31 52 22 26 19]
 [17 12 75 19 27]
 [21 24 20 64 21]
 [25 27 21 24 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.09it/s]
Epoch 43 : Training Loss: 0.39833, acc: 0.38933, kappa: 0.23667, f1: 0.38887, LR: 0.00001, Time elapsed 0.21 mins
[[54 24 18 28 26]
 [31 51 22 25 21]
 [19 14 71 19 27]
 [22 24 20 63 21]
 [26 27 21 23 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.53it/s]
Epoch 44 : Training Loss: 0.39840, acc: 0.39200, kappa: 0.24000, f1: 0.39130, LR: 0.00001, Time elapsed 0.22 mins
[[52 24 20 26 28]
 [31 51 21 25 22]
 [16 16 74 17 27]
 [21 22 20 63 24]
 [25 27 21 23 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.67it/s]
Epoch 45 : Training Loss: 0.39815, acc: 0.39467, kappa: 0.24333, f1: 0.39421, LR: 0.00001, Time elapsed 0.21 mins
[[53 24 19 26 28]
 [31 51 20 27 21]
 [16 16 73 17 28]
 [21 23 20 63 23]
 [24 27 20 23 56]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 46 : Training Loss: 0.39829, acc: 0.38800, kappa: 0.23500, f1: 0.38769, LR: 0.00000, Time elapsed 0.21 mins
[[53 24 19 27 27]
 [31 52 20 25 22]
 [17 13 73 19 28]
 [23 23 20 60 24]
 [26 27 21 23 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.41it/s]
Epoch 47 : Training Loss: 0.39844, acc: 0.39067, kappa: 0.23833, f1: 0.39039, LR: 0.00000, Time elapsed 0.21 mins
[[53 24 19 26 28]
 [32 52 20 24 22]
 [17 13 73 19 28]
 [22 23 20 61 24]
 [26 27 21 22 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.18it/s]
Epoch 48 : Training Loss: 0.39816, acc: 0.38933, kappa: 0.23667, f1: 0.38902, LR: 0.00000, Time elapsed 0.21 mins
[[53 24 19 26 28]
 [32 52 20 24 22]
 [17 14 73 19 27]
 [23 23 20 61 23]
 [26 27 21 23 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.51it/s]
Epoch 49 : Training Loss: 0.39820, acc: 0.38933, kappa: 0.23667, f1: 0.38894, LR: 0.00000, Time elapsed 0.21 mins
[[53 24 19 26 28]
 [32 52 20 24 22]
 [17 14 74 18 27]
 [23 23 20 60 24]
 [26 27 22 22 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.69it/s]
Epoch 50 : Training Loss: 0.39819, acc: 0.38933, kappa: 0.23667, f1: 0.38898, LR: 0.00000, Time elapsed 0.21 mins
[[53 24 19 26 28]
 [31 52 20 25 22]
 [17 15 74 17 27]
 [23 23 20 60 24]
 [26 27 21 23 53]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.38it/s]
***************************Test results************************
Test Evaluation: acc: 0.41867, kappa: 0.27333, f1: 0.41926
[[57 27 23 25 18]
 [20 65 20 25 20]
 [32 19 62 17 20]
 [22 31 17 65 15]
 [25 23 15 22 65]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch27_acc_0.41867_kappa_0.27333_f1_0.41926.pth
[32m[I 2025-08-29 22:02:18,106][0m Trial 69 finished with value: 0.2733333333333333 and parameters: {'lr': 0.00018051927081408752, 'weight_decay': 0.01167606550248134, '--dropout': 0.1691775641725073, '--clip_value': 1.5987136468201397}. Best is trial 35 with value: 0.36.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=8.299414776485687e-05, weight_decay=0.015477331108584638, optimizer='AdamW', clip_value=1.316975199708669, dropout=0.18799737343818446, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.18799737343818446, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.18799737343818446, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
