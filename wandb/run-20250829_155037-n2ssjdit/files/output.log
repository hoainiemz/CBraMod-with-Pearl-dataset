100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.68it/s]
Epoch 1 : Training Loss: 1.63102, acc: 0.20133, kappa: 0.00167, f1: 0.06960, LR: 0.00006, Time elapsed 0.25 mins
[[  0   1 149   0   0]
 [  2   1 147   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20133, kappa: 0.00167, f1: 0.06960
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.92it/s]
Epoch 2 : Training Loss: 1.60639, acc: 0.22667, kappa: 0.03333, f1: 0.17594, LR: 0.00006, Time elapsed 0.25 mins
[[72 22  6  0 50]
 [73 33  2  4 38]
 [65 20  1  1 63]
 [72 24  9  2 43]
 [59 21  5  3 62]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22667, kappa: 0.03333, f1: 0.17594
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.97it/s]
Epoch 3 : Training Loss: 1.57496, acc: 0.24533, kappa: 0.05667, f1: 0.20531, LR: 0.00006, Time elapsed 0.25 mins
[[87 37  8  4 14]
 [83 54  3  0 10]
 [84 25 19  3 19]
 [78 39 14  1 18]
 [87 25 12  3 23]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24533, kappa: 0.05667, f1: 0.20531
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.01it/s]
Epoch 4 : Training Loss: 1.53004, acc: 0.24133, kappa: 0.05167, f1: 0.20854, LR: 0.00006, Time elapsed 0.25 mins
[[33  6 16 27 68]
 [35 10 11 24 70]
 [39  2 13 18 78]
 [27  5 13 34 71]
 [29  4  8 18 91]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.28it/s]
Epoch 5 : Training Loss: 1.45438, acc: 0.25600, kappa: 0.07000, f1: 0.24813, LR: 0.00006, Time elapsed 0.25 mins
[[66 24 22 20 18]
 [44 36 18 19 33]
 [44 20 26 22 38]
 [42 25 23 25 35]
 [54 15 16 26 39]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25600, kappa: 0.07000, f1: 0.24813
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.03it/s]
Epoch 6 : Training Loss: 1.38040, acc: 0.25467, kappa: 0.06833, f1: 0.25431, LR: 0.00006, Time elapsed 0.25 mins
[[35 33 25 31 26]
 [32 34 17 27 40]
 [26 21 39 31 33]
 [22 28 27 37 36]
 [30 26 23 25 46]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.63it/s]
Epoch 7 : Training Loss: 1.29307, acc: 0.26933, kappa: 0.08667, f1: 0.26554, LR: 0.00006, Time elapsed 0.25 mins
[[33 22 20 39 36]
 [28 36  7 43 36]
 [24 18 27 42 39]
 [26 18 12 54 40]
 [29 17 15 37 52]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26933, kappa: 0.08667, f1: 0.26554
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.85it/s]
Epoch 8 : Training Loss: 1.20052, acc: 0.27200, kappa: 0.09000, f1: 0.27178, LR: 0.00006, Time elapsed 0.25 mins
[[42 34 25 30 19]
 [36 46 20 28 20]
 [28 30 39 29 24]
 [25 31 29 41 24]
 [39 26 23 26 36]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27200, kappa: 0.09000, f1: 0.27178
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.87it/s]
Epoch 9 : Training Loss: 1.11357, acc: 0.28000, kappa: 0.10000, f1: 0.27917, LR: 0.00006, Time elapsed 0.25 mins
[[37 22 26 35 30]
 [21 40 20 32 37]
 [24 19 36 37 34]
 [18 28 18 48 38]
 [26 22 21 32 49]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28000, kappa: 0.10000, f1: 0.27917
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.68it/s]
Epoch 10 : Training Loss: 1.01769, acc: 0.26400, kappa: 0.08000, f1: 0.26436, LR: 0.00005, Time elapsed 0.25 mins
[[35 30 28 28 29]
 [36 40 13 27 34]
 [28 23 39 21 39]
 [26 27 21 37 39]
 [38 21 24 20 47]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.82it/s]
Epoch 11 : Training Loss: 0.92213, acc: 0.25867, kappa: 0.07333, f1: 0.25885, LR: 0.00005, Time elapsed 0.25 mins
[[36 35 29 26 24]
 [25 42 19 37 27]
 [22 27 39 26 36]
 [24 37 16 37 36]
 [32 23 27 28 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.89it/s]
Epoch 12 : Training Loss: 0.80835, acc: 0.27200, kappa: 0.09000, f1: 0.27182, LR: 0.00005, Time elapsed 0.25 mins
[[37 29 29 33 22]
 [26 42 22 34 26]
 [22 28 44 31 25]
 [22 29 28 43 28]
 [29 22 31 30 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.93it/s]
Epoch 13 : Training Loss: 0.74012, acc: 0.28400, kappa: 0.10500, f1: 0.28356, LR: 0.00005, Time elapsed 0.25 mins
[[37 21 30 35 27]
 [20 42 18 40 30]
 [21 23 37 32 37]
 [19 23 26 47 35]
 [24 18 27 31 50]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28400, kappa: 0.10500, f1: 0.28356
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.58it/s]
Epoch 14 : Training Loss: 0.67337, acc: 0.28800, kappa: 0.11000, f1: 0.28569, LR: 0.00005, Time elapsed 0.26 mins
[[43 18 29 29 31]
 [34 32 16 37 31]
 [24 19 43 29 35]
 [24 21 26 40 39]
 [26 13 28 25 58]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28800, kappa: 0.11000, f1: 0.28569
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.95it/s]
Epoch 15 : Training Loss: 0.63500, acc: 0.27067, kappa: 0.08833, f1: 0.27056, LR: 0.00005, Time elapsed 0.25 mins
[[39 27 25 28 31]
 [34 41 17 29 29]
 [28 16 42 29 35]
 [31 24 25 33 37]
 [30 22 30 20 48]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.88it/s]
Epoch 16 : Training Loss: 0.58987, acc: 0.26267, kappa: 0.07833, f1: 0.26206, LR: 0.00005, Time elapsed 0.25 mins
[[48 24 22 28 28]
 [37 38 22 27 26]
 [36 22 33 29 30]
 [33 23 20 37 37]
 [43 18 23 25 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.00it/s]
Epoch 17 : Training Loss: 0.55009, acc: 0.27333, kappa: 0.09167, f1: 0.27336, LR: 0.00004, Time elapsed 0.25 mins
[[39 27 28 34 22]
 [29 47 22 33 19]
 [27 28 45 30 20]
 [26 35 23 39 27]
 [35 24 25 31 35]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.92it/s]
Epoch 18 : Training Loss: 0.53121, acc: 0.27333, kappa: 0.09167, f1: 0.27334, LR: 0.00004, Time elapsed 0.25 mins
[[40 30 26 27 27]
 [28 40 22 35 25]
 [27 28 39 26 30]
 [23 30 21 42 34]
 [37 21 23 25 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.93it/s]
Epoch 19 : Training Loss: 0.51222, acc: 0.26667, kappa: 0.08333, f1: 0.26430, LR: 0.00004, Time elapsed 0.25 mins
[[31 33 27 24 35]
 [21 51 16 30 32]
 [18 38 36 26 32]
 [15 39 19 34 43]
 [23 30 26 23 48]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.84it/s]
Epoch 20 : Training Loss: 0.49559, acc: 0.27333, kappa: 0.09167, f1: 0.27269, LR: 0.00004, Time elapsed 0.25 mins
[[43 29 17 38 23]
 [24 45 17 43 21]
 [27 31 32 37 23]
 [22 34 14 47 33]
 [30 30 20 32 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.70it/s]
Epoch 21 : Training Loss: 0.48419, acc: 0.27867, kappa: 0.09833, f1: 0.27682, LR: 0.00004, Time elapsed 0.25 mins
[[31 27 34 31 27]
 [25 47 18 33 27]
 [19 28 46 25 32]
 [20 31 26 34 39]
 [20 25 28 26 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.67it/s]
Epoch 22 : Training Loss: 0.47333, acc: 0.27467, kappa: 0.09333, f1: 0.27488, LR: 0.00004, Time elapsed 0.25 mins
[[42 27 28 26 27]
 [31 44 23 35 17]
 [28 26 44 31 21]
 [33 28 26 38 25]
 [33 25 28 26 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.98it/s]
Epoch 23 : Training Loss: 0.46732, acc: 0.27467, kappa: 0.09333, f1: 0.27304, LR: 0.00003, Time elapsed 0.25 mins
[[39 33 16 33 29]
 [29 55 12 36 18]
 [25 39 32 31 23]
 [28 41 12 42 27]
 [32 34 20 26 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.68it/s]
Epoch 24 : Training Loss: 0.45734, acc: 0.26000, kappa: 0.07500, f1: 0.25820, LR: 0.00003, Time elapsed 0.25 mins
[[39 32 16 34 29]
 [25 51 16 37 21]
 [22 40 29 34 25]
 [27 37 16 40 30]
 [34 30 20 30 36]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.72it/s]
Epoch 25 : Training Loss: 0.45400, acc: 0.27200, kappa: 0.09000, f1: 0.27111, LR: 0.00003, Time elapsed 0.25 mins
[[35 31 19 36 29]
 [25 46 21 39 19]
 [24 32 38 28 28]
 [23 30 20 48 29]
 [27 25 29 32 37]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.01it/s]
Epoch 26 : Training Loss: 0.44886, acc: 0.26667, kappa: 0.08333, f1: 0.26727, LR: 0.00003, Time elapsed 0.25 mins
[[41 28 21 31 29]
 [30 42 20 31 27]
 [28 25 39 27 31]
 [27 25 22 37 39]
 [38 21 23 27 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.95it/s]
Epoch 27 : Training Loss: 0.44119, acc: 0.28267, kappa: 0.10333, f1: 0.28261, LR: 0.00003, Time elapsed 0.26 mins
[[41 29 20 28 32]
 [22 44 17 37 30]
 [28 24 36 31 31]
 [24 30 14 43 39]
 [33 21 19 29 48]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.86it/s]
Epoch 28 : Training Loss: 0.43785, acc: 0.29733, kappa: 0.12167, f1: 0.29786, LR: 0.00002, Time elapsed 0.26 mins
[[45 26 22 26 31]
 [26 48 19 35 22]
 [24 27 48 26 25]
 [23 30 22 41 34]
 [32 24 24 29 41]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.29733, kappa: 0.12167, f1: 0.29786
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.87it/s]
Epoch 29 : Training Loss: 0.43302, acc: 0.27733, kappa: 0.09667, f1: 0.27679, LR: 0.00002, Time elapsed 0.26 mins
[[29 31 24 34 32]
 [20 43 19 46 22]
 [20 28 47 30 25]
 [21 28 19 46 36]
 [30 22 24 31 43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.60it/s]
Epoch 30 : Training Loss: 0.43037, acc: 0.28533, kappa: 0.10667, f1: 0.28483, LR: 0.00002, Time elapsed 0.25 mins
[[40 35 17 34 24]
 [24 51 20 32 23]
 [27 29 39 32 23]
 [24 32 18 46 30]
 [28 32 22 30 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.00it/s]
Epoch 31 : Training Loss: 0.42791, acc: 0.29200, kappa: 0.11500, f1: 0.29199, LR: 0.00002, Time elapsed 0.25 mins
[[38 32 21 26 33]
 [26 47 20 33 24]
 [21 26 42 27 34]
 [24 26 19 46 35]
 [31 22 25 26 46]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.71it/s]
Epoch 32 : Training Loss: 0.42371, acc: 0.28267, kappa: 0.10333, f1: 0.28285, LR: 0.00002, Time elapsed 0.25 mins
[[41 31 27 23 28]
 [28 50 19 32 21]
 [33 25 41 25 26]
 [31 29 18 40 32]
 [35 23 24 28 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.00it/s]
Epoch 33 : Training Loss: 0.42102, acc: 0.28133, kappa: 0.10167, f1: 0.28137, LR: 0.00002, Time elapsed 0.25 mins
[[36 38 23 26 27]
 [25 50 18 32 25]
 [22 33 44 24 27]
 [23 35 17 39 36]
 [26 33 22 27 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.94it/s]
Epoch 34 : Training Loss: 0.42009, acc: 0.28133, kappa: 0.10167, f1: 0.28112, LR: 0.00001, Time elapsed 0.25 mins
[[36 36 21 28 29]
 [25 51 20 32 22]
 [25 28 43 26 28]
 [31 33 19 36 31]
 [30 22 25 28 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.88it/s]
Epoch 35 : Training Loss: 0.41917, acc: 0.28267, kappa: 0.10333, f1: 0.28241, LR: 0.00001, Time elapsed 0.25 mins
[[37 30 26 28 29]
 [21 47 25 36 21]
 [27 24 41 33 25]
 [26 25 18 48 33]
 [33 23 23 32 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.67it/s]
Epoch 36 : Training Loss: 0.41627, acc: 0.28000, kappa: 0.10000, f1: 0.28022, LR: 0.00001, Time elapsed 0.25 mins
[[39 32 18 26 35]
 [21 49 20 35 25]
 [28 27 39 30 26]
 [25 30 18 41 36]
 [31 21 24 32 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.30it/s]
Epoch 37 : Training Loss: 0.41504, acc: 0.28267, kappa: 0.10333, f1: 0.28208, LR: 0.00001, Time elapsed 0.25 mins
[[37 35 25 25 28]
 [23 51 21 32 23]
 [23 29 42 28 28]
 [20 34 22 41 33]
 [30 23 27 29 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.01it/s]
Epoch 38 : Training Loss: 0.41439, acc: 0.27733, kappa: 0.09667, f1: 0.27694, LR: 0.00001, Time elapsed 0.25 mins
[[40 35 25 27 23]
 [26 49 19 33 23]
 [27 29 38 28 28]
 [25 33 19 42 31]
 [33 20 27 31 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.96it/s]
Epoch 39 : Training Loss: 0.41375, acc: 0.28133, kappa: 0.10167, f1: 0.28111, LR: 0.00001, Time elapsed 0.26 mins
[[43 29 18 27 33]
 [26 48 18 33 25]
 [28 28 36 27 31]
 [27 31 17 39 36]
 [34 19 24 28 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.24it/s]
Epoch 40 : Training Loss: 0.41149, acc: 0.27867, kappa: 0.09833, f1: 0.27836, LR: 0.00001, Time elapsed 0.25 mins
[[40 32 26 29 23]
 [25 50 19 31 25]
 [28 28 40 26 28]
 [25 33 19 39 34]
 [31 23 28 28 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.80it/s]
Epoch 41 : Training Loss: 0.41089, acc: 0.29467, kappa: 0.11833, f1: 0.29457, LR: 0.00001, Time elapsed 0.26 mins
[[41 32 23 26 28]
 [25 50 19 32 24]
 [26 26 42 27 29]
 [23 31 19 42 35]
 [30 22 25 27 46]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.83it/s]
Epoch 42 : Training Loss: 0.41019, acc: 0.29333, kappa: 0.11667, f1: 0.29308, LR: 0.00000, Time elapsed 0.26 mins
[[39 33 23 27 28]
 [23 52 19 32 24]
 [26 27 41 28 28]
 [22 33 16 42 37]
 [33 20 23 28 46]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.86it/s]
Epoch 43 : Training Loss: 0.40962, acc: 0.28800, kappa: 0.11000, f1: 0.28763, LR: 0.00000, Time elapsed 0.26 mins
[[38 34 23 32 23]
 [23 51 19 34 23]
 [25 29 41 29 26]
 [23 34 17 45 31]
 [33 23 25 28 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.78it/s]
Epoch 44 : Training Loss: 0.40917, acc: 0.29067, kappa: 0.11333, f1: 0.29103, LR: 0.00000, Time elapsed 0.26 mins
[[42 33 18 31 26]
 [26 51 16 35 22]
 [27 26 40 29 28]
 [25 34 16 43 32]
 [33 21 22 32 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.25it/s]
Epoch 45 : Training Loss: 0.40877, acc: 0.28533, kappa: 0.10667, f1: 0.28490, LR: 0.00000, Time elapsed 0.25 mins
[[41 32 20 30 27]
 [26 54 17 32 21]
 [25 30 39 28 28]
 [25 34 16 41 34]
 [34 22 25 30 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.49it/s]
Epoch 46 : Training Loss: 0.40868, acc: 0.28800, kappa: 0.11000, f1: 0.28758, LR: 0.00000, Time elapsed 0.26 mins
[[40 32 22 31 25]
 [26 53 17 33 21]
 [26 28 40 30 26]
 [24 34 16 45 31]
 [34 22 24 32 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.12it/s]
Epoch 47 : Training Loss: 0.40872, acc: 0.28533, kappa: 0.10667, f1: 0.28487, LR: 0.00000, Time elapsed 0.25 mins
[[41 32 22 30 25]
 [27 54 17 31 21]
 [26 29 39 28 28]
 [25 34 17 40 34]
 [34 21 25 30 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.06it/s]
Epoch 48 : Training Loss: 0.40822, acc: 0.28800, kappa: 0.11000, f1: 0.28754, LR: 0.00000, Time elapsed 0.26 mins
[[41 33 21 31 24]
 [26 54 18 31 21]
 [25 30 39 28 28]
 [25 34 16 41 34]
 [34 21 24 30 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.04it/s]
Epoch 49 : Training Loss: 0.40760, acc: 0.28533, kappa: 0.10667, f1: 0.28521, LR: 0.00000, Time elapsed 0.25 mins
[[39 34 22 31 24]
 [26 53 19 31 21]
 [25 28 41 28 28]
 [25 33 16 40 36]
 [34 21 24 30 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.93it/s]
Epoch 50 : Training Loss: 0.40803, acc: 0.28667, kappa: 0.10833, f1: 0.28668, LR: 0.00000, Time elapsed 0.25 mins
[[40 33 22 30 25]
 [26 52 19 32 21]
 [26 27 42 27 28]
 [24 34 16 41 35]
 [34 21 25 30 40]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.33it/s]
***************************Test results************************
Test Evaluation: acc: 0.28000, kappa: 0.10000, f1: 0.27943
[[45 21 27 30 27]
 [38 36 20 25 31]
 [27 19 41 32 31]
 [31 24 25 39 31]
 [26 23 24 28 49]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch28_acc_0.28000_kappa_0.10000_f1_0.27943.pth
[32m[I 2025-08-29 16:03:30,205][0m Trial 37 finished with value: 0.09999999999999998 and parameters: {'lr': 5.998654380510801e-05, 'weight_decay': 0.011343272874178209, '--dropout': 0.19993285441089045, '--clip_value': 1.9147319799237246}. Best is trial 35 with value: 0.36.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.0001577498688986208, weight_decay=0.040970892503465084, optimizer='AdamW', clip_value=1.9962047427214602, dropout=0.156324556894422, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.156324556894422, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.156324556894422, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
