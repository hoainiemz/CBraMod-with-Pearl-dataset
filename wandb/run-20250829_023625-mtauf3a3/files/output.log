100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.15it/s]
Epoch 1 : Training Loss: 1.61073, acc: 0.18667, kappa: -0.01667, f1: 0.10016, LR: 0.00000, Time elapsed 0.31 mins
[[  0   1   0 107  42]
 [  2   2   0 110  36]
 [  0   2   0 106  42]
 [  0   0   0 111  39]
 [  0   1   0 122  27]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.65it/s]
Epoch 2 : Training Loss: 1.60773, acc: 0.21867, kappa: 0.02333, f1: 0.16104, LR: 0.00000, Time elapsed 0.33 mins
[[  1  24   5 102  18]
 [  1  36   1  86  26]
 [  0  16   4 103  27]
 [  0  25   2 101  22]
 [  0  20   1 107  22]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21867, kappa: 0.02333, f1: 0.16104
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.01it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.75it/s]
Epoch 3 : Training Loss: 1.60508, acc: 0.21333, kappa: 0.01667, f1: 0.17175, LR: 0.00000, Time elapsed 0.31 mins
[[ 5 26  9 92 18]
 [ 6 29  8 83 24]
 [ 1 19 10 92 28]
 [ 3 27  8 93 19]
 [ 0 22  6 99 23]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.24it/s]
Epoch 4 : Training Loss: 1.60071, acc: 0.24000, kappa: 0.05000, f1: 0.22271, LR: 0.00000, Time elapsed 0.33 mins
[[15 54 39 34  8]
 [15 53 42 32  8]
 [ 7 38 48 44 13]
 [10 43 38 50  9]
 [ 4 39 45 48 14]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24000, kappa: 0.05000, f1: 0.22271
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.24it/s]
Epoch 5 : Training Loss: 1.59842, acc: 0.24667, kappa: 0.05833, f1: 0.23539, LR: 0.00000, Time elapsed 0.33 mins
[[18 27 43 41 21]
 [13 24 51 32 30]
 [ 8 14 54 43 31]
 [10 17 34 57 32]
 [ 4 18 47 49 32]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24667, kappa: 0.05833, f1: 0.23539
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.06it/s]
Epoch 6 : Training Loss: 1.59213, acc: 0.26000, kappa: 0.07500, f1: 0.25670, LR: 0.00000, Time elapsed 0.32 mins
[[26 32 34 39 19]
 [21 37 37 27 28]
 [12 17 45 42 34]
 [18 26 30 52 24]
 [12 25 40 38 35]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26000, kappa: 0.07500, f1: 0.25670
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.25it/s]
Epoch 7 : Training Loss: 1.59015, acc: 0.26533, kappa: 0.08167, f1: 0.25644, LR: 0.00000, Time elapsed 0.31 mins
[[18 33 45 32 22]
 [14 40 51 20 25]
 [ 7 21 62 35 25]
 [ 8 31 45 44 22]
 [ 6 29 51 29 35]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26533, kappa: 0.08167, f1: 0.25644
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.40it/s]
Epoch 8 : Training Loss: 1.58548, acc: 0.25600, kappa: 0.07000, f1: 0.25295, LR: 0.00000, Time elapsed 0.32 mins
[[28 38 27 38 19]
 [26 45 31 24 24]
 [18 22 33 46 31]
 [24 32 24 52 18]
 [17 35 29 35 34]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.77it/s]
Epoch 9 : Training Loss: 1.58156, acc: 0.26133, kappa: 0.07667, f1: 0.25995, LR: 0.00000, Time elapsed 0.34 mins
[[34 43 27 27 19]
 [32 49 32 20 17]
 [23 27 42 31 27]
 [29 40 27 40 14]
 [24 39 32 24 31]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.73it/s]
Epoch 10 : Training Loss: 1.57604, acc: 0.25467, kappa: 0.06833, f1: 0.25295, LR: 0.00000, Time elapsed 0.34 mins
[[38 31 34 22 25]
 [35 35 36 14 30]
 [22 23 45 22 38]
 [28 29 34 28 31]
 [19 28 39 19 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.20it/s]
Epoch 11 : Training Loss: 1.57281, acc: 0.24933, kappa: 0.06167, f1: 0.24725, LR: 0.00000, Time elapsed 0.34 mins
[[43 34 17 32 24]
 [36 44 21 16 33]
 [31 27 27 27 38]
 [33 38 20 32 27]
 [31 40 15 23 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.63it/s]
Epoch 12 : Training Loss: 1.56926, acc: 0.24933, kappa: 0.06167, f1: 0.24806, LR: 0.00000, Time elapsed 0.34 mins
[[46 33 19 32 20]
 [41 42 26 19 22]
 [34 28 29 28 31]
 [43 35 25 37 10]
 [37 37 19 24 33]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.23it/s]
Epoch 13 : Training Loss: 1.56342, acc: 0.25467, kappa: 0.06833, f1: 0.24934, LR: 0.00000, Time elapsed 0.33 mins
[[55 40 15 26 14]
 [47 50 16 17 20]
 [47 35 28 17 23]
 [45 42 24 30  9]
 [43 38 18 23 28]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.26it/s]
Epoch 14 : Training Loss: 1.56032, acc: 0.25733, kappa: 0.07167, f1: 0.25468, LR: 0.00000, Time elapsed 0.31 mins
[[46 36 25 24 19]
 [40 48 25 15 22]
 [37 31 41 14 27]
 [45 36 32 26 11]
 [39 33 26 20 32]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.58it/s]
Epoch 15 : Training Loss: 1.55911, acc: 0.26133, kappa: 0.07667, f1: 0.25914, LR: 0.00000, Time elapsed 0.34 mins
[[40 36 16 35 23]
 [37 46 16 23 28]
 [29 30 27 25 39]
 [31 39 21 35 24]
 [29 35 14 24 48]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.20it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.57it/s]
Epoch 16 : Training Loss: 1.55468, acc: 0.26000, kappa: 0.07500, f1: 0.25872, LR: 0.00000, Time elapsed 0.29 mins
[[48 36 25 23 18]
 [42 45 23 20 20]
 [37 26 38 20 29]
 [45 34 30 33  8]
 [41 31 25 22 31]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.68it/s]
Epoch 17 : Training Loss: 1.55170, acc: 0.24933, kappa: 0.06167, f1: 0.24947, LR: 0.00000, Time elapsed 0.33 mins
[[42 35 18 36 19]
 [43 39 21 23 24]
 [34 25 31 25 35]
 [43 31 24 38 14]
 [37 26 20 30 37]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.10it/s]
Epoch 18 : Training Loss: 1.55080, acc: 0.26000, kappa: 0.07500, f1: 0.25778, LR: 0.00000, Time elapsed 0.33 mins
[[39 40 27 22 22]
 [33 48 22 20 27]
 [32 31 37 17 33]
 [32 36 34 26 22]
 [24 36 25 20 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.18it/s]
Epoch 19 : Training Loss: 1.54434, acc: 0.25733, kappa: 0.07167, f1: 0.25778, LR: 0.00000, Time elapsed 0.32 mins
[[39 31 19 39 22]
 [39 42 19 24 26]
 [31 23 35 27 34]
 [38 26 28 38 20]
 [29 28 22 32 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.55it/s]
Epoch 20 : Training Loss: 1.54505, acc: 0.25733, kappa: 0.07167, f1: 0.25621, LR: 0.00000, Time elapsed 0.33 mins
[[36 40 20 36 18]
 [34 51 23 20 22]
 [30 31 38 20 31]
 [36 36 31 35 12]
 [25 36 22 34 33]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.11it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.17it/s]
Epoch 21 : Training Loss: 1.54174, acc: 0.25200, kappa: 0.06500, f1: 0.25003, LR: 0.00000, Time elapsed 0.30 mins
[[45 34 16 36 19]
 [39 48 18 22 23]
 [36 30 29 20 35]
 [43 39 22 33 13]
 [35 33 19 29 34]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.43it/s]
Epoch 22 : Training Loss: 1.53714, acc: 0.25333, kappa: 0.06667, f1: 0.24986, LR: 0.00000, Time elapsed 0.34 mins
[[44 34 12 39 21]
 [44 43  9 26 28]
 [35 27 21 28 39]
 [42 33 15 40 20]
 [34 33  9 32 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.96it/s]
Epoch 23 : Training Loss: 1.53461, acc: 0.26267, kappa: 0.07833, f1: 0.26047, LR: 0.00000, Time elapsed 0.34 mins
[[37 34 17 42 20]
 [33 48 15 29 25]
 [31 27 28 29 35]
 [30 35 21 47 17]
 [25 33 17 38 37]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.31it/s]
Epoch 24 : Training Loss: 1.52881, acc: 0.26000, kappa: 0.07500, f1: 0.25810, LR: 0.00000, Time elapsed 0.32 mins
[[41 34 18 39 18]
 [35 49 16 28 22]
 [35 28 29 27 31]
 [42 33 23 44  8]
 [31 33 16 38 32]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.34it/s]
Epoch 25 : Training Loss: 1.53008, acc: 0.25867, kappa: 0.07333, f1: 0.25701, LR: 0.00000, Time elapsed 0.32 mins
[[32 28 20 43 27]
 [34 37 20 28 31]
 [28 19 31 33 39]
 [29 24 25 43 29]
 [18 24 18 39 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.31it/s]
Epoch 26 : Training Loss: 1.52865, acc: 0.26133, kappa: 0.07667, f1: 0.26058, LR: 0.00000, Time elapsed 0.34 mins
[[47 25 18 39 21]
 [44 38 14 28 26]
 [37 19 30 27 37]
 [44 25 23 44 14]
 [37 21 17 38 37]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.20it/s]
Epoch 27 : Training Loss: 1.52033, acc: 0.25600, kappa: 0.07000, f1: 0.25286, LR: 0.00000, Time elapsed 0.34 mins
[[42 39 13 35 21]
 [37 50 11 28 24]
 [33 35 24 22 36]
 [40 40 15 40 15]
 [29 38 15 32 36]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.18it/s]
Epoch 28 : Training Loss: 1.52062, acc: 0.25600, kappa: 0.07000, f1: 0.25294, LR: 0.00000, Time elapsed 0.32 mins
[[46 36 14 33 21]
 [41 47 15 21 26]
 [35 32 24 23 36]
 [44 36 17 35 18]
 [31 34 14 31 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:20<00:00,  3.45it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.54it/s]
Epoch 29 : Training Loss: 1.51945, acc: 0.25600, kappa: 0.07000, f1: 0.25411, LR: 0.00000, Time elapsed 0.36 mins
[[43 36 17 37 17]
 [38 47 18 24 23]
 [36 30 31 23 30]
 [43 32 24 42  9]
 [31 35 18 37 29]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.20it/s]
Epoch 30 : Training Loss: 1.51495, acc: 0.25600, kappa: 0.07000, f1: 0.25465, LR: 0.00000, Time elapsed 0.32 mins
[[42 32 16 42 18]
 [39 45 14 28 24]
 [38 26 29 25 32]
 [42 30 19 44 15]
 [28 32 16 42 32]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.34it/s]
Epoch 31 : Training Loss: 1.51245, acc: 0.24533, kappa: 0.05667, f1: 0.24504, LR: 0.00000, Time elapsed 0.33 mins
[[38 30 26 31 25]
 [36 35 32 19 28]
 [35 21 39 17 38]
 [37 24 35 31 23]
 [27 25 29 28 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.19it/s]
Epoch 32 : Training Loss: 1.51090, acc: 0.26133, kappa: 0.07667, f1: 0.25804, LR: 0.00000, Time elapsed 0.32 mins
[[52 30 16 30 22]
 [44 42 15 22 27]
 [41 24 26 20 39]
 [43 29 21 33 24]
 [34 30 17 26 43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.77it/s]
Epoch 33 : Training Loss: 1.50697, acc: 0.26533, kappa: 0.08167, f1: 0.26243, LR: 0.00000, Time elapsed 0.32 mins
[[49 33 16 30 22]
 [40 46 14 24 26]
 [40 27 26 22 35]
 [43 30 20 34 23]
 [32 31 17 26 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.28it/s]
Epoch 34 : Training Loss: 1.50585, acc: 0.25733, kappa: 0.07167, f1: 0.25758, LR: 0.00000, Time elapsed 0.33 mins
[[40 27 23 39 21]
 [35 40 27 23 25]
 [31 25 35 24 35]
 [37 25 31 38 19]
 [29 26 26 29 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.47it/s]
Epoch 35 : Training Loss: 1.50472, acc: 0.25467, kappa: 0.06833, f1: 0.25266, LR: 0.00000, Time elapsed 0.32 mins
[[52 25 23 28 22]
 [44 34 27 20 25]
 [43 21 37 16 33]
 [46 25 28 30 21]
 [34 25 28 25 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.82it/s]
Epoch 36 : Training Loss: 1.50176, acc: 0.25867, kappa: 0.07333, f1: 0.25529, LR: 0.00000, Time elapsed 0.33 mins
[[54 22 20 30 24]
 [45 35 18 23 29]
 [43 22 28 21 36]
 [44 28 22 32 24]
 [36 25 18 26 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.51it/s]
Epoch 37 : Training Loss: 1.50086, acc: 0.25733, kappa: 0.07167, f1: 0.25707, LR: 0.00000, Time elapsed 0.34 mins
[[44 26 22 37 21]
 [37 40 25 23 25]
 [34 24 33 23 36]
 [41 28 26 35 20]
 [29 25 25 30 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.80it/s]
Epoch 38 : Training Loss: 1.49802, acc: 0.25600, kappa: 0.07000, f1: 0.25416, LR: 0.00000, Time elapsed 0.33 mins
[[51 20 20 38 21]
 [42 36 19 27 26]
 [40 21 29 23 37]
 [43 27 22 36 22]
 [34 24 22 30 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.04it/s]
Epoch 39 : Training Loss: 1.49582, acc: 0.26000, kappa: 0.07500, f1: 0.25814, LR: 0.00000, Time elapsed 0.33 mins
[[50 19 20 37 24]
 [42 34 21 25 28]
 [39 20 30 23 38]
 [41 24 24 37 24]
 [30 22 23 31 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.59it/s]
Epoch 40 : Training Loss: 1.49536, acc: 0.26400, kappa: 0.08000, f1: 0.25943, LR: 0.00000, Time elapsed 0.33 mins
[[57 19 21 28 25]
 [45 35 19 20 31]
 [41 20 28 19 42]
 [44 27 22 31 26]
 [35 24 18 26 47]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.35it/s]
Epoch 41 : Training Loss: 1.49240, acc: 0.26400, kappa: 0.08000, f1: 0.26115, LR: 0.00000, Time elapsed 0.33 mins
[[54 21 21 30 24]
 [43 34 23 20 30]
 [38 21 33 19 39]
 [41 24 25 32 28]
 [30 23 25 27 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.24it/s]
Epoch 42 : Training Loss: 1.48979, acc: 0.26000, kappa: 0.07500, f1: 0.25837, LR: 0.00000, Time elapsed 0.32 mins
[[52 19 20 39 20]
 [41 35 24 24 26]
 [36 22 33 22 37]
 [41 26 24 36 23]
 [30 24 26 31 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.14it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.95it/s]
Epoch 43 : Training Loss: 1.49100, acc: 0.26667, kappa: 0.08333, f1: 0.26454, LR: 0.00000, Time elapsed 0.30 mins
[[54 20 21 33 22]
 [41 36 23 23 27]
 [37 21 33 20 39]
 [41 24 25 35 25]
 [30 25 27 26 42]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26667, kappa: 0.08333, f1: 0.26454
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.25it/s]
Epoch 44 : Training Loss: 1.48531, acc: 0.26933, kappa: 0.08667, f1: 0.26537, LR: 0.00000, Time elapsed 0.34 mins
[[56 20 20 33 21]
 [44 37 17 22 30]
 [39 21 27 23 40]
 [42 23 23 34 28]
 [29 24 20 29 48]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26933, kappa: 0.08667, f1: 0.26537
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.76it/s]
Epoch 45 : Training Loss: 1.48523, acc: 0.26533, kappa: 0.08167, f1: 0.26181, LR: 0.00000, Time elapsed 0.34 mins
[[56 21 19 32 22]
 [42 35 23 20 30]
 [39 21 30 19 41]
 [44 26 21 33 26]
 [30 26 23 26 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:20<00:00,  3.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.25it/s]
Epoch 46 : Training Loss: 1.48231, acc: 0.26133, kappa: 0.07667, f1: 0.25675, LR: 0.00000, Time elapsed 0.35 mins
[[58 19 21 29 23]
 [45 31 24 18 32]
 [40 20 32 17 41]
 [42 22 25 30 31]
 [31 22 25 27 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.14it/s]
Epoch 47 : Training Loss: 1.47787, acc: 0.26533, kappa: 0.08167, f1: 0.26290, LR: 0.00000, Time elapsed 0.32 mins
[[54 20 20 34 22]
 [40 36 21 26 27]
 [35 22 30 24 39]
 [41 24 24 36 25]
 [28 24 25 30 43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.91it/s]
Epoch 48 : Training Loss: 1.47835, acc: 0.26133, kappa: 0.07667, f1: 0.25676, LR: 0.00000, Time elapsed 0.32 mins
[[56 20 19 31 24]
 [46 32 19 23 30]
 [39 21 28 22 40]
 [41 23 24 32 30]
 [30 23 21 28 48]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.60it/s]
Epoch 49 : Training Loss: 1.47855, acc: 0.26800, kappa: 0.08500, f1: 0.26504, LR: 0.00000, Time elapsed 0.33 mins
[[55 21 19 32 23]
 [40 37 20 26 27]
 [38 22 29 24 37]
 [40 28 22 35 25]
 [28 24 23 30 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:20<00:00,  3.46it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.40it/s]
Epoch 50 : Training Loss: 1.47292, acc: 0.25867, kappa: 0.07333, f1: 0.25326, LR: 0.00000, Time elapsed 0.36 mins
[[58 20 19 30 23]
 [49 32 18 22 29]
 [43 21 27 21 38]
 [43 26 20 30 31]
 [32 24 19 28 47]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.27it/s]
***************************Test results************************
Test Evaluation: acc: 0.27600, kappa: 0.09500, f1: 0.27272
[[54 18 18 19 41]
 [38 36 17 27 32]
 [39 20 30 25 36]
 [43 31 14 36 26]
 [33 17 19 30 51]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch44_acc_0.27600_kappa_0.09500_f1_0.27272.pth
[32m[I 2025-08-29 02:53:03,077][0m Trial 8 finished with value: 0.09499999999999997 and parameters: {'lr': 1.4982086432155468e-06, 'weight_decay': 0.02875972156225962, '--dropout': 0.19312640661491187, '--clip_value': 1.7125960221746916}. Best is trial 3 with value: 0.3583333333333333.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=6.639623079859462e-06, weight_decay=2.87712237162379e-06, optimizer='AdamW', clip_value=1.1602287406094018, dropout=0.1368466053024314, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1368466053024314, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1368466053024314, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
