100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.96it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 1 : Training Loss: 1.61140, acc: 0.19467, kappa: -0.00667, f1: 0.10783, LR: 0.00000, Time elapsed 0.21 mins
[[  0   0   0 109  41]
 [  0   0   2  99  49]
 [  1   0   1  89  59]
 [  0   1   0 105  44]
 [  0   0   0 110  40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.95it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
Epoch 2 : Training Loss: 1.60474, acc: 0.20000, kappa: 0.00000, f1: 0.11563, LR: 0.00000, Time elapsed 0.21 mins
[[  3   0   6 128  13]
 [  4   0  10 119  17]
 [  2   1  10 118  19]
 [  2   0   8 124  16]
 [  0   0  10 127  13]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.98it/s]
Epoch 3 : Training Loss: 1.59662, acc: 0.23200, kappa: 0.04000, f1: 0.20246, LR: 0.00000, Time elapsed 0.21 mins
[[18 10 27 83 12]
 [13 11 31 80 15]
 [10  8 34 77 21]
 [12 10 23 90 15]
 [11  4 26 88 21]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23200, kappa: 0.04000, f1: 0.20246
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.19it/s]
Epoch 4 : Training Loss: 1.59073, acc: 0.24400, kappa: 0.05500, f1: 0.23361, LR: 0.00000, Time elapsed 0.21 mins
[[32 18 40 46 14]
 [32 19 50 36 13]
 [20 15 53 45 17]
 [27 15 43 56  9]
 [21 11 50 45 23]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24400, kappa: 0.05500, f1: 0.23361
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.52it/s]
Epoch 5 : Training Loss: 1.58340, acc: 0.25733, kappa: 0.07167, f1: 0.25146, LR: 0.00000, Time elapsed 0.21 mins
[[32 17 29 48 24]
 [33 21 24 37 35]
 [17 14 37 44 38]
 [24 19 26 51 30]
 [18 12 28 40 52]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25733, kappa: 0.07167, f1: 0.25146
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.25it/s]
Epoch 6 : Training Loss: 1.57396, acc: 0.22533, kappa: 0.03167, f1: 0.21854, LR: 0.00000, Time elapsed 0.21 mins
[[48 21 36 30 15]
 [53 21 40 19 17]
 [44 16 48 25 17]
 [50 16 43 31 10]
 [52 10 41 26 21]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.98it/s]
Epoch 7 : Training Loss: 1.56682, acc: 0.25200, kappa: 0.06500, f1: 0.24836, LR: 0.00000, Time elapsed 0.21 mins
[[47 25 29 28 21]
 [54 24 29 14 29]
 [32 16 32 33 37]
 [37 17 28 35 33]
 [33 15 27 24 51]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.70it/s]
Epoch 8 : Training Loss: 1.55935, acc: 0.25600, kappa: 0.07000, f1: 0.25334, LR: 0.00000, Time elapsed 0.21 mins
[[50 31 25 23 21]
 [46 33 21 15 35]
 [34 31 28 18 39]
 [38 28 24 33 27]
 [37 27 16 22 48]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.04it/s]
Epoch 9 : Training Loss: 1.55236, acc: 0.25733, kappa: 0.07167, f1: 0.25667, LR: 0.00000, Time elapsed 0.21 mins
[[46 36 17 32 19]
 [43 39 16 30 22]
 [37 30 27 26 30]
 [40 32 26 38 14]
 [32 30 14 31 43]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.00it/s]
Epoch 10 : Training Loss: 1.54737, acc: 0.26000, kappa: 0.07500, f1: 0.25993, LR: 0.00000, Time elapsed 0.21 mins
[[44 42 22 30 12]
 [36 47 26 24 17]
 [30 37 35 25 23]
 [28 41 34 35 12]
 [25 39 25 27 34]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26000, kappa: 0.07500, f1: 0.25993
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.26it/s]
Epoch 11 : Training Loss: 1.54115, acc: 0.25867, kappa: 0.07333, f1: 0.25860, LR: 0.00000, Time elapsed 0.21 mins
[[47 31 23 33 16]
 [45 36 23 23 23]
 [36 24 38 22 30]
 [39 30 31 35 15]
 [30 27 24 31 38]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.15it/s]
Epoch 12 : Training Loss: 1.52966, acc: 0.26267, kappa: 0.07833, f1: 0.26085, LR: 0.00000, Time elapsed 0.21 mins
[[48 32 19 29 22]
 [43 39 19 23 26]
 [37 29 32 18 34]
 [43 27 30 29 21]
 [26 31 17 27 49]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26267, kappa: 0.07833, f1: 0.26085
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.90it/s]
Epoch 13 : Training Loss: 1.52808, acc: 0.25467, kappa: 0.06833, f1: 0.24726, LR: 0.00000, Time elapsed 0.21 mins
[[42 23 18 35 32]
 [38 31 15 22 44]
 [29 19 23 24 55]
 [28 20 21 32 49]
 [22 23 16 26 63]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.78it/s]
Epoch 14 : Training Loss: 1.51766, acc: 0.26133, kappa: 0.07667, f1: 0.25613, LR: 0.00000, Time elapsed 0.21 mins
[[53 26 26 24 21]
 [47 33 34 12 24]
 [38 22 45 13 32]
 [44 21 42 21 22]
 [28 26 33 19 44]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.48it/s]
Epoch 15 : Training Loss: 1.51587, acc: 0.24667, kappa: 0.05833, f1: 0.23408, LR: 0.00000, Time elapsed 0.21 mins
[[61 26 20 16 27]
 [54 25 20 13 38]
 [48 22 29  9 42]
 [49 20 31 17 33]
 [42 20 21 14 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.20it/s]
Epoch 16 : Training Loss: 1.50491, acc: 0.26933, kappa: 0.08667, f1: 0.26813, LR: 0.00000, Time elapsed 0.21 mins
[[46 23 22 40 19]
 [37 32 28 29 24]
 [30 19 41 26 34]
 [33 19 31 46 21]
 [25 25 27 36 37]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26933, kappa: 0.08667, f1: 0.26813
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.11it/s]
Epoch 17 : Training Loss: 1.49624, acc: 0.25733, kappa: 0.07167, f1: 0.25526, LR: 0.00000, Time elapsed 0.21 mins
[[48 19 28 38 17]
 [41 29 34 24 22]
 [33 19 46 22 30]
 [37 16 41 35 21]
 [29 23 34 29 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
Epoch 18 : Training Loss: 1.48966, acc: 0.24800, kappa: 0.06000, f1: 0.24247, LR: 0.00000, Time elapsed 0.21 mins
[[51 19 18 40 22]
 [45 26 13 32 34]
 [38 18 23 28 43]
 [39 18 21 41 31]
 [33 19 15 38 45]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.09it/s]
Epoch 19 : Training Loss: 1.48030, acc: 0.24667, kappa: 0.05833, f1: 0.24002, LR: 0.00000, Time elapsed 0.21 mins
[[40 25 14 44 27]
 [35 37  7 33 38]
 [37 24 17 29 43]
 [30 25 17 38 40]
 [25 29 10 33 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.53it/s]
Epoch 20 : Training Loss: 1.47678, acc: 0.24133, kappa: 0.05167, f1: 0.23743, LR: 0.00000, Time elapsed 0.21 mins
[[28 23 24 38 37]
 [27 27 27 27 42]
 [23 21 37 18 51]
 [20 21 31 35 43]
 [15 20 29 32 54]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.42it/s]
Epoch 21 : Training Loss: 1.46737, acc: 0.25067, kappa: 0.06333, f1: 0.24469, LR: 0.00000, Time elapsed 0.21 mins
[[41 19 20 35 35]
 [33 27 21 29 40]
 [30 21 25 23 51]
 [28 21 22 36 43]
 [21 21 17 32 59]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.03it/s]
Epoch 22 : Training Loss: 1.45897, acc: 0.24933, kappa: 0.06167, f1: 0.24436, LR: 0.00000, Time elapsed 0.21 mins
[[48 21 21 30 30]
 [40 27 23 22 38]
 [39 21 28 20 42]
 [36 21 25 31 37]
 [26 24 22 25 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.46it/s]
Epoch 23 : Training Loss: 1.45379, acc: 0.24800, kappa: 0.06000, f1: 0.23444, LR: 0.00000, Time elapsed 0.21 mins
[[55 14 14 28 39]
 [50 19 19 20 42]
 [46 12 21 17 54]
 [38 13 23 30 46]
 [38 10 14 27 61]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.03it/s]
Epoch 24 : Training Loss: 1.44817, acc: 0.24800, kappa: 0.06000, f1: 0.24244, LR: 0.00000, Time elapsed 0.21 mins
[[39 19 21 26 45]
 [33 27 24 18 48]
 [27 17 33 14 59]
 [27 17 30 27 49]
 [25 18 25 22 60]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.93it/s]
Epoch 25 : Training Loss: 1.43011, acc: 0.24267, kappa: 0.05333, f1: 0.23666, LR: 0.00000, Time elapsed 0.21 mins
[[46 15 21 38 30]
 [46 20 22 28 34]
 [40 15 28 26 41]
 [33 14 29 38 36]
 [30 12 23 35 50]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.99it/s]
Epoch 26 : Training Loss: 1.43040, acc: 0.24667, kappa: 0.05833, f1: 0.24270, LR: 0.00000, Time elapsed 0.21 mins
[[41 24 19 32 34]
 [37 33 21 25 34]
 [29 22 25 24 50]
 [30 25 22 32 41]
 [25 20 19 32 54]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.99it/s]
Epoch 27 : Training Loss: 1.42551, acc: 0.24667, kappa: 0.05833, f1: 0.23826, LR: 0.00000, Time elapsed 0.21 mins
[[37 25 18 19 51]
 [36 31 21 14 48]
 [26 18 27 15 64]
 [29 22 22 24 53]
 [24 20 19 21 66]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.88it/s]
Epoch 28 : Training Loss: 1.42201, acc: 0.24800, kappa: 0.06000, f1: 0.24195, LR: 0.00000, Time elapsed 0.21 mins
[[44 21 18 25 42]
 [39 28 20 23 40]
 [31 17 25 22 55]
 [30 20 22 31 47]
 [26 17 20 29 58]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.72it/s]
Epoch 29 : Training Loss: 1.40984, acc: 0.25600, kappa: 0.07000, f1: 0.24771, LR: 0.00000, Time elapsed 0.21 mins
[[42 18 16 24 50]
 [37 27 18 20 48]
 [30 15 25 22 58]
 [32 17 19 32 50]
 [24 15 16 29 66]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
Epoch 30 : Training Loss: 1.40076, acc: 0.24933, kappa: 0.06167, f1: 0.24268, LR: 0.00000, Time elapsed 0.21 mins
[[38 17 18 38 39]
 [29 25 19 38 39]
 [30 16 23 30 51]
 [27 17 18 45 43]
 [20 14 18 42 56]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 31 : Training Loss: 1.39527, acc: 0.25600, kappa: 0.07000, f1: 0.25050, LR: 0.00000, Time elapsed 0.21 mins
[[49 18 21 23 39]
 [42 28 21 22 37]
 [34 17 28 20 51]
 [32 17 25 31 45]
 [27 16 21 30 56]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.99it/s]
Epoch 32 : Training Loss: 1.39346, acc: 0.24667, kappa: 0.05833, f1: 0.24216, LR: 0.00000, Time elapsed 0.21 mins
[[37 24 19 29 41]
 [26 30 22 32 40]
 [28 18 24 26 54]
 [25 22 21 38 44]
 [19 17 21 37 56]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.08it/s]
Epoch 33 : Training Loss: 1.38677, acc: 0.25467, kappa: 0.06833, f1: 0.25024, LR: 0.00000, Time elapsed 0.21 mins
[[39 21 19 29 42]
 [31 29 22 27 41]
 [28 15 29 23 55]
 [27 18 25 35 45]
 [21 16 22 32 59]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.86it/s]
Epoch 34 : Training Loss: 1.37657, acc: 0.24933, kappa: 0.06167, f1: 0.24246, LR: 0.00000, Time elapsed 0.21 mins
[[31 19 17 35 48]
 [27 25 19 36 43]
 [25 13 28 27 57]
 [23 17 21 41 48]
 [18 14 19 37 62]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.73it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.71it/s]
Epoch 35 : Training Loss: 1.37569, acc: 0.25333, kappa: 0.06667, f1: 0.24729, LR: 0.00000, Time elapsed 0.22 mins
[[45 22 15 27 41]
 [38 30 16 26 40]
 [32 17 22 25 54]
 [33 22 16 37 42]
 [29 18 13 34 56]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.12it/s]
Epoch 36 : Training Loss: 1.36518, acc: 0.26267, kappa: 0.07833, f1: 0.25273, LR: 0.00000, Time elapsed 0.21 mins
[[45 21 15 23 46]
 [36 28 17 24 45]
 [30 15 22 23 60]
 [31 19 19 34 47]
 [25 12 14 31 68]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.78it/s]
Epoch 37 : Training Loss: 1.36338, acc: 0.25467, kappa: 0.06833, f1: 0.25046, LR: 0.00000, Time elapsed 0.21 mins
[[49 22 17 24 38]
 [43 29 20 22 36]
 [32 15 28 22 53]
 [34 21 22 33 40]
 [32 14 19 33 52]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.88it/s]
Epoch 38 : Training Loss: 1.35972, acc: 0.24800, kappa: 0.06000, f1: 0.24093, LR: 0.00000, Time elapsed 0.21 mins
[[40 19 15 34 42]
 [29 25 17 37 42]
 [28 14 22 30 56]
 [28 16 21 41 44]
 [24 14 14 40 58]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 39 : Training Loss: 1.35634, acc: 0.24533, kappa: 0.05667, f1: 0.23738, LR: 0.00000, Time elapsed 0.21 mins
[[36 24 14 28 48]
 [28 30 16 31 45]
 [27 16 19 26 62]
 [24 26 16 38 46]
 [22 17 12 38 61]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.76it/s]
Epoch 40 : Training Loss: 1.34423, acc: 0.26000, kappa: 0.07500, f1: 0.25450, LR: 0.00000, Time elapsed 0.21 mins
[[49 19 16 24 42]
 [40 27 20 25 38]
 [32 14 27 21 56]
 [32 18 22 36 42]
 [31 14 17 32 56]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.09it/s]
Epoch 41 : Training Loss: 1.35506, acc: 0.24933, kappa: 0.06167, f1: 0.24143, LR: 0.00000, Time elapsed 0.22 mins
[[37 19 15 28 51]
 [31 29 17 26 47]
 [28 14 22 22 64]
 [27 19 20 34 50]
 [21 16 14 34 65]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.22it/s]
Epoch 42 : Training Loss: 1.35047, acc: 0.26133, kappa: 0.07667, f1: 0.25725, LR: 0.00000, Time elapsed 0.21 mins
[[43 19 17 26 45]
 [36 29 21 24 40]
 [28 14 29 21 58]
 [30 17 22 37 44]
 [26 14 20 32 58]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.71it/s]
Epoch 43 : Training Loss: 1.34451, acc: 0.25600, kappa: 0.07000, f1: 0.25053, LR: 0.00000, Time elapsed 0.21 mins
[[39 21 16 24 50]
 [35 29 20 24 42]
 [29 14 28 21 58]
 [31 18 21 34 46]
 [26 17 18 27 62]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.92it/s]
Epoch 44 : Training Loss: 1.33270, acc: 0.25733, kappa: 0.07167, f1: 0.25043, LR: 0.00000, Time elapsed 0.21 mins
[[47 19 15 22 47]
 [38 30 20 21 41]
 [32 14 24 19 61]
 [32 19 20 31 48]
 [31 16 15 27 61]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.01it/s]
Epoch 45 : Training Loss: 1.33031, acc: 0.26133, kappa: 0.07667, f1: 0.25664, LR: 0.00000, Time elapsed 0.21 mins
[[39 20 16 28 47]
 [33 31 20 24 42]
 [27 15 28 25 55]
 [28 21 21 37 43]
 [21 16 15 37 61]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.86it/s]
Epoch 46 : Training Loss: 1.33380, acc: 0.26267, kappa: 0.07833, f1: 0.25822, LR: 0.00000, Time elapsed 0.21 mins
[[41 21 19 24 45]
 [34 31 21 24 40]
 [27 17 29 21 56]
 [30 21 22 36 41]
 [23 16 19 32 60]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.44it/s]
Epoch 47 : Training Loss: 1.33335, acc: 0.26000, kappa: 0.07500, f1: 0.25589, LR: 0.00000, Time elapsed 0.21 mins
[[46 22 18 23 41]
 [39 30 20 22 39]
 [30 16 29 19 56]
 [31 22 21 34 42]
 [32 17 17 28 56]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.32it/s]
Epoch 48 : Training Loss: 1.33041, acc: 0.25467, kappa: 0.06833, f1: 0.24616, LR: 0.00000, Time elapsed 0.21 mins
[[37 20 16 25 52]
 [32 30 20 24 44]
 [27 17 24 22 60]
 [27 21 20 32 50]
 [22 15 15 30 68]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.85it/s]
Epoch 49 : Training Loss: 1.32122, acc: 0.26133, kappa: 0.07667, f1: 0.25719, LR: 0.00000, Time elapsed 0.21 mins
[[42 23 19 22 44]
 [35 32 22 21 40]
 [27 18 30 19 56]
 [30 23 22 33 42]
 [25 18 18 30 59]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.10it/s]
Epoch 50 : Training Loss: 1.32719, acc: 0.25333, kappa: 0.06667, f1: 0.24690, LR: 0.00000, Time elapsed 0.21 mins
[[38 20 18 23 51]
 [35 30 20 23 42]
 [28 17 27 20 58]
 [29 20 21 31 49]
 [24 15 18 29 64]]
***************************Test************************
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.05it/s]
***************************Test results************************
Test Evaluation: acc: 0.26667, kappa: 0.08333, f1: 0.26600
[[41 15 25 29 40]
 [33 32 21 39 25]
 [32 21 38 31 28]
 [34 31 22 46 17]
 [28 19 23 37 43]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch16_acc_0.26667_kappa_0.08333_f1_0.26600.pth
[32m[I 2025-08-29 06:25:17,463][0m Trial 1 finished with value: 0.08333333333333337 and parameters: {'lr': 2.636875533972305e-06, 'weight_decay': 5.407712220288122e-06, '--dropout': 0.011616722433639893, '--clip_value': 1.7992642186624028}. Best is trial 1 with value: 0.08333333333333337.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=4.191711516695204e-05, weight_decay=0.0021242802137208896, optimizer='AdamW', clip_value=1.9548647782429915, dropout=0.004116898859160489, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.004116898859160489, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.004116898859160489, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
