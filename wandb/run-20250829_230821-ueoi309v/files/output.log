100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.92it/s]
Epoch 1 : Training Loss: 1.63699, acc: 0.20533, kappa: 0.00667, f1: 0.12856, LR: 0.00011, Time elapsed 0.21 mins
[[ 0  6  0 88 56]
 [ 1  6  0 93 50]
 [ 0  2  0 87 61]
 [ 0  9  0 89 52]
 [ 0  1  0 90 59]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20533, kappa: 0.00667, f1: 0.12856
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.99it/s]
Epoch 2 : Training Loss: 1.62412, acc: 0.20667, kappa: 0.00833, f1: 0.11679, LR: 0.00011, Time elapsed 0.21 mins
[[  7  15   1   0 127]
 [  6  19   0   0 125]
 [  6  10   1   0 133]
 [  9  15   0   0 126]
 [  8  13   1   0 128]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20667, kappa: 0.00833, f1: 0.11679
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.34it/s]
Epoch 3 : Training Loss: 1.60001, acc: 0.24267, kappa: 0.05333, f1: 0.20080, LR: 0.00011, Time elapsed 0.22 mins
[[43 11 10 86  0]
 [49 16 11 74  0]
 [39  9 28 74  0]
 [36 10 10 93  1]
 [35 13 16 84  2]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24267, kappa: 0.05333, f1: 0.20080
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.49it/s]
Epoch 4 : Training Loss: 1.54446, acc: 0.23867, kappa: 0.04833, f1: 0.21770, LR: 0.00011, Time elapsed 0.21 mins
[[68 13 13 44 12]
 [69 24  6 35 16]
 [48 20 15 49 18]
 [58 20  8 55  9]
 [50 14  8 61 17]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.75it/s]
Epoch 5 : Training Loss: 1.44860, acc: 0.27467, kappa: 0.09333, f1: 0.25794, LR: 0.00010, Time elapsed 0.21 mins
[[51 30 26 12 31]
 [45 48 21  7 29]
 [33 21 53 10 33]
 [48 23 32  5 42]
 [38 20 33 10 49]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27467, kappa: 0.09333, f1: 0.25794
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.46it/s]
Epoch 6 : Training Loss: 1.32101, acc: 0.26267, kappa: 0.07833, f1: 0.26335, LR: 0.00010, Time elapsed 0.22 mins
[[53 29 14 20 34]
 [62 41 18 11 18]
 [45 17 35 21 32]
 [50 27 13 29 31]
 [51 20 11 29 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.11it/s]
Epoch 7 : Training Loss: 1.16759, acc: 0.29600, kappa: 0.12000, f1: 0.29454, LR: 0.00010, Time elapsed 0.22 mins
[[43 33 23 30 21]
 [38 51 24 25 12]
 [31 20 54 27 18]
 [31 36 22 44 17]
 [33 29 25 33 30]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.29600, kappa: 0.12000, f1: 0.29454
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.68it/s]
Epoch 8 : Training Loss: 0.97385, acc: 0.29200, kappa: 0.11500, f1: 0.29050, LR: 0.00010, Time elapsed 0.22 mins
[[31 30 25 31 33]
 [30 53 21 24 22]
 [20 25 43 27 35]
 [22 30 24 42 32]
 [22 21 23 34 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.68it/s]
Epoch 9 : Training Loss: 0.81247, acc: 0.31200, kappa: 0.14000, f1: 0.30654, LR: 0.00010, Time elapsed 0.22 mins
[[20 32 22 45 31]
 [24 54 21 30 21]
 [19 23 53 29 26]
 [12 25 17 56 40]
 [16 24 18 41 51]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.31200, kappa: 0.14000, f1: 0.30654
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.71it/s]
Epoch 10 : Training Loss: 0.67571, acc: 0.29200, kappa: 0.11500, f1: 0.28967, LR: 0.00010, Time elapsed 0.22 mins
[[33 19 28 31 39]
 [36 40 25 22 27]
 [22 19 57 18 34]
 [21 23 28 34 44]
 [29 14 28 24 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.22it/s]
Epoch 11 : Training Loss: 0.61099, acc: 0.29467, kappa: 0.11833, f1: 0.29255, LR: 0.00009, Time elapsed 0.21 mins
[[31 29 25 26 39]
 [33 44 20 21 32]
 [19 21 52 23 35]
 [24 30 22 38 36]
 [21 19 29 25 56]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.76it/s]
Epoch 12 : Training Loss: 0.56731, acc: 0.31733, kappa: 0.14667, f1: 0.31719, LR: 0.00009, Time elapsed 0.22 mins
[[39 29 25 29 28]
 [35 49 16 30 20]
 [30 23 44 25 28]
 [23 27 16 52 32]
 [24 16 22 34 54]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.31733, kappa: 0.14667, f1: 0.31719
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.63it/s]
Epoch 13 : Training Loss: 0.52602, acc: 0.29067, kappa: 0.11333, f1: 0.29125, LR: 0.00009, Time elapsed 0.21 mins
[[34 30 25 33 28]
 [37 42 21 32 18]
 [33 19 52 23 23]
 [25 34 18 47 26]
 [27 14 28 38 43]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.31it/s]
Epoch 14 : Training Loss: 0.51486, acc: 0.30133, kappa: 0.12667, f1: 0.30159, LR: 0.00009, Time elapsed 0.21 mins
[[43 20 26 34 27]
 [44 37 24 29 16]
 [34 18 57 24 17]
 [31 30 13 49 27]
 [31 12 29 38 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.73it/s]
Epoch 15 : Training Loss: 0.49569, acc: 0.30400, kappa: 0.13000, f1: 0.30440, LR: 0.00009, Time elapsed 0.21 mins
[[34 22 24 35 35]
 [42 41 23 23 21]
 [26 24 54 20 26]
 [29 31 15 44 31]
 [29 18 23 25 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.80it/s]
Epoch 16 : Training Loss: 0.48396, acc: 0.31867, kappa: 0.14833, f1: 0.32068, LR: 0.00008, Time elapsed 0.22 mins
[[42 30 21 32 25]
 [36 50 15 34 15]
 [31 24 52 27 16]
 [34 29 12 53 22]
 [31 25 20 32 42]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.31867, kappa: 0.14833, f1: 0.32068
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.34it/s]
Epoch 17 : Training Loss: 0.47131, acc: 0.31867, kappa: 0.14833, f1: 0.31971, LR: 0.00008, Time elapsed 0.22 mins
[[46 23 19 40 22]
 [41 42 18 33 16]
 [27 19 50 33 21]
 [25 28 20 54 23]
 [20 23 21 39 47]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.66it/s]
Epoch 18 : Training Loss: 0.46456, acc: 0.31600, kappa: 0.14500, f1: 0.31664, LR: 0.00008, Time elapsed 0.21 mins
[[45 28 19 31 27]
 [36 57 15 28 14]
 [25 26 46 26 27]
 [30 34 13 45 28]
 [26 30 19 31 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.53it/s]
Epoch 19 : Training Loss: 0.44978, acc: 0.31600, kappa: 0.14500, f1: 0.31341, LR: 0.00007, Time elapsed 0.22 mins
[[37 24 17 37 35]
 [29 42 18 28 33]
 [29 17 39 31 34]
 [20 27  9 56 38]
 [22 18 14 33 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.36it/s]
Epoch 20 : Training Loss: 0.44249, acc: 0.30667, kappa: 0.13333, f1: 0.30898, LR: 0.00007, Time elapsed 0.22 mins
[[52 29 20 20 29]
 [51 47 13 24 15]
 [37 28 43 20 22]
 [48 33  9 38 22]
 [40 18 21 21 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.67it/s]
Epoch 21 : Training Loss: 0.43539, acc: 0.32800, kappa: 0.16000, f1: 0.32867, LR: 0.00007, Time elapsed 0.22 mins
[[41 20 25 28 36]
 [42 48 19 22 19]
 [25 25 56 18 26]
 [30 28 19 43 30]
 [32 21 20 19 58]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.32800, kappa: 0.16000, f1: 0.32867
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.90it/s]
Epoch 22 : Training Loss: 0.42980, acc: 0.32133, kappa: 0.15167, f1: 0.32109, LR: 0.00006, Time elapsed 0.22 mins
[[48 20 26 29 27]
 [46 37 23 25 19]
 [34 16 56 20 24]
 [32 26 18 43 31]
 [28 20 22 23 57]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.43it/s]
Epoch 23 : Training Loss: 0.42605, acc: 0.30000, kappa: 0.12500, f1: 0.29998, LR: 0.00006, Time elapsed 0.22 mins
[[37 23 22 35 33]
 [38 35 22 36 19]
 [30 18 49 35 18]
 [30 25 18 53 24]
 [23 22 21 33 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.07it/s]
Epoch 24 : Training Loss: 0.42013, acc: 0.32133, kappa: 0.15167, f1: 0.32406, LR: 0.00006, Time elapsed 0.21 mins
[[42 22 18 35 33]
 [37 46 15 33 19]
 [30 14 50 35 21]
 [31 33 10 50 26]
 [26 16 20 35 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.94it/s]
Epoch 25 : Training Loss: 0.41585, acc: 0.32533, kappa: 0.15667, f1: 0.32667, LR: 0.00005, Time elapsed 0.21 mins
[[45 24 25 27 29]
 [43 45 23 25 14]
 [33 14 60 25 18]
 [36 29 18 44 23]
 [29 15 30 26 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.97it/s]
Epoch 26 : Training Loss: 0.41333, acc: 0.33067, kappa: 0.16333, f1: 0.33286, LR: 0.00005, Time elapsed 0.22 mins
[[46 21 24 35 24]
 [39 43 17 34 17]
 [34 10 54 32 20]
 [34 28 11 56 21]
 [29 12 23 37 49]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.33067, kappa: 0.16333, f1: 0.33286
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.09it/s]
Epoch 27 : Training Loss: 0.41084, acc: 0.32400, kappa: 0.15500, f1: 0.32571, LR: 0.00005, Time elapsed 0.22 mins
[[38 21 22 37 32]
 [39 49 17 28 17]
 [31 13 52 29 25]
 [24 35 13 52 26]
 [25 21 18 34 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.95it/s]
Epoch 28 : Training Loss: 0.40809, acc: 0.32267, kappa: 0.15333, f1: 0.32400, LR: 0.00004, Time elapsed 0.22 mins
[[42 25 21 31 31]
 [38 49 15 28 20]
 [36 16 45 25 28]
 [33 32  9 45 31]
 [29 20 17 23 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.22it/s]
Epoch 29 : Training Loss: 0.40674, acc: 0.33467, kappa: 0.16833, f1: 0.33544, LR: 0.00004, Time elapsed 0.21 mins
[[40 29 24 29 28]
 [38 47 19 25 21]
 [27 16 54 29 24]
 [31 32 13 46 28]
 [26 18 17 25 64]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.33467, kappa: 0.16833, f1: 0.33544
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.51it/s]
Epoch 30 : Training Loss: 0.40537, acc: 0.33200, kappa: 0.16500, f1: 0.33288, LR: 0.00004, Time elapsed 0.22 mins
[[41 23 24 33 29]
 [40 48 20 23 19]
 [29 16 53 28 24]
 [32 27 14 47 30]
 [21 20 22 27 60]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.02it/s]
Epoch 31 : Training Loss: 0.40457, acc: 0.33467, kappa: 0.16833, f1: 0.33549, LR: 0.00003, Time elapsed 0.21 mins
[[41 20 24 37 28]
 [39 45 19 29 18]
 [30 16 52 27 25]
 [32 32 10 46 30]
 [22 17 17 27 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.86it/s]
Epoch 32 : Training Loss: 0.40357, acc: 0.33867, kappa: 0.17333, f1: 0.34015, LR: 0.00003, Time elapsed 0.21 mins
[[41 23 21 34 31]
 [40 48 20 25 17]
 [30 15 54 27 24]
 [30 30 12 49 29]
 [25 19 17 27 62]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.33867, kappa: 0.17333, f1: 0.34015
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.77it/s]
Epoch 33 : Training Loss: 0.40275, acc: 0.32667, kappa: 0.15833, f1: 0.32749, LR: 0.00003, Time elapsed 0.22 mins
[[41 22 25 33 29]
 [41 46 19 24 20]
 [31 16 50 28 25]
 [31 28 16 45 30]
 [27 17 18 25 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.18it/s]
Epoch 34 : Training Loss: 0.40233, acc: 0.33867, kappa: 0.17333, f1: 0.33945, LR: 0.00003, Time elapsed 0.21 mins
[[45 27 19 29 30]
 [41 48 18 24 19]
 [30 15 56 25 24]
 [30 32 16 43 29]
 [26 17 23 22 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.35it/s]
Epoch 35 : Training Loss: 0.40172, acc: 0.32667, kappa: 0.15833, f1: 0.32846, LR: 0.00002, Time elapsed 0.22 mins
[[42 23 23 34 28]
 [40 51 19 24 16]
 [36 16 49 26 23]
 [32 33 14 44 27]
 [28 19 21 23 59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.26it/s]
Epoch 36 : Training Loss: 0.40138, acc: 0.33600, kappa: 0.17000, f1: 0.33693, LR: 0.00002, Time elapsed 0.21 mins
[[43 25 22 32 28]
 [40 46 18 28 18]
 [30 14 51 29 26]
 [31 28 14 46 31]
 [25 15 16 28 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.72it/s]
Epoch 37 : Training Loss: 0.40096, acc: 0.33333, kappa: 0.16667, f1: 0.33490, LR: 0.00002, Time elapsed 0.22 mins
[[39 26 21 35 29]
 [40 48 17 27 18]
 [31 16 52 27 24]
 [28 32 14 50 26]
 [26 20 17 26 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.16it/s]
Epoch 38 : Training Loss: 0.40075, acc: 0.33733, kappa: 0.17167, f1: 0.33886, LR: 0.00002, Time elapsed 0.22 mins
[[43 25 23 32 27]
 [40 49 17 27 17]
 [29 17 54 25 25]
 [30 32 13 45 30]
 [29 17 18 24 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.44it/s]
Epoch 39 : Training Loss: 0.40057, acc: 0.33600, kappa: 0.17000, f1: 0.33609, LR: 0.00001, Time elapsed 0.22 mins
[[41 23 24 31 31]
 [40 45 19 29 17]
 [29 16 54 25 26]
 [29 28 15 46 32]
 [25 16 20 23 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.59it/s]
Epoch 40 : Training Loss: 0.40008, acc: 0.33467, kappa: 0.16833, f1: 0.33584, LR: 0.00001, Time elapsed 0.21 mins
[[42 27 23 31 27]
 [40 46 19 29 16]
 [28 16 56 26 24]
 [30 31 14 46 29]
 [26 17 21 25 61]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.41it/s]
Epoch 41 : Training Loss: 0.39991, acc: 0.34267, kappa: 0.17833, f1: 0.34282, LR: 0.00001, Time elapsed 0.22 mins
[[43 25 23 31 28]
 [38 46 20 28 18]
 [30 13 55 26 26]
 [28 30 15 46 31]
 [23 14 19 27 67]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.34267, kappa: 0.17833, f1: 0.34282
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.76it/s]
Epoch 42 : Training Loss: 0.39950, acc: 0.33733, kappa: 0.17167, f1: 0.33850, LR: 0.00001, Time elapsed 0.21 mins
[[42 24 22 33 29]
 [38 48 18 28 18]
 [29 13 55 26 27]
 [30 31 14 45 30]
 [24 17 18 28 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.03it/s]
Epoch 43 : Training Loss: 0.39939, acc: 0.34400, kappa: 0.18000, f1: 0.34494, LR: 0.00001, Time elapsed 0.22 mins
[[42 25 24 32 27]
 [40 47 19 27 17]
 [28 13 57 27 25]
 [29 30 16 48 27]
 [24 15 19 28 64]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.34400, kappa: 0.18000, f1: 0.34494
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 44 : Training Loss: 0.39924, acc: 0.33733, kappa: 0.17167, f1: 0.33779, LR: 0.00000, Time elapsed 0.21 mins
[[41 24 25 32 28]
 [38 46 20 27 19]
 [27 14 57 27 25]
 [28 32 14 47 29]
 [23 16 21 28 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.11it/s]
Epoch 45 : Training Loss: 0.39922, acc: 0.34000, kappa: 0.17500, f1: 0.34077, LR: 0.00000, Time elapsed 0.21 mins
[[41 23 25 33 28]
 [37 48 18 28 19]
 [28 12 56 27 27]
 [29 30 15 47 29]
 [24 16 20 27 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.52it/s]
Epoch 46 : Training Loss: 0.39907, acc: 0.34000, kappa: 0.17500, f1: 0.34119, LR: 0.00000, Time elapsed 0.22 mins
[[43 24 23 32 28]
 [39 48 18 28 17]
 [28 16 55 26 25]
 [30 31 14 47 28]
 [25 16 20 27 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.30it/s]
Epoch 47 : Training Loss: 0.39922, acc: 0.34133, kappa: 0.17667, f1: 0.34228, LR: 0.00000, Time elapsed 0.22 mins
[[43 24 23 32 28]
 [38 48 18 28 18]
 [28 14 55 27 26]
 [30 29 15 47 29]
 [24 16 20 27 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.44it/s]
Epoch 48 : Training Loss: 0.39938, acc: 0.34267, kappa: 0.17833, f1: 0.34358, LR: 0.00000, Time elapsed 0.21 mins
[[43 23 24 32 28]
 [38 48 17 28 19]
 [28 14 55 26 27]
 [30 29 14 48 29]
 [24 16 20 27 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.91it/s]
Epoch 49 : Training Loss: 0.39933, acc: 0.34133, kappa: 0.17667, f1: 0.34229, LR: 0.00000, Time elapsed 0.22 mins
[[43 24 23 33 27]
 [38 48 17 28 19]
 [28 16 54 26 26]
 [30 29 14 48 29]
 [24 16 20 27 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.69it/s]
Epoch 50 : Training Loss: 0.39889, acc: 0.34000, kappa: 0.17500, f1: 0.34094, LR: 0.00000, Time elapsed 0.22 mins
[[44 24 23 32 27]
 [38 48 17 28 19]
 [28 17 54 25 26]
 [30 29 14 47 30]
 [24 17 20 27 62]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.50it/s]
***************************Test results************************
Test Evaluation: acc: 0.32400, kappa: 0.15500, f1: 0.32372
[[50 21 27 23 29]
 [35 44 21 32 18]
 [26 24 47 27 26]
 [24 25 29 45 27]
 [27 18 21 27 57]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch43_acc_0.32400_kappa_0.15500_f1_0.32372.pth
[32m[I 2025-08-29 23:19:20,691][0m Trial 76 finished with value: 0.15500000000000003 and parameters: {'lr': 0.00010712011326221835, 'weight_decay': 0.0030773553345354162, '--dropout': 0.16712196852050837, '--clip_value': 1.8126722781983866}. Best is trial 35 with value: 0.36.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=9.44245072594862e-06, weight_decay=0.0099352889155718, optimizer='AdamW', clip_value=1.8480641002830875, dropout=0.17506887256745446, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.17506887256745446, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.17506887256745446, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
