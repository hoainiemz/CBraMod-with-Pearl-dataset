100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.73it/s]
Epoch 1 : Training Loss: 1.68012, acc: 0.20933, kappa: 0.01167, f1: 0.08483, LR: 0.00019, Time elapsed 0.28 mins
[[  0   4 146   0   0]
 [  2   7 141   0   0]
 [  0   0 150   0   0]
 [  0   3 147   0   0]
 [  0   5 145   0   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20933, kappa: 0.01167, f1: 0.08483
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.58it/s]
Epoch 2 : Training Loss: 1.63256, acc: 0.21200, kappa: 0.01500, f1: 0.11880, LR: 0.00019, Time elapsed 0.28 mins
[[  0  27   3   0 120]
 [  0  24   1   0 125]
 [  0  23   4   0 123]
 [  0  18   4   2 126]
 [  1  17   2   1 129]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21200, kappa: 0.01500, f1: 0.11880
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.45it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.37it/s]
Epoch 3 : Training Loss: 1.62416, acc: 0.23467, kappa: 0.04333, f1: 0.16305, LR: 0.00019, Time elapsed 0.28 mins
[[  5  43  90  10   2]
 [ 10  48  88   4   0]
 [  3  31 111   3   2]
 [  5  36  98  11   0]
 [  6  36 100   7   1]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23467, kappa: 0.04333, f1: 0.16305
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.57it/s]
Epoch 4 : Training Loss: 1.60182, acc: 0.23067, kappa: 0.03833, f1: 0.15343, LR: 0.00019, Time elapsed 0.28 mins
[[ 19   8 115   0   8]
 [ 21  10 117   0   2]
 [  9   3 131   0   7]
 [ 15   7 120   1   7]
 [ 13   6 118   1  12]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.68it/s]
Epoch 5 : Training Loss: 1.55961, acc: 0.29067, kappa: 0.11333, f1: 0.27739, LR: 0.00019, Time elapsed 0.28 mins
[[48 17 24 45 16]
 [40 25 32 42 11]
 [28  8 61 33 20]
 [35  6 39 64  6]
 [33  6 46 45 20]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.29067, kappa: 0.11333, f1: 0.27739
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.87it/s]
Epoch 6 : Training Loss: 1.48018, acc: 0.29467, kappa: 0.11833, f1: 0.27512, LR: 0.00019, Time elapsed 0.28 mins
[[33 24  5 81  7]
 [25 40  5 76  4]
 [25 24 35 59  7]
 [24 23  1 99  3]
 [25 23  6 82 14]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.29467, kappa: 0.11833, f1: 0.27512
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.86it/s]
Epoch 7 : Training Loss: 1.33318, acc: 0.37867, kappa: 0.22333, f1: 0.37185, LR: 0.00018, Time elapsed 0.28 mins
[[46 18 19 48 19]
 [35 37 18 41 19]
 [15  8 66 29 32]
 [22  7 23 85 13]
 [29 15 25 31 50]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.37867, kappa: 0.22333, f1: 0.37185
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.19it/s]
Epoch 8 : Training Loss: 1.14789, acc: 0.38800, kappa: 0.23500, f1: 0.38492, LR: 0.00018, Time elapsed 0.28 mins
[[46 18 23 48 15]
 [29 48 24 31 18]
 [16 14 79 20 21]
 [23 16 32 66 13]
 [21 20 27 30 52]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.38800, kappa: 0.23500, f1: 0.38492
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.15it/s]
Epoch 9 : Training Loss: 0.96024, acc: 0.40000, kappa: 0.25000, f1: 0.39937, LR: 0.00018, Time elapsed 0.27 mins
[[54 24 18 29 25]
 [27 60 26 14 23]
 [16 15 65 14 40]
 [24 28 19 52 27]
 [27 21 20 13 69]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.40000, kappa: 0.25000, f1: 0.39937
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.42it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.93it/s]
Epoch 10 : Training Loss: 0.78514, acc: 0.43200, kappa: 0.29000, f1: 0.43269, LR: 0.00017, Time elapsed 0.28 mins
[[57 27 15 28 23]
 [33 66 17 16 18]
 [17 24 69 18 22]
 [18 27 16 68 21]
 [25 20 16 25 64]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.43200, kappa: 0.29000, f1: 0.43269
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.83it/s]
Epoch 11 : Training Loss: 0.69623, acc: 0.42533, kappa: 0.28167, f1: 0.42377, LR: 0.00017, Time elapsed 0.28 mins
[[63 14 17 25 31]
 [34 46 19 25 26]
 [20 13 76 14 27]
 [29 18 20 65 18]
 [27 12 20 22 69]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.77it/s]
Epoch 12 : Training Loss: 0.61110, acc: 0.42533, kappa: 0.28167, f1: 0.42520, LR: 0.00017, Time elapsed 0.27 mins
[[59 19 24 22 26]
 [25 60 16 23 26]
 [19 17 71 12 31]
 [19 21 30 63 17]
 [26 22 19 17 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.41it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.87it/s]
Epoch 13 : Training Loss: 0.58076, acc: 0.45067, kappa: 0.31333, f1: 0.44615, LR: 0.00016, Time elapsed 0.28 mins
[[59 16 20 31 24]
 [24 45 21 37 23]
 [11 13 81 19 26]
 [14 20 18 82 16]
 [18 15 21 25 71]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.45067, kappa: 0.31333, f1: 0.44615
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.62it/s]
Epoch 14 : Training Loss: 0.54549, acc: 0.45200, kappa: 0.31500, f1: 0.44988, LR: 0.00016, Time elapsed 0.28 mins
[[66 14 22 31 17]
 [35 55 22 23 15]
 [17 14 87 13 19]
 [21 18 26 69 16]
 [24 17 21 26 62]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.45200, kappa: 0.31500, f1: 0.44988
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.44it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.03it/s]
Epoch 15 : Training Loss: 0.51592, acc: 0.44667, kappa: 0.30833, f1: 0.44558, LR: 0.00015, Time elapsed 0.28 mins
[[69 17 14 32 18]
 [25 56 18 31 20]
 [18 20 66 20 26]
 [20 17 13 82 18]
 [20 16 17 35 62]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.05it/s]
Epoch 16 : Training Loss: 0.49797, acc: 0.46533, kappa: 0.33167, f1: 0.46483, LR: 0.00015, Time elapsed 0.28 mins
[[67 19 13 27 24]
 [26 63 21 20 20]
 [14 14 84 16 22]
 [12 30 21 71 16]
 [15 22 21 28 64]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.46533, kappa: 0.33167, f1: 0.46483
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.22it/s]
Epoch 17 : Training Loss: 0.47754, acc: 0.46133, kappa: 0.32667, f1: 0.45983, LR: 0.00014, Time elapsed 0.28 mins
[[62 12 14 29 33]
 [21 55 17 29 28]
 [13 22 68 16 31]
 [16 14 15 84 21]
 [20 15 11 27 77]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.82it/s]
Epoch 18 : Training Loss: 0.46091, acc: 0.44933, kappa: 0.31167, f1: 0.44812, LR: 0.00014, Time elapsed 0.28 mins
[[72 18 16 22 22]
 [35 54 22 22 17]
 [21 16 78 15 20]
 [18 19 30 70 13]
 [33 17 16 21 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.72it/s]
Epoch 19 : Training Loss: 0.44797, acc: 0.46800, kappa: 0.33500, f1: 0.46541, LR: 0.00013, Time elapsed 0.27 mins
[[71 11 23 28 17]
 [27 59 28 25 11]
 [21 15 83 19 12]
 [15 18 23 82 12]
 [23 12 27 32 56]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.46800, kappa: 0.33500, f1: 0.46541
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.38it/s]
Epoch 20 : Training Loss: 0.43861, acc: 0.46267, kappa: 0.32833, f1: 0.46170, LR: 0.00013, Time elapsed 0.28 mins
[[60 22 16 22 30]
 [22 64 20 25 19]
 [14 23 77 15 21]
 [13 24 15 81 17]
 [18 18 22 27 65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.31it/s]
Epoch 21 : Training Loss: 0.43155, acc: 0.47733, kappa: 0.34667, f1: 0.47627, LR: 0.00012, Time elapsed 0.27 mins
[[68 18 19 21 24]
 [25 71 16 22 16]
 [16 18 85 12 19]
 [16 24 23 71 16]
 [20 18 25 24 63]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.47733, kappa: 0.34667, f1: 0.47627
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.74it/s]
Epoch 22 : Training Loss: 0.42729, acc: 0.47467, kappa: 0.34333, f1: 0.47303, LR: 0.00011, Time elapsed 0.27 mins
[[72 19 18 21 20]
 [30 58 22 28 12]
 [21 16 83 14 16]
 [17 21 20 78 14]
 [20 15 27 23 65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.84it/s]
Epoch 23 : Training Loss: 0.42314, acc: 0.48533, kappa: 0.35667, f1: 0.48486, LR: 0.00011, Time elapsed 0.28 mins
[[74 18 17 18 23]
 [27 64 19 25 15]
 [15 20 83 14 18]
 [18 26 19 71 16]
 [22 17 21 18 72]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.48533, kappa: 0.35667, f1: 0.48486
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.27it/s]
Epoch 24 : Training Loss: 0.41963, acc: 0.47067, kappa: 0.33833, f1: 0.46753, LR: 0.00010, Time elapsed 0.28 mins
[[69 18 22 22 19]
 [26 63 20 32  9]
 [19 17 86 13 15]
 [15 22 20 81 12]
 [25 17 27 27 54]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.45it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.80it/s]
Epoch 25 : Training Loss: 0.41775, acc: 0.47867, kappa: 0.34833, f1: 0.47780, LR: 0.00010, Time elapsed 0.28 mins
[[72 21 17 21 19]
 [24 65 18 27 16]
 [17 18 82 14 19]
 [18 23 18 77 14]
 [23 18 22 24 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.42it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.88it/s]
Epoch 26 : Training Loss: 0.41668, acc: 0.48667, kappa: 0.35833, f1: 0.48634, LR: 0.00009, Time elapsed 0.28 mins
[[74 22 16 19 19]
 [28 70 17 22 13]
 [18 20 83 12 17]
 [19 25 18 73 15]
 [23 19 24 19 65]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.48667, kappa: 0.35833, f1: 0.48634
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.19it/s]
Epoch 27 : Training Loss: 0.41409, acc: 0.49733, kappa: 0.37167, f1: 0.49634, LR: 0.00008, Time elapsed 0.28 mins
[[71 20 15 23 21]
 [28 67 21 22 12]
 [18 16 89 12 15]
 [15 22 17 79 17]
 [25 16 20 22 67]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.49733, kappa: 0.37167, f1: 0.49634
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.12it/s]
Epoch 28 : Training Loss: 0.41383, acc: 0.48933, kappa: 0.36167, f1: 0.48854, LR: 0.00008, Time elapsed 0.28 mins
[[76 17 16 22 19]
 [32 64 18 21 15]
 [19 19 85 13 14]
 [16 23 22 74 15]
 [24 16 24 18 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.16it/s]
Epoch 29 : Training Loss: 0.41254, acc: 0.48267, kappa: 0.35333, f1: 0.48229, LR: 0.00007, Time elapsed 0.28 mins
[[71 20 16 21 22]
 [25 70 20 20 15]
 [20 20 82 13 15]
 [16 25 20 73 16]
 [26 15 22 21 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.88it/s]
Epoch 30 : Training Loss: 0.41132, acc: 0.48133, kappa: 0.35167, f1: 0.48031, LR: 0.00007, Time elapsed 0.28 mins
[[71 17 19 21 22]
 [28 67 22 19 14]
 [17 20 84 12 17]
 [14 23 22 75 16]
 [21 15 28 22 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.18it/s]
Epoch 31 : Training Loss: 0.41036, acc: 0.48800, kappa: 0.36000, f1: 0.48653, LR: 0.00006, Time elapsed 0.28 mins
[[75 20 18 18 19]
 [30 64 23 21 12]
 [19 15 89 15 12]
 [15 23 25 73 14]
 [23 15 30 17 65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.88it/s]
Epoch 32 : Training Loss: 0.40980, acc: 0.48133, kappa: 0.35167, f1: 0.47951, LR: 0.00006, Time elapsed 0.27 mins
[[74 17 17 21 21]
 [32 61 21 23 13]
 [20 16 90 14 10]
 [16 24 22 72 16]
 [27 15 26 18 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.93it/s]
Epoch 33 : Training Loss: 0.40863, acc: 0.48000, kappa: 0.35000, f1: 0.47955, LR: 0.00005, Time elapsed 0.28 mins
[[72 21 14 21 22]
 [23 66 20 23 18]
 [19 18 81 15 17]
 [15 23 21 71 20]
 [23 14 24 19 70]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.59it/s]
Epoch 34 : Training Loss: 0.40823, acc: 0.47867, kappa: 0.34833, f1: 0.47822, LR: 0.00005, Time elapsed 0.27 mins
[[75 21 14 19 21]
 [27 63 20 26 14]
 [19 19 80 14 18]
 [16 24 19 72 19]
 [25 15 22 19 69]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.88it/s]
Epoch 35 : Training Loss: 0.40688, acc: 0.47733, kappa: 0.34667, f1: 0.47690, LR: 0.00004, Time elapsed 0.28 mins
[[71 20 17 21 21]
 [22 65 20 28 15]
 [19 19 79 15 18]
 [15 24 17 75 19]
 [24 13 23 22 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.61it/s]
Epoch 36 : Training Loss: 0.40693, acc: 0.48267, kappa: 0.35333, f1: 0.48217, LR: 0.00004, Time elapsed 0.27 mins
[[72 21 15 21 21]
 [24 66 19 24 17]
 [18 19 85 14 14]
 [15 26 18 72 19]
 [28 16 21 18 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.12it/s]
Epoch 37 : Training Loss: 0.40637, acc: 0.47200, kappa: 0.34000, f1: 0.47103, LR: 0.00003, Time elapsed 0.28 mins
[[73 16 14 25 22]
 [24 62 21 26 17]
 [19 17 83 13 18]
 [15 27 21 69 18]
 [27 14 25 17 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.46it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.82it/s]
Epoch 38 : Training Loss: 0.40609, acc: 0.48000, kappa: 0.35000, f1: 0.47882, LR: 0.00003, Time elapsed 0.28 mins
[[72 18 16 23 21]
 [22 69 21 25 13]
 [18 16 86 14 16]
 [15 26 22 70 17]
 [27 16 25 19 63]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.03it/s]
Epoch 39 : Training Loss: 0.40553, acc: 0.48000, kappa: 0.35000, f1: 0.47929, LR: 0.00002, Time elapsed 0.27 mins
[[75 16 18 19 22]
 [24 66 19 24 17]
 [19 17 82 13 19]
 [15 25 22 69 19]
 [26 15 24 17 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.40it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.81it/s]
Epoch 40 : Training Loss: 0.40557, acc: 0.48133, kappa: 0.35167, f1: 0.48033, LR: 0.00002, Time elapsed 0.28 mins
[[69 18 19 20 24]
 [22 66 19 25 18]
 [17 16 86 14 17]
 [13 25 23 71 18]
 [23 16 23 19 69]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.85it/s]
Epoch 41 : Training Loss: 0.40455, acc: 0.48800, kappa: 0.36000, f1: 0.48712, LR: 0.00002, Time elapsed 0.27 mins
[[70 19 18 20 23]
 [24 66 21 26 13]
 [18 17 86 13 16]
 [14 25 21 74 16]
 [22 16 25 17 70]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.88it/s]
Epoch 42 : Training Loss: 0.40466, acc: 0.48267, kappa: 0.35333, f1: 0.48160, LR: 0.00001, Time elapsed 0.27 mins
[[71 18 17 22 22]
 [26 63 21 25 15]
 [19 17 86 13 15]
 [13 22 24 74 17]
 [27 18 20 17 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.09it/s]
Epoch 43 : Training Loss: 0.40468, acc: 0.48133, kappa: 0.35167, f1: 0.48068, LR: 0.00001, Time elapsed 0.27 mins
[[71 18 17 21 23]
 [24 65 19 25 17]
 [19 17 84 13 17]
 [14 25 21 72 18]
 [26 16 20 19 69]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.95it/s]
Epoch 44 : Training Loss: 0.40439, acc: 0.48000, kappa: 0.35000, f1: 0.47886, LR: 0.00001, Time elapsed 0.27 mins
[[71 18 17 22 22]
 [25 65 19 25 16]
 [18 16 87 13 16]
 [14 25 22 71 18]
 [28 15 23 18 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.11it/s]
Epoch 45 : Training Loss: 0.40400, acc: 0.48000, kappa: 0.35000, f1: 0.47910, LR: 0.00001, Time elapsed 0.28 mins
[[71 19 17 22 21]
 [25 66 20 24 15]
 [18 17 86 13 16]
 [14 26 22 70 18]
 [28 16 22 17 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.85it/s]
Epoch 46 : Training Loss: 0.40417, acc: 0.48267, kappa: 0.35333, f1: 0.48172, LR: 0.00000, Time elapsed 0.28 mins
[[72 18 18 20 22]
 [25 66 20 24 15]
 [19 16 86 13 16]
 [15 24 22 70 19]
 [27 16 24 15 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.03it/s]
Epoch 47 : Training Loss: 0.40420, acc: 0.48000, kappa: 0.35000, f1: 0.47916, LR: 0.00000, Time elapsed 0.27 mins
[[70 19 18 21 22]
 [25 65 20 25 15]
 [20 16 85 13 16]
 [14 24 22 72 18]
 [27 16 23 16 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.48it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.28it/s]
Epoch 48 : Training Loss: 0.40409, acc: 0.47733, kappa: 0.34667, f1: 0.47651, LR: 0.00000, Time elapsed 0.28 mins
[[70 19 17 22 22]
 [26 64 20 25 15]
 [20 16 85 13 16]
 [15 24 22 71 18]
 [27 16 22 17 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.99it/s]
Epoch 49 : Training Loss: 0.40429, acc: 0.48133, kappa: 0.35167, f1: 0.48063, LR: 0.00000, Time elapsed 0.28 mins
[[71 19 17 21 22]
 [25 66 20 24 15]
 [20 16 85 13 16]
 [15 24 22 71 18]
 [28 16 21 17 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:15<00:00,  4.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.82it/s]
Epoch 50 : Training Loss: 0.40402, acc: 0.48267, kappa: 0.35333, f1: 0.48194, LR: 0.00000, Time elapsed 0.27 mins
[[71 19 17 21 22]
 [25 66 20 24 15]
 [20 16 85 13 16]
 [14 24 22 72 18]
 [28 16 22 16 68]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.51it/s]
***************************Test results************************
Test Evaluation: acc: 0.48933, kappa: 0.36167, f1: 0.48943
[[76 20 14 23 17]
 [25 73 18 14 20]
 [14 21 69 19 27]
 [23 24 15 73 15]
 [21 19 13 21 76]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch27_acc_0.48933_kappa_0.36167_f1_0.48943.pth
[32m[I 2025-08-30 02:59:47,275][0m Trial 95 finished with value: 0.3616666666666667 and parameters: {'lr': 0.0001921801957092561, 'weight_decay': 0.0010268758509388836, '--dropout': 0.19091523278158146, '--clip_value': 1.510611396856516}. Best is trial 78 with value: 0.3733333333333333.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.00030341435125601685, weight_decay=0.001103207940747658, optimizer='AdamW', clip_value=1.515153300367905, dropout=0.19026893329995664, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.19026893329995664, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.19026893329995664, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
