100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:20<00:00,  3.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.67it/s]
Epoch 1 : Training Loss: 1.61641, acc: 0.20800, kappa: 0.01000, f1: 0.13195, LR: 0.00001, Time elapsed 0.35 mins
[[  1   3  97  46   3]
 [  7   5  98  38   2]
 [  1   5 105  37   2]
 [  1   8  95  43   3]
 [  1   2  98  47   2]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20800, kappa: 0.01000, f1: 0.13195
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.27it/s]
Epoch 2 : Training Loss: 1.59824, acc: 0.23467, kappa: 0.04333, f1: 0.21396, LR: 0.00001, Time elapsed 0.31 mins
[[59  6 38 33 14]
 [62  6 41 23 18]
 [41  6 50 30 23]
 [55 10 35 39 11]
 [48  7 39 34 22]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23467, kappa: 0.04333, f1: 0.21396
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.63it/s]
Epoch 3 : Training Loss: 1.58491, acc: 0.23733, kappa: 0.04667, f1: 0.22936, LR: 0.00001, Time elapsed 0.33 mins
[[29 33 43 34 11]
 [32 33 51 25  9]
 [11 27 58 43 11]
 [26 29 49 40  6]
 [19 24 49 40 18]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23733, kappa: 0.04667, f1: 0.22936
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.00it/s]
Epoch 4 : Training Loss: 1.56859, acc: 0.22267, kappa: 0.02833, f1: 0.20695, LR: 0.00001, Time elapsed 0.31 mins
[[37  8 55 35 15]
 [41 12 56 24 17]
 [23  8 66 34 19]
 [34 15 56 31 14]
 [22 11 57 39 21]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.57it/s]
Epoch 5 : Training Loss: 1.55136, acc: 0.23200, kappa: 0.04000, f1: 0.22044, LR: 0.00001, Time elapsed 0.33 mins
[[43 11 49 25 22]
 [44 18 48 12 28]
 [24 11 51 20 44]
 [35 14 51 14 36]
 [29  9 43 21 48]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.52it/s]
Epoch 6 : Training Loss: 1.53244, acc: 0.24000, kappa: 0.05000, f1: 0.21767, LR: 0.00001, Time elapsed 0.33 mins
[[66 10 18 24 32]
 [62 19 15  9 45]
 [48  9 21 14 58]
 [58 12 23 13 44]
 [51 11  9 18 61]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24000, kappa: 0.05000, f1: 0.21767
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.23it/s]
Epoch 7 : Training Loss: 1.50579, acc: 0.24133, kappa: 0.05167, f1: 0.23195, LR: 0.00001, Time elapsed 0.32 mins
[[31  8 19 62 30]
 [31 16 13 53 37]
 [20  9 27 49 45]
 [24 11 20 55 40]
 [17  7 11 63 52]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24133, kappa: 0.05167, f1: 0.23195
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.61it/s]
Epoch 8 : Training Loss: 1.47808, acc: 0.24533, kappa: 0.05667, f1: 0.24445, LR: 0.00001, Time elapsed 0.30 mins
[[40 16 27 42 25]
 [34 25 22 39 30]
 [30 15 36 38 31]
 [32 20 30 39 29]
 [26 12 23 45 44]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24533, kappa: 0.05667, f1: 0.24445
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.62it/s]
Epoch 9 : Training Loss: 1.44454, acc: 0.25067, kappa: 0.06333, f1: 0.24996, LR: 0.00001, Time elapsed 0.31 mins
[[34 22 19 46 29]
 [32 30 18 37 33]
 [27 18 34 38 33]
 [28 21 29 44 28]
 [21 19 17 47 46]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25067, kappa: 0.06333, f1: 0.24996
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.87it/s]
Epoch 10 : Training Loss: 1.42586, acc: 0.24933, kappa: 0.06167, f1: 0.24424, LR: 0.00001, Time elapsed 0.31 mins
[[58 19 11 33 29]
 [63 30 10 17 30]
 [44 16 25 29 36]
 [45 25 15 30 35]
 [45 21 12 28 44]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.58it/s]
Epoch 11 : Training Loss: 1.39246, acc: 0.23200, kappa: 0.04000, f1: 0.22243, LR: 0.00001, Time elapsed 0.34 mins
[[53 14  9 44 30]
 [52 18  9 41 30]
 [38 12 19 44 37]
 [39 17 15 41 38]
 [38 14 12 43 43]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.05it/s]
Epoch 12 : Training Loss: 1.36404, acc: 0.23467, kappa: 0.04333, f1: 0.22444, LR: 0.00001, Time elapsed 0.32 mins
[[40 17 16 29 48]
 [39 31 13 19 48]
 [36 16 17 21 60]
 [32 26 13 25 54]
 [32 14 10 31 63]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.72it/s]
Epoch 13 : Training Loss: 1.32982, acc: 0.24133, kappa: 0.05167, f1: 0.23539, LR: 0.00001, Time elapsed 0.33 mins
[[37 24 28 21 40]
 [45 32 21 13 39]
 [34 20 33 13 50]
 [32 25 31 21 41]
 [32 21 19 20 58]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.43it/s]
Epoch 14 : Training Loss: 1.29961, acc: 0.22800, kappa: 0.03500, f1: 0.21812, LR: 0.00001, Time elapsed 0.31 mins
[[29 21 20 28 52]
 [36 28 13 20 53]
 [26 18 21 19 66]
 [27 25 21 27 50]
 [28 18 11 27 66]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.64it/s]
Epoch 15 : Training Loss: 1.26787, acc: 0.22800, kappa: 0.03500, f1: 0.21565, LR: 0.00001, Time elapsed 0.31 mins
[[41 15 17 24 53]
 [51 22 15 15 47]
 [34 14 20 17 65]
 [36 18 20 23 53]
 [31 12 14 28 65]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.47it/s]
Epoch 16 : Training Loss: 1.24637, acc: 0.23333, kappa: 0.04167, f1: 0.23126, LR: 0.00001, Time elapsed 0.34 mins
[[36 21 25 30 38]
 [45 29 19 25 32]
 [35 18 30 28 39]
 [31 28 24 30 37]
 [30 18 19 33 50]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.47it/s]
Epoch 17 : Training Loss: 1.21539, acc: 0.24133, kappa: 0.05167, f1: 0.23541, LR: 0.00001, Time elapsed 0.32 mins
[[42 23 21 24 40]
 [45 32 17 19 37]
 [34 18 25 24 49]
 [34 24 22 25 45]
 [32 19 18 24 57]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.52it/s]
Epoch 18 : Training Loss: 1.18057, acc: 0.24933, kappa: 0.06167, f1: 0.24408, LR: 0.00001, Time elapsed 0.33 mins
[[32 27 22 26 43]
 [38 37 10 20 45]
 [34 22 23 24 47]
 [25 30 16 36 43]
 [28 24 12 27 59]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.69it/s]
Epoch 19 : Training Loss: 1.16415, acc: 0.25067, kappa: 0.06333, f1: 0.25048, LR: 0.00001, Time elapsed 0.30 mins
[[30 28 26 25 41]
 [38 38 17 22 35]
 [29 19 36 25 41]
 [30 23 23 35 39]
 [30 22 20 29 49]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.90it/s]
Epoch 20 : Training Loss: 1.13939, acc: 0.24000, kappa: 0.05000, f1: 0.23578, LR: 0.00001, Time elapsed 0.34 mins
[[33 25 23 28 41]
 [39 37 12 19 43]
 [30 20 26 24 50]
 [28 30 20 28 44]
 [29 24 16 25 56]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.78it/s]
Epoch 21 : Training Loss: 1.11833, acc: 0.23467, kappa: 0.04333, f1: 0.23068, LR: 0.00001, Time elapsed 0.31 mins
[[32 24 25 26 43]
 [38 36 12 17 47]
 [33 21 29 19 48]
 [32 29 24 24 41]
 [31 23 19 22 55]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.69it/s]
Epoch 22 : Training Loss: 1.09617, acc: 0.24133, kappa: 0.05167, f1: 0.23920, LR: 0.00001, Time elapsed 0.34 mins
[[42 26 25 24 33]
 [47 36 11 19 37]
 [39 18 32 20 41]
 [34 27 23 24 42]
 [37 21 23 22 47]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.67it/s]
Epoch 23 : Training Loss: 1.07203, acc: 0.24000, kappa: 0.05000, f1: 0.23775, LR: 0.00001, Time elapsed 0.32 mins
[[29 28 22 30 41]
 [40 36 12 25 37]
 [29 21 29 25 46]
 [24 29 21 34 42]
 [28 26 19 25 52]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.27it/s]
Epoch 24 : Training Loss: 1.06024, acc: 0.23733, kappa: 0.04667, f1: 0.23699, LR: 0.00001, Time elapsed 0.31 mins
[[40 17 24 36 33]
 [43 30 16 28 33]
 [37 17 32 26 38]
 [35 27 18 33 37]
 [39 20 22 26 43]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.74it/s]
Epoch 25 : Training Loss: 1.03428, acc: 0.25067, kappa: 0.06333, f1: 0.24970, LR: 0.00001, Time elapsed 0.34 mins
[[33 24 23 37 33]
 [40 34 13 29 34]
 [29 18 31 31 41]
 [28 27 17 41 37]
 [33 19 20 29 49]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.51it/s]
Epoch 26 : Training Loss: 1.01684, acc: 0.24667, kappa: 0.05833, f1: 0.24476, LR: 0.00001, Time elapsed 0.33 mins
[[28 28 25 35 34]
 [35 33 20 28 34]
 [27 20 37 29 37]
 [24 29 25 35 37]
 [24 23 23 28 52]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.56it/s]
Epoch 27 : Training Loss: 1.00159, acc: 0.24400, kappa: 0.05500, f1: 0.24342, LR: 0.00001, Time elapsed 0.31 mins
[[30 33 24 29 34]
 [35 40 12 28 35]
 [28 23 32 28 39]
 [23 32 19 36 40]
 [32 24 24 25 45]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.28it/s]
Epoch 28 : Training Loss: 0.98514, acc: 0.24267, kappa: 0.05333, f1: 0.24121, LR: 0.00000, Time elapsed 0.31 mins
[[34 27 25 30 34]
 [36 40 13 26 35]
 [33 21 30 28 38]
 [29 30 21 29 41]
 [33 23 21 24 49]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.94it/s]
Epoch 29 : Training Loss: 0.97484, acc: 0.24133, kappa: 0.05167, f1: 0.23875, LR: 0.00000, Time elapsed 0.35 mins
[[37 30 25 23 35]
 [41 42 11 20 36]
 [37 21 33 19 40]
 [31 35 18 21 45]
 [36 24 20 22 48]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.66it/s]
Epoch 30 : Training Loss: 0.95435, acc: 0.25467, kappa: 0.06833, f1: 0.25350, LR: 0.00000, Time elapsed 0.32 mins
[[40 29 20 33 28]
 [37 40 12 28 33]
 [32 24 29 33 32]
 [29 31 17 35 38]
 [33 25 20 25 47]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25467, kappa: 0.06833, f1: 0.25350
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.79it/s]
Epoch 31 : Training Loss: 0.94156, acc: 0.24400, kappa: 0.05500, f1: 0.24409, LR: 0.00000, Time elapsed 0.33 mins
[[36 32 25 29 28]
 [36 39 17 26 32]
 [32 25 39 24 30]
 [27 33 25 29 36]
 [34 27 23 26 40]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.61it/s]
Epoch 32 : Training Loss: 0.91146, acc: 0.25600, kappa: 0.07000, f1: 0.25593, LR: 0.00000, Time elapsed 0.30 mins
[[33 30 25 33 29]
 [35 38 19 26 32]
 [25 24 39 28 34]
 [26 28 22 38 36]
 [28 23 28 27 44]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25600, kappa: 0.07000, f1: 0.25593
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:20<00:00,  3.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.49it/s]
Epoch 33 : Training Loss: 0.91169, acc: 0.24933, kappa: 0.06167, f1: 0.24777, LR: 0.00000, Time elapsed 0.35 mins
[[38 29 23 29 31]
 [39 40 17 22 32]
 [34 22 32 24 38]
 [27 34 23 29 37]
 [29 27 21 25 48]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.38it/s]
Epoch 34 : Training Loss: 0.90454, acc: 0.25467, kappa: 0.06833, f1: 0.25290, LR: 0.00000, Time elapsed 0.31 mins
[[39 29 19 34 29]
 [37 42 15 26 30]
 [36 21 26 30 37]
 [30 31 16 38 35]
 [32 26 18 28 46]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.81it/s]
Epoch 35 : Training Loss: 0.88789, acc: 0.24267, kappa: 0.05333, f1: 0.24248, LR: 0.00000, Time elapsed 0.30 mins
[[41 26 24 33 26]
 [39 38 22 27 24]
 [38 25 34 25 28]
 [29 31 27 30 33]
 [36 25 22 28 39]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.26it/s]
Epoch 36 : Training Loss: 0.88314, acc: 0.25467, kappa: 0.06833, f1: 0.25296, LR: 0.00000, Time elapsed 0.31 mins
[[36 29 24 30 31]
 [33 37 20 25 35]
 [30 21 37 23 39]
 [27 29 27 29 38]
 [29 24 19 26 52]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.72it/s]
Epoch 37 : Training Loss: 0.87371, acc: 0.25867, kappa: 0.07333, f1: 0.25824, LR: 0.00000, Time elapsed 0.34 mins
[[37 26 26 31 30]
 [34 38 25 26 27]
 [27 20 45 25 33]
 [28 27 30 30 35]
 [30 23 25 28 44]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25867, kappa: 0.07333, f1: 0.25824
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.50it/s]
Epoch 38 : Training Loss: 0.86193, acc: 0.25333, kappa: 0.06667, f1: 0.25237, LR: 0.00000, Time elapsed 0.31 mins
[[36 30 23 29 32]
 [34 40 22 22 32]
 [28 25 40 22 35]
 [27 30 28 28 37]
 [31 24 23 26 46]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.32it/s]
Epoch 39 : Training Loss: 0.84825, acc: 0.24933, kappa: 0.06167, f1: 0.24901, LR: 0.00000, Time elapsed 0.34 mins
[[40 28 22 30 30]
 [38 39 18 22 33]
 [32 23 34 27 34]
 [31 26 25 31 37]
 [34 24 22 27 43]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.90it/s]
Epoch 40 : Training Loss: 0.84541, acc: 0.24400, kappa: 0.05500, f1: 0.24399, LR: 0.00000, Time elapsed 0.31 mins
[[36 31 22 32 29]
 [35 39 21 25 30]
 [27 26 39 25 33]
 [26 31 26 29 38]
 [31 29 23 27 40]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.16it/s]
Epoch 41 : Training Loss: 0.84660, acc: 0.24933, kappa: 0.06167, f1: 0.24754, LR: 0.00000, Time elapsed 0.33 mins
[[34 30 21 30 35]
 [31 40 17 22 40]
 [27 25 35 23 40]
 [25 34 25 28 38]
 [27 27 21 25 50]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.46it/s]
Epoch 42 : Training Loss: 0.83414, acc: 0.25067, kappa: 0.06333, f1: 0.25019, LR: 0.00000, Time elapsed 0.32 mins
[[37 28 22 30 33]
 [34 38 20 24 34]
 [28 23 38 23 38]
 [27 30 26 30 37]
 [30 26 23 26 45]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.71it/s]
Epoch 43 : Training Loss: 0.83447, acc: 0.25333, kappa: 0.06667, f1: 0.25284, LR: 0.00000, Time elapsed 0.34 mins
[[36 28 22 30 34]
 [34 38 19 24 35]
 [28 23 38 24 37]
 [27 30 25 31 37]
 [29 27 20 27 47]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.11it/s]
Epoch 44 : Training Loss: 0.81841, acc: 0.25200, kappa: 0.06500, f1: 0.25117, LR: 0.00000, Time elapsed 0.31 mins
[[36 29 22 30 33]
 [35 40 19 24 32]
 [28 25 37 23 37]
 [28 31 25 29 37]
 [29 26 21 27 47]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.43it/s]
Epoch 45 : Training Loss: 0.81508, acc: 0.24933, kappa: 0.06167, f1: 0.24855, LR: 0.00000, Time elapsed 0.31 mins
[[37 28 21 30 34]
 [35 40 17 24 34]
 [29 23 34 25 39]
 [30 30 23 29 38]
 [34 24 19 26 47]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.55it/s]
Epoch 46 : Training Loss: 0.81463, acc: 0.25067, kappa: 0.06333, f1: 0.25041, LR: 0.00000, Time elapsed 0.35 mins
[[35 31 22 31 31]
 [34 40 19 27 30]
 [26 26 38 26 34]
 [27 31 24 30 38]
 [30 27 21 27 45]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.56it/s]
Epoch 47 : Training Loss: 0.80785, acc: 0.24800, kappa: 0.06000, f1: 0.24750, LR: 0.00000, Time elapsed 0.31 mins
[[36 30 22 30 32]
 [36 40 16 23 35]
 [27 27 37 24 35]
 [29 31 24 28 38]
 [31 28 20 26 45]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.39it/s]
Epoch 48 : Training Loss: 0.81410, acc: 0.24267, kappa: 0.05333, f1: 0.24208, LR: 0.00000, Time elapsed 0.33 mins
[[34 29 22 32 33]
 [36 40 16 25 33]
 [28 26 34 24 38]
 [29 29 24 29 39]
 [31 28 20 26 45]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.23it/s]
Epoch 49 : Training Loss: 0.80941, acc: 0.25067, kappa: 0.06333, f1: 0.25037, LR: 0.00000, Time elapsed 0.34 mins
[[34 29 23 32 32]
 [35 40 19 25 31]
 [25 25 41 24 35]
 [28 28 27 29 38]
 [29 26 24 27 44]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.66it/s]
Epoch 50 : Training Loss: 0.80395, acc: 0.25467, kappa: 0.06833, f1: 0.25425, LR: 0.00000, Time elapsed 0.31 mins
[[35 28 22 31 34]
 [34 39 18 25 34]
 [26 24 40 23 37]
 [28 28 26 30 38]
 [31 24 22 26 47]]
***************************Test************************
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.36it/s]
***************************Test results************************
Test Evaluation: acc: 0.25333, kappa: 0.06667, f1: 0.25110
[[49 20 28 18 35]
 [35 34 23 23 35]
 [29 28 33 29 31]
 [31 26 24 28 41]
 [25 21 26 32 46]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch37_acc_0.25333_kappa_0.06667_f1_0.25110.pth
[32m[I 2025-08-28 23:03:17,005][0m Trial 0 finished with value: 0.06666666666666665 and parameters: {'lr': 1.0253509690168497e-05, 'weight_decay': 0.029334453957883984, '--dropout': 0.146398788362281, '--clip_value': 1.397987726295555}. Best is trial 0 with value: 0.06666666666666665.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=2.636875533972305e-06, weight_decay=5.407712220288122e-06, optimizer='AdamW', clip_value=1.7992642186624028, dropout=0.011616722433639893, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.011616722433639893, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.011616722433639893, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
