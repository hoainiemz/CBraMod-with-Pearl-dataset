100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.19it/s]
Epoch 1 : Training Loss: 1.68352, acc: 0.20400, kappa: 0.00500, f1: 0.09467, LR: 0.00018, Time elapsed 0.21 mins
[[ 10 139   1   0   0]
 [  6 140   4   0   0]
 [  9 138   3   0   0]
 [  4 141   5   0   0]
 [  9 139   2   0   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20400, kappa: 0.00500, f1: 0.09467
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.18it/s]
Epoch 2 : Training Loss: 1.63978, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00018, Time elapsed 0.21 mins
[[150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.09it/s]
Epoch 3 : Training Loss: 1.62361, acc: 0.23200, kappa: 0.04000, f1: 0.18178, LR: 0.00018, Time elapsed 0.21 mins
[[ 3 52  3 62 30]
 [10 60  4 47 29]
 [ 1 43  1 77 28]
 [ 3 38  1 73 35]
 [ 2 32  4 75 37]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23200, kappa: 0.04000, f1: 0.18178
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.03it/s]
Epoch 4 : Training Loss: 1.61349, acc: 0.28000, kappa: 0.10000, f1: 0.26384, LR: 0.00018, Time elapsed 0.21 mins
[[79 26 15 24  6]
 [69 51 11 13  6]
 [60 19 28 27 16]
 [57 28 22 36  7]
 [65 29 16 24 16]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28000, kappa: 0.10000, f1: 0.26384
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.07it/s]
Epoch 5 : Training Loss: 1.56815, acc: 0.28133, kappa: 0.10167, f1: 0.27137, LR: 0.00018, Time elapsed 0.21 mins
[[63 27 25 11 24]
 [52 50 23  4 21]
 [52 17 39  9 33]
 [51 27 28 16 28]
 [47 30 22  8 43]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28133, kappa: 0.10167, f1: 0.27137
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.99it/s]
Epoch 6 : Training Loss: 1.49055, acc: 0.29067, kappa: 0.11333, f1: 0.29043, LR: 0.00018, Time elapsed 0.21 mins
[[31 10 35 61 13]
 [21 37 38 40 14]
 [14 10 46 47 33]
 [30 13 25 62 20]
 [25  9 26 48 42]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.29067, kappa: 0.11333, f1: 0.29043
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.07it/s]
Epoch 7 : Training Loss: 1.34975, acc: 0.35333, kappa: 0.19167, f1: 0.35169, LR: 0.00017, Time elapsed 0.21 mins
[[41 22 28 35 24]
 [30 44 19 36 21]
 [25 12 59 24 30]
 [23 16 21 67 23]
 [30 18 25 23 54]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.35333, kappa: 0.19167, f1: 0.35169
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.99it/s]
Epoch 8 : Training Loss: 1.12144, acc: 0.39333, kappa: 0.24167, f1: 0.39017, LR: 0.00017, Time elapsed 0.21 mins
[[51 20 22 39 18]
 [27 43 19 37 24]
 [20 15 57 23 35]
 [21 11 15 72 31]
 [21 17 13 27 72]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.39333, kappa: 0.24167, f1: 0.39017
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.13it/s]
Epoch 9 : Training Loss: 0.89692, acc: 0.37467, kappa: 0.21833, f1: 0.37578, LR: 0.00017, Time elapsed 0.21 mins
[[56 20 22 35 17]
 [36 49 22 29 14]
 [22 16 63 22 27]
 [32 24 22 54 18]
 [38 18 19 16 59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.12it/s]
Epoch 10 : Training Loss: 0.72977, acc: 0.38400, kappa: 0.23000, f1: 0.38211, LR: 0.00016, Time elapsed 0.21 mins
[[62 28 21 24 15]
 [35 65 23 14 13]
 [19 25 64 17 25]
 [31 33 20 41 25]
 [30 28 23 13 56]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.94it/s]
Epoch 11 : Training Loss: 0.63169, acc: 0.40533, kappa: 0.25667, f1: 0.40211, LR: 0.00016, Time elapsed 0.21 mins
[[41 16 21 46 26]
 [21 50 22 38 19]
 [16 10 71 25 28]
 [15 19 18 73 25]
 [20 14 19 28 69]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.40533, kappa: 0.25667, f1: 0.40211
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.88it/s]
Epoch 12 : Training Loss: 0.56998, acc: 0.38800, kappa: 0.23500, f1: 0.38532, LR: 0.00016, Time elapsed 0.21 mins
[[44 30 34 26 16]
 [30 61 27 19 13]
 [15 25 80 13 17]
 [23 26 31 54 16]
 [26 29 28 15 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.78it/s]
Epoch 13 : Training Loss: 0.53972, acc: 0.40533, kappa: 0.25667, f1: 0.40487, LR: 0.00015, Time elapsed 0.21 mins
[[56 24 22 28 20]
 [29 55 23 26 17]
 [17 20 70 16 27]
 [20 25 18 56 31]
 [22 24 18 19 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.88it/s]
Epoch 14 : Training Loss: 0.50803, acc: 0.39333, kappa: 0.24167, f1: 0.39088, LR: 0.00015, Time elapsed 0.21 mins
[[39 23 26 34 28]
 [26 59 18 27 20]
 [15 20 64 23 28]
 [22 27 16 59 26]
 [21 19 15 21 74]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.01it/s]
Epoch 15 : Training Loss: 0.49267, acc: 0.40533, kappa: 0.25667, f1: 0.40477, LR: 0.00014, Time elapsed 0.21 mins
[[48 23 20 32 27]
 [29 58 17 26 20]
 [16 17 65 17 35]
 [18 21 16 61 34]
 [20 28 12 18 72]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.56it/s]
Epoch 16 : Training Loss: 0.47726, acc: 0.38667, kappa: 0.23333, f1: 0.38636, LR: 0.00014, Time elapsed 0.21 mins
[[48 28 19 34 21]
 [30 62 16 24 18]
 [20 22 52 25 31]
 [21 28 11 64 26]
 [24 23 12 27 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 17 : Training Loss: 0.46748, acc: 0.39867, kappa: 0.24833, f1: 0.39588, LR: 0.00014, Time elapsed 0.21 mins
[[52 19 23 35 21]
 [37 48 19 28 18]
 [13 19 54 28 36]
 [19 19 14 76 22]
 [22 11 16 32 69]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.31it/s]
Epoch 18 : Training Loss: 0.45026, acc: 0.39733, kappa: 0.24667, f1: 0.39635, LR: 0.00013, Time elapsed 0.21 mins
[[44 22 24 36 24]
 [23 59 24 24 20]
 [12 18 65 26 29]
 [23 22 21 62 22]
 [24 16 12 30 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.21it/s]
Epoch 19 : Training Loss: 0.44002, acc: 0.41333, kappa: 0.26667, f1: 0.41391, LR: 0.00012, Time elapsed 0.21 mins
[[52 31 17 31 19]
 [29 66 19 16 20]
 [ 9 26 67 26 22]
 [26 29 14 59 22]
 [20 30 16 18 66]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.41333, kappa: 0.26667, f1: 0.41391
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.72it/s]
Epoch 20 : Training Loss: 0.43139, acc: 0.42000, kappa: 0.27500, f1: 0.41998, LR: 0.00012, Time elapsed 0.21 mins
[[57 22 18 30 23]
 [29 59 20 20 22]
 [15 20 65 22 28]
 [20 20 19 65 26]
 [19 23 13 26 69]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42000, kappa: 0.27500, f1: 0.41998
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.90it/s]
Epoch 21 : Training Loss: 0.42293, acc: 0.42533, kappa: 0.28167, f1: 0.42485, LR: 0.00011, Time elapsed 0.21 mins
[[54 19 21 31 25]
 [29 60 23 18 20]
 [14 19 69 23 25]
 [20 21 18 69 22]
 [25 21 16 21 67]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42533, kappa: 0.28167, f1: 0.42485
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.77it/s]
Epoch 22 : Training Loss: 0.41913, acc: 0.42400, kappa: 0.28000, f1: 0.42382, LR: 0.00011, Time elapsed 0.21 mins
[[55 19 24 31 21]
 [28 61 23 23 15]
 [15 14 72 24 25]
 [25 19 23 64 19]
 [21 20 20 23 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.21it/s]
Epoch 23 : Training Loss: 0.41487, acc: 0.42000, kappa: 0.27500, f1: 0.42048, LR: 0.00010, Time elapsed 0.21 mins
[[61 22 19 31 17]
 [30 62 23 22 13]
 [17 21 62 24 26]
 [29 22 13 66 20]
 [22 22 18 24 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.45it/s]
Epoch 24 : Training Loss: 0.41239, acc: 0.42933, kappa: 0.28667, f1: 0.42831, LR: 0.00010, Time elapsed 0.21 mins
[[56 19 21 33 21]
 [26 58 26 21 19]
 [15 17 71 20 27]
 [20 21 21 64 24]
 [17 19 20 21 73]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42933, kappa: 0.28667, f1: 0.42831
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 25 : Training Loss: 0.41086, acc: 0.41733, kappa: 0.27167, f1: 0.41709, LR: 0.00009, Time elapsed 0.21 mins
[[53 26 16 33 22]
 [27 58 22 24 19]
 [15 19 68 23 25]
 [19 24 16 68 23]
 [16 24 18 26 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.97it/s]
Epoch 26 : Training Loss: 0.40882, acc: 0.41867, kappa: 0.27333, f1: 0.41747, LR: 0.00009, Time elapsed 0.21 mins
[[49 25 21 33 22]
 [23 63 25 18 21]
 [13 18 71 21 27]
 [19 25 16 61 29]
 [16 23 16 25 70]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.14it/s]
Epoch 27 : Training Loss: 0.40745, acc: 0.43200, kappa: 0.29000, f1: 0.43202, LR: 0.00008, Time elapsed 0.21 mins
[[57 22 20 30 21]
 [26 67 18 22 17]
 [17 20 70 17 26]
 [20 23 18 65 24]
 [19 22 17 27 65]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.43200, kappa: 0.29000, f1: 0.43202
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.77it/s]
Epoch 28 : Training Loss: 0.40646, acc: 0.42800, kappa: 0.28500, f1: 0.42779, LR: 0.00007, Time elapsed 0.21 mins
[[55 21 20 35 19]
 [26 61 22 26 15]
 [16 17 70 20 27]
 [22 22 18 70 18]
 [18 26 15 26 65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.03it/s]
Epoch 29 : Training Loss: 0.40557, acc: 0.41600, kappa: 0.27000, f1: 0.41572, LR: 0.00007, Time elapsed 0.21 mins
[[52 23 20 32 23]
 [28 61 23 23 15]
 [14 16 69 23 28]
 [20 25 15 66 24]
 [17 27 16 26 64]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.14it/s]
Epoch 30 : Training Loss: 0.40460, acc: 0.42400, kappa: 0.28000, f1: 0.42323, LR: 0.00006, Time elapsed 0.21 mins
[[52 24 19 36 19]
 [27 61 21 25 16]
 [18 19 64 23 26]
 [18 22 13 75 22]
 [16 27 14 27 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.52it/s]
Epoch 31 : Training Loss: 0.40423, acc: 0.42133, kappa: 0.27667, f1: 0.42087, LR: 0.00006, Time elapsed 0.21 mins
[[54 22 20 31 23]
 [30 59 20 20 21]
 [19 18 63 21 29]
 [23 20 14 69 24]
 [17 24 14 24 71]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.42it/s]
Epoch 32 : Training Loss: 0.40297, acc: 0.42933, kappa: 0.28667, f1: 0.42900, LR: 0.00005, Time elapsed 0.21 mins
[[57 20 20 28 25]
 [29 60 22 21 18]
 [15 18 72 19 26]
 [25 20 17 64 24]
 [16 23 18 24 69]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.11it/s]
Epoch 33 : Training Loss: 0.40292, acc: 0.42000, kappa: 0.27500, f1: 0.42038, LR: 0.00005, Time elapsed 0.21 mins
[[59 19 20 31 21]
 [31 59 17 23 20]
 [19 17 64 21 29]
 [25 21 15 65 24]
 [19 20 16 27 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.56it/s]
Epoch 34 : Training Loss: 0.40262, acc: 0.42267, kappa: 0.27833, f1: 0.42287, LR: 0.00004, Time elapsed 0.21 mins
[[56 22 20 30 22]
 [30 59 16 23 22]
 [18 18 67 20 27]
 [24 23 15 66 22]
 [19 22 16 24 69]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.97it/s]
Epoch 35 : Training Loss: 0.40208, acc: 0.42267, kappa: 0.27833, f1: 0.42282, LR: 0.00004, Time elapsed 0.21 mins
[[55 22 20 34 19]
 [30 62 17 23 18]
 [19 19 67 19 26]
 [23 24 14 67 22]
 [18 23 20 23 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.41it/s]
Epoch 36 : Training Loss: 0.40187, acc: 0.41867, kappa: 0.27333, f1: 0.41848, LR: 0.00003, Time elapsed 0.21 mins
[[53 23 21 33 20]
 [30 61 19 21 19]
 [18 20 68 17 27]
 [22 24 16 65 23]
 [15 26 18 24 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.77it/s]
Epoch 37 : Training Loss: 0.40144, acc: 0.41600, kappa: 0.27000, f1: 0.41596, LR: 0.00003, Time elapsed 0.21 mins
[[54 23 20 32 21]
 [29 61 18 22 20]
 [18 19 66 20 27]
 [24 23 16 64 23]
 [18 22 20 23 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.91it/s]
Epoch 38 : Training Loss: 0.40102, acc: 0.42000, kappa: 0.27500, f1: 0.41966, LR: 0.00003, Time elapsed 0.21 mins
[[53 24 21 31 21]
 [26 64 19 21 20]
 [18 17 67 20 28]
 [24 22 17 63 24]
 [15 24 19 24 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 39 : Training Loss: 0.40088, acc: 0.42133, kappa: 0.27667, f1: 0.42105, LR: 0.00002, Time elapsed 0.21 mins
[[55 23 21 29 22]
 [27 63 20 22 18]
 [19 17 70 15 29]
 [23 24 17 62 24]
 [15 24 21 24 66]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.24it/s]
Epoch 40 : Training Loss: 0.40039, acc: 0.41467, kappa: 0.26833, f1: 0.41410, LR: 0.00002, Time elapsed 0.21 mins
[[50 24 21 34 21]
 [29 62 20 21 18]
 [17 16 70 19 28]
 [22 23 17 64 24]
 [16 23 20 26 65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.25it/s]
Epoch 41 : Training Loss: 0.40065, acc: 0.42000, kappa: 0.27500, f1: 0.41972, LR: 0.00002, Time elapsed 0.21 mins
[[52 24 20 34 20]
 [28 63 22 22 15]
 [17 22 68 18 25]
 [23 25 16 67 19]
 [15 26 19 25 65]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.18it/s]
Epoch 42 : Training Loss: 0.40030, acc: 0.41067, kappa: 0.26333, f1: 0.41057, LR: 0.00001, Time elapsed 0.21 mins
[[54 25 19 31 21]
 [29 61 21 21 18]
 [20 22 61 18 29]
 [23 24 15 64 24]
 [15 27 16 24 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.35it/s]
Epoch 43 : Training Loss: 0.40018, acc: 0.41733, kappa: 0.27167, f1: 0.41702, LR: 0.00001, Time elapsed 0.21 mins
[[52 23 20 33 22]
 [29 61 21 22 17]
 [19 18 68 18 27]
 [23 23 16 65 23]
 [14 26 18 25 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.23it/s]
Epoch 44 : Training Loss: 0.39967, acc: 0.42267, kappa: 0.27833, f1: 0.42233, LR: 0.00001, Time elapsed 0.21 mins
[[53 23 20 33 21]
 [29 61 22 22 16]
 [19 16 69 19 27]
 [23 21 16 67 23]
 [15 24 18 26 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.97it/s]
Epoch 45 : Training Loss: 0.40000, acc: 0.42133, kappa: 0.27667, f1: 0.42106, LR: 0.00001, Time elapsed 0.21 mins
[[52 24 20 33 21]
 [29 62 20 22 17]
 [19 17 68 19 27]
 [23 23 16 67 21]
 [14 26 17 26 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.13it/s]
Epoch 46 : Training Loss: 0.40002, acc: 0.42267, kappa: 0.27833, f1: 0.42259, LR: 0.00000, Time elapsed 0.21 mins
[[54 24 20 31 21]
 [29 62 20 22 17]
 [19 18 69 17 27]
 [23 23 16 65 23]
 [15 26 17 25 67]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.25it/s]
Epoch 47 : Training Loss: 0.40005, acc: 0.42533, kappa: 0.28167, f1: 0.42538, LR: 0.00000, Time elapsed 0.21 mins
[[56 24 20 29 21]
 [29 62 20 22 17]
 [19 17 68 17 29]
 [23 23 15 65 24]
 [14 26 16 26 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
Epoch 48 : Training Loss: 0.39955, acc: 0.42267, kappa: 0.27833, f1: 0.42281, LR: 0.00000, Time elapsed 0.21 mins
[[57 24 19 29 21]
 [29 62 20 22 17]
 [19 17 66 19 29]
 [23 24 16 64 23]
 [14 26 16 26 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.11it/s]
Epoch 49 : Training Loss: 0.39963, acc: 0.42400, kappa: 0.28000, f1: 0.42399, LR: 0.00000, Time elapsed 0.21 mins
[[56 24 20 29 21]
 [28 63 20 22 17]
 [19 17 66 19 29]
 [23 23 16 65 23]
 [14 26 16 26 68]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.99it/s]
Epoch 50 : Training Loss: 0.39952, acc: 0.42267, kappa: 0.27833, f1: 0.42261, LR: 0.00000, Time elapsed 0.21 mins
[[56 24 20 29 21]
 [28 62 21 22 17]
 [19 17 66 19 29]
 [23 23 15 65 24]
 [14 25 17 26 68]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.79it/s]
***************************Test results************************
Test Evaluation: acc: 0.46667, kappa: 0.33333, f1: 0.46732
[[66 23 16 23 22]
 [26 71 17 16 20]
 [24 21 69 10 26]
 [27 20 19 69 15]
 [22 19 13 21 75]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch27_acc_0.46667_kappa_0.33333_f1_0.46732.pth
[32m[I 2025-08-29 21:40:27,770][0m Trial 67 finished with value: 0.33333333333333337 and parameters: {'lr': 0.0001819590660524952, 'weight_decay': 0.02510630031360039, '--dropout': 0.1905095058229324, '--clip_value': 1.4430535783038612}. Best is trial 35 with value: 0.36.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.00032239754051976153, weight_decay=0.027049194542049806, optimizer='AdamW', clip_value=1.4213075873001517, dropout=0.1919353851493973, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1919353851493973, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1919353851493973, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
