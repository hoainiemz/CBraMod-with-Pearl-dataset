100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.33it/s]
Epoch 1 : Training Loss: 1.64960, acc: 0.20133, kappa: 0.00167, f1: 0.11822, LR: 0.00011, Time elapsed 0.21 mins
[[  3   0  40 107   0]
 [  8   0  43  99   0]
 [  1   0  44 105   0]
 [  3   0  43 104   0]
 [  2   0  33 115   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20133, kappa: 0.00167, f1: 0.11822
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.48it/s]
Epoch 2 : Training Loss: 1.63178, acc: 0.20000, kappa: 0.00000, f1: 0.06674, LR: 0.00011, Time elapsed 0.21 mins
[[  0   0   0 150   0]
 [  0   0   0 149   1]
 [  0   0   0 150   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.54it/s]
Epoch 3 : Training Loss: 1.60793, acc: 0.22533, kappa: 0.03167, f1: 0.18326, LR: 0.00011, Time elapsed 0.22 mins
[[89 27 26  4  4]
 [80 29 32  3  6]
 [78 28 38  4  2]
 [83 26 33  5  3]
 [81 28 30  3  8]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22533, kappa: 0.03167, f1: 0.18326
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.44it/s]
Epoch 4 : Training Loss: 1.54023, acc: 0.23467, kappa: 0.04333, f1: 0.22253, LR: 0.00011, Time elapsed 0.22 mins
[[65 11 30 23 21]
 [67 15 28 15 25]
 [50  8 36 31 25]
 [62  6 31 24 27]
 [53 10 26 25 36]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23467, kappa: 0.04333, f1: 0.22253
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.63it/s]
Epoch 5 : Training Loss: 1.43507, acc: 0.26667, kappa: 0.08333, f1: 0.26182, LR: 0.00011, Time elapsed 0.21 mins
[[26 30  7 48 39]
 [23 42  7 48 30]
 [23 24 25 44 34]
 [24 23 10 58 35]
 [28 19  6 48 49]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26667, kappa: 0.08333, f1: 0.26182
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.68it/s]
Epoch 6 : Training Loss: 1.28267, acc: 0.25200, kappa: 0.06500, f1: 0.25009, LR: 0.00011, Time elapsed 0.21 mins
[[37 25 28 42 18]
 [41 43 22 29 15]
 [32 27 40 32 19]
 [33 29 23 45 20]
 [33 27 29 37 24]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.78it/s]
Epoch 7 : Training Loss: 1.09525, acc: 0.28667, kappa: 0.10833, f1: 0.28072, LR: 0.00011, Time elapsed 0.21 mins
[[59 15 28 34 14]
 [43 30 24 35 18]
 [34 17 51 29 19]
 [42 20 26 48 14]
 [37 20 31 35 27]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28667, kappa: 0.10833, f1: 0.28072
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
Epoch 8 : Training Loss: 0.92277, acc: 0.25333, kappa: 0.06667, f1: 0.25337, LR: 0.00010, Time elapsed 0.22 mins
[[31 25 27 35 32]
 [33 36 21 39 21]
 [33 17 43 26 31]
 [27 25 26 36 36]
 [28 24 32 22 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.70it/s]
Epoch 9 : Training Loss: 0.76770, acc: 0.25333, kappa: 0.06667, f1: 0.25140, LR: 0.00010, Time elapsed 0.21 mins
[[32 32 29 34 23]
 [29 47 29 30 15]
 [27 30 48 23 22]
 [24 27 44 32 23]
 [31 28 34 26 31]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.25it/s]
Epoch 10 : Training Loss: 0.64041, acc: 0.28133, kappa: 0.10167, f1: 0.28016, LR: 0.00010, Time elapsed 0.21 mins
[[35 30 23 37 25]
 [32 46 27 27 18]
 [26 28 51 21 24]
 [23 26 32 44 25]
 [29 24 42 20 35]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.52it/s]
Epoch 11 : Training Loss: 0.58708, acc: 0.27867, kappa: 0.09833, f1: 0.27739, LR: 0.00010, Time elapsed 0.22 mins
[[41 30 19 33 27]
 [29 47 19 39 16]
 [28 29 40 31 22]
 [27 29 22 50 22]
 [41 19 30 29 31]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.01it/s]
Epoch 12 : Training Loss: 0.55615, acc: 0.26667, kappa: 0.08333, f1: 0.26640, LR: 0.00010, Time elapsed 0.22 mins
[[47 20 28 27 28]
 [42 32 24 34 18]
 [34 12 46 29 29]
 [43 14 29 40 24]
 [41 14 30 30 35]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.38it/s]
Epoch 13 : Training Loss: 0.53471, acc: 0.28267, kappa: 0.10333, f1: 0.28051, LR: 0.00009, Time elapsed 0.22 mins
[[35 43 17 27 28]
 [26 57 16 36 15]
 [25 37 38 25 25]
 [22 35 22 45 26]
 [26 33 29 25 37]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.63it/s]
Epoch 14 : Training Loss: 0.50731, acc: 0.27733, kappa: 0.09667, f1: 0.27594, LR: 0.00009, Time elapsed 0.22 mins
[[48 36 17 22 27]
 [41 50 17 21 21]
 [34 28 37 23 28]
 [34 33 21 32 30]
 [38 25 27 19 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.64it/s]
Epoch 15 : Training Loss: 0.48654, acc: 0.27067, kappa: 0.08833, f1: 0.26819, LR: 0.00009, Time elapsed 0.22 mins
[[52 26 27 21 24]
 [39 50 18 28 15]
 [35 23 39 28 25]
 [38 33 26 30 23]
 [39 29 23 27 32]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.36it/s]
Epoch 16 : Training Loss: 0.47307, acc: 0.27600, kappa: 0.09500, f1: 0.27607, LR: 0.00009, Time elapsed 0.22 mins
[[41 25 32 20 32]
 [36 51 20 20 23]
 [33 24 41 18 34]
 [34 28 22 33 33]
 [37 23 27 22 41]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.07it/s]
Epoch 17 : Training Loss: 0.46894, acc: 0.28000, kappa: 0.10000, f1: 0.28003, LR: 0.00008, Time elapsed 0.22 mins
[[37 24 22 34 33]
 [35 38 20 42 15]
 [30 14 46 37 23]
 [28 24 21 53 24]
 [34 24 20 36 36]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.98it/s]
Epoch 18 : Training Loss: 0.45822, acc: 0.29600, kappa: 0.12000, f1: 0.29641, LR: 0.00008, Time elapsed 0.22 mins
[[46 23 24 27 30]
 [46 47 21 25 11]
 [31 18 55 22 24]
 [39 22 27 37 25]
 [37 24 28 24 37]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.29600, kappa: 0.12000, f1: 0.29641
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.33it/s]
Epoch 19 : Training Loss: 0.45608, acc: 0.28800, kappa: 0.11000, f1: 0.28730, LR: 0.00008, Time elapsed 0.22 mins
[[44 27 22 27 30]
 [33 54 17 24 22]
 [24 30 46 28 22]
 [31 36 24 33 26]
 [36 18 29 28 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.35it/s]
Epoch 20 : Training Loss: 0.44436, acc: 0.28267, kappa: 0.10333, f1: 0.28353, LR: 0.00007, Time elapsed 0.22 mins
[[40 25 24 28 33]
 [41 44 19 26 20]
 [28 29 47 21 25]
 [33 34 19 42 22]
 [33 22 29 27 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.15it/s]
Epoch 21 : Training Loss: 0.43788, acc: 0.25600, kappa: 0.07000, f1: 0.25715, LR: 0.00007, Time elapsed 0.21 mins
[[27 23 31 41 28]
 [35 42 17 35 21]
 [25 21 44 36 24]
 [33 29 24 41 23]
 [31 18 28 35 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.62it/s]
Epoch 22 : Training Loss: 0.43075, acc: 0.27867, kappa: 0.09833, f1: 0.27889, LR: 0.00007, Time elapsed 0.22 mins
[[43 28 21 26 32]
 [39 45 18 24 24]
 [29 27 42 26 26]
 [30 30 20 44 26]
 [32 24 30 29 35]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.80it/s]
Epoch 23 : Training Loss: 0.42821, acc: 0.27867, kappa: 0.09833, f1: 0.27949, LR: 0.00006, Time elapsed 0.21 mins
[[43 24 23 25 35]
 [42 41 19 33 15]
 [29 21 46 25 29]
 [33 24 22 41 30]
 [35 20 30 27 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.78it/s]
Epoch 24 : Training Loss: 0.42379, acc: 0.26667, kappa: 0.08333, f1: 0.26543, LR: 0.00006, Time elapsed 0.21 mins
[[40 25 28 22 35]
 [36 45 23 25 21]
 [24 24 51 25 26]
 [27 28 35 33 27]
 [38 23 34 24 31]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.20it/s]
Epoch 25 : Training Loss: 0.41904, acc: 0.26800, kappa: 0.08500, f1: 0.26736, LR: 0.00006, Time elapsed 0.21 mins
[[47 24 27 25 27]
 [41 43 16 32 18]
 [33 25 44 23 25]
 [32 33 23 36 26]
 [39 28 26 26 31]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.63it/s]
Epoch 26 : Training Loss: 0.41641, acc: 0.28400, kappa: 0.10500, f1: 0.28468, LR: 0.00005, Time elapsed 0.22 mins
[[49 24 22 27 28]
 [48 42 12 30 18]
 [31 22 46 26 25]
 [35 31 22 41 21]
 [43 21 24 27 35]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.38it/s]
Epoch 27 : Training Loss: 0.41307, acc: 0.27600, kappa: 0.09500, f1: 0.27436, LR: 0.00005, Time elapsed 0.22 mins
[[34 33 25 25 33]
 [31 57 16 23 23]
 [24 29 42 24 31]
 [28 33 27 36 26]
 [30 31 27 24 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.47it/s]
Epoch 28 : Training Loss: 0.41053, acc: 0.27733, kappa: 0.09667, f1: 0.27755, LR: 0.00005, Time elapsed 0.21 mins
[[47 29 20 20 34]
 [44 48 11 24 23]
 [31 33 40 22 24]
 [39 30 18 33 30]
 [42 26 22 20 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 29 : Training Loss: 0.40793, acc: 0.28267, kappa: 0.10333, f1: 0.28167, LR: 0.00004, Time elapsed 0.22 mins
[[47 24 23 27 29]
 [36 46 20 28 20]
 [27 27 49 25 22]
 [34 32 28 33 23]
 [32 29 31 21 37]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.33it/s]
Epoch 30 : Training Loss: 0.40618, acc: 0.27067, kappa: 0.08833, f1: 0.27145, LR: 0.00004, Time elapsed 0.21 mins
[[39 29 22 25 35]
 [36 48 12 30 24]
 [26 26 45 24 29]
 [34 31 22 34 29]
 [36 32 23 22 37]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.80it/s]
Epoch 31 : Training Loss: 0.40578, acc: 0.28933, kappa: 0.11167, f1: 0.29009, LR: 0.00004, Time elapsed 0.21 mins
[[45 21 24 25 35]
 [35 50 13 27 25]
 [32 24 44 26 24]
 [33 30 21 36 30]
 [38 25 21 24 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.64it/s]
Epoch 32 : Training Loss: 0.40454, acc: 0.27333, kappa: 0.09167, f1: 0.27395, LR: 0.00003, Time elapsed 0.22 mins
[[43 24 25 23 35]
 [38 43 16 33 20]
 [32 23 45 25 25]
 [34 30 27 34 25]
 [39 22 24 25 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
Epoch 33 : Training Loss: 0.40391, acc: 0.28267, kappa: 0.10333, f1: 0.28353, LR: 0.00003, Time elapsed 0.21 mins
[[43 23 24 23 37]
 [39 47 16 27 21]
 [31 26 45 24 24]
 [35 27 26 38 24]
 [39 25 23 24 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.74it/s]
Epoch 34 : Training Loss: 0.40343, acc: 0.28133, kappa: 0.10167, f1: 0.28186, LR: 0.00003, Time elapsed 0.22 mins
[[41 21 28 25 35]
 [34 46 19 30 21]
 [28 26 45 26 25]
 [30 25 28 41 26]
 [37 25 23 27 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 35 : Training Loss: 0.40230, acc: 0.27333, kappa: 0.09167, f1: 0.27404, LR: 0.00002, Time elapsed 0.22 mins
[[41 22 29 22 36]
 [40 42 20 28 20]
 [30 25 45 25 25]
 [33 27 26 39 25]
 [37 21 25 29 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.60it/s]
Epoch 36 : Training Loss: 0.40203, acc: 0.28267, kappa: 0.10333, f1: 0.28321, LR: 0.00002, Time elapsed 0.21 mins
[[44 24 26 23 33]
 [38 45 19 27 21]
 [31 24 45 29 21]
 [33 28 27 39 23]
 [39 22 25 25 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.69it/s]
Epoch 37 : Training Loss: 0.40115, acc: 0.27600, kappa: 0.09500, f1: 0.27682, LR: 0.00002, Time elapsed 0.22 mins
[[43 25 24 24 34]
 [39 42 16 32 21]
 [29 26 42 27 26]
 [35 29 21 42 23]
 [38 23 23 28 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.56it/s]
Epoch 38 : Training Loss: 0.40128, acc: 0.27867, kappa: 0.09833, f1: 0.27907, LR: 0.00002, Time elapsed 0.21 mins
[[44 28 20 24 34]
 [36 46 16 32 20]
 [29 26 40 28 27]
 [33 28 23 41 25]
 [38 25 23 26 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.67it/s]
Epoch 39 : Training Loss: 0.40054, acc: 0.28133, kappa: 0.10167, f1: 0.28193, LR: 0.00001, Time elapsed 0.21 mins
[[40 24 24 26 36]
 [34 48 18 30 20]
 [29 25 46 26 24]
 [33 28 26 39 24]
 [36 24 26 26 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.51it/s]
Epoch 40 : Training Loss: 0.40060, acc: 0.27733, kappa: 0.09667, f1: 0.27770, LR: 0.00001, Time elapsed 0.22 mins
[[41 25 24 27 33]
 [36 48 17 29 20]
 [29 26 44 27 24]
 [33 27 28 38 24]
 [37 25 27 24 37]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.84it/s]
Epoch 41 : Training Loss: 0.40042, acc: 0.27867, kappa: 0.09833, f1: 0.27931, LR: 0.00001, Time elapsed 0.21 mins
[[40 26 25 24 35]
 [37 47 18 27 21]
 [29 24 47 26 24]
 [34 28 26 37 25]
 [38 24 26 24 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.88it/s]
Epoch 42 : Training Loss: 0.39996, acc: 0.28000, kappa: 0.10000, f1: 0.28083, LR: 0.00001, Time elapsed 0.21 mins
[[41 23 26 24 36]
 [34 49 16 31 20]
 [30 23 42 27 28]
 [33 26 26 39 26]
 [38 23 24 26 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.98it/s]
Epoch 43 : Training Loss: 0.39988, acc: 0.28133, kappa: 0.10167, f1: 0.28189, LR: 0.00001, Time elapsed 0.21 mins
[[41 27 25 24 33]
 [35 49 16 30 20]
 [30 25 44 26 25]
 [33 27 26 39 25]
 [38 25 24 25 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.85it/s]
Epoch 44 : Training Loss: 0.39993, acc: 0.28267, kappa: 0.10333, f1: 0.28310, LR: 0.00000, Time elapsed 0.21 mins
[[41 25 25 25 34]
 [35 49 17 27 22]
 [28 24 46 26 26]
 [33 27 26 38 26]
 [36 25 27 24 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 45 : Training Loss: 0.40014, acc: 0.28000, kappa: 0.10000, f1: 0.28081, LR: 0.00000, Time elapsed 0.22 mins
[[41 23 24 25 37]
 [36 49 17 27 21]
 [29 24 43 26 28]
 [33 26 26 39 26]
 [37 22 27 26 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.69it/s]
Epoch 46 : Training Loss: 0.39987, acc: 0.27867, kappa: 0.09833, f1: 0.27942, LR: 0.00000, Time elapsed 0.21 mins
[[41 26 22 26 35]
 [36 49 15 29 21]
 [29 24 44 26 27]
 [34 26 26 39 25]
 [38 24 26 26 36]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.62it/s]
Epoch 47 : Training Loss: 0.39967, acc: 0.28133, kappa: 0.10167, f1: 0.28195, LR: 0.00000, Time elapsed 0.22 mins
[[41 24 25 26 34]
 [35 49 17 28 21]
 [29 24 44 26 27]
 [33 26 26 39 26]
 [37 24 27 24 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.67it/s]
Epoch 48 : Training Loss: 0.39975, acc: 0.28133, kappa: 0.10167, f1: 0.28209, LR: 0.00000, Time elapsed 0.21 mins
[[41 24 24 25 36]
 [36 49 17 27 21]
 [29 24 44 26 27]
 [33 26 26 39 26]
 [38 24 26 24 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 49 : Training Loss: 0.39973, acc: 0.27867, kappa: 0.09833, f1: 0.27941, LR: 0.00000, Time elapsed 0.21 mins
[[41 24 24 25 36]
 [36 49 17 27 21]
 [29 24 43 26 28]
 [33 26 26 39 26]
 [39 24 26 24 37]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.88it/s]
Epoch 50 : Training Loss: 0.39942, acc: 0.27867, kappa: 0.09833, f1: 0.27944, LR: 0.00000, Time elapsed 0.21 mins
[[41 24 25 25 35]
 [37 48 16 28 21]
 [29 24 43 26 28]
 [33 26 26 39 26]
 [38 24 26 24 38]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.79it/s]
***************************Test results************************
Test Evaluation: acc: 0.30000, kappa: 0.12500, f1: 0.29620
[[61 21 27 15 26]
 [37 34 22 27 30]
 [30 16 56 23 25]
 [42 21 25 34 28]
 [36 20 27 27 40]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch18_acc_0.30000_kappa_0.12500_f1_0.29620.pth
[32m[I 2025-08-29 19:18:51,121][0m Trial 54 finished with value: 0.125 and parameters: {'lr': 0.00011107476461370312, 'weight_decay': 0.0015990229714304722, '--dropout': 0.19570805737104946, '--clip_value': 1.7384987891949795}. Best is trial 35 with value: 0.36.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=7.952229305204238e-05, weight_decay=0.0037039648613441238, optimizer='AdamW', clip_value=1.937623862422311, dropout=0.1657190992062446, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1657190992062446, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1657190992062446, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
