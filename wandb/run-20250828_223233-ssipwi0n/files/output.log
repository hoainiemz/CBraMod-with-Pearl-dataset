100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.97it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.03it/s]
Epoch 1 : Training Loss: 1.61090, acc: 0.21333, kappa: 0.01667, f1: 0.13977, LR: 0.00001, Time elapsed 0.31 mins
[[ 1  8 54 87  0]
 [ 9  7 62 72  0]
 [ 1  6 73 70  0]
 [ 4  9 58 79  0]
 [ 2  7 64 77  0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21333, kappa: 0.01667, f1: 0.13977
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.03it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.53it/s]
Epoch 2 : Training Loss: 1.59969, acc: 0.25467, kappa: 0.06833, f1: 0.23547, LR: 0.00001, Time elapsed 0.31 mins
[[ 9 35 22 52 32]
 [ 5 48 24 41 32]
 [ 1 32 26 51 40]
 [ 5 30 21 63 31]
 [ 1 32 21 51 45]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25467, kappa: 0.06833, f1: 0.23547
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.56it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.61it/s]
Epoch 3 : Training Loss: 1.58636, acc: 0.24933, kappa: 0.06167, f1: 0.24543, LR: 0.00001, Time elapsed 0.35 mins
[[40 24 32 36 18]
 [42 28 32 33 15]
 [33 19 45 35 18]
 [34 19 38 49 10]
 [27 17 32 49 25]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.08it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.40it/s]
Epoch 4 : Training Loss: 1.57702, acc: 0.24267, kappa: 0.05333, f1: 0.23778, LR: 0.00001, Time elapsed 0.31 mins
[[38 28 21 37 26]
 [41 30 24 20 35]
 [24 22 22 30 52]
 [29 27 19 38 37]
 [27 18 15 36 54]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.02it/s]
Epoch 5 : Training Loss: 1.56358, acc: 0.24800, kappa: 0.06000, f1: 0.24751, LR: 0.00001, Time elapsed 0.33 mins
[[34 27 35 40 14]
 [39 30 35 25 21]
 [24 20 41 37 28]
 [21 23 40 44 22]
 [22 21 28 42 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.96it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.77it/s]
Epoch 6 : Training Loss: 1.54957, acc: 0.25733, kappa: 0.07167, f1: 0.24432, LR: 0.00001, Time elapsed 0.31 mins
[[58 25  8 33 26]
 [51 32  5 25 37]
 [37 17 13 26 57]
 [40 26 11 38 35]
 [40 20  6 32 52]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25733, kappa: 0.07167, f1: 0.24432
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.58it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.47it/s]
Epoch 7 : Training Loss: 1.53541, acc: 0.25067, kappa: 0.06333, f1: 0.24322, LR: 0.00001, Time elapsed 0.35 mins
[[57 25 21 22 25]
 [50 31 22 16 31]
 [35 21 27 20 47]
 [36 24 28 23 39]
 [34 23 24 19 50]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.02it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.47it/s]
Epoch 8 : Training Loss: 1.51960, acc: 0.25600, kappa: 0.07000, f1: 0.25086, LR: 0.00001, Time elapsed 0.31 mins
[[56 19 22 37 16]
 [48 30 18 26 28]
 [36 21 25 25 43]
 [33 28 24 33 32]
 [32 23 17 30 48]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.61it/s]
Epoch 9 : Training Loss: 1.50369, acc: 0.26267, kappa: 0.07833, f1: 0.24861, LR: 0.00001, Time elapsed 0.32 mins
[[52 14 11 32 41]
 [50 25  9 23 43]
 [34 17 18 19 62]
 [34 19 14 34 49]
 [30 18  8 26 68]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26267, kappa: 0.07833, f1: 0.24861
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.72it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.67it/s]
Epoch 10 : Training Loss: 1.48165, acc: 0.26400, kappa: 0.08000, f1: 0.25319, LR: 0.00001, Time elapsed 0.33 mins
[[47 18 16 27 42]
 [47 31  8 19 45]
 [36 20 22 17 55]
 [28 24 17 29 52]
 [31 21  7 22 69]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26400, kappa: 0.08000, f1: 0.25319
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.10it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.17it/s]
Epoch 11 : Training Loss: 1.46519, acc: 0.25733, kappa: 0.07167, f1: 0.24771, LR: 0.00001, Time elapsed 0.30 mins
[[57 13 18 29 33]
 [58 22 14 20 36]
 [39 15 29 19 48]
 [41 11 28 28 42]
 [38 14 18 23 57]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.55it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.44it/s]
Epoch 12 : Training Loss: 1.44179, acc: 0.25600, kappa: 0.07000, f1: 0.24973, LR: 0.00001, Time elapsed 0.35 mins
[[43 19 17 33 38]
 [41 26 12 26 45]
 [36 17 28 24 45]
 [29 19 22 34 46]
 [27 17 16 29 61]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.07it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.64it/s]
Epoch 13 : Training Loss: 1.42580, acc: 0.24800, kappa: 0.06000, f1: 0.23854, LR: 0.00001, Time elapsed 0.31 mins
[[39 17 31 20 43]
 [42 21 29 18 40]
 [29 12 41 19 49]
 [26 21 37 23 43]
 [25 15 28 20 62]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.58it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.15it/s]
Epoch 14 : Training Loss: 1.39916, acc: 0.25600, kappa: 0.07000, f1: 0.24943, LR: 0.00001, Time elapsed 0.35 mins
[[32 17 20 28 53]
 [36 26 17 27 44]
 [24 14 32 25 55]
 [23 17 23 37 50]
 [19 14 22 30 65]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.12it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.47it/s]
Epoch 15 : Training Loss: 1.38522, acc: 0.24667, kappa: 0.05833, f1: 0.23258, LR: 0.00001, Time elapsed 0.30 mins
[[32 14 18 19 67]
 [39 19 15 20 57]
 [27 11 29 17 66]
 [22 18 19 28 63]
 [22 14 13 24 77]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.72it/s]
Epoch 16 : Training Loss: 1.35265, acc: 0.24800, kappa: 0.06000, f1: 0.24146, LR: 0.00001, Time elapsed 0.33 mins
[[32 19 25 19 55]
 [38 32 21 16 43]
 [28 17 36 20 49]
 [23 26 26 23 52]
 [20 15 27 25 63]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.77it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.72it/s]
Epoch 17 : Training Loss: 1.33057, acc: 0.25467, kappa: 0.06833, f1: 0.23949, LR: 0.00001, Time elapsed 0.33 mins
[[36 13 12 25 64]
 [44 22  9 23 52]
 [28 14 22 19 67]
 [26 16 14 32 62]
 [25 11  9 26 79]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.03it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.30it/s]
Epoch 18 : Training Loss: 1.30937, acc: 0.25333, kappa: 0.06667, f1: 0.25001, LR: 0.00001, Time elapsed 0.31 mins
[[43 18 21 29 39]
 [48 27 21 16 38]
 [35 15 38 20 42]
 [28 22 26 29 45]
 [33 13 23 28 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.04it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.55it/s]
Epoch 19 : Training Loss: 1.29698, acc: 0.24133, kappa: 0.05167, f1: 0.23400, LR: 0.00000, Time elapsed 0.31 mins
[[25 13 19 42 51]
 [39 22 17 31 41]
 [27 13 29 33 48]
 [22 15 18 48 47]
 [23 10 18 42 57]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.72it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.03it/s]
Epoch 20 : Training Loss: 1.28003, acc: 0.24667, kappa: 0.05833, f1: 0.24464, LR: 0.00000, Time elapsed 0.33 mins
[[33 18 27 25 47]
 [47 28 23 14 38]
 [28 14 42 19 47]
 [32 17 26 29 46]
 [32 13 23 29 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.55it/s]
Epoch 21 : Training Loss: 1.25790, acc: 0.24667, kappa: 0.05833, f1: 0.24113, LR: 0.00000, Time elapsed 0.32 mins
[[41 14 12 31 52]
 [47 24 11 19 49]
 [30 15 27 21 57]
 [32 17 14 33 54]
 [30 13 14 33 60]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.59it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.66it/s]
Epoch 22 : Training Loss: 1.24213, acc: 0.24400, kappa: 0.05500, f1: 0.24232, LR: 0.00000, Time elapsed 0.34 mins
[[35 21 18 28 48]
 [46 31 15 18 40]
 [27 16 34 19 54]
 [28 28 18 29 47]
 [33 18 19 26 54]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.06it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.32it/s]
Epoch 23 : Training Loss: 1.22712, acc: 0.25867, kappa: 0.07333, f1: 0.25584, LR: 0.00000, Time elapsed 0.31 mins
[[38 14 19 41 38]
 [43 26 12 31 38]
 [28 15 32 30 45]
 [26 18 18 49 39]
 [31 14 17 39 49]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.57it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.30it/s]
Epoch 24 : Training Loss: 1.19753, acc: 0.24800, kappa: 0.06000, f1: 0.24455, LR: 0.00000, Time elapsed 0.35 mins
[[28 17 20 34 51]
 [39 26 13 28 44]
 [25 14 33 27 51]
 [24 20 17 43 46]
 [26 14 16 38 56]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.61it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.14it/s]
Epoch 25 : Training Loss: 1.18832, acc: 0.23733, kappa: 0.04667, f1: 0.23336, LR: 0.00000, Time elapsed 0.34 mins
[[28 22 22 27 51]
 [40 26 14 22 48]
 [26 15 33 21 55]
 [26 23 16 32 53]
 [28 16 17 30 59]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.02it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.36it/s]
Epoch 26 : Training Loss: 1.17606, acc: 0.25067, kappa: 0.06333, f1: 0.24931, LR: 0.00000, Time elapsed 0.31 mins
[[38 21 20 28 43]
 [46 32 13 17 42]
 [29 17 32 22 50]
 [31 27 17 33 42]
 [33 20 16 28 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.28it/s]
Epoch 27 : Training Loss: 1.16096, acc: 0.25600, kappa: 0.07000, f1: 0.24980, LR: 0.00000, Time elapsed 0.33 mins
[[43 14 19 29 45]
 [55 23 12 17 43]
 [33 12 32 19 54]
 [39 16 15 31 49]
 [34 13 14 26 63]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.66it/s]
Epoch 28 : Training Loss: 1.14458, acc: 0.25733, kappa: 0.07167, f1: 0.25204, LR: 0.00000, Time elapsed 0.32 mins
[[31 24 16 33 46]
 [44 32  7 24 43]
 [25 17 26 28 54]
 [22 29 13 42 44]
 [26 21 10 31 62]]
 82%|████████████████████████████████████████████████████████████████████████████████████████████████████▍                      | 58/71 [00:14<00:03,  3.91it/s]
[33m[W 2025-08-28 22:42:00,003][0m Trial 4 failed with parameters: {'lr': 6.624310605949985e-06, 'weight_decay': 0.00029229052129200957, '--dropout': 0.08638900372842316, '--clip_value': 0.9368437102970628} because of the following error: KeyboardInterrupt().[0m
Traceback (most recent call last):
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/hyper_optuna.py", line 23, in objective
    score = eval(config, trial)['kappa']
            ^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/optuna_trainable.py", line 118, in eval
    return t.train_for_multiclass(trial)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_trainer.py", line 106, in train_for_multiclass
    losses.append(loss.data.cpu().numpy())
                  ^^^^^^^^^^^^^^^
KeyboardInterrupt
[33m[W 2025-08-28 22:42:00,007][0m Trial 4 failed with value None.[0m
Traceback (most recent call last):
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/hyper_optuna.py", line 37, in <module>
    study.optimize(objective, n_trials=100)
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/optuna/study/_optimize.py", line 258, in _run_trial
    raise func_err
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/hyper_optuna.py", line 23, in objective
    score = eval(config, trial)['kappa']
            ^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/optuna_trainable.py", line 118, in eval
    return t.train_for_multiclass(trial)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_trainer.py", line 106, in train_for_multiclass
    losses.append(loss.data.cpu().numpy())
                  ^^^^^^^^^^^^^^^
KeyboardInterrupt
Traceback (most recent call last):
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/hyper_optuna.py", line 37, in <module>
    study.optimize(objective, n_trials=100)
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/optuna/study/_optimize.py", line 258, in _run_trial
    raise func_err
  File "/mnt/disk1/aiotlab/envs/hoainiem/lib/python3.12/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/hyper_optuna.py", line 23, in objective
    score = eval(config, trial)['kappa']
            ^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/optuna_trainable.py", line 118, in eval
    return t.train_for_multiclass(trial)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/finetune_trainer.py", line 106, in train_for_multiclass
    losses.append(loss.data.cpu().numpy())
                  ^^^^^^^^^^^^^^^
KeyboardInterrupt
