100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.63it/s]
Epoch 1 : Training Loss: 1.64107, acc: 0.20133, kappa: 0.00167, f1: 0.06939, LR: 0.00009, Time elapsed 0.26 mins
[[  1   0   0   0 149]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20133, kappa: 0.00167, f1: 0.06939
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.70it/s]
Epoch 2 : Training Loss: 1.62114, acc: 0.19600, kappa: -0.00500, f1: 0.06820, LR: 0.00009, Time elapsed 0.26 mins
[[  0 149   0   1   0]
 [  4 146   0   0   0]
 [  0 149   0   1   0]
 [  1 148   0   1   0]
 [  0 148   0   2   0]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.94it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.09it/s]
Epoch 3 : Training Loss: 1.60228, acc: 0.26533, kappa: 0.08167, f1: 0.24975, LR: 0.00009, Time elapsed 0.25 mins
[[ 8 22 26 47 47]
 [12 36 25 28 49]
 [ 7  9 44 35 55]
 [ 5 12 32 45 56]
 [ 8 11 24 41 66]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26533, kappa: 0.08167, f1: 0.24975
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.99it/s]
Epoch 4 : Training Loss: 1.57032, acc: 0.25467, kappa: 0.06833, f1: 0.22661, LR: 0.00009, Time elapsed 0.25 mins
[[26 54 10 22 38]
 [17 80  7 11 35]
 [21 44  9 13 63]
 [15 54 10 21 50]
 [22 49  9 15 55]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.58it/s]
Epoch 5 : Training Loss: 1.50574, acc: 0.26133, kappa: 0.07667, f1: 0.24747, LR: 0.00009, Time elapsed 0.25 mins
[[28 49 32 32  9]
 [18 75 23 25  9]
 [23 35 43 33 16]
 [18 52 30 32 18]
 [20 44 31 37 18]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.69it/s]
Epoch 6 : Training Loss: 1.38924, acc: 0.25600, kappa: 0.07000, f1: 0.24653, LR: 0.00008, Time elapsed 0.26 mins
[[30 35 38 14 33]
 [29 48 29 15 29]
 [23 23 61 12 31]
 [23 25 49 17 36]
 [20 33 43 18 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.32it/s]
Epoch 7 : Training Loss: 1.26229, acc: 0.26533, kappa: 0.08167, f1: 0.26587, LR: 0.00008, Time elapsed 0.25 mins
[[35 29 26 28 32]
 [37 49 15 29 20]
 [25 23 41 30 31]
 [25 24 25 38 38]
 [30 29 22 33 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:13<00:00,  5.28it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.47it/s]
Epoch 8 : Training Loss: 1.10223, acc: 0.24933, kappa: 0.06167, f1: 0.24897, LR: 0.00008, Time elapsed 0.24 mins
[[30 26 28 40 26]
 [35 42 21 31 21]
 [20 24 36 33 37]
 [23 25 19 45 38]
 [28 28 21 39 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.94it/s]
Epoch 9 : Training Loss: 0.93375, acc: 0.27867, kappa: 0.09833, f1: 0.27067, LR: 0.00008, Time elapsed 0.26 mins
[[38 16 34 46 16]
 [26 31 27 48 18]
 [25 14 50 38 23]
 [25  9 27 67 22]
 [24 17 30 56 23]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27867, kappa: 0.09833, f1: 0.27067
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.80it/s]
Epoch 10 : Training Loss: 0.75945, acc: 0.27867, kappa: 0.09833, f1: 0.27734, LR: 0.00008, Time elapsed 0.25 mins
[[42 19 18 43 28]
 [38 40 12 38 22]
 [35 21 33 33 28]
 [30 17 15 59 29]
 [42 19 18 36 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.78it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.87it/s]
Epoch 11 : Training Loss: 0.65971, acc: 0.27467, kappa: 0.09333, f1: 0.27348, LR: 0.00008, Time elapsed 0.26 mins
[[35 29 21 33 32]
 [34 37 21 25 33]
 [23 20 35 26 46]
 [23 23 14 49 41]
 [26 24 20 30 50]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.84it/s]
Epoch 12 : Training Loss: 0.58566, acc: 0.28533, kappa: 0.10667, f1: 0.28482, LR: 0.00008, Time elapsed 0.26 mins
[[36 16 24 45 29]
 [37 37 19 34 23]
 [28 14 41 37 30]
 [29 15 19 59 28]
 [32 19 17 41 41]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28533, kappa: 0.10667, f1: 0.28482
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.75it/s]
Epoch 13 : Training Loss: 0.55144, acc: 0.30800, kappa: 0.13500, f1: 0.30537, LR: 0.00007, Time elapsed 0.26 mins
[[38 20 30 24 38]
 [30 46 27 20 27]
 [25 17 47 21 40]
 [25 23 22 36 44]
 [25 23 22 16 64]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.30800, kappa: 0.13500, f1: 0.30537
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.97it/s]
Epoch 14 : Training Loss: 0.52137, acc: 0.30267, kappa: 0.12833, f1: 0.29977, LR: 0.00007, Time elapsed 0.26 mins
[[39 28 26 33 24]
 [26 56 22 27 19]
 [24 21 40 32 33]
 [23 24 22 60 21]
 [30 26 30 32 32]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.56it/s]
Epoch 15 : Training Loss: 0.50154, acc: 0.29600, kappa: 0.12000, f1: 0.29655, LR: 0.00007, Time elapsed 0.26 mins
[[42 25 28 25 30]
 [38 49 23 18 22]
 [21 20 50 23 36]
 [24 24 24 42 36]
 [31 27 29 24 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.56it/s]
Epoch 16 : Training Loss: 0.48821, acc: 0.28133, kappa: 0.10167, f1: 0.27908, LR: 0.00007, Time elapsed 0.26 mins
[[42 22 27 36 23]
 [33 46 23 31 17]
 [29 20 41 33 27]
 [29 18 22 56 25]
 [34 22 29 39 26]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.00it/s]
Epoch 17 : Training Loss: 0.47539, acc: 0.27600, kappa: 0.09500, f1: 0.27462, LR: 0.00007, Time elapsed 0.26 mins
[[43 20 30 30 27]
 [36 30 28 26 30]
 [25 18 45 25 37]
 [31 20 23 47 29]
 [28 16 32 32 42]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.31it/s]
Epoch 18 : Training Loss: 0.46131, acc: 0.28000, kappa: 0.10000, f1: 0.27876, LR: 0.00006, Time elapsed 0.26 mins
[[36 25 31 29 29]
 [32 45 28 24 21]
 [26 26 52 21 25]
 [25 25 24 46 30]
 [27 27 38 27 31]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.73it/s]
Epoch 19 : Training Loss: 0.45757, acc: 0.30267, kappa: 0.12833, f1: 0.30161, LR: 0.00006, Time elapsed 0.26 mins
[[44 21 26 31 28]
 [40 35 23 27 25]
 [24 16 57 20 33]
 [28 14 28 52 28]
 [35 19 28 29 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.46it/s]
Epoch 20 : Training Loss: 0.44868, acc: 0.30533, kappa: 0.13167, f1: 0.30546, LR: 0.00006, Time elapsed 0.26 mins
[[39 19 30 33 29]
 [30 47 23 27 23]
 [19 22 48 24 37]
 [29 20 24 52 25]
 [29 23 24 31 43]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.39it/s]
Epoch 21 : Training Loss: 0.44258, acc: 0.28000, kappa: 0.10000, f1: 0.27764, LR: 0.00006, Time elapsed 0.26 mins
[[42 28 31 39 10]
 [37 44 24 32 13]
 [29 30 39 33 19]
 [31 25 19 55 20]
 [26 27 31 36 30]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.65it/s]
Epoch 22 : Training Loss: 0.43725, acc: 0.28000, kappa: 0.10000, f1: 0.27689, LR: 0.00005, Time elapsed 0.26 mins
[[40 23 27 38 22]
 [34 49 23 29 15]
 [28 24 41 32 25]
 [28 19 24 56 23]
 [36 22 31 37 24]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.89it/s]
Epoch 23 : Training Loss: 0.43279, acc: 0.28667, kappa: 0.10833, f1: 0.28477, LR: 0.00005, Time elapsed 0.25 mins
[[39 25 29 33 24]
 [32 39 25 33 21]
 [24 21 49 29 27]
 [25 15 24 56 30]
 [32 23 31 32 32]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.69it/s]
Epoch 24 : Training Loss: 0.42822, acc: 0.27600, kappa: 0.09500, f1: 0.27617, LR: 0.00005, Time elapsed 0.26 mins
[[34 23 28 33 32]
 [35 43 24 24 24]
 [23 21 47 26 33]
 [30 23 20 49 28]
 [32 28 28 28 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.59it/s]
Epoch 25 : Training Loss: 0.42468, acc: 0.29200, kappa: 0.11500, f1: 0.29169, LR: 0.00004, Time elapsed 0.26 mins
[[38 28 28 31 25]
 [34 50 20 24 22]
 [26 20 47 26 31]
 [27 21 25 49 28]
 [27 27 33 28 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.75it/s]
Epoch 26 : Training Loss: 0.41964, acc: 0.29333, kappa: 0.11667, f1: 0.29214, LR: 0.00004, Time elapsed 0.26 mins
[[43 25 22 37 23]
 [37 44 18 32 19]
 [28 21 43 28 30]
 [23 19 19 57 32]
 [29 26 27 35 33]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.65it/s]
Epoch 27 : Training Loss: 0.41953, acc: 0.27467, kappa: 0.09333, f1: 0.27227, LR: 0.00004, Time elapsed 0.26 mins
[[30 32 31 35 22]
 [34 42 26 30 18]
 [24 18 46 31 31]
 [24 23 24 55 24]
 [25 25 27 40 33]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.38it/s]
Epoch 28 : Training Loss: 0.41542, acc: 0.29733, kappa: 0.12167, f1: 0.29557, LR: 0.00004, Time elapsed 0.26 mins
[[42 26 30 36 16]
 [39 47 20 29 15]
 [31 18 47 28 26]
 [30 20 21 58 21]
 [39 20 27 35 29]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.59it/s]
Epoch 29 : Training Loss: 0.41313, acc: 0.30267, kappa: 0.12833, f1: 0.30219, LR: 0.00003, Time elapsed 0.26 mins
[[38 23 27 33 29]
 [35 42 22 30 21]
 [23 14 51 25 37]
 [21 23 19 56 31]
 [28 22 28 32 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.59it/s]
Epoch 30 : Training Loss: 0.41089, acc: 0.29467, kappa: 0.11833, f1: 0.29509, LR: 0.00003, Time elapsed 0.26 mins
[[42 28 28 31 21]
 [39 45 21 24 21]
 [29 21 45 22 33]
 [28 23 18 50 31]
 [31 21 24 35 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.87it/s]
Epoch 31 : Training Loss: 0.40902, acc: 0.29067, kappa: 0.11333, f1: 0.28968, LR: 0.00003, Time elapsed 0.26 mins
[[39 26 27 31 27]
 [38 50 22 23 17]
 [24 22 49 26 29]
 [25 27 22 49 27]
 [30 27 31 31 31]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.93it/s]
Epoch 32 : Training Loss: 0.40792, acc: 0.29200, kappa: 0.11500, f1: 0.29182, LR: 0.00003, Time elapsed 0.26 mins
[[36 29 25 34 26]
 [33 44 22 24 27]
 [25 21 48 24 32]
 [27 22 20 53 28]
 [29 24 27 32 38]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.77it/s]
Epoch 33 : Training Loss: 0.40665, acc: 0.28933, kappa: 0.11167, f1: 0.28934, LR: 0.00002, Time elapsed 0.26 mins
[[39 25 25 32 29]
 [36 45 21 27 21]
 [26 19 47 27 31]
 [28 20 23 51 28]
 [29 27 26 33 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.52it/s]
Epoch 34 : Training Loss: 0.40527, acc: 0.29867, kappa: 0.12333, f1: 0.29694, LR: 0.00002, Time elapsed 0.26 mins
[[35 26 27 35 27]
 [33 45 22 27 23]
 [23 21 44 29 33]
 [25 23 16 62 24]
 [31 23 24 34 38]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.11it/s]
Epoch 35 : Training Loss: 0.40452, acc: 0.30000, kappa: 0.12500, f1: 0.29886, LR: 0.00002, Time elapsed 0.25 mins
[[36 28 28 30 28]
 [30 50 24 24 22]
 [26 21 46 27 30]
 [25 25 19 56 25]
 [26 26 26 35 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.93it/s]
Epoch 36 : Training Loss: 0.40386, acc: 0.30267, kappa: 0.12833, f1: 0.30236, LR: 0.00002, Time elapsed 0.26 mins
[[42 26 24 32 26]
 [33 49 23 24 21]
 [26 20 45 27 32]
 [22 23 22 54 29]
 [32 25 24 32 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.94it/s]
Epoch 37 : Training Loss: 0.40333, acc: 0.29733, kappa: 0.12167, f1: 0.29743, LR: 0.00001, Time elapsed 0.26 mins
[[39 24 28 32 27]
 [36 45 24 22 23]
 [26 18 48 26 32]
 [28 21 19 54 28]
 [31 23 26 33 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.74it/s]
Epoch 38 : Training Loss: 0.40254, acc: 0.30267, kappa: 0.12833, f1: 0.30235, LR: 0.00001, Time elapsed 0.26 mins
[[40 26 26 30 28]
 [34 51 24 22 19]
 [25 20 48 24 33]
 [25 22 23 53 27]
 [31 28 23 33 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.66it/s]
Epoch 39 : Training Loss: 0.40229, acc: 0.29867, kappa: 0.12333, f1: 0.29795, LR: 0.00001, Time elapsed 0.26 mins
[[39 28 25 33 25]
 [35 50 18 27 20]
 [24 21 44 29 32]
 [22 22 20 55 31]
 [28 29 22 35 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.90it/s]
Epoch 40 : Training Loss: 0.40168, acc: 0.30533, kappa: 0.13167, f1: 0.30475, LR: 0.00001, Time elapsed 0.26 mins
[[38 28 26 30 28]
 [30 54 22 26 18]
 [24 19 49 25 33]
 [26 22 20 53 29]
 [29 27 25 34 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.86it/s]
Epoch 41 : Training Loss: 0.40179, acc: 0.30133, kappa: 0.12667, f1: 0.30041, LR: 0.00001, Time elapsed 0.26 mins
[[40 28 24 32 26]
 [34 53 21 24 18]
 [24 20 44 29 33]
 [27 24 18 55 26]
 [30 27 22 37 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.58it/s]
Epoch 42 : Training Loss: 0.40157, acc: 0.30000, kappa: 0.12500, f1: 0.29915, LR: 0.00001, Time elapsed 0.25 mins
[[41 27 25 31 26]
 [34 49 23 27 17]
 [26 18 46 28 32]
 [24 23 21 55 27]
 [30 28 22 36 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.67it/s]
Epoch 43 : Training Loss: 0.40129, acc: 0.30400, kappa: 0.13000, f1: 0.30308, LR: 0.00001, Time elapsed 0.26 mins
[[39 27 25 33 26]
 [33 52 21 25 19]
 [25 19 45 28 33]
 [25 22 21 57 25]
 [32 26 23 34 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.53it/s]
Epoch 44 : Training Loss: 0.40092, acc: 0.30267, kappa: 0.12833, f1: 0.30192, LR: 0.00000, Time elapsed 0.26 mins
[[39 28 26 31 26]
 [33 51 22 25 19]
 [24 19 47 27 33]
 [25 23 20 55 27]
 [30 28 24 33 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.56it/s]
Epoch 45 : Training Loss: 0.40076, acc: 0.30000, kappa: 0.12500, f1: 0.29950, LR: 0.00000, Time elapsed 0.26 mins
[[41 26 24 34 25]
 [34 48 21 27 20]
 [24 19 46 28 33]
 [24 23 21 54 28]
 [29 27 26 32 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.80it/s]
Epoch 46 : Training Loss: 0.40085, acc: 0.29467, kappa: 0.11833, f1: 0.29392, LR: 0.00000, Time elapsed 0.26 mins
[[37 26 28 33 26]
 [33 49 21 27 20]
 [24 20 45 28 33]
 [24 24 20 54 28]
 [29 28 25 32 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.68it/s]
Epoch 47 : Training Loss: 0.40047, acc: 0.30000, kappa: 0.12500, f1: 0.29978, LR: 0.00000, Time elapsed 0.26 mins
[[40 26 24 33 27]
 [35 50 20 25 20]
 [25 19 45 28 33]
 [25 22 19 55 29]
 [33 25 25 32 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.70it/s]
Epoch 48 : Training Loss: 0.40058, acc: 0.29867, kappa: 0.12333, f1: 0.29809, LR: 0.00000, Time elapsed 0.26 mins
[[38 27 25 34 26]
 [34 50 21 25 20]
 [25 19 46 28 32]
 [24 22 20 55 29]
 [31 27 25 32 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.69it/s]
Epoch 49 : Training Loss: 0.40077, acc: 0.30000, kappa: 0.12500, f1: 0.29950, LR: 0.00000, Time elapsed 0.26 mins
[[39 27 25 34 25]
 [35 50 20 24 21]
 [25 19 46 28 32]
 [24 22 20 55 29]
 [31 27 25 32 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.39it/s]
Epoch 50 : Training Loss: 0.40076, acc: 0.30267, kappa: 0.12833, f1: 0.30204, LR: 0.00000, Time elapsed 0.25 mins
[[40 26 24 34 26]
 [34 50 21 25 20]
 [25 19 46 28 32]
 [24 22 20 56 28]
 [31 27 24 33 35]]
***************************Test************************
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.17it/s]
***************************Test results************************
Test Evaluation: acc: 0.30000, kappa: 0.12500, f1: 0.29618
[[41 25 26 16 42]
 [25 44 23 22 36]
 [27 25 43 17 38]
 [28 24 23 32 43]
 [23 21 19 22 65]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch13_acc_0.30000_kappa_0.12500_f1_0.29618.pth
[32m[I 2025-08-29 13:20:46,729][0m Trial 24 finished with value: 0.125 and parameters: {'lr': 8.801788127467066e-05, 'weight_decay': 0.008485571126247744, '--dropout': 0.16810743834566239, '--clip_value': 1.3795442964581812}. Best is trial 21 with value: 0.345.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.00047294797338055073, weight_decay=0.00041483514305339173, optimizer='AdamW', clip_value=1.70716795115456, dropout=0.1733191387548493, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1733191387548493, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1733191387548493, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
