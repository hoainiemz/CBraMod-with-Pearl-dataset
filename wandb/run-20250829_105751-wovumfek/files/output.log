100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.97it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.88it/s]
Epoch 1 : Training Loss: 1.67433, acc: 0.21467, kappa: 0.01833, f1: 0.12168, LR: 0.00014, Time elapsed 0.21 mins
[[  0 116   0  32   2]
 [  0 125   0  21   4]
 [  0 119   0  27   4]
 [  0 114   0  31   5]
 [  0 108   0  37   5]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21467, kappa: 0.01833, f1: 0.12168
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.96it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.63it/s]
Epoch 2 : Training Loss: 1.62703, acc: 0.22800, kappa: 0.03500, f1: 0.14421, LR: 0.00014, Time elapsed 0.21 mins
[[  0   6  31 113   0]
 [  1   9  28 112   0]
 [  0   1  46 103   0]
 [  1   3  30 116   0]
 [  0   4  34 112   0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22800, kappa: 0.03500, f1: 0.14421
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.23it/s]
Epoch 3 : Training Loss: 1.60244, acc: 0.23200, kappa: 0.04000, f1: 0.15944, LR: 0.00014, Time elapsed 0.21 mins
[[  3  15  19   0 113]
 [  1  20  14   0 115]
 [  0  11  30   0 109]
 [  0  12  20   0 118]
 [  4  13  12   0 121]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23200, kappa: 0.04000, f1: 0.15944
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.07it/s]
Epoch 4 : Training Loss: 1.55077, acc: 0.30933, kappa: 0.13667, f1: 0.29368, LR: 0.00014, Time elapsed 0.21 mins
[[21 29 27 57 16]
 [20 54 25 43  8]
 [11 23 54 42 20]
 [12 23 24 78 13]
 [13 32 27 53 25]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.30933, kappa: 0.13667, f1: 0.29368
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.36it/s]
Epoch 5 : Training Loss: 1.43288, acc: 0.33333, kappa: 0.16667, f1: 0.32835, LR: 0.00014, Time elapsed 0.21 mins
[[27 32 25 36 30]
 [17 56 32 26 19]
 [17 19 61 17 36]
 [17 22 24 52 35]
 [15 32 23 26 54]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.33333, kappa: 0.16667, f1: 0.32835
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.23it/s]
Epoch 6 : Training Loss: 1.23927, acc: 0.38000, kappa: 0.22500, f1: 0.37589, LR: 0.00014, Time elapsed 0.21 mins
[[52 22 12 46 18]
 [20 65 15 30 20]
 [19 23 50 31 27]
 [23 22 12 79 14]
 [25 27 19 40 39]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.38000, kappa: 0.22500, f1: 0.37589
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.23it/s]
Epoch 7 : Training Loss: 0.99030, acc: 0.39067, kappa: 0.23833, f1: 0.38599, LR: 0.00014, Time elapsed 0.21 mins
[[56 17 27 40 10]
 [33 51 20 34 12]
 [19 13 74 25 19]
 [22 20 23 73 12]
 [29 21 31 30 39]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.39067, kappa: 0.23833, f1: 0.38599
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
Epoch 8 : Training Loss: 0.75875, acc: 0.39867, kappa: 0.24833, f1: 0.39844, LR: 0.00013, Time elapsed 0.21 mins
[[56 17 24 32 21]
 [38 51 25 21 15]
 [24  9 72 17 28]
 [29 16 21 65 19]
 [28 19 25 23 55]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.39867, kappa: 0.24833, f1: 0.39844
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.16it/s]
Epoch 9 : Training Loss: 0.61011, acc: 0.37867, kappa: 0.22333, f1: 0.37877, LR: 0.00013, Time elapsed 0.21 mins
[[58 23 23 27 19]
 [39 61 12 24 14]
 [27 25 56 16 26]
 [17 32 17 63 21]
 [32 34 16 22 46]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.31it/s]
Epoch 10 : Training Loss: 0.54888, acc: 0.40133, kappa: 0.25167, f1: 0.39872, LR: 0.00013, Time elapsed 0.21 mins
[[44 20 30 40 16]
 [26 57 30 26 11]
 [17  7 75 28 23]
 [10 26 26 68 20]
 [21 24 26 22 57]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.40133, kappa: 0.25167, f1: 0.39872
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.32it/s]
Epoch 11 : Training Loss: 0.51385, acc: 0.41067, kappa: 0.26333, f1: 0.41119, LR: 0.00013, Time elapsed 0.21 mins
[[68 16 14 28 24]
 [40 54 14 26 16]
 [26 15 57 25 27]
 [30 17 13 68 22]
 [31 25 15 18 61]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.41067, kappa: 0.26333, f1: 0.41119
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.93it/s]
Epoch 12 : Training Loss: 0.48934, acc: 0.42000, kappa: 0.27500, f1: 0.42048, LR: 0.00012, Time elapsed 0.21 mins
[[65 20 16 24 25]
 [34 65 16 19 16]
 [28 11 64 14 33]
 [29 20 21 52 28]
 [27 22 15 17 69]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42000, kappa: 0.27500, f1: 0.42048
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.05it/s]
Epoch 13 : Training Loss: 0.46869, acc: 0.41733, kappa: 0.27167, f1: 0.41785, LR: 0.00012, Time elapsed 0.21 mins
[[55 22 17 29 27]
 [24 65 21 20 20]
 [20 12 64 20 34]
 [23 15 16 72 24]
 [27 28 16 22 57]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.91it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.15it/s]
Epoch 14 : Training Loss: 0.45911, acc: 0.40133, kappa: 0.25167, f1: 0.39958, LR: 0.00012, Time elapsed 0.21 mins
[[55 25 21 37 12]
 [30 54 16 31 19]
 [18 12 64 28 28]
 [21 16 19 77 17]
 [28 22 22 27 51]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.17it/s]
Epoch 15 : Training Loss: 0.45094, acc: 0.40400, kappa: 0.25500, f1: 0.40331, LR: 0.00011, Time elapsed 0.21 mins
[[51 25 15 39 20]
 [22 56 19 30 23]
 [22 13 63 30 22]
 [14 19 18 76 23]
 [24 24 12 33 57]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.93it/s]
Epoch 16 : Training Loss: 0.43848, acc: 0.41067, kappa: 0.26333, f1: 0.40968, LR: 0.00011, Time elapsed 0.21 mins
[[67 15 13 31 24]
 [35 48 22 23 22]
 [29  8 61 23 29]
 [23 13 20 73 21]
 [32 19 16 24 59]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.21it/s]
Epoch 17 : Training Loss: 0.42863, acc: 0.41600, kappa: 0.27000, f1: 0.41664, LR: 0.00011, Time elapsed 0.21 mins
[[65 21 15 33 16]
 [27 57 18 32 16]
 [23 13 64 24 26]
 [23 25 18 67 17]
 [27 29 14 21 59]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.94it/s]
Epoch 18 : Training Loss: 0.42337, acc: 0.40933, kappa: 0.26167, f1: 0.40938, LR: 0.00010, Time elapsed 0.21 mins
[[58 18 16 40 18]
 [27 53 21 24 25]
 [26 11 60 23 30]
 [21 21 11 72 25]
 [28 21 12 25 64]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.91it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.26it/s]
Epoch 19 : Training Loss: 0.41505, acc: 0.39867, kappa: 0.24833, f1: 0.39810, LR: 0.00010, Time elapsed 0.21 mins
[[47 27 18 41 17]
 [25 62 21 24 18]
 [24 14 67 20 25]
 [20 26 18 68 18]
 [24 31 17 23 55]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.10it/s]
Epoch 20 : Training Loss: 0.40903, acc: 0.41600, kappa: 0.27000, f1: 0.41553, LR: 0.00009, Time elapsed 0.21 mins
[[52 23 20 33 22]
 [27 56 28 18 21]
 [26 10 70 20 24]
 [20 18 20 67 25]
 [26 21 16 20 67]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.99it/s]
Epoch 21 : Training Loss: 0.40579, acc: 0.42933, kappa: 0.28667, f1: 0.42931, LR: 0.00009, Time elapsed 0.21 mins
[[58 21 20 34 17]
 [30 58 24 21 17]
 [28 12 67 22 21]
 [17 22 17 73 21]
 [25 20 15 24 66]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42933, kappa: 0.28667, f1: 0.42931
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.16it/s]
Epoch 22 : Training Loss: 0.40251, acc: 0.43200, kappa: 0.29000, f1: 0.43135, LR: 0.00009, Time elapsed 0.21 mins
[[52 19 18 35 26]
 [29 59 22 20 20]
 [24 10 69 23 24]
 [18 22 15 75 20]
 [21 25 13 22 69]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.43200, kappa: 0.29000, f1: 0.43135
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.02it/s]
Epoch 23 : Training Loss: 0.40013, acc: 0.43200, kappa: 0.29000, f1: 0.43232, LR: 0.00008, Time elapsed 0.21 mins
[[55 24 14 35 22]
 [31 63 19 20 17]
 [25 11 66 24 24]
 [17 24 14 74 21]
 [24 29 15 16 66]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.44it/s]
Epoch 24 : Training Loss: 0.39915, acc: 0.43067, kappa: 0.28833, f1: 0.42998, LR: 0.00008, Time elapsed 0.21 mins
[[56 20 17 31 26]
 [27 58 21 25 19]
 [25  9 63 25 28]
 [18 20 14 75 23]
 [22 25 13 19 71]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.13it/s]
Epoch 25 : Training Loss: 0.39801, acc: 0.42933, kappa: 0.28667, f1: 0.42913, LR: 0.00007, Time elapsed 0.21 mins
[[54 20 17 37 22]
 [27 60 22 23 18]
 [25 10 68 20 27]
 [16 23 13 74 24]
 [26 25 16 17 66]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.57it/s]
Epoch 26 : Training Loss: 0.39649, acc: 0.44400, kappa: 0.30500, f1: 0.44318, LR: 0.00007, Time elapsed 0.21 mins
[[54 23 20 35 18]
 [32 59 20 24 15]
 [24 10 67 22 27]
 [17 22 11 80 20]
 [22 21 13 21 73]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.44400, kappa: 0.30500, f1: 0.44318
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.01it/s]
Epoch 27 : Training Loss: 0.39587, acc: 0.42933, kappa: 0.28667, f1: 0.42923, LR: 0.00006, Time elapsed 0.21 mins
[[52 21 19 37 21]
 [30 61 20 21 18]
 [25 11 69 20 25]
 [18 24 13 75 20]
 [25 24 15 21 65]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.98it/s]
Epoch 28 : Training Loss: 0.39557, acc: 0.43200, kappa: 0.29000, f1: 0.43208, LR: 0.00006, Time elapsed 0.21 mins
[[55 21 20 32 22]
 [29 62 21 21 17]
 [25 11 68 22 24]
 [19 21 14 75 21]
 [27 24 14 21 64]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.06it/s]
Epoch 29 : Training Loss: 0.39505, acc: 0.42933, kappa: 0.28667, f1: 0.42864, LR: 0.00005, Time elapsed 0.21 mins
[[51 22 21 36 20]
 [29 63 21 19 18]
 [25 10 64 23 28]
 [17 22 12 75 24]
 [22 24 15 20 69]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.19it/s]
Epoch 30 : Training Loss: 0.39460, acc: 0.42800, kappa: 0.28500, f1: 0.42799, LR: 0.00005, Time elapsed 0.21 mins
[[53 23 18 34 22]
 [28 60 20 25 17]
 [25 11 67 21 26]
 [17 23 15 72 23]
 [26 22 13 20 69]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.17it/s]
Epoch 31 : Training Loss: 0.39434, acc: 0.43467, kappa: 0.29333, f1: 0.43451, LR: 0.00005, Time elapsed 0.21 mins
[[57 19 19 33 22]
 [28 62 22 21 17]
 [23  9 71 22 25]
 [18 22 13 75 22]
 [25 29 15 20 61]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.87it/s]
Epoch 32 : Training Loss: 0.39441, acc: 0.42400, kappa: 0.28000, f1: 0.42359, LR: 0.00004, Time elapsed 0.21 mins
[[54 21 18 38 19]
 [30 58 19 24 19]
 [28  9 62 24 27]
 [19 20 12 76 23]
 [22 24 15 21 68]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.27it/s]
Epoch 33 : Training Loss: 0.39417, acc: 0.42933, kappa: 0.28667, f1: 0.42867, LR: 0.00004, Time elapsed 0.21 mins
[[52 21 21 37 19]
 [28 62 21 21 18]
 [23 12 66 22 27]
 [16 20 16 72 26]
 [21 23 15 21 70]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.20it/s]
Epoch 34 : Training Loss: 0.39389, acc: 0.43200, kappa: 0.29000, f1: 0.43142, LR: 0.00003, Time elapsed 0.21 mins
[[53 19 21 37 20]
 [31 58 20 23 18]
 [23 10 69 21 27]
 [18 21 14 74 23]
 [21 25 14 20 70]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.19it/s]
Epoch 35 : Training Loss: 0.39363, acc: 0.42800, kappa: 0.28500, f1: 0.42755, LR: 0.00003, Time elapsed 0.21 mins
[[52 22 18 38 20]
 [30 59 21 21 19]
 [23 10 69 24 24]
 [18 23 13 75 21]
 [22 22 16 24 66]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.15it/s]
Epoch 36 : Training Loss: 0.39359, acc: 0.42800, kappa: 0.28500, f1: 0.42797, LR: 0.00003, Time elapsed 0.21 mins
[[54 18 21 38 19]
 [32 58 20 21 19]
 [24  7 68 24 27]
 [19 21 14 74 22]
 [24 22 14 23 67]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.92it/s]
Epoch 37 : Training Loss: 0.39352, acc: 0.42800, kappa: 0.28500, f1: 0.42797, LR: 0.00002, Time elapsed 0.21 mins
[[56 20 21 34 19]
 [33 59 22 19 17]
 [25  9 65 24 27]
 [19 23 13 73 22]
 [23 25 14 20 68]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.89it/s]
Epoch 38 : Training Loss: 0.39327, acc: 0.41867, kappa: 0.27333, f1: 0.41879, LR: 0.00002, Time elapsed 0.21 mins
[[55 21 21 35 18]
 [31 58 21 20 20]
 [26  9 65 24 26]
 [19 24 14 70 23]
 [24 24 15 21 66]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.13it/s]
Epoch 39 : Training Loss: 0.39338, acc: 0.42400, kappa: 0.28000, f1: 0.42382, LR: 0.00002, Time elapsed 0.21 mins
[[55 21 20 33 21]
 [31 57 21 22 19]
 [25  9 66 24 26]
 [19 23 13 74 21]
 [23 26 13 22 66]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.94it/s]
Epoch 40 : Training Loss: 0.39324, acc: 0.42533, kappa: 0.28167, f1: 0.42541, LR: 0.00001, Time elapsed 0.21 mins
[[52 21 19 39 19]
 [30 62 21 19 18]
 [25  8 67 23 27]
 [17 23 14 72 24]
 [24 26 13 21 66]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.77it/s]
Epoch 41 : Training Loss: 0.39303, acc: 0.43067, kappa: 0.28833, f1: 0.43068, LR: 0.00001, Time elapsed 0.21 mins
[[55 18 22 35 20]
 [30 61 21 20 18]
 [25  8 66 24 27]
 [18 23 12 75 22]
 [26 22 14 22 66]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.77it/s]
Epoch 42 : Training Loss: 0.39289, acc: 0.43467, kappa: 0.29333, f1: 0.43453, LR: 0.00001, Time elapsed 0.21 mins
[[56 19 20 35 20]
 [30 59 21 22 18]
 [25  8 67 24 26]
 [19 23 13 74 21]
 [22 24 13 21 70]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.09it/s]
Epoch 43 : Training Loss: 0.39295, acc: 0.42933, kappa: 0.28667, f1: 0.42923, LR: 0.00001, Time elapsed 0.21 mins
[[55 18 21 36 20]
 [30 60 21 20 19]
 [25 10 65 25 25]
 [19 23 14 73 21]
 [23 25 13 20 69]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.02it/s]
Epoch 44 : Training Loss: 0.39284, acc: 0.43200, kappa: 0.29000, f1: 0.43182, LR: 0.00001, Time elapsed 0.21 mins
[[55 19 20 35 21]
 [30 62 21 18 19]
 [25 10 65 25 25]
 [19 23 14 73 21]
 [20 26 14 21 69]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.97it/s]
Epoch 45 : Training Loss: 0.39278, acc: 0.43333, kappa: 0.29167, f1: 0.43306, LR: 0.00000, Time elapsed 0.21 mins
[[55 19 21 35 20]
 [30 60 21 20 19]
 [25  9 66 24 26]
 [18 23 12 75 22]
 [23 23 14 21 69]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.16it/s]
Epoch 46 : Training Loss: 0.39274, acc: 0.43067, kappa: 0.28833, f1: 0.43026, LR: 0.00000, Time elapsed 0.21 mins
[[55 18 23 34 20]
 [30 59 21 21 19]
 [25  9 66 25 25]
 [19 23 13 74 21]
 [21 24 15 21 69]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.21it/s]
Epoch 47 : Training Loss: 0.39270, acc: 0.43067, kappa: 0.28833, f1: 0.43041, LR: 0.00000, Time elapsed 0.21 mins
[[55 18 23 34 20]
 [30 59 21 21 19]
 [25  8 67 25 25]
 [19 23 13 74 21]
 [23 23 15 21 68]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.06it/s]
Epoch 48 : Training Loss: 0.39285, acc: 0.43067, kappa: 0.28833, f1: 0.43041, LR: 0.00000, Time elapsed 0.21 mins
[[55 18 23 34 20]
 [30 59 21 21 19]
 [25  8 67 25 25]
 [19 23 13 74 21]
 [23 23 15 21 68]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.13it/s]
Epoch 49 : Training Loss: 0.39272, acc: 0.42933, kappa: 0.28667, f1: 0.42909, LR: 0.00000, Time elapsed 0.21 mins
[[55 18 23 35 19]
 [30 59 21 21 19]
 [25  8 67 24 26]
 [19 23 13 74 21]
 [23 24 15 21 67]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.68it/s]
Epoch 50 : Training Loss: 0.39279, acc: 0.43067, kappa: 0.28833, f1: 0.43044, LR: 0.00000, Time elapsed 0.21 mins
[[55 18 22 36 19]
 [30 60 21 20 19]
 [25  9 66 25 25]
 [19 23 12 75 21]
 [23 24 15 21 67]]
***************************Test************************
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.55it/s]
***************************Test results************************
Test Evaluation: acc: 0.44800, kappa: 0.31000, f1: 0.44811
[[74 18 18 21 19]
 [24 69 18 26 13]
 [22 18 69 18 23]
 [22 24 20 61 23]
 [28 17 14 28 63]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch26_acc_0.44800_kappa_0.31000_f1_0.44811.pth
[32m[I 2025-08-29 11:08:36,917][0m Trial 13 finished with value: 0.31000000000000005 and parameters: {'lr': 0.00014272872620517486, 'weight_decay': 3.2241376696970083e-05, '--dropout': 0.028312661589656687, '--clip_value': 0.7992431288253218}. Best is trial 11 with value: 0.32333333333333336.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.0001290718160346886, weight_decay=0.0001279668650218061, optimizer='AdamW', clip_value=1.472918312761419, dropout=0.0008401068991506849, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.0008401068991506849, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.0008401068991506849, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
