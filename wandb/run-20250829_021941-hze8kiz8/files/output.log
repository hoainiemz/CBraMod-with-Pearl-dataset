100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.09it/s]
Epoch 1 : Training Loss: 1.62206, acc: 0.20800, kappa: 0.01000, f1: 0.10356, LR: 0.00004, Time elapsed 0.32 mins
[[139   2   0   8   1]
 [134   4   0   7   5]
 [139   1   0  10   0]
 [136   1   0  12   1]
 [140   1   0   8   1]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20800, kappa: 0.01000, f1: 0.10356
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.70it/s]
Epoch 2 : Training Loss: 1.59916, acc: 0.25067, kappa: 0.06333, f1: 0.23596, LR: 0.00004, Time elapsed 0.33 mins
[[34  9 22 49 36]
 [35 10 24 51 30]
 [30  2 36 35 47]
 [24  7 21 51 47]
 [23  4 25 41 57]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25067, kappa: 0.06333, f1: 0.23596
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.09it/s]
Epoch 3 : Training Loss: 1.56921, acc: 0.25467, kappa: 0.06833, f1: 0.24637, LR: 0.00004, Time elapsed 0.32 mins
[[48 18 33 13 38]
 [37 39 35 10 29]
 [33 14 48 10 45]
 [40 23 39 12 36]
 [43 13 32 18 44]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25467, kappa: 0.06833, f1: 0.24637
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.34it/s]
Epoch 4 : Training Loss: 1.53062, acc: 0.26000, kappa: 0.07500, f1: 0.25990, LR: 0.00004, Time elapsed 0.34 mins
[[45 19 21 34 31]
 [33 38 21 28 30]
 [31 16 31 31 41]
 [30 26 23 36 35]
 [36 14 19 36 45]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26000, kappa: 0.07500, f1: 0.25990
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.65it/s]
Epoch 5 : Training Loss: 1.47221, acc: 0.23467, kappa: 0.04333, f1: 0.22263, LR: 0.00004, Time elapsed 0.33 mins
[[55 10 17 31 37]
 [59 14 16 23 38]
 [44  5 24 25 52]
 [51  7 20 33 39]
 [50  7 16 27 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.27it/s]
Epoch 6 : Training Loss: 1.40611, acc: 0.24800, kappa: 0.06000, f1: 0.24120, LR: 0.00004, Time elapsed 0.33 mins
[[21 31 34 45 19]
 [23 47 27 33 20]
 [23 24 40 36 27]
 [21 25 29 55 20]
 [23 29 30 45 23]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.64it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.56it/s]
Epoch 7 : Training Loss: 1.34860, acc: 0.26400, kappa: 0.08000, f1: 0.26249, LR: 0.00004, Time elapsed 0.34 mins
[[34 31 23 37 25]
 [20 52 22 30 26]
 [24 30 32 28 36]
 [20 31 21 42 36]
 [24 31 20 37 38]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26400, kappa: 0.08000, f1: 0.26249
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  4.17it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.63it/s]
Epoch 8 : Training Loss: 1.28309, acc: 0.24933, kappa: 0.06167, f1: 0.24782, LR: 0.00004, Time elapsed 0.30 mins
[[31 29 27 32 31]
 [36 39 28 26 21]
 [17 31 47 21 34]
 [26 29 33 28 34]
 [24 29 28 27 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.33it/s]
Epoch 9 : Training Loss: 1.20720, acc: 0.26000, kappa: 0.07500, f1: 0.25955, LR: 0.00004, Time elapsed 0.34 mins
[[39 23 28 32 28]
 [29 37 26 24 34]
 [25 20 44 24 37]
 [24 27 30 31 38]
 [29 19 30 28 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.96it/s]
Epoch 10 : Training Loss: 1.15904, acc: 0.24000, kappa: 0.05000, f1: 0.23957, LR: 0.00004, Time elapsed 0.34 mins
[[34 19 18 45 34]
 [29 33 18 39 31]
 [26 19 30 34 41]
 [20 21 25 47 37]
 [33 17 23 41 36]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.71it/s]
Epoch 11 : Training Loss: 1.07805, acc: 0.24933, kappa: 0.06167, f1: 0.24873, LR: 0.00004, Time elapsed 0.34 mins
[[35 17 26 49 23]
 [24 32 22 46 26]
 [25 16 36 43 30]
 [21 19 25 50 35]
 [30 19 24 43 34]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.36it/s]
Epoch 12 : Training Loss: 1.01778, acc: 0.25600, kappa: 0.07000, f1: 0.25604, LR: 0.00003, Time elapsed 0.34 mins
[[38 20 20 35 37]
 [30 37 16 32 35]
 [24 21 31 32 42]
 [23 22 23 42 40]
 [26 20 21 39 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.09it/s]
Epoch 13 : Training Loss: 0.94917, acc: 0.26800, kappa: 0.08500, f1: 0.26483, LR: 0.00003, Time elapsed 0.33 mins
[[53 27 22 26 22]
 [36 51 20 25 18]
 [28 32 31 25 34]
 [27 33 23 32 35]
 [34 32 23 27 34]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26800, kappa: 0.08500, f1: 0.26483
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.64it/s]
Epoch 14 : Training Loss: 0.89468, acc: 0.25467, kappa: 0.06833, f1: 0.25229, LR: 0.00003, Time elapsed 0.33 mins
[[48 25 24 27 26]
 [43 43 23 18 23]
 [32 25 38 20 35]
 [34 28 31 24 33]
 [34 26 27 25 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.00it/s]
Epoch 15 : Training Loss: 0.83654, acc: 0.27733, kappa: 0.09667, f1: 0.27627, LR: 0.00003, Time elapsed 0.32 mins
[[35 29 11 45 30]
 [21 54 11 35 29]
 [20 28 31 39 32]
 [17 34 15 44 40]
 [18 29 24 35 44]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27733, kappa: 0.09667, f1: 0.27627
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.47it/s]
Epoch 16 : Training Loss: 0.78150, acc: 0.26533, kappa: 0.08167, f1: 0.26578, LR: 0.00003, Time elapsed 0.34 mins
[[42 23 19 33 33]
 [37 35 23 32 23]
 [30 16 40 30 34]
 [31 18 22 38 41]
 [30 16 31 29 44]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.43it/s]
Epoch 17 : Training Loss: 0.73194, acc: 0.28000, kappa: 0.10000, f1: 0.27967, LR: 0.00003, Time elapsed 0.32 mins
[[50 21 22 34 23]
 [38 44 16 30 22]
 [30 22 34 31 33]
 [31 25 21 42 31]
 [34 17 28 31 40]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28000, kappa: 0.10000, f1: 0.27967
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.90it/s]
Epoch 18 : Training Loss: 0.67584, acc: 0.27200, kappa: 0.09000, f1: 0.27250, LR: 0.00003, Time elapsed 0.34 mins
[[38 24 22 41 25]
 [32 43 19 38 18]
 [28 23 40 34 25]
 [27 29 17 45 32]
 [23 27 28 34 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.40it/s]
Epoch 19 : Training Loss: 0.64545, acc: 0.28533, kappa: 0.10667, f1: 0.28578, LR: 0.00003, Time elapsed 0.32 mins
[[47 24 20 31 28]
 [32 44 25 27 22]
 [27 21 48 27 27]
 [26 28 21 38 37]
 [33 21 27 32 37]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28533, kappa: 0.10667, f1: 0.28578
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.24it/s]
Epoch 20 : Training Loss: 0.60229, acc: 0.28400, kappa: 0.10500, f1: 0.28215, LR: 0.00003, Time elapsed 0.32 mins
[[34 36 28 31 21]
 [28 57 18 25 22]
 [24 31 46 25 24]
 [23 30 25 36 36]
 [25 28 29 28 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.96it/s]
Epoch 21 : Training Loss: 0.56638, acc: 0.26533, kappa: 0.08167, f1: 0.26519, LR: 0.00003, Time elapsed 0.33 mins
[[43 21 23 45 18]
 [34 39 17 44 16]
 [28 24 39 37 22]
 [30 25 22 47 26]
 [36 21 25 37 31]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.28it/s]
Epoch 22 : Training Loss: 0.55026, acc: 0.28400, kappa: 0.10500, f1: 0.28325, LR: 0.00002, Time elapsed 0.33 mins
[[44 29 17 31 29]
 [33 50 16 25 26]
 [27 32 35 23 33]
 [27 27 19 39 38]
 [26 29 22 28 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.12it/s]
Epoch 23 : Training Loss: 0.52846, acc: 0.29333, kappa: 0.11667, f1: 0.29416, LR: 0.00002, Time elapsed 0.33 mins
[[41 21 26 32 30]
 [33 44 18 30 25]
 [24 14 48 28 36]
 [28 23 25 38 36]
 [29 18 28 26 49]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.29333, kappa: 0.11667, f1: 0.29416
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.90it/s]
Epoch 24 : Training Loss: 0.51546, acc: 0.26933, kappa: 0.08667, f1: 0.26982, LR: 0.00002, Time elapsed 0.34 mins
[[40 32 15 37 26]
 [32 47 16 40 15]
 [22 35 35 34 24]
 [25 36 19 42 28]
 [26 28 20 38 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:17<00:00,  3.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.01it/s]
Epoch 25 : Training Loss: 0.50380, acc: 0.25333, kappa: 0.06667, f1: 0.25236, LR: 0.00002, Time elapsed 0.31 mins
[[31 18 24 34 43]
 [30 33 25 29 33]
 [20 17 46 26 41]
 [22 23 27 33 45]
 [26 21 31 25 47]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.14it/s]
Epoch 26 : Training Loss: 0.48708, acc: 0.25333, kappa: 0.06667, f1: 0.25205, LR: 0.00002, Time elapsed 0.35 mins
[[49 13 30 26 32]
 [46 30 21 28 25]
 [32 16 44 28 30]
 [46 20 23 28 33]
 [42 15 27 27 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.78it/s]
Epoch 27 : Training Loss: 0.48166, acc: 0.26400, kappa: 0.08000, f1: 0.26393, LR: 0.00002, Time elapsed 0.34 mins
[[48 21 23 31 27]
 [38 43 13 31 25]
 [32 24 35 29 30]
 [40 28 16 36 30]
 [38 23 26 27 36]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.21it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.96it/s]
Epoch 28 : Training Loss: 0.47022, acc: 0.27733, kappa: 0.09667, f1: 0.27639, LR: 0.00002, Time elapsed 0.30 mins
[[53 22 17 27 31]
 [40 44 20 24 22]
 [38 22 42 20 28]
 [38 31 20 30 31]
 [38 25 22 26 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.18it/s]
Epoch 29 : Training Loss: 0.46426, acc: 0.26533, kappa: 0.08167, f1: 0.26440, LR: 0.00002, Time elapsed 0.33 mins
[[30 21 28 43 28]
 [29 38 23 41 19]
 [23 21 43 34 29]
 [25 24 21 50 30]
 [28 23 27 34 38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.99it/s]
Epoch 30 : Training Loss: 0.45843, acc: 0.27467, kappa: 0.09333, f1: 0.27469, LR: 0.00001, Time elapsed 0.34 mins
[[41 16 23 37 33]
 [33 37 23 32 25]
 [27 18 38 32 35]
 [26 24 20 41 39]
 [32 18 23 28 49]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.08it/s]
Epoch 31 : Training Loss: 0.45326, acc: 0.28533, kappa: 0.10667, f1: 0.28588, LR: 0.00001, Time elapsed 0.33 mins
[[40 21 27 34 28]
 [35 44 23 32 16]
 [21 24 46 31 28]
 [26 28 21 42 33]
 [30 18 31 29 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.00it/s]
Epoch 32 : Training Loss: 0.44886, acc: 0.27200, kappa: 0.09000, f1: 0.27202, LR: 0.00001, Time elapsed 0.33 mins
[[42 25 19 34 30]
 [31 47 18 36 18]
 [22 30 39 32 27]
 [32 27 22 42 27]
 [33 27 25 31 34]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.14it/s]
Epoch 33 : Training Loss: 0.44480, acc: 0.27200, kappa: 0.09000, f1: 0.27212, LR: 0.00001, Time elapsed 0.34 mins
[[41 18 24 39 28]
 [29 39 26 38 18]
 [25 21 47 31 26]
 [28 28 22 42 30]
 [32 26 30 27 35]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.34it/s]
Epoch 34 : Training Loss: 0.43952, acc: 0.26933, kappa: 0.08667, f1: 0.26904, LR: 0.00001, Time elapsed 0.34 mins
[[35 22 23 37 33]
 [32 37 25 29 27]
 [19 24 44 31 32]
 [23 27 24 41 35]
 [28 21 30 26 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 12.99it/s]
Epoch 35 : Training Loss: 0.43538, acc: 0.26800, kappa: 0.08500, f1: 0.26707, LR: 0.00001, Time elapsed 0.33 mins
[[43 27 21 28 31]
 [32 49 20 30 19]
 [25 34 37 29 25]
 [30 36 19 39 26]
 [36 30 26 25 33]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.24it/s]
Epoch 36 : Training Loss: 0.43193, acc: 0.28000, kappa: 0.10000, f1: 0.28054, LR: 0.00001, Time elapsed 0.33 mins
[[43 21 23 33 30]
 [36 47 21 26 20]
 [24 25 43 31 27]
 [30 29 22 38 31]
 [34 23 26 28 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.42it/s]
Epoch 37 : Training Loss: 0.42959, acc: 0.27333, kappa: 0.09167, f1: 0.27409, LR: 0.00001, Time elapsed 0.33 mins
[[37 18 25 37 33]
 [32 43 22 34 19]
 [18 25 46 33 28]
 [28 28 22 40 32]
 [31 23 28 29 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.22it/s]
Epoch 38 : Training Loss: 0.42772, acc: 0.27733, kappa: 0.09667, f1: 0.27835, LR: 0.00001, Time elapsed 0.34 mins
[[37 18 23 38 34]
 [33 43 21 31 22]
 [23 23 46 29 29]
 [30 27 19 42 32]
 [32 21 29 28 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.48it/s]
Epoch 39 : Training Loss: 0.42701, acc: 0.28667, kappa: 0.10833, f1: 0.28709, LR: 0.00001, Time elapsed 0.33 mins
[[39 15 25 35 36]
 [34 40 24 28 24]
 [23 20 49 28 30]
 [25 22 24 42 37]
 [28 20 30 27 45]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.10it/s]
Epoch 40 : Training Loss: 0.42435, acc: 0.26800, kappa: 0.08500, f1: 0.26803, LR: 0.00000, Time elapsed 0.34 mins
[[41 19 18 38 34]
 [36 45 18 30 21]
 [26 29 33 33 29]
 [32 26 17 42 33]
 [33 24 25 28 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.10it/s]
Epoch 41 : Training Loss: 0.42251, acc: 0.27600, kappa: 0.09500, f1: 0.27668, LR: 0.00000, Time elapsed 0.33 mins
[[42 18 21 35 34]
 [36 43 21 27 23]
 [25 26 41 28 30]
 [28 27 22 39 34]
 [31 21 27 29 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.79it/s]
Epoch 42 : Training Loss: 0.42065, acc: 0.27333, kappa: 0.09167, f1: 0.27387, LR: 0.00000, Time elapsed 0.33 mins
[[43 16 24 36 31]
 [35 43 23 30 19]
 [27 25 44 30 24]
 [31 26 22 40 31]
 [35 23 29 28 35]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:16<00:00,  4.21it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.82it/s]
Epoch 43 : Training Loss: 0.41899, acc: 0.27600, kappa: 0.09500, f1: 0.27624, LR: 0.00000, Time elapsed 0.29 mins
[[41 20 23 37 29]
 [32 46 24 29 19]
 [26 26 42 31 25]
 [30 29 21 42 28]
 [31 25 28 30 36]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.06it/s]
Epoch 44 : Training Loss: 0.41835, acc: 0.28000, kappa: 0.10000, f1: 0.28056, LR: 0.00000, Time elapsed 0.33 mins
[[43 16 19 40 32]
 [35 42 23 30 20]
 [28 23 38 34 27]
 [29 22 22 47 30]
 [33 18 26 33 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.24it/s]
Epoch 45 : Training Loss: 0.41898, acc: 0.27600, kappa: 0.09500, f1: 0.27663, LR: 0.00000, Time elapsed 0.33 mins
[[41 17 21 37 34]
 [33 43 21 29 24]
 [25 27 39 28 31]
 [26 25 22 42 35]
 [31 20 27 30 42]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 13.53it/s]
Epoch 46 : Training Loss: 0.41860, acc: 0.27333, kappa: 0.09167, f1: 0.27402, LR: 0.00000, Time elapsed 0.32 mins
[[39 20 20 38 33]
 [33 44 23 30 20]
 [25 26 40 30 29]
 [28 23 23 43 33]
 [31 21 28 31 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:20<00:00,  3.50it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.47it/s]
Epoch 47 : Training Loss: 0.41868, acc: 0.27333, kappa: 0.09167, f1: 0.27391, LR: 0.00000, Time elapsed 0.35 mins
[[43 17 22 36 32]
 [33 44 23 30 20]
 [27 26 41 29 27]
 [28 25 23 41 33]
 [34 22 29 29 36]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.12it/s]
Epoch 48 : Training Loss: 0.41802, acc: 0.27333, kappa: 0.09167, f1: 0.27389, LR: 0.00000, Time elapsed 0.33 mins
[[45 16 20 37 32]
 [34 42 23 30 21]
 [29 23 40 30 28]
 [29 25 21 42 33]
 [35 23 27 29 36]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:19<00:00,  3.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:01<00:00, 11.86it/s]
Epoch 49 : Training Loss: 0.41675, acc: 0.27333, kappa: 0.09167, f1: 0.27404, LR: 0.00000, Time elapsed 0.35 mins
[[42 17 20 38 33]
 [34 43 24 28 21]
 [29 23 39 30 29]
 [28 25 21 42 34]
 [33 23 27 28 39]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:18<00:00,  3.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.08it/s]
Epoch 50 : Training Loss: 0.41739, acc: 0.27600, kappa: 0.09500, f1: 0.27676, LR: 0.00000, Time elapsed 0.32 mins
[[43 17 21 37 32]
 [33 45 23 29 20]
 [29 23 41 29 28]
 [26 26 23 41 34]
 [34 23 27 29 37]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 14.00it/s]
***************************Test results************************
Test Evaluation: acc: 0.25333, kappa: 0.06667, f1: 0.25125
[[39 19 29 24 39]
 [29 29 26 30 36]
 [31 19 40 26 34]
 [27 25 19 30 49]
 [24 17 21 36 52]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch23_acc_0.25333_kappa_0.06667_f1_0.25125.pth
[32m[I 2025-08-29 02:36:24,090][0m Trial 7 finished with value: 0.06666666666666665 and parameters: {'lr': 3.971084710792477e-05, 'weight_decay': 1.6529856983237873e-06, '--dropout': 0.12150897038028768, '--clip_value': 0.7557861855309373}. Best is trial 3 with value: 0.3583333333333333.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=1.4982086432155468e-06, weight_decay=0.02875972156225962, optimizer='AdamW', clip_value=1.7125960221746916, dropout=0.19312640661491187, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.19312640661491187, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.19312640661491187, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
