100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.74it/s]
Epoch 1 : Training Loss: 1.78892, acc: 0.21600, kappa: 0.02000, f1: 0.12313, LR: 0.00027, Time elapsed 0.25 mins
[[96 54  0  0  0]
 [84 66  0  0  0]
 [95 55  0  0  0]
 [97 53  0  0  0]
 [93 57  0  0  0]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.21600, kappa: 0.02000, f1: 0.12313
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.95it/s]
Epoch 2 : Training Loss: 1.64099, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00027, Time elapsed 0.25 mins
[[  0   0 150   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.79it/s]
Epoch 3 : Training Loss: 1.63534, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00027, Time elapsed 0.25 mins
[[  0   0   0 150   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]
 [  0   0   0 150   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.92it/s]
Epoch 4 : Training Loss: 1.67268, acc: 0.20400, kappa: 0.00500, f1: 0.11195, LR: 0.00027, Time elapsed 0.25 mins
[[111   0   0  39   0]
 [121   0   0  29   0]
 [114   0   0  36   0]
 [108   0   0  42   0]
 [106   0   0  44   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.82it/s]
Epoch 5 : Training Loss: 1.63232, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00026, Time elapsed 0.25 mins
[[  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.80it/s]
Epoch 6 : Training Loss: 1.63675, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00026, Time elapsed 0.25 mins
[[150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]
 [150   0   0   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.77it/s]
Epoch 7 : Training Loss: 1.62831, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00026, Time elapsed 0.25 mins
[[  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]
 [  0   0   0   0 150]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.79it/s]
Epoch 8 : Training Loss: 1.62820, acc: 0.20000, kappa: 0.00000, f1: 0.06667, LR: 0.00025, Time elapsed 0.25 mins
[[  0   0 150   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]
 [  0   0 150   0   0]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.68it/s]
Epoch 9 : Training Loss: 1.62446, acc: 0.21067, kappa: 0.01333, f1: 0.11100, LR: 0.00025, Time elapsed 0.25 mins
[[  0 121   0   0  29]
 [  0 124   0   0  26]
 [  0 109   0   0  41]
 [  0 122   0   0  28]
 [  0 116   0   0  34]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.92it/s]
Epoch 10 : Training Loss: 1.63084, acc: 0.20267, kappa: 0.00333, f1: 0.07450, LR: 0.00024, Time elapsed 0.25 mins
[[  0 147   0   0   3]
 [  0 149   0   0   1]
 [  0 146   0   0   4]
 [  0 150   0   0   0]
 [  0 147   0   0   3]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.10it/s]
Epoch 11 : Training Loss: 1.62877, acc: 0.21200, kappa: 0.01500, f1: 0.13475, LR: 0.00024, Time elapsed 0.25 mins
[[  0 112   0   9  29]
 [  0 109   0  10  31]
 [  0  85   0  13  52]
 [  0 100   0  12  38]
 [  0 101   0  11  38]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.02it/s]
Epoch 12 : Training Loss: 1.60958, acc: 0.22800, kappa: 0.03500, f1: 0.17470, LR: 0.00023, Time elapsed 0.25 mins
[[101  21  23   0   5]
 [107  21  15   0   7]
 [ 87   8  40   0  15]
 [107  15  25   0   3]
 [ 97  18  26   0   9]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.22800, kappa: 0.03500, f1: 0.17470
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.01it/s]
Epoch 13 : Training Loss: 1.59662, acc: 0.24667, kappa: 0.05833, f1: 0.19578, LR: 0.00023, Time elapsed 0.25 mins
[[ 13  81   0  42  14]
 [  9 102   0  25  14]
 [ 11  61   1  56  21]
 [ 14  79   0  39  18]
 [  6  72   0  42  30]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24667, kappa: 0.05833, f1: 0.19578
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.52it/s]
Epoch 14 : Training Loss: 1.57935, acc: 0.24533, kappa: 0.05667, f1: 0.15952, LR: 0.00022, Time elapsed 0.25 mins
[[  0  65  82   0   3]
 [  1  69  76   0   4]
 [  1  38 104   0   7]
 [  0  63  84   0   3]
 [  2  50  87   0  11]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.89it/s]
Epoch 15 : Training Loss: 1.54471, acc: 0.26533, kappa: 0.08167, f1: 0.25261, LR: 0.00021, Time elapsed 0.25 mins
[[19 59 17 43 12]
 [17 76 15 34  8]
 [ 9 42 39 41 19]
 [17 53 19 41 20]
 [ 9 46 19 52 24]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26533, kappa: 0.08167, f1: 0.25261
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.96it/s]
Epoch 16 : Training Loss: 1.49466, acc: 0.26667, kappa: 0.08333, f1: 0.25608, LR: 0.00021, Time elapsed 0.25 mins
[[17  9 12 93 19]
 [15 38 16 64 17]
 [12 13 27 60 38]
 [15 11 15 80 29]
 [15 11 12 74 38]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26667, kappa: 0.08333, f1: 0.25608
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.19it/s]
Epoch 17 : Training Loss: 1.39475, acc: 0.29067, kappa: 0.11333, f1: 0.28421, LR: 0.00020, Time elapsed 0.25 mins
[[21 19 23 55 32]
 [22 35 22 47 24]
 [11  8 47 35 49]
 [12 14 25 59 40]
 [11 19 17 47 56]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.29067, kappa: 0.11333, f1: 0.28421
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.91it/s]
Epoch 18 : Training Loss: 1.25397, acc: 0.32933, kappa: 0.16167, f1: 0.32704, LR: 0.00019, Time elapsed 0.25 mins
[[68 27 14 18 23]
 [39 50 22 22 17]
 [29 15 54 20 32]
 [53 19 14 31 33]
 [49 25 17 15 44]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.32933, kappa: 0.16167, f1: 0.32704
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.93it/s]
Epoch 19 : Training Loss: 1.08087, acc: 0.33867, kappa: 0.17333, f1: 0.33674, LR: 0.00018, Time elapsed 0.25 mins
[[36 34 20 38 22]
 [20 56 23 37 14]
 [12 23 50 38 27]
 [22 28 14 64 22]
 [29 26 17 30 48]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.33867, kappa: 0.17333, f1: 0.33674
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.13it/s]
Epoch 20 : Training Loss: 0.91339, acc: 0.35600, kappa: 0.19500, f1: 0.35690, LR: 0.00018, Time elapsed 0.25 mins
[[47 30 23 31 19]
 [31 57 22 23 17]
 [21 16 57 22 34]
 [29 24 17 53 27]
 [33 26 14 24 53]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.35600, kappa: 0.19500, f1: 0.35690
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.12it/s]
Epoch 21 : Training Loss: 0.77882, acc: 0.37200, kappa: 0.21500, f1: 0.36981, LR: 0.00017, Time elapsed 0.25 mins
[[65 11 15 40 19]
 [38 47 13 39 13]
 [31 14 42 36 27]
 [36 15  7 75 17]
 [41 15 15 29 50]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.37200, kappa: 0.21500, f1: 0.36981
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.21it/s]
Epoch 22 : Training Loss: 0.67902, acc: 0.36133, kappa: 0.20167, f1: 0.35925, LR: 0.00016, Time elapsed 0.25 mins
[[53 18 20 39 20]
 [34 45 15 47  9]
 [24 12 62 26 26]
 [25 19 20 71 15]
 [37 17 23 33 40]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.76it/s]
Epoch 23 : Training Loss: 0.60138, acc: 0.39200, kappa: 0.24000, f1: 0.39207, LR: 0.00015, Time elapsed 0.25 mins
[[71 22 16 23 18]
 [41 47 17 31 14]
 [32 12 60 23 23]
 [35 19 16 62 18]
 [38 20 15 23 54]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.39200, kappa: 0.24000, f1: 0.39207
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.88it/s]
Epoch 24 : Training Loss: 0.56508, acc: 0.39200, kappa: 0.24000, f1: 0.39068, LR: 0.00014, Time elapsed 0.26 mins
[[56 25 20 37 12]
 [32 56 14 33 15]
 [28 18 60 23 21]
 [23 22 16 76 13]
 [37 22 24 21 46]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.12it/s]
Epoch 25 : Training Loss: 0.52518, acc: 0.39867, kappa: 0.24833, f1: 0.39500, LR: 0.00014, Time elapsed 0.25 mins
[[75 20 13 30 12]
 [39 50 15 33 13]
 [33 19 55 22 21]
 [32 19 13 75 11]
 [36 21 25 24 44]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.39867, kappa: 0.24833, f1: 0.39500
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.07it/s]
Epoch 26 : Training Loss: 0.50246, acc: 0.38800, kappa: 0.23500, f1: 0.38628, LR: 0.00013, Time elapsed 0.25 mins
[[48 23 29 33 17]
 [29 52 25 34 10]
 [20 17 73 22 18]
 [25 19 22 67 17]
 [28 22 30 19 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.84it/s]
Epoch 27 : Training Loss: 0.48551, acc: 0.38133, kappa: 0.22667, f1: 0.38154, LR: 0.00012, Time elapsed 0.25 mins
[[60 22 17 30 21]
 [37 49 18 30 16]
 [24 16 65 23 22]
 [28 22 17 61 22]
 [34 19 23 23 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.24it/s]
Epoch 28 : Training Loss: 0.46865, acc: 0.39867, kappa: 0.24833, f1: 0.39820, LR: 0.00011, Time elapsed 0.25 mins
[[65 20 22 30 13]
 [39 49 24 28 10]
 [26 18 69 20 17]
 [31 17 19 65 18]
 [38 19 29 13 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.59it/s]
Epoch 29 : Training Loss: 0.45910, acc: 0.42133, kappa: 0.27667, f1: 0.41940, LR: 0.00010, Time elapsed 0.25 mins
[[62 22 21 31 14]
 [25 55 24 32 14]
 [19 15 75 25 16]
 [22 17 20 72 19]
 [28 19 31 20 52]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42133, kappa: 0.27667, f1: 0.41940
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.04it/s]
Epoch 30 : Training Loss: 0.44853, acc: 0.40933, kappa: 0.26167, f1: 0.40774, LR: 0.00009, Time elapsed 0.25 mins
[[55 29 17 34 15]
 [27 56 21 35 11]
 [22 17 67 27 17]
 [21 16 18 78 17]
 [31 19 24 25 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.87it/s]
Epoch 31 : Training Loss: 0.44395, acc: 0.41333, kappa: 0.26667, f1: 0.41321, LR: 0.00009, Time elapsed 0.25 mins
[[62 26 20 31 11]
 [28 58 19 36  9]
 [22 21 69 24 14]
 [24 21 17 70 18]
 [34 20 23 22 51]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.94it/s]
Epoch 32 : Training Loss: 0.44055, acc: 0.41467, kappa: 0.26833, f1: 0.41341, LR: 0.00008, Time elapsed 0.25 mins
[[68 22 17 28 15]
 [30 56 23 27 14]
 [22 20 71 19 18]
 [32 17 18 66 17]
 [29 21 27 23 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.73it/s]
Epoch 33 : Training Loss: 0.43597, acc: 0.41467, kappa: 0.26833, f1: 0.41286, LR: 0.00007, Time elapsed 0.25 mins
[[68 20 18 31 13]
 [31 54 20 34 11]
 [26 19 67 22 16]
 [26 16 18 74 16]
 [36 19 24 23 48]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.94it/s]
Epoch 34 : Training Loss: 0.43419, acc: 0.40800, kappa: 0.26000, f1: 0.40644, LR: 0.00006, Time elapsed 0.25 mins
[[64 20 23 27 16]
 [28 53 20 37 12]
 [23 16 70 22 19]
 [28 16 18 70 18]
 [32 19 26 24 49]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.95it/s]
Epoch 35 : Training Loss: 0.43054, acc: 0.39733, kappa: 0.24667, f1: 0.39738, LR: 0.00006, Time elapsed 0.25 mins
[[62 25 19 28 16]
 [30 53 21 27 19]
 [27 20 64 17 22]
 [27 20 20 64 19]
 [33 19 24 19 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.76it/s]
Epoch 36 : Training Loss: 0.42784, acc: 0.41067, kappa: 0.26333, f1: 0.40920, LR: 0.00005, Time elapsed 0.25 mins
[[67 22 19 27 15]
 [34 55 20 28 13]
 [26 15 75 19 15]
 [31 21 19 65 14]
 [38 19 25 22 46]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.65it/s]
Epoch 37 : Training Loss: 0.42670, acc: 0.41733, kappa: 0.27167, f1: 0.41617, LR: 0.00004, Time elapsed 0.25 mins
[[65 22 22 27 14]
 [30 56 24 29 11]
 [23 17 76 19 15]
 [28 22 21 66 13]
 [35 19 24 22 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 15.28it/s]
Epoch 38 : Training Loss: 0.42608, acc: 0.42000, kappa: 0.27500, f1: 0.41910, LR: 0.00004, Time elapsed 0.26 mins
[[59 30 18 29 14]
 [28 58 20 32 12]
 [23 18 76 19 14]
 [27 20 17 72 14]
 [33 19 25 23 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.21it/s]
Epoch 39 : Training Loss: 0.42302, acc: 0.42533, kappa: 0.28167, f1: 0.42495, LR: 0.00003, Time elapsed 0.25 mins
[[67 21 19 28 15]
 [33 53 19 30 15]
 [23 18 74 20 15]
 [30 18 18 69 15]
 [32 17 23 22 56]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42533, kappa: 0.28167, f1: 0.42495
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.75it/s]
Epoch 40 : Training Loss: 0.42350, acc: 0.42533, kappa: 0.28167, f1: 0.42500, LR: 0.00003, Time elapsed 0.25 mins
[[67 23 18 27 15]
 [32 55 19 31 13]
 [25 17 74 19 15]
 [27 19 21 68 15]
 [32 18 23 22 55]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.05it/s]
Epoch 41 : Training Loss: 0.42142, acc: 0.42933, kappa: 0.28667, f1: 0.42856, LR: 0.00002, Time elapsed 0.25 mins
[[67 22 18 28 15]
 [31 55 21 30 13]
 [24 17 74 21 14]
 [27 18 20 72 13]
 [32 18 23 23 54]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.42933, kappa: 0.28667, f1: 0.42856
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.73it/s]
Epoch 42 : Training Loss: 0.42199, acc: 0.42133, kappa: 0.27667, f1: 0.41987, LR: 0.00002, Time elapsed 0.25 mins
[[68 22 19 28 13]
 [31 56 21 31 11]
 [24 17 72 21 16]
 [26 19 20 71 14]
 [37 17 25 22 49]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.17it/s]
Epoch 43 : Training Loss: 0.42073, acc: 0.42400, kappa: 0.28000, f1: 0.42298, LR: 0.00001, Time elapsed 0.25 mins
[[69 20 18 28 15]
 [29 58 21 30 12]
 [23 18 71 20 18]
 [25 20 20 68 17]
 [33 18 26 21 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.93it/s]
Epoch 44 : Training Loss: 0.42077, acc: 0.43067, kappa: 0.28833, f1: 0.42949, LR: 0.00001, Time elapsed 0.25 mins
[[69 21 19 27 14]
 [30 57 20 30 13]
 [23 18 75 19 15]
 [24 20 21 69 16]
 [33 17 26 21 53]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.43067, kappa: 0.28833, f1: 0.42949
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.70it/s]
Epoch 45 : Training Loss: 0.41990, acc: 0.42667, kappa: 0.28333, f1: 0.42518, LR: 0.00001, Time elapsed 0.25 mins
[[69 22 19 28 12]
 [31 56 22 30 11]
 [23 17 74 22 14]
 [26 19 21 71 13]
 [35 17 25 23 50]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.92it/s]
Epoch 46 : Training Loss: 0.41893, acc: 0.43067, kappa: 0.28833, f1: 0.42947, LR: 0.00001, Time elapsed 0.25 mins
[[69 20 19 27 15]
 [30 57 22 30 11]
 [23 17 74 22 14]
 [26 19 20 71 14]
 [33 17 25 23 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.10it/s]
Epoch 47 : Training Loss: 0.41850, acc: 0.42800, kappa: 0.28500, f1: 0.42683, LR: 0.00000, Time elapsed 0.25 mins
[[67 22 19 27 15]
 [29 57 21 32 11]
 [23 17 73 22 15]
 [25 18 20 72 15]
 [31 17 25 25 52]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.99it/s]
Epoch 48 : Training Loss: 0.41845, acc: 0.42800, kappa: 0.28500, f1: 0.42721, LR: 0.00000, Time elapsed 0.25 mins
[[66 22 20 28 14]
 [29 58 21 31 11]
 [23 17 73 22 15]
 [25 19 20 71 15]
 [31 17 26 23 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.96it/s]
Epoch 49 : Training Loss: 0.41840, acc: 0.42933, kappa: 0.28667, f1: 0.42846, LR: 0.00000, Time elapsed 0.25 mins
[[68 21 19 28 14]
 [30 58 21 30 11]
 [23 17 72 22 16]
 [25 19 20 71 15]
 [31 17 26 23 53]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.00it/s]
Epoch 50 : Training Loss: 0.41915, acc: 0.42667, kappa: 0.28333, f1: 0.42563, LR: 0.00000, Time elapsed 0.25 mins
[[68 20 20 28 14]
 [29 59 22 30 10]
 [23 17 72 22 16]
 [26 19 20 70 15]
 [32 17 26 24 51]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.64it/s]
***************************Test results************************
Test Evaluation: acc: 0.41467, kappa: 0.26833, f1: 0.41350
[[69 19 16 31 15]
 [33 64 20 22 11]
 [23 19 71 18 19]
 [32 21 20 60 17]
 [30 19 27 27 47]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch44_acc_0.41467_kappa_0.26833_f1_0.41350.pth
[32m[I 2025-08-29 15:04:24,477][0m Trial 32 finished with value: 0.2683333333333333 and parameters: {'lr': 0.00026995710399638966, 'weight_decay': 0.003980996186679751, '--dropout': 0.15455858907458497, '--clip_value': 1.6651134520073787}. Best is trial 21 with value: 0.345.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.00010482162652766126, weight_decay=0.0007031271127364459, optimizer='AdamW', clip_value=1.8552633528362135, dropout=0.13256253331454732, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.13256253331454732, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.13256253331454732, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
