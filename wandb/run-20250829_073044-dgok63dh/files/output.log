100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:11<00:00,  5.95it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.59it/s]
Epoch 1 : Training Loss: 1.61131, acc: 0.20267, kappa: 0.00333, f1: 0.14765, LR: 0.00000, Time elapsed 0.21 mins
[[ 24   1  32   2  91]
 [ 13   1  33   4  99]
 [ 14   0  24   3 109]
 [ 21   0  31   5  93]
 [ 21   0  26   5  98]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.20267, kappa: 0.00333, f1: 0.14765
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.82it/s]
Epoch 2 : Training Loss: 1.60780, acc: 0.24133, kappa: 0.05167, f1: 0.22804, LR: 0.00000, Time elapsed 0.21 mins
[[14 12 53 18 53]
 [ 8 23 53 14 52]
 [ 2 11 56 20 61]
 [ 6 16 41 31 56]
 [ 6  7 51 29 57]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24133, kappa: 0.05167, f1: 0.22804
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.02it/s]
Epoch 3 : Training Loss: 1.60471, acc: 0.23600, kappa: 0.04500, f1: 0.21475, LR: 0.00000, Time elapsed 0.21 mins
[[12 21 36 72  9]
 [ 7 31 39 56 17]
 [ 2 18 41 72 17]
 [10 23 26 76 15]
 [ 6 12 35 80 17]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 4 : Training Loss: 1.60030, acc: 0.23867, kappa: 0.04833, f1: 0.21481, LR: 0.00000, Time elapsed 0.21 mins
[[14 14 22 69 31]
 [11 17 18 64 40]
 [ 5  7 23 71 44]
 [ 9 11 12 78 40]
 [ 4  7 23 69 47]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.63it/s]
Epoch 5 : Training Loss: 1.59714, acc: 0.26667, kappa: 0.08333, f1: 0.26268, LR: 0.00000, Time elapsed 0.21 mins
[[22 33 36 38 21]
 [ 9 50 33 31 27]
 [ 7 27 44 37 35]
 [16 33 27 44 30]
 [ 8 28 36 38 40]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26667, kappa: 0.08333, f1: 0.26268
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.25it/s]
Epoch 6 : Training Loss: 1.59564, acc: 0.26267, kappa: 0.07833, f1: 0.25547, LR: 0.00000, Time elapsed 0.21 mins
[[22 23 38 47 20]
 [14 30 33 46 27]
 [10 16 44 50 30]
 [17 20 28 62 23]
 [11 14 33 53 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.89it/s]
Epoch 7 : Training Loss: 1.59120, acc: 0.27067, kappa: 0.08833, f1: 0.25913, LR: 0.00000, Time elapsed 0.21 mins
[[22 38 37 38 15]
 [11 60 45 23 11]
 [ 9 33 55 38 15]
 [16 36 41 45 12]
 [17 31 48 33 21]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27067, kappa: 0.08833, f1: 0.25913
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.90it/s]
Epoch 8 : Training Loss: 1.58702, acc: 0.28400, kappa: 0.10500, f1: 0.27986, LR: 0.00000, Time elapsed 0.21 mins
[[27 42 32 33 16]
 [18 61 35 17 19]
 [15 33 45 34 23]
 [22 43 26 41 18]
 [21 36 30 24 39]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.28400, kappa: 0.10500, f1: 0.27986
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.04it/s]
Epoch 9 : Training Loss: 1.58183, acc: 0.27200, kappa: 0.09000, f1: 0.27202, LR: 0.00000, Time elapsed 0.21 mins
[[48 32 26 27 17]
 [44 44 26 15 21]
 [37 22 36 28 27]
 [39 33 25 36 17]
 [37 24 21 28 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.83it/s]
Epoch 10 : Training Loss: 1.57833, acc: 0.26800, kappa: 0.08500, f1: 0.26761, LR: 0.00000, Time elapsed 0.22 mins
[[39 34 33 28 16]
 [34 46 38 15 17]
 [30 27 46 27 20]
 [30 34 35 36 15]
 [29 27 31 29 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.77it/s]
Epoch 11 : Training Loss: 1.57468, acc: 0.27867, kappa: 0.09833, f1: 0.27727, LR: 0.00000, Time elapsed 0.21 mins
[[32 38 30 39 11]
 [22 52 39 20 17]
 [20 28 48 33 21]
 [22 37 37 42 12]
 [18 32 30 35 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.34it/s]
Epoch 12 : Training Loss: 1.57193, acc: 0.25333, kappa: 0.06667, f1: 0.25320, LR: 0.00000, Time elapsed 0.21 mins
[[44 35 26 28 17]
 [42 42 29 17 20]
 [36 26 37 26 25]
 [41 32 32 33 12]
 [32 34 22 28 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.69it/s]
Epoch 13 : Training Loss: 1.56788, acc: 0.25733, kappa: 0.07167, f1: 0.25738, LR: 0.00000, Time elapsed 0.21 mins
[[42 36 25 27 20]
 [36 42 24 21 27]
 [32 30 37 23 28]
 [33 34 34 35 14]
 [30 37 19 27 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.96it/s]
Epoch 14 : Training Loss: 1.56220, acc: 0.25733, kappa: 0.07167, f1: 0.25669, LR: 0.00000, Time elapsed 0.21 mins
[[41 43 23 26 17]
 [38 50 21 21 20]
 [35 38 36 15 26]
 [37 41 30 32 10]
 [29 45 16 26 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.87it/s]
Epoch 15 : Training Loss: 1.56092, acc: 0.26133, kappa: 0.07667, f1: 0.26123, LR: 0.00000, Time elapsed 0.22 mins
[[44 39 18 34 15]
 [35 45 21 25 24]
 [34 31 32 24 29]
 [39 36 25 36 14]
 [30 39 14 28 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.22it/s]
Epoch 16 : Training Loss: 1.55791, acc: 0.26000, kappa: 0.07500, f1: 0.25666, LR: 0.00000, Time elapsed 0.21 mins
[[26 47 23 41 13]
 [23 54 25 26 22]
 [20 39 39 26 26]
 [21 39 33 43 14]
 [14 42 23 38 33]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.69it/s]
Epoch 17 : Training Loss: 1.55576, acc: 0.24800, kappa: 0.06000, f1: 0.24456, LR: 0.00000, Time elapsed 0.21 mins
[[51 24 14 44 17]
 [45 31 17 27 30]
 [42 17 24 32 35]
 [45 25 24 42 14]
 [41 24 13 34 38]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.58it/s]
Epoch 18 : Training Loss: 1.55324, acc: 0.25333, kappa: 0.06667, f1: 0.25077, LR: 0.00000, Time elapsed 0.21 mins
[[51 31 15 38 15]
 [46 38 18 23 25]
 [41 24 25 30 30]
 [45 28 23 40 14]
 [39 31 16 28 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.94it/s]
Epoch 19 : Training Loss: 1.54605, acc: 0.25067, kappa: 0.06333, f1: 0.24848, LR: 0.00000, Time elapsed 0.21 mins
[[41 36 15 46 12]
 [37 48 20 28 17]
 [36 29 27 30 28]
 [41 33 24 42 10]
 [26 37 17 40 30]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.38it/s]
Epoch 20 : Training Loss: 1.54763, acc: 0.25600, kappa: 0.07000, f1: 0.25378, LR: 0.00000, Time elapsed 0.21 mins
[[33 41 14 47 15]
 [29 50 18 30 23]
 [26 33 27 34 30]
 [29 39 23 45 14]
 [20 39 13 41 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 21 : Training Loss: 1.54382, acc: 0.25467, kappa: 0.06833, f1: 0.25487, LR: 0.00000, Time elapsed 0.21 mins
[[36 36 20 44 14]
 [31 42 26 30 21]
 [32 29 35 30 24]
 [36 31 28 44 11]
 [21 34 20 41 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 22 : Training Loss: 1.54166, acc: 0.25733, kappa: 0.07167, f1: 0.25559, LR: 0.00000, Time elapsed 0.21 mins
[[54 25 23 29 19]
 [50 33 22 20 25]
 [43 22 35 17 33]
 [52 26 29 31 12]
 [39 25 20 26 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.56it/s]
Epoch 23 : Training Loss: 1.53746, acc: 0.25067, kappa: 0.06333, f1: 0.24953, LR: 0.00000, Time elapsed 0.21 mins
[[38 37 14 44 17]
 [39 44 14 30 23]
 [37 31 26 27 29]
 [43 32 19 45 11]
 [29 34 13 39 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.69it/s]
Epoch 24 : Training Loss: 1.53849, acc: 0.25600, kappa: 0.07000, f1: 0.25048, LR: 0.00000, Time elapsed 0.21 mins
[[53 30 15 46  6]
 [48 40 16 34 12]
 [45 26 31 28 20]
 [44 30 22 47  7]
 [35 30 18 46 21]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.77it/s]
Epoch 25 : Training Loss: 1.53162, acc: 0.26400, kappa: 0.08000, f1: 0.26192, LR: 0.00000, Time elapsed 0.21 mins
[[37 39 16 34 24]
 [32 48 15 26 29]
 [33 33 27 17 40]
 [34 36 21 40 19]
 [23 36 17 28 46]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.81it/s]
Epoch 26 : Training Loss: 1.52788, acc: 0.24667, kappa: 0.05833, f1: 0.24504, LR: 0.00000, Time elapsed 0.21 mins
[[33 29 17 51 20]
 [37 36 16 34 27]
 [31 26 27 33 33]
 [34 28 23 49 16]
 [22 31 17 40 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.74it/s]
Epoch 27 : Training Loss: 1.52842, acc: 0.25867, kappa: 0.07333, f1: 0.25888, LR: 0.00000, Time elapsed 0.21 mins
[[35 35 19 37 24]
 [32 39 24 28 27]
 [31 29 36 20 34]
 [31 30 28 41 20]
 [22 34 18 33 43]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.93it/s]
Epoch 28 : Training Loss: 1.52590, acc: 0.25467, kappa: 0.06833, f1: 0.25320, LR: 0.00000, Time elapsed 0.21 mins
[[42 30 17 41 20]
 [39 39 15 28 29]
 [36 29 26 24 35]
 [40 29 21 42 18]
 [26 33 15 34 42]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.49it/s]
Epoch 29 : Training Loss: 1.52359, acc: 0.25467, kappa: 0.06833, f1: 0.25458, LR: 0.00000, Time elapsed 0.21 mins
[[40 34 20 32 24]
 [37 37 24 23 29]
 [35 28 35 15 37]
 [40 27 26 34 23]
 [28 30 22 25 45]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 30 : Training Loss: 1.52258, acc: 0.26000, kappa: 0.07500, f1: 0.25912, LR: 0.00000, Time elapsed 0.21 mins
[[46 33 16 33 22]
 [40 38 18 25 29]
 [40 27 30 16 37]
 [43 28 23 36 20]
 [31 32 15 27 45]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.71it/s]
Epoch 31 : Training Loss: 1.51873, acc: 0.26667, kappa: 0.08333, f1: 0.26721, LR: 0.00000, Time elapsed 0.21 mins
[[41 29 20 43 17]
 [37 38 22 28 25]
 [34 26 40 22 28]
 [40 27 24 44 15]
 [23 31 23 36 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.91it/s]
Epoch 32 : Training Loss: 1.51146, acc: 0.26400, kappa: 0.08000, f1: 0.26399, LR: 0.00000, Time elapsed 0.22 mins
[[46 25 21 39 19]
 [43 32 27 23 25]
 [39 22 41 19 29]
 [43 25 27 37 18]
 [31 23 27 27 42]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.73it/s]
Epoch 33 : Training Loss: 1.51618, acc: 0.26267, kappa: 0.07833, f1: 0.26171, LR: 0.00000, Time elapsed 0.21 mins
[[43 27 17 45 18]
 [37 38 16 33 26]
 [37 26 28 25 34]
 [40 27 21 44 18]
 [26 28 16 36 44]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.61it/s]
Epoch 34 : Training Loss: 1.50846, acc: 0.26667, kappa: 0.08333, f1: 0.26688, LR: 0.00000, Time elapsed 0.21 mins
[[43 26 19 43 19]
 [40 36 19 29 26]
 [37 24 34 21 34]
 [42 25 22 43 18]
 [27 27 18 34 44]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.73it/s]
Epoch 35 : Training Loss: 1.51029, acc: 0.26533, kappa: 0.08167, f1: 0.26441, LR: 0.00000, Time elapsed 0.21 mins
[[46 26 20 36 22]
 [38 35 20 26 31]
 [34 24 35 18 39]
 [39 26 22 35 28]
 [27 27 17 31 48]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.65it/s]
Epoch 36 : Training Loss: 1.50742, acc: 0.26800, kappa: 0.08500, f1: 0.26655, LR: 0.00000, Time elapsed 0.21 mins
[[47 26 18 40 19]
 [43 33 16 28 30]
 [40 23 30 21 36]
 [39 27 18 43 23]
 [30 27 12 33 48]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.28it/s]
Epoch 37 : Training Loss: 1.50169, acc: 0.26400, kappa: 0.08000, f1: 0.26334, LR: 0.00000, Time elapsed 0.21 mins
[[45 26 19 40 20]
 [40 35 18 29 28]
 [36 24 32 21 37]
 [39 27 22 41 21]
 [27 26 17 35 45]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.82it/s]
Epoch 38 : Training Loss: 1.50102, acc: 0.26000, kappa: 0.07500, f1: 0.25881, LR: 0.00000, Time elapsed 0.21 mins
[[49 27 18 36 20]
 [45 34 19 25 27]
 [44 24 31 18 33]
 [43 26 21 36 24]
 [32 26 18 29 45]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.85it/s]
Epoch 39 : Training Loss: 1.50030, acc: 0.25733, kappa: 0.07167, f1: 0.25500, LR: 0.00000, Time elapsed 0.21 mins
[[52 22 19 37 20]
 [46 30 21 25 28]
 [46 20 32 18 34]
 [45 23 24 34 24]
 [32 23 21 29 45]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.66it/s]
Epoch 40 : Training Loss: 1.49786, acc: 0.25600, kappa: 0.07000, f1: 0.25392, LR: 0.00000, Time elapsed 0.21 mins
[[47 23 21 34 25]
 [44 29 25 21 31]
 [40 21 33 17 39]
 [42 22 24 35 27]
 [34 21 22 25 48]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.00it/s]
Epoch 41 : Training Loss: 1.49484, acc: 0.26133, kappa: 0.07667, f1: 0.26056, LR: 0.00000, Time elapsed 0.21 mins
[[45 27 19 39 20]
 [41 34 20 26 29]
 [36 25 33 19 37]
 [37 27 23 38 25]
 [30 25 20 29 46]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.72it/s]
Epoch 42 : Training Loss: 1.49415, acc: 0.26133, kappa: 0.07667, f1: 0.25949, LR: 0.00000, Time elapsed 0.21 mins
[[45 25 18 39 23]
 [40 34 18 25 33]
 [38 23 30 20 39]
 [37 26 21 37 29]
 [29 24 16 31 50]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.81it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.66it/s]
Epoch 43 : Training Loss: 1.49126, acc: 0.26000, kappa: 0.07500, f1: 0.25827, LR: 0.00000, Time elapsed 0.21 mins
[[47 25 18 39 21]
 [42 34 18 25 31]
 [39 23 30 20 38]
 [36 27 22 37 28]
 [30 24 18 31 47]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.03it/s]
Epoch 44 : Training Loss: 1.49238, acc: 0.26000, kappa: 0.07500, f1: 0.25657, LR: 0.00000, Time elapsed 0.21 mins
[[47 24 17 41 21]
 [41 34 16 26 33]
 [41 23 25 20 41]
 [36 26 19 39 30]
 [30 25 14 31 50]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.63it/s]
Epoch 45 : Training Loss: 1.49129, acc: 0.26267, kappa: 0.07833, f1: 0.25872, LR: 0.00000, Time elapsed 0.21 mins
[[46 23 17 40 24]
 [39 33 17 27 34]
 [41 23 25 20 41]
 [34 23 22 40 31]
 [30 22 14 31 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.73it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.92it/s]
Epoch 46 : Training Loss: 1.48752, acc: 0.26000, kappa: 0.07500, f1: 0.25860, LR: 0.00000, Time elapsed 0.22 mins
[[46 23 20 40 21]
 [43 32 24 21 30]
 [42 21 32 19 36]
 [36 24 25 38 27]
 [30 21 23 29 47]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.58it/s]
Epoch 47 : Training Loss: 1.48242, acc: 0.26000, kappa: 0.07500, f1: 0.25536, LR: 0.00000, Time elapsed 0.21 mins
[[47 23 17 38 25]
 [41 34 15 25 35]
 [42 23 23 20 42]
 [36 26 20 38 30]
 [30 22 14 31 53]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.64it/s]
Epoch 48 : Training Loss: 1.48077, acc: 0.26800, kappa: 0.08500, f1: 0.26563, LR: 0.00000, Time elapsed 0.21 mins
[[48 24 17 41 20]
 [40 34 17 29 30]
 [40 23 28 23 36]
 [37 28 19 42 24]
 [27 25 16 33 49]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.05it/s]
Epoch 49 : Training Loss: 1.48631, acc: 0.26000, kappa: 0.07500, f1: 0.25610, LR: 0.00000, Time elapsed 0.21 mins
[[45 25 18 38 24]
 [39 34 16 27 34]
 [40 24 24 22 40]
 [33 26 21 40 30]
 [27 24 15 32 52]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.82it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.74it/s]
Epoch 50 : Training Loss: 1.48018, acc: 0.26800, kappa: 0.08500, f1: 0.26544, LR: 0.00000, Time elapsed 0.21 mins
[[47 24 19 41 19]
 [37 35 17 33 28]
 [39 24 27 23 37]
 [33 27 20 45 25]
 [25 24 18 36 47]]
***************************Test************************
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.59it/s]
***************************Test results************************
Test Evaluation: acc: 0.28800, kappa: 0.11000, f1: 0.28458
[[29 31 32 25 33]
 [17 58 27 27 21]
 [14 30 48 28 30]
 [19 41 31 39 20]
 [19 27 30 32 42]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch8_acc_0.28800_kappa_0.11000_f1_0.28458.pth
[32m[I 2025-08-29 07:41:36,538][0m Trial 8 finished with value: 0.10999999999999999 and parameters: {'lr': 1.4982086432155468e-06, 'weight_decay': 0.02875972156225962, '--dropout': 0.19312640661491187, '--clip_value': 1.7125960221746916}. Best is trial 3 with value: 0.2833333333333333.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=6.639623079859462e-06, weight_decay=2.87712237162379e-06, optimizer='AdamW', clip_value=1.1602287406094018, dropout=0.1368466053024314, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.1368466053024314, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.1368466053024314, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
