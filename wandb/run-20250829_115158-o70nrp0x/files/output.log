100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.87it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.64it/s]
Epoch 1 : Training Loss: 1.62856, acc: 0.23600, kappa: 0.04500, f1: 0.20921, LR: 0.00007, Time elapsed 0.21 mins
[[37 11 59 23 20]
 [40 16 65 18 11]
 [30  8 87 12 13]
 [28 11 69 22 20]
 [32  5 82 16 15]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.23600, kappa: 0.04500, f1: 0.20921
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.20it/s]
Epoch 2 : Training Loss: 1.61136, acc: 0.21333, kappa: 0.01667, f1: 0.10312, LR: 0.00007, Time elapsed 0.21 mins
[[  0   3   7   0 140]
 [  0   7   4   1 138]
 [  0   4   7   0 139]
 [  0   0  11   1 138]
 [  0   2   3   0 145]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.92it/s]
Epoch 3 : Training Loss: 1.58732, acc: 0.22400, kappa: 0.03000, f1: 0.18200, LR: 0.00007, Time elapsed 0.21 mins
[[51 41  1 13 44]
 [55 47  1  8 39]
 [45 29  0 13 63]
 [44 35  2  7 62]
 [45 36  0  6 63]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.83it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.07it/s]
Epoch 4 : Training Loss: 1.54034, acc: 0.24800, kappa: 0.06000, f1: 0.23595, LR: 0.00007, Time elapsed 0.21 mins
[[51 14 14 46 25]
 [44 28  9 32 37]
 [41 12 11 34 52]
 [39 10 13 46 42]
 [48 13  8 31 50]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.24800, kappa: 0.06000, f1: 0.23595
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.79it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.58it/s]
Epoch 5 : Training Loss: 1.47175, acc: 0.22667, kappa: 0.03333, f1: 0.21248, LR: 0.00007, Time elapsed 0.21 mins
[[33  7 17 48 45]
 [35 14 14 43 44]
 [32  7 18 38 55]
 [23  6 17 53 51]
 [27 10 12 49 52]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.77it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.01it/s]
Epoch 6 : Training Loss: 1.39858, acc: 0.25600, kappa: 0.07000, f1: 0.24512, LR: 0.00006, Time elapsed 0.22 mins
[[61 17 19 23 30]
 [56 28 16  9 41]
 [45 17 20 21 47]
 [49 18 17 28 38]
 [46 20 14 15 55]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.25600, kappa: 0.07000, f1: 0.24512
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.84it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 20.06it/s]
Epoch 7 : Training Loss: 1.29311, acc: 0.24000, kappa: 0.05000, f1: 0.24018, LR: 0.00006, Time elapsed 0.21 mins
[[37 26 35 31 21]
 [44 35 21 24 26]
 [35 21 31 27 36]
 [37 25 17 37 34]
 [32 32 22 24 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.66it/s]
Epoch 8 : Training Loss: 1.17716, acc: 0.26667, kappa: 0.08333, f1: 0.26313, LR: 0.00006, Time elapsed 0.22 mins
[[31 34 23 41 21]
 [25 56 19 20 30]
 [18 31 30 29 42]
 [16 36 22 38 38]
 [22 36 21 26 45]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26667, kappa: 0.08333, f1: 0.26313
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.74it/s]
Epoch 9 : Training Loss: 1.04079, acc: 0.26400, kappa: 0.08000, f1: 0.25795, LR: 0.00006, Time elapsed 0.22 mins
[[28 19 40 46 17]
 [31 34 27 41 17]
 [18 14 59 35 24]
 [21 21 33 51 24]
 [28 24 38 34 26]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.78it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.51it/s]
Epoch 10 : Training Loss: 0.91536, acc: 0.26933, kappa: 0.08667, f1: 0.26882, LR: 0.00006, Time elapsed 0.22 mins
[[47 27 29 24 23]
 [45 45 15 25 20]
 [26 26 39 24 35]
 [32 32 18 36 32]
 [33 28 27 27 35]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.26933, kappa: 0.08667, f1: 0.26882
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.75it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.60it/s]
Epoch 11 : Training Loss: 0.79304, acc: 0.26933, kappa: 0.08667, f1: 0.26646, LR: 0.00006, Time elapsed 0.22 mins
[[26 22 38 40 24]
 [28 46 18 34 24]
 [15 28 38 34 35]
 [19 26 20 54 31]
 [27 22 27 36 38]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.76it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 19.54it/s]
Epoch 12 : Training Loss: 0.66534, acc: 0.26400, kappa: 0.08000, f1: 0.26350, LR: 0.00006, Time elapsed 0.22 mins
[[37 33 29 30 21]
 [30 42 24 32 22]
 [21 24 45 31 29]
 [24 27 23 43 33]
 [37 23 28 31 31]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:12<00:00,  5.57it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 18.71it/s]
Epoch 13 : Training Loss: 0.60213, acc: 0.26533, kappa: 0.08167, f1: 0.26046, LR: 0.00006, Time elapsed 0.22 mins
[[22 37 25 42 24]
 [21 54 20 35 20]
 [15 38 38 35 24]
 [15 42 25 48 20]
 [17 38 21 37 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:13<00:00,  5.08it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.93it/s]
Epoch 14 : Training Loss: 0.55281, acc: 0.25333, kappa: 0.06667, f1: 0.25218, LR: 0.00005, Time elapsed 0.24 mins
[[31 27 36 35 21]
 [24 36 28 38 24]
 [26 26 43 30 25]
 [30 22 30 47 21]
 [34 19 32 32 33]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.96it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.83it/s]
Epoch 15 : Training Loss: 0.51735, acc: 0.23867, kappa: 0.04833, f1: 0.23859, LR: 0.00005, Time elapsed 0.25 mins
[[33 27 38 26 26]
 [32 40 25 24 29]
 [25 24 41 26 34]
 [30 26 30 34 30]
 [34 29 32 24 31]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.24it/s]
Epoch 16 : Training Loss: 0.50301, acc: 0.26800, kappa: 0.08500, f1: 0.26739, LR: 0.00005, Time elapsed 0.25 mins
[[36 31 27 32 24]
 [31 48 22 27 22]
 [22 30 38 28 32]
 [27 23 20 46 34]
 [35 29 25 28 33]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.17it/s]
Epoch 17 : Training Loss: 0.47864, acc: 0.24800, kappa: 0.06000, f1: 0.24665, LR: 0.00005, Time elapsed 0.25 mins
[[27 36 27 29 31]
 [36 37 19 34 24]
 [22 31 36 29 32]
 [19 25 24 49 33]
 [25 33 21 34 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.92it/s]
Epoch 18 : Training Loss: 0.46701, acc: 0.24800, kappa: 0.06000, f1: 0.24610, LR: 0.00005, Time elapsed 0.25 mins
[[27 28 28 41 26]
 [32 37 22 35 24]
 [21 22 36 35 36]
 [17 26 23 50 34]
 [29 23 26 36 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.94it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.80it/s]
Epoch 19 : Training Loss: 0.45913, acc: 0.25600, kappa: 0.07000, f1: 0.25458, LR: 0.00005, Time elapsed 0.25 mins
[[38 28 28 34 22]
 [37 44 16 32 21]
 [27 32 33 28 30]
 [23 30 28 46 23]
 [27 35 27 30 31]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.45it/s]
Epoch 20 : Training Loss: 0.44474, acc: 0.25467, kappa: 0.06833, f1: 0.25417, LR: 0.00004, Time elapsed 0.25 mins
[[29 31 32 30 28]
 [38 37 14 36 25]
 [25 26 39 30 30]
 [24 26 20 49 31]
 [33 27 28 25 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.00it/s]
Epoch 21 : Training Loss: 0.44091, acc: 0.26267, kappa: 0.07833, f1: 0.26163, LR: 0.00004, Time elapsed 0.25 mins
[[32 31 34 30 23]
 [30 47 19 32 22]
 [18 30 40 32 30]
 [28 31 25 44 22]
 [33 32 23 28 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.43it/s]
Epoch 22 : Training Loss: 0.43197, acc: 0.25333, kappa: 0.06667, f1: 0.25116, LR: 0.00004, Time elapsed 0.25 mins
[[25 32 30 38 25]
 [26 37 16 45 26]
 [16 29 38 32 35]
 [20 25 22 50 33]
 [29 27 18 36 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.89it/s]
Epoch 23 : Training Loss: 0.42919, acc: 0.27200, kappa: 0.09000, f1: 0.27046, LR: 0.00004, Time elapsed 0.25 mins
[[28 30 46 24 22]
 [28 43 22 33 24]
 [18 29 44 24 35]
 [17 25 34 49 25]
 [24 34 29 23 40]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27200, kappa: 0.09000, f1: 0.27046
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.71it/s]
Epoch 24 : Training Loss: 0.42422, acc: 0.24667, kappa: 0.05833, f1: 0.24549, LR: 0.00004, Time elapsed 0.25 mins
[[29 27 29 36 29]
 [34 37 19 40 20]
 [20 30 36 37 27]
 [21 23 24 47 35]
 [28 27 25 34 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.91it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.53it/s]
Epoch 25 : Training Loss: 0.42147, acc: 0.27467, kappa: 0.09333, f1: 0.27458, LR: 0.00003, Time elapsed 0.25 mins
[[40 23 26 25 36]
 [34 39 19 29 29]
 [21 27 42 28 32]
 [31 23 25 37 34]
 [33 23 21 25 48]]
kappa increasing....saving weights !!
Val Evaluation: acc: 0.27467, kappa: 0.09333, f1: 0.27458
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.33it/s]
Epoch 26 : Training Loss: 0.41723, acc: 0.24000, kappa: 0.05000, f1: 0.23950, LR: 0.00003, Time elapsed 0.25 mins
[[28 28 26 33 35]
 [36 40 22 27 25]
 [20 29 36 33 32]
 [24 28 30 39 29]
 [28 29 26 30 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.95it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.19it/s]
Epoch 27 : Training Loss: 0.41642, acc: 0.25333, kappa: 0.06667, f1: 0.25115, LR: 0.00003, Time elapsed 0.25 mins
[[25 27 33 34 31]
 [35 35 23 33 24]
 [13 28 46 34 29]
 [23 23 30 46 28]
 [23 31 25 33 38]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.28it/s]
Epoch 28 : Training Loss: 0.41180, acc: 0.25467, kappa: 0.06833, f1: 0.25386, LR: 0.00003, Time elapsed 0.25 mins
[[29 31 31 32 27]
 [31 41 20 34 24]
 [23 30 37 31 29]
 [23 29 21 44 33]
 [29 27 26 28 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.24it/s]
Epoch 29 : Training Loss: 0.40989, acc: 0.26533, kappa: 0.08167, f1: 0.26441, LR: 0.00003, Time elapsed 0.25 mins
[[31 33 26 34 26]
 [25 41 20 41 23]
 [24 29 39 35 23]
 [25 25 23 49 28]
 [29 27 23 32 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.97it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.68it/s]
Epoch 30 : Training Loss: 0.40818, acc: 0.26267, kappa: 0.07833, f1: 0.26178, LR: 0.00002, Time elapsed 0.25 mins
[[32 26 25 41 26]
 [31 35 20 40 24]
 [28 26 42 31 23]
 [22 26 21 51 30]
 [32 23 23 35 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.89it/s]
Epoch 31 : Training Loss: 0.40659, acc: 0.26133, kappa: 0.07667, f1: 0.26030, LR: 0.00002, Time elapsed 0.26 mins
[[31 35 28 30 26]
 [33 45 19 26 27]
 [20 32 41 32 25]
 [23 26 28 45 28]
 [28 31 31 26 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.70it/s]
Epoch 32 : Training Loss: 0.40433, acc: 0.26133, kappa: 0.07667, f1: 0.26162, LR: 0.00002, Time elapsed 0.25 mins
[[34 28 24 33 31]
 [37 39 19 32 23]
 [22 30 42 33 23]
 [23 27 24 42 34]
 [29 28 24 30 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.19it/s]
Epoch 33 : Training Loss: 0.40355, acc: 0.25733, kappa: 0.07167, f1: 0.25571, LR: 0.00002, Time elapsed 0.25 mins
[[28 30 29 36 27]
 [31 39 18 38 24]
 [20 31 35 37 27]
 [21 27 22 49 31]
 [31 27 21 29 42]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.27it/s]
Epoch 34 : Training Loss: 0.40204, acc: 0.25467, kappa: 0.06833, f1: 0.25456, LR: 0.00002, Time elapsed 0.25 mins
[[32 30 29 34 25]
 [33 39 18 34 26]
 [19 31 40 34 26]
 [22 28 24 43 33]
 [35 25 23 30 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.89it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.03it/s]
Epoch 35 : Training Loss: 0.40103, acc: 0.26000, kappa: 0.07500, f1: 0.25998, LR: 0.00001, Time elapsed 0.25 mins
[[33 29 28 33 27]
 [35 41 19 28 27]
 [21 27 40 32 30]
 [22 24 24 44 36]
 [34 28 25 26 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.99it/s]
Epoch 36 : Training Loss: 0.40032, acc: 0.27333, kappa: 0.09167, f1: 0.27121, LR: 0.00001, Time elapsed 0.25 mins
[[31 31 29 36 23]
 [33 44 18 35 20]
 [18 31 43 34 24]
 [19 26 28 53 24]
 [31 28 29 28 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.20it/s]
Epoch 37 : Training Loss: 0.39965, acc: 0.26400, kappa: 0.08000, f1: 0.26344, LR: 0.00001, Time elapsed 0.26 mins
[[31 30 27 36 26]
 [32 38 18 38 24]
 [22 30 40 32 26]
 [26 24 20 50 30]
 [33 29 20 29 39]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.97it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.48it/s]
Epoch 38 : Training Loss: 0.39921, acc: 0.26000, kappa: 0.07500, f1: 0.25981, LR: 0.00001, Time elapsed 0.25 mins
[[30 29 29 32 30]
 [33 40 19 33 25]
 [22 29 41 31 27]
 [26 26 22 44 32]
 [32 27 24 27 40]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.86it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.27it/s]
Epoch 39 : Training Loss: 0.39859, acc: 0.25867, kappa: 0.07333, f1: 0.25758, LR: 0.00001, Time elapsed 0.26 mins
[[31 34 30 32 23]
 [31 37 22 36 24]
 [21 29 44 32 24]
 [22 28 24 48 28]
 [32 28 28 28 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.27it/s]
Epoch 40 : Training Loss: 0.39838, acc: 0.25200, kappa: 0.06500, f1: 0.25161, LR: 0.00001, Time elapsed 0.25 mins
[[31 31 25 35 28]
 [34 38 17 37 24]
 [23 31 38 32 26]
 [23 28 21 47 31]
 [34 29 23 29 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.40it/s]
Epoch 41 : Training Loss: 0.39775, acc: 0.25333, kappa: 0.06667, f1: 0.25272, LR: 0.00001, Time elapsed 0.25 mins
[[31 29 25 35 30]
 [32 37 18 38 25]
 [21 28 39 34 28]
 [23 27 22 48 30]
 [34 28 23 30 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.96it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.04it/s]
Epoch 42 : Training Loss: 0.39742, acc: 0.25733, kappa: 0.07167, f1: 0.25693, LR: 0.00001, Time elapsed 0.25 mins
[[31 31 27 33 28]
 [33 40 17 36 24]
 [21 32 42 30 25]
 [22 28 23 46 31]
 [33 30 24 29 34]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.00it/s]
Epoch 43 : Training Loss: 0.39742, acc: 0.25733, kappa: 0.07167, f1: 0.25646, LR: 0.00000, Time elapsed 0.25 mins
[[29 31 28 37 25]
 [31 39 19 37 24]
 [23 30 41 32 24]
 [21 28 23 48 30]
 [33 28 23 30 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.93it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.48it/s]
Epoch 44 : Training Loss: 0.39730, acc: 0.26133, kappa: 0.07667, f1: 0.26050, LR: 0.00000, Time elapsed 0.25 mins
[[30 33 29 34 24]
 [32 39 20 36 23]
 [20 30 42 31 27]
 [21 28 23 48 30]
 [33 27 24 29 37]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.90it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.06it/s]
Epoch 45 : Training Loss: 0.39698, acc: 0.25733, kappa: 0.07167, f1: 0.25669, LR: 0.00000, Time elapsed 0.25 mins
[[30 34 28 35 23]
 [30 40 19 37 24]
 [20 31 41 32 26]
 [22 30 20 47 31]
 [34 29 23 29 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.00it/s]
Epoch 46 : Training Loss: 0.39691, acc: 0.26000, kappa: 0.07500, f1: 0.25954, LR: 0.00000, Time elapsed 0.25 mins
[[31 32 28 34 25]
 [32 40 20 35 23]
 [21 30 42 32 25]
 [24 28 20 47 31]
 [34 29 23 29 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  5.04it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.00it/s]
Epoch 47 : Training Loss: 0.39677, acc: 0.26000, kappa: 0.07500, f1: 0.25915, LR: 0.00000, Time elapsed 0.25 mins
[[29 32 29 35 25]
 [31 40 19 37 23]
 [21 31 42 32 24]
 [21 29 21 48 31]
 [33 30 23 28 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.88it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.12it/s]
Epoch 48 : Training Loss: 0.39701, acc: 0.25600, kappa: 0.07000, f1: 0.25531, LR: 0.00000, Time elapsed 0.25 mins
[[30 32 30 33 25]
 [32 39 21 36 22]
 [22 31 41 32 24]
 [23 28 22 47 30]
 [34 29 23 29 35]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.92it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.87it/s]
Epoch 49 : Training Loss: 0.39676, acc: 0.25867, kappa: 0.07333, f1: 0.25819, LR: 0.00000, Time elapsed 0.25 mins
[[31 31 28 34 26]
 [32 39 20 36 23]
 [23 31 41 31 24]
 [22 28 21 47 32]
 [33 29 23 29 36]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 71/71 [00:14<00:00,  4.85it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 17.00it/s]
Epoch 50 : Training Loss: 0.39666, acc: 0.26000, kappa: 0.07500, f1: 0.25955, LR: 0.00000, Time elapsed 0.26 mins
[[31 32 28 34 25]
 [32 39 20 36 23]
 [23 30 42 31 24]
 [22 29 21 47 31]
 [33 30 24 27 36]]
***************************Test************************
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 12/12 [00:00<00:00, 16.61it/s]
***************************Test results************************
Test Evaluation: acc: 0.27600, kappa: 0.09500, f1: 0.27354
[[53 23 21 19 34]
 [40 34 26 20 30]
 [25 23 38 25 39]
 [33 26 23 33 35]
 [37 19 20 25 49]]
model save in /mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models/epoch25_acc_0.27600_kappa_0.09500_f1_0.27354.pth
[32m[I 2025-08-29 12:04:20,044][0m Trial 18 finished with value: 0.09499999999999997 and parameters: {'lr': 6.682627165603545e-05, 'weight_decay': 0.00011730597348169787, '--dropout': 0.06668728147798558, '--clip_value': 1.269920082903508}. Best is trial 11 with value: 0.32333333333333336.[0m
Namespace(seed=3407, cuda=0, epochs=50, batch_size=64, lr=0.0004714881614545436, weight_decay=1.3134028343058025e-06, optimizer='AdamW', clip_value=1.9940254840418203, dropout=0.019808986130339233, classifier='all_patch_reps', downstream_dataset='BCIC2020-3', datasets_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/datasets/speech/processed', num_of_classes=5, model_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/finetune_models', num_workers=16, label_smoothing=0.1, multi_lr=True, frozen=False, use_pretrained_weights=True, foundation_dir='/mnt/disk1/aiotlab/namth/EEGFoundationModel/CBraMod/pretrained_weights/pretrained_weights.pth')
The downstream dataset is BCIC2020-3
4500 750 750
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b (c s d)')
    (1): Linear(in_features=38400, out_features=600, bias=True)
    (2): ELU(alpha=1.0)
    (3): Dropout(p=0.019808986130339233, inplace=False)
    (4): Linear(in_features=600, out_features=200, bias=True)
    (5): ELU(alpha=1.0)
    (6): Dropout(p=0.019808986130339233, inplace=False)
    (7): Linear(in_features=200, out_features=5, bias=True)
  )
)
[34m[1mwandb[0m: Finishing previous runs because reinit is set to True.
