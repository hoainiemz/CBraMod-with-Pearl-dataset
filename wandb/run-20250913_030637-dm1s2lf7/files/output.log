3554 1051
4605
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b d c s')
    (1): AdaptiveAvgPool2d(output_size=(1, 1))
    (2): Flatten(start_dim=1, end_dim=-1)
    (3): Linear(in_features=200, out_features=1, bias=True)
    (4): Rearrange('b 1 -> (b 1)')
  )
)
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:06<00:00,  8.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.36it/s]
Epoch 1 : Training Loss: 0.66951, acc: 0.70336, pr_auc: 0.68481, roc_auc: 0.76409, LR: 0.00030, Time elapsed 0.12 mins
[[1379  476]
 [ 572 1127]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.36it/s]
Test Evaluation: acc: 0.41460, pr_auc: 0.40261, roc_auc: 0.46583
[[372 216]
 [372  91]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.20it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.30it/s]
Epoch 2 : Training Loss: 0.55878, acc: 0.55005, pr_auc: 0.68885, roc_auc: 0.76618, LR: 0.00029, Time elapsed 0.10 mins
[[1747  108]
 [1430  269]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.24it/s]
Test Evaluation: acc: 0.48832, pr_auc: 0.40534, roc_auc: 0.43240
[[573  15]
 [462   1]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.24it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.70it/s]
Epoch 3 : Training Loss: 0.54463, acc: 0.84972, pr_auc: 0.90744, roc_auc: 0.91777, LR: 0.00028, Time elapsed 0.10 mins
[[1506  349]
 [ 191 1508]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.84it/s]
Test Evaluation: acc: 0.45541, pr_auc: 0.41717, roc_auc: 0.46710
[[373 215]
 [335 128]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.98it/s]
Epoch 4 : Training Loss: 0.39609, acc: 0.82128, pr_auc: 0.94854, roc_auc: 0.95341, LR: 0.00027, Time elapsed 0.10 mins
[[1811   44]
 [ 567 1132]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.47it/s]
Test Evaluation: acc: 0.44807, pr_auc: 0.36499, roc_auc: 0.36825
[[452 136]
 [404  59]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 48.05it/s]
Epoch 5 : Training Loss: 0.32920, acc: 0.89147, pr_auc: 0.96352, roc_auc: 0.96309, LR: 0.00026, Time elapsed 0.10 mins
[[1781   74]
 [ 301 1398]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.41it/s]
Test Evaluation: acc: 0.45597, pr_auc: 0.35614, roc_auc: 0.37386
[[427 161]
 [377  86]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.34it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.93it/s]
Epoch 6 : Training Loss: 0.30993, acc: 0.88105, pr_auc: 0.95615, roc_auc: 0.95602, LR: 0.00024, Time elapsed 0.10 mins
[[1655  200]
 [ 221 1478]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.59it/s]
Test Evaluation: acc: 0.46614, pr_auc: 0.38513, roc_auc: 0.40123
[[298 290]
 [266 197]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.26it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.66it/s]
Epoch 7 : Training Loss: 0.30930, acc: 0.89028, pr_auc: 0.98459, roc_auc: 0.98314, LR: 0.00022, Time elapsed 0.10 mins
[[1841   14]
 [ 360 1339]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.86it/s]
Test Evaluation: acc: 0.43165, pr_auc: 0.35969, roc_auc: 0.37564
[[373 215]
 [357 106]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.26it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.52it/s]
Epoch 8 : Training Loss: 0.28979, acc: 0.91184, pr_auc: 0.98637, roc_auc: 0.98540, LR: 0.00020, Time elapsed 0.10 mins
[[1838   17]
 [ 284 1415]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.51it/s]
Test Evaluation: acc: 0.45204, pr_auc: 0.34781, roc_auc: 0.34714
[[430 158]
 [383  80]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.28it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.78it/s]
Epoch 9 : Training Loss: 0.24024, acc: 0.94321, pr_auc: 0.99023, roc_auc: 0.99008, LR: 0.00017, Time elapsed 0.10 mins
[[1831   24]
 [ 171 1528]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.37it/s]
Test Evaluation: acc: 0.46791, pr_auc: 0.38208, roc_auc: 0.41143
[[375 213]
 [325 138]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.31it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.56it/s]
Epoch 10 : Training Loss: 0.19500, acc: 0.95094, pr_auc: 0.99011, roc_auc: 0.99028, LR: 0.00015, Time elapsed 0.10 mins
[[1792   63]
 [ 109 1590]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.23it/s]
Test Evaluation: acc: 0.36251, pr_auc: 0.33201, roc_auc: 0.31285
[[279 309]
 [347 116]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.23it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.34it/s]
Epoch 11 : Training Loss: 0.15036, acc: 0.96016, pr_auc: 0.99472, roc_auc: 0.99456, LR: 0.00013, Time elapsed 0.10 mins
[[1824   31]
 [ 107 1592]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.23it/s]
Test Evaluation: acc: 0.46289, pr_auc: 0.38600, roc_auc: 0.43864
[[331 257]
 [295 168]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.22it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.55it/s]
Epoch 12 : Training Loss: 0.13754, acc: 0.94887, pr_auc: 0.99388, roc_auc: 0.99369, LR: 0.00010, Time elapsed 0.10 mins
[[1840   15]
 [ 160 1539]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.11it/s]
Test Evaluation: acc: 0.48671, pr_auc: 0.39547, roc_auc: 0.44587
[[406 182]
 [332 131]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.20it/s]
Epoch 13 : Training Loss: 0.13468, acc: 0.97286, pr_auc: 0.99690, roc_auc: 0.99696, LR: 0.00008, Time elapsed 0.10 mins
[[1834   21]
 [  73 1626]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.31it/s]
Test Evaluation: acc: 0.48644, pr_auc: 0.39514, roc_auc: 0.44346
[[346 242]
 [285 178]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.38it/s]
Epoch 14 : Training Loss: 0.12926, acc: 0.96812, pr_auc: 0.99726, roc_auc: 0.99736, LR: 0.00006, Time elapsed 0.10 mins
[[1835   20]
 [  90 1609]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.42it/s]
Test Evaluation: acc: 0.48767, pr_auc: 0.38584, roc_auc: 0.42076
[[383 205]
 [313 150]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 46.99it/s]
Epoch 15 : Training Loss: 0.10014, acc: 0.95368, pr_auc: 0.99677, roc_auc: 0.99662, LR: 0.00004, Time elapsed 0.10 mins
[[1848    7]
 [ 151 1548]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.78it/s]
Test Evaluation: acc: 0.48857, pr_auc: 0.37931, roc_auc: 0.40841
[[412 176]
 [335 128]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.24it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.29it/s]
Epoch 16 : Training Loss: 0.09881, acc: 0.97261, pr_auc: 0.99738, roc_auc: 0.99739, LR: 0.00003, Time elapsed 0.10 mins
[[1832   23]
 [  72 1627]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.12it/s]
Test Evaluation: acc: 0.49196, pr_auc: 0.39106, roc_auc: 0.43582
[[369 219]
 [298 165]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.22it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.46it/s]
Epoch 17 : Training Loss: 0.07388, acc: 0.98034, pr_auc: 0.99868, roc_auc: 0.99874, LR: 0.00002, Time elapsed 0.10 mins
[[1817   38]
 [  32 1667]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.47it/s]
Test Evaluation: acc: 0.44858, pr_auc: 0.40175, roc_auc: 0.42872
[[271 317]
 [261 202]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.27it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.44it/s]
Epoch 18 : Training Loss: 0.07212, acc: 0.98348, pr_auc: 0.99890, roc_auc: 0.99894, LR: 0.00001, Time elapsed 0.10 mins
[[1833   22]
 [  36 1663]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.54it/s]
Test Evaluation: acc: 0.46176, pr_auc: 0.38903, roc_auc: 0.41086
[[303 285]
 [274 189]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.22it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.48it/s]
Epoch 19 : Training Loss: 0.06060, acc: 0.98230, pr_auc: 0.99893, roc_auc: 0.99900, LR: 0.00000, Time elapsed 0.10 mins
[[1821   34]
 [  29 1670]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 47.47it/s]
Test Evaluation: acc: 0.47256, pr_auc: 0.40394, roc_auc: 0.43292
[[303 285]
 [264 199]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:04<00:00, 12.26it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 56/56 [00:01<00:00, 47.53it/s]
Epoch 20 : Training Loss: 0.05999, acc: 0.98269, pr_auc: 0.99896, roc_auc: 0.99902, LR: 0.00000, Time elapsed 0.10 mins
[[1829   26]
 [  35 1664]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.35it/s]
Test Evaluation: acc: 0.47722, pr_auc: 0.40057, roc_auc: 0.42980
[[325 263]
 [277 186]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 17/17 [00:00<00:00, 48.09it/s]
***************************Test results************************
Test Evaluation: acc: 0.47722, pr_auc: 0.40057, roc_auc: 0.42980
[[325 263]
 [277 186]]
model save in ./data/wjq/models_weights/Big/BigFaced/epoch20_acc_0.47722_pr_0.40057_roc_0.42980.pth
[34m[1mwandb[0m: wandb.init() called while a run is active and reinit is set to 'default', so returning the previous run.
7122 2088
9210
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b d c s')
    (1): AdaptiveAvgPool2d(output_size=(1, 1))
    (2): Flatten(start_dim=1, end_dim=-1)
    (3): Linear(in_features=200, out_features=1, bias=True)
    (4): Rearrange('b 1 -> (b 1)')
  )
)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 47.18it/s]
Epoch 1 : Training Loss: 0.68323, acc: 0.67654, pr_auc: 0.66437, roc_auc: 0.73569, LR: 0.00030, Time elapsed 0.20 mins
[[2585 1141]
 [1157 2239]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 46.29it/s]
Test Evaluation: acc: 0.50269, pr_auc: 0.48117, roc_auc: 0.52582
[[705 455]
 [559 369]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 1 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 12.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 47.15it/s]
Epoch 2 : Training Loss: 0.55713, acc: 0.81625, pr_auc: 0.87983, roc_auc: 0.89710, LR: 0.00029, Time elapsed 0.19 mins
[[2936  790]
 [ 528 2868]]
  0%|                                                                                                                   | 0/33 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 2 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 47.23it/s]
Test Evaluation: acc: 0.74073, pr_auc: 0.73154, roc_auc: 0.80583
[[816 344]
 [206 722]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 12.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 46.87it/s]
Epoch 3 : Training Loss: 0.46929, acc: 0.84621, pr_auc: 0.92359, roc_auc: 0.93382, LR: 0.00028, Time elapsed 0.19 mins
[[3382  344]
 [ 731 2665]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 47.11it/s]
Test Evaluation: acc: 0.74407, pr_auc: 0.78569, roc_auc: 0.83746
[[960 200]
 [315 613]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 3 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 12.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 46.97it/s]
Epoch 4 : Training Loss: 0.43141, acc: 0.85237, pr_auc: 0.91355, roc_auc: 0.92850, LR: 0.00027, Time elapsed 0.19 mins
[[3271  455]
 [ 588 2808]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 47.07it/s]
Test Evaluation: acc: 0.76897, pr_auc: 0.76626, roc_auc: 0.83710
[[899 261]
 [220 708]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 4 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 12.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 46.80it/s]
Epoch 5 : Training Loss: 0.37023, acc: 0.90478, pr_auc: 0.95364, roc_auc: 0.96208, LR: 0.00026, Time elapsed 0.19 mins
[[3283  443]
 [ 243 3153]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 46.72it/s]
Test Evaluation: acc: 0.81800, pr_auc: 0.87286, roc_auc: 0.89571
[[869 291]
 [105 823]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 5 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 12.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 46.67it/s]
Epoch 6 : Training Loss: 0.30129, acc: 0.82737, pr_auc: 0.95696, roc_auc: 0.96304, LR: 0.00024, Time elapsed 0.19 mins
[[3619  107]
 [1075 2321]]
  0%|                                                                                                                   | 0/33 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 6 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 46.62it/s]
Test Evaluation: acc: 0.78114, pr_auc: 0.90384, roc_auc: 0.92193
[[1101   59]
 [ 359  569]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 12.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 46.53it/s]
Epoch 7 : Training Loss: 0.28751, acc: 0.85124, pr_auc: 0.93251, roc_auc: 0.94369, LR: 0.00022, Time elapsed 0.20 mins
[[2714 1012]
 [  88 3308]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 46.78it/s]
Test Evaluation: acc: 0.75366, pr_auc: 0.86736, roc_auc: 0.88767
[[636 524]
 [ 38 890]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 7 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 12.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 46.55it/s]
Epoch 8 : Training Loss: 0.30871, acc: 0.91023, pr_auc: 0.98010, roc_auc: 0.98199, LR: 0.00020, Time elapsed 0.20 mins
[[3610  116]
 [ 504 2892]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 46.69it/s]
Test Evaluation: acc: 0.83944, pr_auc: 0.92432, roc_auc: 0.93621
[[1070   90]
 [ 226  702]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 8 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 46.11it/s]
Epoch 9 : Training Loss: 0.24526, acc: 0.93620, pr_auc: 0.98373, roc_auc: 0.98480, LR: 0.00017, Time elapsed 0.20 mins
[[3515  211]
 [ 241 3155]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 46.12it/s]
Test Evaluation: acc: 0.87403, pr_auc: 0.94109, roc_auc: 0.94829
[[1009  151]
 [ 113  815]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 9 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 46.17it/s]
Epoch 10 : Training Loss: 0.21269, acc: 0.93519, pr_auc: 0.98083, roc_auc: 0.98325, LR: 0.00015, Time elapsed 0.20 mins
[[3536  190]
 [ 267 3129]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 46.20it/s]
Test Evaluation: acc: 0.89235, pr_auc: 0.94597, roc_auc: 0.95877
[[1034  126]
 [  99  829]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 10 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 46.05it/s]
Epoch 11 : Training Loss: 0.19640, acc: 0.91353, pr_auc: 0.98544, roc_auc: 0.98612, LR: 0.00013, Time elapsed 0.20 mins
[[3639   87]
 [ 508 2888]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 45.84it/s]
Test Evaluation: acc: 0.87543, pr_auc: 0.96427, roc_auc: 0.96967
[[1111   49]
 [ 192  736]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 11 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 45.06it/s]
Epoch 12 : Training Loss: 0.17386, acc: 0.96583, pr_auc: 0.99533, roc_auc: 0.99574, LR: 0.00010, Time elapsed 0.20 mins
[[3648   78]
 [ 161 3235]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 44.39it/s]
Test Evaluation: acc: 0.93136, pr_auc: 0.98059, roc_auc: 0.98376
[[1092   68]
 [  73  855]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 12 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 44.39it/s]
Epoch 13 : Training Loss: 0.15202, acc: 0.96093, pr_auc: 0.99383, roc_auc: 0.99422, LR: 0.00008, Time elapsed 0.20 mins
[[3640   86]
 [ 187 3209]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 44.14it/s]
Test Evaluation: acc: 0.91929, pr_auc: 0.97511, roc_auc: 0.97867
[[1094   66]
 [  97  831]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 13 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 44.49it/s]
Epoch 14 : Training Loss: 0.11510, acc: 0.96641, pr_auc: 0.99530, roc_auc: 0.99564, LR: 0.00006, Time elapsed 0.20 mins
[[3626  100]
 [ 137 3259]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 44.32it/s]
Test Evaluation: acc: 0.93481, pr_auc: 0.98160, roc_auc: 0.98431
[[1080   80]
 [  57  871]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 14 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 43.70it/s]
Epoch 15 : Training Loss: 0.12570, acc: 0.96070, pr_auc: 0.99580, roc_auc: 0.99624, LR: 0.00004, Time elapsed 0.20 mins
[[3691   35]
 [ 235 3161]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 43.53it/s]
Test Evaluation: acc: 0.91929, pr_auc: 0.98109, roc_auc: 0.98496
[[1129   31]
 [ 125  803]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 15 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 43.28it/s]
Epoch 16 : Training Loss: 0.09804, acc: 0.97113, pr_auc: 0.99672, roc_auc: 0.99692, LR: 0.00003, Time elapsed 0.20 mins
[[3682   44]
 [ 156 3240]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 43.45it/s]
Test Evaluation: acc: 0.94504, pr_auc: 0.98718, roc_auc: 0.98913
[[1120   40]
 [  70  858]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 16 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 43.49it/s]
Epoch 17 : Training Loss: 0.09094, acc: 0.97970, pr_auc: 0.99744, roc_auc: 0.99772, LR: 0.00002, Time elapsed 0.21 mins
[[3657   69]
 [  75 3321]]
  0%|                                                                                                                   | 0/33 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 17 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 43.00it/s]
Test Evaluation: acc: 0.95636, pr_auc: 0.98967, roc_auc: 0.99166
[[1105   55]
 [  37  891]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 43.10it/s]
Epoch 18 : Training Loss: 0.08097, acc: 0.97926, pr_auc: 0.99766, roc_auc: 0.99788, LR: 0.00001, Time elapsed 0.21 mins
[[3679   47]
 [  98 3298]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 43.54it/s]
Test Evaluation: acc: 0.95560, pr_auc: 0.98992, roc_auc: 0.99166
[[1117   43]
 [  48  880]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 18 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 42.78it/s]
Epoch 19 : Training Loss: 0.08156, acc: 0.98077, pr_auc: 0.99766, roc_auc: 0.99789, LR: 0.00000, Time elapsed 0.21 mins
[[3665   61]
 [  75 3321]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 43.40it/s]
Test Evaluation: acc: 0.95657, pr_auc: 0.99004, roc_auc: 0.99173
[[1103   57]
 [  35  893]]
  0%|                                                                                                                  | 0/112 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 19 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:09<00:00, 11.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 112/112 [00:02<00:00, 42.88it/s]
Epoch 20 : Training Loss: 0.07749, acc: 0.97923, pr_auc: 0.99760, roc_auc: 0.99781, LR: 0.00000, Time elapsed 0.21 mins
[[3682   44]
 [ 101 3295]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 43.65it/s]
Test Evaluation: acc: 0.95636, pr_auc: 0.98976, roc_auc: 0.99146
[[1120   40]
 [  49  879]]
***************************Test************************
  0%|                                                                                                                   | 0/33 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 20 that is less than the current step 21. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 33/33 [00:00<00:00, 42.88it/s]
***************************Test results************************
Test Evaluation: acc: 0.95636, pr_auc: 0.98976, roc_auc: 0.99146
[[1120   40]
 [  49  879]]
model save in ./data/wjq/models_weights/Big/BigFaced/epoch20_acc_0.95636_pr_0.98976_roc_0.99146.pth
[34m[1mwandb[0m: wandb.init() called while a run is active and reinit is set to 'default', so returning the previous run.
10600 3215
13815
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b d c s')
    (1): AdaptiveAvgPool2d(output_size=(1, 1))
    (2): Flatten(start_dim=1, end_dim=-1)
    (3): Linear(in_features=200, out_features=1, bias=True)
    (4): Rearrange('b 1 -> (b 1)')
  )
)
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 43.36it/s]
Epoch 1 : Training Loss: 0.67248, acc: 0.65365, pr_auc: 0.73592, roc_auc: 0.78177, LR: 0.00030, Time elapsed 0.31 mins
[[5004  584]
 [2948 2064]]
  0%|                                                                                                                   | 0/51 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 1 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 41.92it/s]
Test Evaluation: acc: 0.58390, pr_auc: 0.60889, roc_auc: 0.72294
[[1491  250]
 [1015  459]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 44.17it/s]
Epoch 2 : Training Loss: 0.53087, acc: 0.82269, pr_auc: 0.89160, roc_auc: 0.91913, LR: 0.00029, Time elapsed 0.30 mins
[[5116  472]
 [1354 3658]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.56it/s]
Test Evaluation: acc: 0.77405, pr_auc: 0.82120, roc_auc: 0.86847
[[1520  221]
 [ 479  995]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 2 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.78it/s]
Epoch 3 : Training Loss: 0.41601, acc: 0.86760, pr_auc: 0.92937, roc_auc: 0.94250, LR: 0.00028, Time elapsed 0.31 mins
[[5008  580]
 [ 807 4205]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.67it/s]
Test Evaluation: acc: 0.82201, pr_auc: 0.88428, roc_auc: 0.90925
[[1511  230]
 [ 330 1144]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 3 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.38it/s]
Epoch 4 : Training Loss: 0.32269, acc: 0.88957, pr_auc: 0.97130, roc_auc: 0.97336, LR: 0.00027, Time elapsed 0.31 mins
[[5423  165]
 [ 959 4053]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 43.07it/s]
Test Evaluation: acc: 0.85350, pr_auc: 0.95362, roc_auc: 0.96043
[[1675   66]
 [ 376 1098]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 4 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.99it/s]
Epoch 5 : Training Loss: 0.25392, acc: 0.92714, pr_auc: 0.97728, roc_auc: 0.97976, LR: 0.00026, Time elapsed 0.31 mins
[[5368  220]
 [ 533 4479]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.46it/s]
Test Evaluation: acc: 0.90013, pr_auc: 0.95974, roc_auc: 0.96656
[[1646   95]
 [ 214 1260]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 5 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 43.14it/s]
Epoch 6 : Training Loss: 0.25935, acc: 0.91379, pr_auc: 0.97089, roc_auc: 0.97597, LR: 0.00024, Time elapsed 0.31 mins
[[4833  755]
 [ 187 4825]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 43.20it/s]
Test Evaluation: acc: 0.90560, pr_auc: 0.95918, roc_auc: 0.96888
[[1482  259]
 [  59 1415]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 6 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 43.06it/s]
Epoch 7 : Training Loss: 0.21183, acc: 0.94474, pr_auc: 0.99127, roc_auc: 0.99161, LR: 0.00022, Time elapsed 0.31 mins
[[5490   98]
 [ 466 4546]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 43.46it/s]
Test Evaluation: acc: 0.93273, pr_auc: 0.98605, roc_auc: 0.98726
[[1704   37]
 [ 167 1307]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 7 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.99it/s]
Epoch 8 : Training Loss: 0.18525, acc: 0.91336, pr_auc: 0.98988, roc_auc: 0.99100, LR: 0.00020, Time elapsed 0.31 mins
[[5525   63]
 [ 812 4200]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.90it/s]
Test Evaluation: acc: 0.88897, pr_auc: 0.98215, roc_auc: 0.98506
[[1717   24]
 [ 307 1167]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 8 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.42it/s]
Epoch 9 : Training Loss: 0.18136, acc: 0.96316, pr_auc: 0.99420, roc_auc: 0.99473, LR: 0.00017, Time elapsed 0.31 mins
[[5358  230]
 [ 163 4849]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.24it/s]
Test Evaluation: acc: 0.95197, pr_auc: 0.99021, roc_auc: 0.99162
[[1647   94]
 [  62 1412]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 9 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.69it/s]
Epoch 10 : Training Loss: 0.14813, acc: 0.96929, pr_auc: 0.99470, roc_auc: 0.99488, LR: 0.00015, Time elapsed 0.31 mins
[[5489   99]
 [ 219 4793]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.68it/s]
Test Evaluation: acc: 0.95929, pr_auc: 0.99099, roc_auc: 0.99171
[[1702   39]
 [  87 1387]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 10 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.61it/s]
Epoch 11 : Training Loss: 0.12468, acc: 0.96374, pr_auc: 0.99738, roc_auc: 0.99764, LR: 0.00013, Time elapsed 0.31 mins
[[5544   44]
 [ 324 4688]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.17it/s]
Test Evaluation: acc: 0.95384, pr_auc: 0.99565, roc_auc: 0.99630
[[1722   19]
 [ 120 1354]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 11 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 43.03it/s]
Epoch 12 : Training Loss: 0.10739, acc: 0.97380, pr_auc: 0.99676, roc_auc: 0.99705, LR: 0.00010, Time elapsed 0.31 mins
[[5371  217]
 [  68 4944]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.95it/s]
Test Evaluation: acc: 0.96698, pr_auc: 0.99534, roc_auc: 0.99589
[[1652   89]
 [  22 1452]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 12 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.89it/s]
Epoch 13 : Training Loss: 0.11346, acc: 0.96874, pr_auc: 0.99818, roc_auc: 0.99824, LR: 0.00008, Time elapsed 0.31 mins
[[5562   26]
 [ 290 4722]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 44.45it/s]
Test Evaluation: acc: 0.96219, pr_auc: 0.99721, roc_auc: 0.99739
[[1731   10]
 [ 103 1371]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 13 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.54it/s]
Epoch 14 : Training Loss: 0.07563, acc: 0.98608, pr_auc: 0.99907, roc_auc: 0.99917, LR: 0.00006, Time elapsed 0.31 mins
[[5525   63]
 [  83 4929]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.73it/s]
Test Evaluation: acc: 0.98275, pr_auc: 0.99861, roc_auc: 0.99883
[[1714   27]
 [  28 1446]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 14 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 41.80it/s]
Epoch 15 : Training Loss: 0.07078, acc: 0.98503, pr_auc: 0.99883, roc_auc: 0.99888, LR: 0.00004, Time elapsed 0.31 mins
[[5501   87]
 [  72 4940]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.06it/s]
Test Evaluation: acc: 0.98066, pr_auc: 0.99819, roc_auc: 0.99832
[[1702   39]
 [  24 1450]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 15 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.99it/s]
Epoch 16 : Training Loss: 0.07007, acc: 0.98958, pr_auc: 0.99936, roc_auc: 0.99935, LR: 0.00003, Time elapsed 0.31 mins
[[5534   54]
 [  56 4956]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 41.68it/s]
Test Evaluation: acc: 0.98564, pr_auc: 0.99889, roc_auc: 0.99889
[[1717   24]
 [  22 1452]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 16 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 43.00it/s]
Epoch 17 : Training Loss: 0.05399, acc: 0.97990, pr_auc: 0.99916, roc_auc: 0.99923, LR: 0.00002, Time elapsed 0.31 mins
[[5564   24]
 [ 180 4832]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 43.00it/s]
Test Evaluation: acc: 0.97706, pr_auc: 0.99881, roc_auc: 0.99897
[[1732    9]
 [  60 1414]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 17 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.10it/s]
Epoch 18 : Training Loss: 0.04727, acc: 0.98673, pr_auc: 0.99934, roc_auc: 0.99938, LR: 0.00001, Time elapsed 0.31 mins
[[5559   29]
 [ 107 4905]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.55it/s]
Test Evaluation: acc: 0.98270, pr_auc: 0.99899, roc_auc: 0.99909
[[1728   13]
 [  40 1434]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 18 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.63it/s]
Epoch 19 : Training Loss: 0.04395, acc: 0.98730, pr_auc: 0.99940, roc_auc: 0.99943, LR: 0.00000, Time elapsed 0.31 mins
[[5562   26]
 [ 104 4908]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.89it/s]
Test Evaluation: acc: 0.98356, pr_auc: 0.99911, roc_auc: 0.99920
[[1731   10]
 [  40 1434]]
  0%|                                                                                                                  | 0/166 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 19 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:14<00:00, 11.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 166/166 [00:03<00:00, 42.27it/s]
Epoch 20 : Training Loss: 0.04437, acc: 0.98779, pr_auc: 0.99944, roc_auc: 0.99947, LR: 0.00000, Time elapsed 0.31 mins
[[5563   25]
 [ 100 4912]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.29it/s]
Test Evaluation: acc: 0.98395, pr_auc: 0.99915, roc_auc: 0.99923
[[1730   11]
 [  38 1436]]
***************************Test************************
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 51/51 [00:01<00:00, 42.22it/s]
***************************Test results************************
Test Evaluation: acc: 0.98395, pr_auc: 0.99915, roc_auc: 0.99923
[[1730   11]
 [  38 1436]]
model save in ./data/wjq/models_weights/Big/BigFaced/epoch20_acc_0.98395_pr_0.99915_roc_0.99923.pth
[34m[1mwandb[0m: wandb.init() called while a run is active and reinit is set to 'default', so returning the previous run.
14155 4265
18420
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b d c s')
    (1): AdaptiveAvgPool2d(output_size=(1, 1))
    (2): Flatten(start_dim=1, end_dim=-1)
    (3): Linear(in_features=200, out_features=1, bias=True)
    (4): Rearrange('b 1 -> (b 1)')
  )
)
  0%|                                                                                                                  | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 20 that is less than the current step 22. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.48it/s]
Epoch 1 : Training Loss: 0.63627, acc: 0.72754, pr_auc: 0.86776, roc_auc: 0.88184, LR: 0.00030, Time elapsed 0.42 mins
[[7069  372]
 [3323 3391]]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 41.54it/s]
Test Evaluation: acc: 0.72599, pr_auc: 0.85051, roc_auc: 0.87534
[[2207  124]
 [ 957  977]]
  0%|                                                                                                                  | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 1 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.66it/s]
Epoch 2 : Training Loss: 0.39800, acc: 0.85297, pr_auc: 0.94913, roc_auc: 0.95259, LR: 0.00029, Time elapsed 0.41 mins
[[7127  314]
 [1691 5023]]
  0%|                                                                                                                   | 0/67 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 2 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 41.90it/s]
Test Evaluation: acc: 0.84136, pr_auc: 0.93763, roc_auc: 0.94630
[[2229  102]
 [ 529 1405]]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 43.05it/s]
Epoch 3 : Training Loss: 0.33286, acc: 0.90973, pr_auc: 0.96653, roc_auc: 0.96882, LR: 0.00028, Time elapsed 0.41 mins
[[6982  459]
 [ 798 5916]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.22it/s]
Test Evaluation: acc: 0.90426, pr_auc: 0.96028, roc_auc: 0.96534
[[2186  145]
 [ 250 1684]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 3 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.23it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 43.03it/s]
Epoch 4 : Training Loss: 0.26855, acc: 0.91939, pr_auc: 0.97558, roc_auc: 0.97696, LR: 0.00027, Time elapsed 0.42 mins
[[7159  282]
 [ 828 5886]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.59it/s]
Test Evaluation: acc: 0.91865, pr_auc: 0.97213, roc_auc: 0.97519
[[2241   90]
 [ 240 1694]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 4 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.79it/s]
Epoch 5 : Training Loss: 0.23255, acc: 0.94736, pr_auc: 0.98642, roc_auc: 0.98698, LR: 0.00026, Time elapsed 0.41 mins
[[7050  391]
 [ 354 6360]]
 64%|██████████████████████████████████████████████████████████████████████████████▉                                            | 43/67 [00:01<00:00, 42.74it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 5 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.87it/s]
Test Evaluation: acc: 0.94371, pr_auc: 0.98337, roc_auc: 0.98519
[[2206  125]
 [ 114 1820]]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.89it/s]
Epoch 6 : Training Loss: 0.22829, acc: 0.91665, pr_auc: 0.98479, roc_auc: 0.98518, LR: 0.00024, Time elapsed 0.41 mins
[[7341  100]
 [1029 5685]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.79it/s]
Test Evaluation: acc: 0.90653, pr_auc: 0.98124, roc_auc: 0.98313
[[2299   32]
 [ 335 1599]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 6 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 43.10it/s]
Epoch 7 : Training Loss: 0.18626, acc: 0.94896, pr_auc: 0.98583, roc_auc: 0.98727, LR: 0.00022, Time elapsed 0.41 mins
[[7086  355]
 [ 365 6349]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 43.20it/s]
Test Evaluation: acc: 0.94517, pr_auc: 0.98285, roc_auc: 0.98572
[[2214  117]
 [ 115 1819]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 7 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.34it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 43.23it/s]
Epoch 8 : Training Loss: 0.16860, acc: 0.95978, pr_auc: 0.99478, roc_auc: 0.99508, LR: 0.00020, Time elapsed 0.41 mins
[[7370   71]
 [ 476 6238]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.97it/s]
Test Evaluation: acc: 0.95723, pr_auc: 0.99377, roc_auc: 0.99456
[[2310   21]
 [ 148 1786]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 8 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.37it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.56it/s]
Epoch 9 : Training Loss: 0.12985, acc: 0.97206, pr_auc: 0.99569, roc_auc: 0.99602, LR: 0.00017, Time elapsed 0.41 mins
[[7299  142]
 [ 247 6467]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.74it/s]
Test Evaluation: acc: 0.97212, pr_auc: 0.99518, roc_auc: 0.99589
[[2289   42]
 [  73 1861]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 9 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.53it/s]
Epoch 10 : Training Loss: 0.13945, acc: 0.95768, pr_auc: 0.99741, roc_auc: 0.99760, LR: 0.00015, Time elapsed 0.41 mins
[[6861  580]
 [  45 6669]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.28it/s]
Test Evaluation: acc: 0.95665, pr_auc: 0.99697, roc_auc: 0.99740
[[2147  184]
 [  15 1919]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 10 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.45it/s]
Epoch 11 : Training Loss: 0.10670, acc: 0.96837, pr_auc: 0.99735, roc_auc: 0.99751, LR: 0.00013, Time elapsed 0.41 mins
[[7387   54]
 [ 376 6338]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.05it/s]
Test Evaluation: acc: 0.96512, pr_auc: 0.99684, roc_auc: 0.99728
[[2313   18]
 [ 120 1814]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 11 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.85it/s]
Epoch 12 : Training Loss: 0.09057, acc: 0.98185, pr_auc: 0.99836, roc_auc: 0.99852, LR: 0.00010, Time elapsed 0.41 mins
[[7254  187]
 [  75 6639]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.88it/s]
Test Evaluation: acc: 0.98045, pr_auc: 0.99804, roc_auc: 0.99837
[[2270   61]
 [  25 1909]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 12 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 43.17it/s]
Epoch 13 : Training Loss: 0.07195, acc: 0.98663, pr_auc: 0.99912, roc_auc: 0.99917, LR: 0.00008, Time elapsed 0.41 mins
[[7344   97]
 [  92 6622]]
  0%|                                                                                                                                    | 0/67 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 13 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.84it/s]
Test Evaluation: acc: 0.98611, pr_auc: 0.99897, roc_auc: 0.99910
[[2300   31]
 [  28 1906]]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.54it/s]
Epoch 14 : Training Loss: 0.07174, acc: 0.99202, pr_auc: 0.99965, roc_auc: 0.99969, LR: 0.00006, Time elapsed 0.41 mins
[[7392   49]
 [  63 6651]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.02it/s]
Test Evaluation: acc: 0.99135, pr_auc: 0.99958, roc_auc: 0.99966
[[2316   15]
 [  21 1913]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 14 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.96it/s]
Epoch 15 : Training Loss: 0.05829, acc: 0.99433, pr_auc: 0.99970, roc_auc: 0.99974, LR: 0.00004, Time elapsed 0.41 mins
[[7381   60]
 [  22 6692]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.49it/s]
Test Evaluation: acc: 0.99416, pr_auc: 0.99967, roc_auc: 0.99974
[[2311   20]
 [   6 1928]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 15 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 43.12it/s]
Epoch 16 : Training Loss: 0.03768, acc: 0.99669, pr_auc: 0.99991, roc_auc: 0.99992, LR: 0.00003, Time elapsed 0.41 mins
[[7435    6]
 [  39 6675]]
 64%|██████████████████████████████████████████████████████████████████████████████▉                                            | 43/67 [00:01<00:00, 42.84it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 16 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 43.00it/s]
Test Evaluation: acc: 0.99724, pr_auc: 0.99989, roc_auc: 0.99991
[[2329    2]
 [   9 1925]]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.63it/s]
Epoch 17 : Training Loss: 0.03250, acc: 0.99586, pr_auc: 0.99979, roc_auc: 0.99980, LR: 0.00002, Time elapsed 0.41 mins
[[7416   25]
 [  33 6681]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.70it/s]
Test Evaluation: acc: 0.99565, pr_auc: 0.99976, roc_auc: 0.99979
[[2324    7]
 [  11 1923]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 17 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.40it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 43.07it/s]
Epoch 18 : Training Loss: 0.02568, acc: 0.99778, pr_auc: 0.99993, roc_auc: 0.99994, LR: 0.00001, Time elapsed 0.41 mins
[[7429   12]
 [  19 6695]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.75it/s]
Test Evaluation: acc: 0.99785, pr_auc: 0.99992, roc_auc: 0.99993
[[2327    4]
 [   5 1929]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 18 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.27it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.91it/s]
Epoch 19 : Training Loss: 0.01910, acc: 0.99843, pr_auc: 0.99995, roc_auc: 0.99996, LR: 0.00000, Time elapsed 0.41 mins
[[7432    9]
 [  13 6701]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 41.89it/s]
Test Evaluation: acc: 0.99858, pr_auc: 0.99995, roc_auc: 0.99996
[[2328    3]
 [   3 1931]]
  0%|                                                                                                                                   | 0/222 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 19 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:19<00:00, 11.34it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 222/222 [00:05<00:00, 42.90it/s]
Epoch 20 : Training Loss: 0.02257, acc: 0.99843, pr_auc: 0.99995, roc_auc: 0.99996, LR: 0.00000, Time elapsed 0.41 mins
[[7432    9]
 [  13 6701]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.91it/s]
Test Evaluation: acc: 0.99858, pr_auc: 0.99995, roc_auc: 0.99996
[[2328    3]
 [   3 1931]]
***************************Test************************
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 67/67 [00:01<00:00, 42.96it/s]
***************************Test results************************
Test Evaluation: acc: 0.99858, pr_auc: 0.99995, roc_auc: 0.99996
[[2328    3]
 [   3 1931]]
model save in ./data/wjq/models_weights/Big/BigFaced/epoch20_acc_0.99858_pr_0.99995_roc_0.99996.pth
[34m[1mwandb[0m: wandb.init() called while a run is active and reinit is set to 'default', so returning the previous run.
18420 4605
23025
Model(
  (backbone): CBraMod(
    (patch_embedding): PatchEmbedding(
      (positional_encoding): Sequential(
        (0): Conv2d(200, 200, kernel_size=(19, 7), stride=(1, 1), padding=(9, 3), groups=200)
      )
      (proj_in): Sequential(
        (0): Conv2d(1, 25, kernel_size=(1, 49), stride=(1, 25), padding=(0, 24))
        (1): GroupNorm(5, 25, eps=1e-05, affine=True)
        (2): GELU(approximate='none')
        (3): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (4): GroupNorm(5, 25, eps=1e-05, affine=True)
        (5): GELU(approximate='none')
        (6): Conv2d(25, 25, kernel_size=(1, 3), stride=(1, 1), padding=(0, 1))
        (7): GroupNorm(5, 25, eps=1e-05, affine=True)
        (8): GELU(approximate='none')
      )
      (spectral_proj): Sequential(
        (0): Linear(in_features=101, out_features=200, bias=True)
        (1): Dropout(p=0.1, inplace=False)
      )
    )
    (encoder): TransformerEncoder(
      (layers): ModuleList(
        (0-11): 12 x TransformerEncoderLayer(
          (self_attn_s): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (self_attn_t): MultiheadAttention(
            (out_proj): NonDynamicallyQuantizableLinear(in_features=100, out_features=100, bias=True)
          )
          (linear1): Linear(in_features=200, out_features=800, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (linear2): Linear(in_features=800, out_features=200, bias=True)
          (norm1): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (norm2): LayerNorm((200,), eps=1e-05, elementwise_affine=True)
          (dropout1): Dropout(p=0.1, inplace=False)
          (dropout2): Dropout(p=0.1, inplace=False)
        )
      )
    )
    (proj_out): Identity()
  )
  (classifier): Sequential(
    (0): Rearrange('b c s d -> b d c s')
    (1): AdaptiveAvgPool2d(output_size=(1, 1))
    (2): Flatten(start_dim=1, end_dim=-1)
    (3): Linear(in_features=200, out_features=1, bias=True)
    (4): Rearrange('b 1 -> (b 1)')
  )
)
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 20 that is less than the current step 23. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.21it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.66it/s]
Epoch 1 : Training Loss: 0.66956, acc: 0.71138, pr_auc: 0.74827, roc_auc: 0.79074, LR: 0.00030, Time elapsed 0.54 mins
[[5564 4208]
 [1268 7380]]
  0%|                                                                                                                                    | 0/72 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 1 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 41.14it/s]
Test Evaluation: acc: 0.71138, pr_auc: 0.74827, roc_auc: 0.79074
[[1391 1052]
 [ 317 1845]]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.50it/s]
Epoch 2 : Training Loss: 0.45329, acc: 0.88495, pr_auc: 0.94808, roc_auc: 0.95312, LR: 0.00029, Time elapsed 0.54 mins
[[9024  748]
 [1328 7320]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.27it/s]
Test Evaluation: acc: 0.88495, pr_auc: 0.94808, roc_auc: 0.95312
[[2256  187]
 [ 332 1830]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 2 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 43.11it/s]
Epoch 3 : Training Loss: 0.31808, acc: 0.92417, pr_auc: 0.97273, roc_auc: 0.97454, LR: 0.00028, Time elapsed 0.53 mins
[[9212  560]
 [ 816 7832]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.66it/s]
Test Evaluation: acc: 0.92417, pr_auc: 0.97273, roc_auc: 0.97454
[[2303  140]
 [ 204 1958]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 3 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.78it/s]
Epoch 4 : Training Loss: 0.24501, acc: 0.92168, pr_auc: 0.97726, roc_auc: 0.97627, LR: 0.00027, Time elapsed 0.54 mins
[[9552  220]
 [1160 7488]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.64it/s]
Test Evaluation: acc: 0.92168, pr_auc: 0.97726, roc_auc: 0.97627
[[2388   55]
 [ 290 1872]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 4 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 43.69it/s]
Epoch 5 : Training Loss: 0.19259, acc: 0.95807, pr_auc: 0.99321, roc_auc: 0.99378, LR: 0.00026, Time elapsed 0.53 mins
[[9644  128]
 [ 612 8036]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 38.52it/s]
Test Evaluation: acc: 0.95807, pr_auc: 0.99321, roc_auc: 0.99378
[[2411   32]
 [ 153 2009]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 5 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.28it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 43.09it/s]
Epoch 6 : Training Loss: 0.14835, acc: 0.96312, pr_auc: 0.99394, roc_auc: 0.99430, LR: 0.00024, Time elapsed 0.54 mins
[[9684   88]
 [ 560 8088]]
  0%|                                                                                                                                    | 0/72 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 6 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.31it/s]
Test Evaluation: acc: 0.96312, pr_auc: 0.99394, roc_auc: 0.99430
[[2421   22]
 [ 140 2022]]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.34it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.11it/s]
Epoch 7 : Training Loss: 0.12274, acc: 0.96825, pr_auc: 0.99685, roc_auc: 0.99733, LR: 0.00022, Time elapsed 0.54 mins
[[9712   60]
 [ 496 8152]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.10it/s]
Test Evaluation: acc: 0.96825, pr_auc: 0.99685, roc_auc: 0.99733
[[2428   15]
 [ 124 2038]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 7 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.34it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.74it/s]
Epoch 8 : Training Loss: 0.10637, acc: 0.95982, pr_auc: 0.99508, roc_auc: 0.99545, LR: 0.00020, Time elapsed 0.54 mins
[[9728   44]
 [ 656 7992]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.78it/s]
Test Evaluation: acc: 0.95982, pr_auc: 0.99508, roc_auc: 0.99545
[[2432   11]
 [ 164 1998]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 8 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.32it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.83it/s]
Epoch 9 : Training Loss: 0.07931, acc: 0.98045, pr_auc: 0.99883, roc_auc: 0.99906, LR: 0.00017, Time elapsed 0.54 mins
[[9756   16]
 [ 324 8324]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.73it/s]
Test Evaluation: acc: 0.98045, pr_auc: 0.99883, roc_auc: 0.99906
[[2439    4]
 [  81 2081]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 9 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 43.08it/s]
Epoch 10 : Training Loss: 0.07018, acc: 0.99223, pr_auc: 0.99948, roc_auc: 0.99953, LR: 0.00015, Time elapsed 0.53 mins
[[9688   84]
 [  60 8588]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.46it/s]
Test Evaluation: acc: 0.99223, pr_auc: 0.99948, roc_auc: 0.99953
[[2422   21]
 [  15 2147]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 10 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.29it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.63it/s]
Epoch 11 : Training Loss: 0.06622, acc: 0.99142, pr_auc: 0.99937, roc_auc: 0.99948, LR: 0.00013, Time elapsed 0.54 mins
[[9740   32]
 [ 120 8528]]
 58%|███████████████████████████████████████████████████████████████████████▊                                                   | 42/72 [00:01<00:00, 41.96it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 11 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.02it/s]
Test Evaluation: acc: 0.99142, pr_auc: 0.99937, roc_auc: 0.99948
[[2435    8]
 [  30 2132]]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.28it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.88it/s]
Epoch 12 : Training Loss: 0.05097, acc: 0.99466, pr_auc: 0.99982, roc_auc: 0.99984, LR: 0.00010, Time elapsed 0.54 mins
[[9740   32]
 [  64 8584]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.40it/s]
Test Evaluation: acc: 0.99466, pr_auc: 0.99982, roc_auc: 0.99984
[[2435    8]
 [  16 2146]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 12 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.31it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.35it/s]
Epoch 13 : Training Loss: 0.03403, acc: 0.99728, pr_auc: 0.99997, roc_auc: 0.99997, LR: 0.00008, Time elapsed 0.54 mins
[[9764    8]
 [  40 8608]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.69it/s]
Test Evaluation: acc: 0.99728, pr_auc: 0.99997, roc_auc: 0.99997
[[2441    2]
 [  10 2152]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 13 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.35it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.24it/s]
Epoch 14 : Training Loss: 0.03476, acc: 0.98659, pr_auc: 0.99954, roc_auc: 0.99957, LR: 0.00006, Time elapsed 0.54 mins
[[9772    0]
 [ 232 8416]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.16it/s]
Test Evaluation: acc: 0.98659, pr_auc: 0.99954, roc_auc: 0.99957
[[2443    0]
 [  58 2104]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 14 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.30it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.74it/s]
Epoch 15 : Training Loss: 0.02345, acc: 0.99699, pr_auc: 0.99998, roc_auc: 0.99999, LR: 0.00004, Time elapsed 0.54 mins
[[9772    0]
 [  52 8596]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.57it/s]
Test Evaluation: acc: 0.99699, pr_auc: 0.99998, roc_auc: 0.99999
[[2443    0]
 [  13 2149]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 15 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.39it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.40it/s]
Epoch 16 : Training Loss: 0.01123, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00003, Time elapsed 0.53 mins
[[9772    0]
 [   0 8648]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.67it/s]
Test Evaluation: acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000
[[2443    0]
 [   0 2162]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 16 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.36it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.92it/s]
Epoch 17 : Training Loss: 0.01186, acc: 0.99980, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00002, Time elapsed 0.53 mins
[[9768    4]
 [   0 8648]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.97it/s]
Test Evaluation: acc: 0.99980, pr_auc: 1.00000, roc_auc: 1.00000
[[2442    1]
 [   0 2162]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 17 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.33it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 43.27it/s]
Epoch 18 : Training Loss: 0.01059, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00001, Time elapsed 0.53 mins
[[9772    0]
 [   0 8648]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.25it/s]
Test Evaluation: acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000
[[2443    0]
 [   0 2162]]
  0%|                                                                                                                                   | 0/288 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 18 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.38it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 42.66it/s]
Epoch 19 : Training Loss: 0.00744, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00000, Time elapsed 0.53 mins
[[9772    0]
 [   0 8648]]
  0%|                                                                                                                                    | 0/72 [00:00<?, ?it/s][34m[1mwandb[0m: [33mWARNING[0m Tried to log to step 19 that is less than the current step 24. Steps must be monotonically increasing, so this data will be ignored. See https://wandb.me/define-metric to log data out of order.
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.67it/s]
Test Evaluation: acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000
[[2443    0]
 [   0 2162]]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:25<00:00, 11.47it/s]
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 288/288 [00:06<00:00, 43.05it/s]
Epoch 20 : Training Loss: 0.00562, acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000, LR: 0.00000, Time elapsed 0.53 mins
[[9772    0]
 [   0 8648]]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.95it/s]
Test Evaluation: acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000
[[2443    0]
 [   0 2162]]
***************************Test************************
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 72/72 [00:01<00:00, 42.95it/s]
***************************Test results************************
Test Evaluation: acc: 1.00000, pr_auc: 1.00000, roc_auc: 1.00000
[[2443    0]
 [   0 2162]]
model save in ./data/wjq/models_weights/Big/BigFaced/epoch20_acc_1.00000_pr_1.00000_roc_1.00000.pth
5-fold cross validation results: acc 0.8832227879029949, pr_auc 0.8778854213025656, roc_auc 0.8840911623833907
Done!!!!!
